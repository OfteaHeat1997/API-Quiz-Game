"use strict";var EI=Object.create;var Qu=Object.defineProperty;var PI=Object.getOwnPropertyDescriptor;var xI=Object.getOwnPropertyNames;var kI=Object.getPrototypeOf,RI=Object.prototype.hasOwnProperty;var L=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),_I=(r,e)=>{for(var t in e)Qu(r,t,{get:e[t],enumerable:!0})},rb=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of xI(e))!RI.call(r,i)&&i!==t&&Qu(r,i,{get:()=>e[i],enumerable:!(n=PI(e,i))||n.enumerable});return r};var V=(r,e,t)=>(t=r!=null?EI(kI(r)):{},rb(e||!r||!r.__esModule?Qu(t,"default",{value:r,enumerable:!0}):t,r)),II=r=>rb(Qu({},"__esModule",{value:!0}),r);var ib=L(bp=>{var nb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");bp.encode=function(r){if(0<=r&&r<nb.length)return nb[r];throw new TypeError("Must be between 0 and 63: "+r)};bp.decode=function(r){var e=65,t=90,n=97,i=122,s=48,o=57,a=43,u=47,c=26,l=52;return e<=r&&r<=t?r-e:n<=r&&r<=i?r-n+c:s<=r&&r<=o?r-s+l:r==a?62:r==u?63:-1}});var Tp=L(Dp=>{var sb=ib(),Cp=5,ob=1<<Cp,ab=ob-1,ub=ob;function OI(r){return r<0?(-r<<1)+1:(r<<1)+0}function AI(r){var e=(r&1)===1,t=r>>1;return e?-t:t}Dp.encode=function(e){var t="",n,i=OI(e);do n=i&ab,i>>>=Cp,i>0&&(n|=ub),t+=sb.encode(n);while(i>0);return t};Dp.decode=function(e,t,n){var i=e.length,s=0,o=0,a,u;do{if(t>=i)throw new Error("Expected more digits in base 64 VLQ value.");if(u=sb.decode(e.charCodeAt(t++)),u===-1)throw new Error("Invalid base64 digit: "+e.charAt(t-1));a=!!(u&ub),u&=ab,s=s+(u<<o),o+=Cp}while(a);n.value=AI(s),n.rest=t}});var Qs=L(ur=>{function NI(r,e,t){if(e in r)return r[e];if(arguments.length===3)return t;throw new Error('"'+e+'" is a required argument.')}ur.getArg=NI;var cb=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,FI=/^data:.+\,.+$/;function ga(r){var e=r.match(cb);return e?{scheme:e[1],auth:e[2],host:e[3],port:e[4],path:e[5]}:null}ur.urlParse=ga;function zs(r){var e="";return r.scheme&&(e+=r.scheme+":"),e+="//",r.auth&&(e+=r.auth+"@"),r.host&&(e+=r.host),r.port&&(e+=":"+r.port),r.path&&(e+=r.path),e}ur.urlGenerate=zs;function Sp(r){var e=r,t=ga(r);if(t){if(!t.path)return r;e=t.path}for(var n=ur.isAbsolute(e),i=e.split(/\/+/),s,o=0,a=i.length-1;a>=0;a--)s=i[a],s==="."?i.splice(a,1):s===".."?o++:o>0&&(s===""?(i.splice(a+1,o),o=0):(i.splice(a,2),o--));return e=i.join("/"),e===""&&(e=n?"/":"."),t?(t.path=e,zs(t)):e}ur.normalize=Sp;function lb(r,e){r===""&&(r="."),e===""&&(e=".");var t=ga(e),n=ga(r);if(n&&(r=n.path||"/"),t&&!t.scheme)return n&&(t.scheme=n.scheme),zs(t);if(t||e.match(FI))return e;if(n&&!n.host&&!n.path)return n.host=e,zs(n);var i=e.charAt(0)==="/"?e:Sp(r.replace(/\/+$/,"")+"/"+e);return n?(n.path=i,zs(n)):i}ur.join=lb;ur.isAbsolute=function(r){return r.charAt(0)==="/"||cb.test(r)};function LI(r,e){r===""&&(r="."),r=r.replace(/\/$/,"");for(var t=0;e.indexOf(r+"/")!==0;){var n=r.lastIndexOf("/");if(n<0||(r=r.slice(0,n),r.match(/^([^\/]+:\/)?\/*$/)))return e;++t}return Array(t+1).join("../")+e.substr(r.length+1)}ur.relative=LI;var db=function(){var r=Object.create(null);return!("__proto__"in r)}();function fb(r){return r}function MI(r){return pb(r)?"$"+r:r}ur.toSetString=db?fb:MI;function qI(r){return pb(r)?r.slice(1):r}ur.fromSetString=db?fb:qI;function pb(r){if(!r)return!1;var e=r.length;if(e<9||r.charCodeAt(e-1)!==95||r.charCodeAt(e-2)!==95||r.charCodeAt(e-3)!==111||r.charCodeAt(e-4)!==116||r.charCodeAt(e-5)!==111||r.charCodeAt(e-6)!==114||r.charCodeAt(e-7)!==112||r.charCodeAt(e-8)!==95||r.charCodeAt(e-9)!==95)return!1;for(var t=e-10;t>=0;t--)if(r.charCodeAt(t)!==36)return!1;return!0}function jI(r,e,t){var n=Gs(r.source,e.source);return n!==0||(n=r.originalLine-e.originalLine,n!==0)||(n=r.originalColumn-e.originalColumn,n!==0||t)||(n=r.generatedColumn-e.generatedColumn,n!==0)||(n=r.generatedLine-e.generatedLine,n!==0)?n:Gs(r.name,e.name)}ur.compareByOriginalPositions=jI;function UI(r,e,t){var n=r.generatedLine-e.generatedLine;return n!==0||(n=r.generatedColumn-e.generatedColumn,n!==0||t)||(n=Gs(r.source,e.source),n!==0)||(n=r.originalLine-e.originalLine,n!==0)||(n=r.originalColumn-e.originalColumn,n!==0)?n:Gs(r.name,e.name)}ur.compareByGeneratedPositionsDeflated=UI;function Gs(r,e){return r===e?0:r===null?1:e===null?-1:r>e?1:-1}function $I(r,e){var t=r.generatedLine-e.generatedLine;return t!==0||(t=r.generatedColumn-e.generatedColumn,t!==0)||(t=Gs(r.source,e.source),t!==0)||(t=r.originalLine-e.originalLine,t!==0)||(t=r.originalColumn-e.originalColumn,t!==0)?t:Gs(r.name,e.name)}ur.compareByGeneratedPositionsInflated=$I;function BI(r){return JSON.parse(r.replace(/^\)]}'[^\n]*\n/,""))}ur.parseSourceMapInput=BI;function WI(r,e,t){if(e=e||"",r&&(r[r.length-1]!=="/"&&e[0]!=="/"&&(r+="/"),e=r+e),t){var n=ga(t);if(!n)throw new Error("sourceMapURL could not be parsed");if(n.path){var i=n.path.lastIndexOf("/");i>=0&&(n.path=n.path.substring(0,i+1))}e=lb(zs(n),e)}return Sp(e)}ur.computeSourceURL=WI});var xp=L(hb=>{var Ep=Qs(),Pp=Object.prototype.hasOwnProperty,ms=typeof Map<"u";function oi(){this._array=[],this._set=ms?new Map:Object.create(null)}oi.fromArray=function(e,t){for(var n=new oi,i=0,s=e.length;i<s;i++)n.add(e[i],t);return n};oi.prototype.size=function(){return ms?this._set.size:Object.getOwnPropertyNames(this._set).length};oi.prototype.add=function(e,t){var n=ms?e:Ep.toSetString(e),i=ms?this.has(e):Pp.call(this._set,n),s=this._array.length;(!i||t)&&this._array.push(e),i||(ms?this._set.set(e,s):this._set[n]=s)};oi.prototype.has=function(e){if(ms)return this._set.has(e);var t=Ep.toSetString(e);return Pp.call(this._set,t)};oi.prototype.indexOf=function(e){if(ms){var t=this._set.get(e);if(t>=0)return t}else{var n=Ep.toSetString(e);if(Pp.call(this._set,n))return this._set[n]}throw new Error('"'+e+'" is not in the set.')};oi.prototype.at=function(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)};oi.prototype.toArray=function(){return this._array.slice()};hb.ArraySet=oi});var vb=L(mb=>{var gb=Qs();function VI(r,e){var t=r.generatedLine,n=e.generatedLine,i=r.generatedColumn,s=e.generatedColumn;return n>t||n==t&&s>=i||gb.compareByGeneratedPositionsInflated(r,e)<=0}function Yu(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}Yu.prototype.unsortedForEach=function(e,t){this._array.forEach(e,t)};Yu.prototype.add=function(e){VI(this._last,e)?(this._last=e,this._array.push(e)):(this._sorted=!1,this._array.push(e))};Yu.prototype.toArray=function(){return this._sorted||(this._array.sort(gb.compareByGeneratedPositionsInflated),this._sorted=!0),this._array};mb.MappingList=Yu});var kp=L(wb=>{var ma=Tp(),Vt=Qs(),Ju=xp().ArraySet,HI=vb().MappingList;function dn(r){r||(r={}),this._file=Vt.getArg(r,"file",null),this._sourceRoot=Vt.getArg(r,"sourceRoot",null),this._skipValidation=Vt.getArg(r,"skipValidation",!1),this._sources=new Ju,this._names=new Ju,this._mappings=new HI,this._sourcesContents=null}dn.prototype._version=3;dn.fromSourceMap=function(e){var t=e.sourceRoot,n=new dn({file:e.file,sourceRoot:t});return e.eachMapping(function(i){var s={generated:{line:i.generatedLine,column:i.generatedColumn}};i.source!=null&&(s.source=i.source,t!=null&&(s.source=Vt.relative(t,s.source)),s.original={line:i.originalLine,column:i.originalColumn},i.name!=null&&(s.name=i.name)),n.addMapping(s)}),e.sources.forEach(function(i){var s=i;t!==null&&(s=Vt.relative(t,i)),n._sources.has(s)||n._sources.add(s);var o=e.sourceContentFor(i);o!=null&&n.setSourceContent(i,o)}),n};dn.prototype.addMapping=function(e){var t=Vt.getArg(e,"generated"),n=Vt.getArg(e,"original",null),i=Vt.getArg(e,"source",null),s=Vt.getArg(e,"name",null);this._skipValidation||this._validateMapping(t,n,i,s),i!=null&&(i=String(i),this._sources.has(i)||this._sources.add(i)),s!=null&&(s=String(s),this._names.has(s)||this._names.add(s)),this._mappings.add({generatedLine:t.line,generatedColumn:t.column,originalLine:n!=null&&n.line,originalColumn:n!=null&&n.column,source:i,name:s})};dn.prototype.setSourceContent=function(e,t){var n=e;this._sourceRoot!=null&&(n=Vt.relative(this._sourceRoot,n)),t!=null?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[Vt.toSetString(n)]=t):this._sourcesContents&&(delete this._sourcesContents[Vt.toSetString(n)],Object.keys(this._sourcesContents).length===0&&(this._sourcesContents=null))};dn.prototype.applySourceMap=function(e,t,n){var i=t;if(t==null){if(e.file==null)throw new Error(`SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map's "file" property. Both were omitted.`);i=e.file}var s=this._sourceRoot;s!=null&&(i=Vt.relative(s,i));var o=new Ju,a=new Ju;this._mappings.unsortedForEach(function(u){if(u.source===i&&u.originalLine!=null){var c=e.originalPositionFor({line:u.originalLine,column:u.originalColumn});c.source!=null&&(u.source=c.source,n!=null&&(u.source=Vt.join(n,u.source)),s!=null&&(u.source=Vt.relative(s,u.source)),u.originalLine=c.line,u.originalColumn=c.column,c.name!=null&&(u.name=c.name))}var l=u.source;l!=null&&!o.has(l)&&o.add(l);var f=u.name;f!=null&&!a.has(f)&&a.add(f)},this),this._sources=o,this._names=a,e.sources.forEach(function(u){var c=e.sourceContentFor(u);c!=null&&(n!=null&&(u=Vt.join(n,u)),s!=null&&(u=Vt.relative(s,u)),this.setSourceContent(u,c))},this)};dn.prototype._validateMapping=function(e,t,n,i){if(t&&typeof t.line!="number"&&typeof t.column!="number")throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(!(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!n&&!i)){if(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&n)return;throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:n,original:t,name:i}))}};dn.prototype._serializeMappings=function(){for(var e=0,t=1,n=0,i=0,s=0,o=0,a="",u,c,l,f,d=this._mappings.toArray(),h=0,m=d.length;h<m;h++){if(c=d[h],u="",c.generatedLine!==t)for(e=0;c.generatedLine!==t;)u+=";",t++;else if(h>0){if(!Vt.compareByGeneratedPositionsInflated(c,d[h-1]))continue;u+=","}u+=ma.encode(c.generatedColumn-e),e=c.generatedColumn,c.source!=null&&(f=this._sources.indexOf(c.source),u+=ma.encode(f-o),o=f,u+=ma.encode(c.originalLine-1-i),i=c.originalLine-1,u+=ma.encode(c.originalColumn-n),n=c.originalColumn,c.name!=null&&(l=this._names.indexOf(c.name),u+=ma.encode(l-s),s=l)),a+=u}return a};dn.prototype._generateSourcesContent=function(e,t){return e.map(function(n){if(!this._sourcesContents)return null;t!=null&&(n=Vt.relative(t,n));var i=Vt.toSetString(n);return Object.prototype.hasOwnProperty.call(this._sourcesContents,i)?this._sourcesContents[i]:null},this)};dn.prototype.toJSON=function(){var e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return this._file!=null&&(e.file=this._file),this._sourceRoot!=null&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e};dn.prototype.toString=function(){return JSON.stringify(this.toJSON())};wb.SourceMapGenerator=dn});var yb=L(vs=>{vs.GREATEST_LOWER_BOUND=1;vs.LEAST_UPPER_BOUND=2;function Rp(r,e,t,n,i,s){var o=Math.floor((e-r)/2)+r,a=i(t,n[o],!0);return a===0?o:a>0?e-o>1?Rp(o,e,t,n,i,s):s==vs.LEAST_UPPER_BOUND?e<n.length?e:-1:o:o-r>1?Rp(r,o,t,n,i,s):s==vs.LEAST_UPPER_BOUND?o:r<0?-1:r}vs.search=function(e,t,n,i){if(t.length===0)return-1;var s=Rp(-1,t.length,e,t,n,i||vs.GREATEST_LOWER_BOUND);if(s<0)return-1;for(;s-1>=0&&n(t[s],t[s-1],!0)===0;)--s;return s}});var Cb=L(bb=>{function _p(r,e,t){var n=r[e];r[e]=r[t],r[t]=n}function KI(r,e){return Math.round(r+Math.random()*(e-r))}function Ip(r,e,t,n){if(t<n){var i=KI(t,n),s=t-1;_p(r,i,n);for(var o=r[n],a=t;a<n;a++)e(r[a],o)<=0&&(s+=1,_p(r,s,a));_p(r,s+1,a);var u=s+1;Ip(r,e,t,u-1),Ip(r,e,u+1,n)}}bb.quickSort=function(r,e){Ip(r,e,0,r.length-1)}});var Tb=L(Zu=>{var pe=Qs(),Op=yb(),Ys=xp().ArraySet,XI=Tp(),va=Cb().quickSort;function ft(r,e){var t=r;return typeof r=="string"&&(t=pe.parseSourceMapInput(r)),t.sections!=null?new En(t,e):new sr(t,e)}ft.fromSourceMap=function(r,e){return sr.fromSourceMap(r,e)};ft.prototype._version=3;ft.prototype.__generatedMappings=null;Object.defineProperty(ft.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}});ft.prototype.__originalMappings=null;Object.defineProperty(ft.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}});ft.prototype._charIsMappingSeparator=function(e,t){var n=e.charAt(t);return n===";"||n===","};ft.prototype._parseMappings=function(e,t){throw new Error("Subclasses must implement _parseMappings")};ft.GENERATED_ORDER=1;ft.ORIGINAL_ORDER=2;ft.GREATEST_LOWER_BOUND=1;ft.LEAST_UPPER_BOUND=2;ft.prototype.eachMapping=function(e,t,n){var i=t||null,s=n||ft.GENERATED_ORDER,o;switch(s){case ft.GENERATED_ORDER:o=this._generatedMappings;break;case ft.ORIGINAL_ORDER:o=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var a=this.sourceRoot;o.map(function(u){var c=u.source===null?null:this._sources.at(u.source);return c=pe.computeSourceURL(a,c,this._sourceMapURL),{source:c,generatedLine:u.generatedLine,generatedColumn:u.generatedColumn,originalLine:u.originalLine,originalColumn:u.originalColumn,name:u.name===null?null:this._names.at(u.name)}},this).forEach(e,i)};ft.prototype.allGeneratedPositionsFor=function(e){var t=pe.getArg(e,"line"),n={source:pe.getArg(e,"source"),originalLine:t,originalColumn:pe.getArg(e,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];var i=[],s=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",pe.compareByOriginalPositions,Op.LEAST_UPPER_BOUND);if(s>=0){var o=this._originalMappings[s];if(e.column===void 0)for(var a=o.originalLine;o&&o.originalLine===a;)i.push({line:pe.getArg(o,"generatedLine",null),column:pe.getArg(o,"generatedColumn",null),lastColumn:pe.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++s];else for(var u=o.originalColumn;o&&o.originalLine===t&&o.originalColumn==u;)i.push({line:pe.getArg(o,"generatedLine",null),column:pe.getArg(o,"generatedColumn",null),lastColumn:pe.getArg(o,"lastGeneratedColumn",null)}),o=this._originalMappings[++s]}return i};Zu.SourceMapConsumer=ft;function sr(r,e){var t=r;typeof r=="string"&&(t=pe.parseSourceMapInput(r));var n=pe.getArg(t,"version"),i=pe.getArg(t,"sources"),s=pe.getArg(t,"names",[]),o=pe.getArg(t,"sourceRoot",null),a=pe.getArg(t,"sourcesContent",null),u=pe.getArg(t,"mappings"),c=pe.getArg(t,"file",null);if(n!=this._version)throw new Error("Unsupported version: "+n);o&&(o=pe.normalize(o)),i=i.map(String).map(pe.normalize).map(function(l){return o&&pe.isAbsolute(o)&&pe.isAbsolute(l)?pe.relative(o,l):l}),this._names=Ys.fromArray(s.map(String),!0),this._sources=Ys.fromArray(i,!0),this._absoluteSources=this._sources.toArray().map(function(l){return pe.computeSourceURL(o,l,e)}),this.sourceRoot=o,this.sourcesContent=a,this._mappings=u,this._sourceMapURL=e,this.file=c}sr.prototype=Object.create(ft.prototype);sr.prototype.consumer=ft;sr.prototype._findSourceIndex=function(r){var e=r;if(this.sourceRoot!=null&&(e=pe.relative(this.sourceRoot,e)),this._sources.has(e))return this._sources.indexOf(e);var t;for(t=0;t<this._absoluteSources.length;++t)if(this._absoluteSources[t]==r)return t;return-1};sr.fromSourceMap=function(e,t){var n=Object.create(sr.prototype),i=n._names=Ys.fromArray(e._names.toArray(),!0),s=n._sources=Ys.fromArray(e._sources.toArray(),!0);n.sourceRoot=e._sourceRoot,n.sourcesContent=e._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=e._file,n._sourceMapURL=t,n._absoluteSources=n._sources.toArray().map(function(h){return pe.computeSourceURL(n.sourceRoot,h,t)});for(var o=e._mappings.toArray().slice(),a=n.__generatedMappings=[],u=n.__originalMappings=[],c=0,l=o.length;c<l;c++){var f=o[c],d=new Db;d.generatedLine=f.generatedLine,d.generatedColumn=f.generatedColumn,f.source&&(d.source=s.indexOf(f.source),d.originalLine=f.originalLine,d.originalColumn=f.originalColumn,f.name&&(d.name=i.indexOf(f.name)),u.push(d)),a.push(d)}return va(n.__originalMappings,pe.compareByOriginalPositions),n};sr.prototype._version=3;Object.defineProperty(sr.prototype,"sources",{get:function(){return this._absoluteSources.slice()}});function Db(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}sr.prototype._parseMappings=function(e,t){for(var n=1,i=0,s=0,o=0,a=0,u=0,c=e.length,l=0,f={},d={},h=[],m=[],D,_,R,N,w;l<c;)if(e.charAt(l)===";")n++,l++,i=0;else if(e.charAt(l)===",")l++;else{for(D=new Db,D.generatedLine=n,N=l;N<c&&!this._charIsMappingSeparator(e,N);N++);if(_=e.slice(l,N),R=f[_],R)l+=_.length;else{for(R=[];l<N;)XI.decode(e,l,d),w=d.value,l=d.rest,R.push(w);if(R.length===2)throw new Error("Found a source, but no line and column");if(R.length===3)throw new Error("Found a source and line, but no column");f[_]=R}D.generatedColumn=i+R[0],i=D.generatedColumn,R.length>1&&(D.source=a+R[1],a+=R[1],D.originalLine=s+R[2],s=D.originalLine,D.originalLine+=1,D.originalColumn=o+R[3],o=D.originalColumn,R.length>4&&(D.name=u+R[4],u+=R[4])),m.push(D),typeof D.originalLine=="number"&&h.push(D)}va(m,pe.compareByGeneratedPositionsDeflated),this.__generatedMappings=m,va(h,pe.compareByOriginalPositions),this.__originalMappings=h};sr.prototype._findMapping=function(e,t,n,i,s,o){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[i]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[i]);return Op.search(e,t,s,o)};sr.prototype.computeColumnSpans=function(){for(var e=0;e<this._generatedMappings.length;++e){var t=this._generatedMappings[e];if(e+1<this._generatedMappings.length){var n=this._generatedMappings[e+1];if(t.generatedLine===n.generatedLine){t.lastGeneratedColumn=n.generatedColumn-1;continue}}t.lastGeneratedColumn=1/0}};sr.prototype.originalPositionFor=function(e){var t={generatedLine:pe.getArg(e,"line"),generatedColumn:pe.getArg(e,"column")},n=this._findMapping(t,this._generatedMappings,"generatedLine","generatedColumn",pe.compareByGeneratedPositionsDeflated,pe.getArg(e,"bias",ft.GREATEST_LOWER_BOUND));if(n>=0){var i=this._generatedMappings[n];if(i.generatedLine===t.generatedLine){var s=pe.getArg(i,"source",null);s!==null&&(s=this._sources.at(s),s=pe.computeSourceURL(this.sourceRoot,s,this._sourceMapURL));var o=pe.getArg(i,"name",null);return o!==null&&(o=this._names.at(o)),{source:s,line:pe.getArg(i,"originalLine",null),column:pe.getArg(i,"originalColumn",null),name:o}}}return{source:null,line:null,column:null,name:null}};sr.prototype.hasContentsOfAllSources=function(){return this.sourcesContent?this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some(function(e){return e==null}):!1};sr.prototype.sourceContentFor=function(e,t){if(!this.sourcesContent)return null;var n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];var i=e;this.sourceRoot!=null&&(i=pe.relative(this.sourceRoot,i));var s;if(this.sourceRoot!=null&&(s=pe.urlParse(this.sourceRoot))){var o=i.replace(/^file:\/\//,"");if(s.scheme=="file"&&this._sources.has(o))return this.sourcesContent[this._sources.indexOf(o)];if((!s.path||s.path=="/")&&this._sources.has("/"+i))return this.sourcesContent[this._sources.indexOf("/"+i)]}if(t)return null;throw new Error('"'+i+'" is not in the SourceMap.')};sr.prototype.generatedPositionFor=function(e){var t=pe.getArg(e,"source");if(t=this._findSourceIndex(t),t<0)return{line:null,column:null,lastColumn:null};var n={source:t,originalLine:pe.getArg(e,"line"),originalColumn:pe.getArg(e,"column")},i=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",pe.compareByOriginalPositions,pe.getArg(e,"bias",ft.GREATEST_LOWER_BOUND));if(i>=0){var s=this._originalMappings[i];if(s.source===n.source)return{line:pe.getArg(s,"generatedLine",null),column:pe.getArg(s,"generatedColumn",null),lastColumn:pe.getArg(s,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}};Zu.BasicSourceMapConsumer=sr;function En(r,e){var t=r;typeof r=="string"&&(t=pe.parseSourceMapInput(r));var n=pe.getArg(t,"version"),i=pe.getArg(t,"sections");if(n!=this._version)throw new Error("Unsupported version: "+n);this._sources=new Ys,this._names=new Ys;var s={line:-1,column:0};this._sections=i.map(function(o){if(o.url)throw new Error("Support for url field in sections not implemented.");var a=pe.getArg(o,"offset"),u=pe.getArg(a,"line"),c=pe.getArg(a,"column");if(u<s.line||u===s.line&&c<s.column)throw new Error("Section offsets must be ordered and non-overlapping.");return s=a,{generatedOffset:{generatedLine:u+1,generatedColumn:c+1},consumer:new ft(pe.getArg(o,"map"),e)}})}En.prototype=Object.create(ft.prototype);En.prototype.constructor=ft;En.prototype._version=3;Object.defineProperty(En.prototype,"sources",{get:function(){for(var r=[],e=0;e<this._sections.length;e++)for(var t=0;t<this._sections[e].consumer.sources.length;t++)r.push(this._sections[e].consumer.sources[t]);return r}});En.prototype.originalPositionFor=function(e){var t={generatedLine:pe.getArg(e,"line"),generatedColumn:pe.getArg(e,"column")},n=Op.search(t,this._sections,function(s,o){var a=s.generatedLine-o.generatedOffset.generatedLine;return a||s.generatedColumn-o.generatedOffset.generatedColumn}),i=this._sections[n];return i?i.consumer.originalPositionFor({line:t.generatedLine-(i.generatedOffset.generatedLine-1),column:t.generatedColumn-(i.generatedOffset.generatedLine===t.generatedLine?i.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}};En.prototype.hasContentsOfAllSources=function(){return this._sections.every(function(e){return e.consumer.hasContentsOfAllSources()})};En.prototype.sourceContentFor=function(e,t){for(var n=0;n<this._sections.length;n++){var i=this._sections[n],s=i.consumer.sourceContentFor(e,!0);if(s)return s}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')};En.prototype.generatedPositionFor=function(e){for(var t=0;t<this._sections.length;t++){var n=this._sections[t];if(n.consumer._findSourceIndex(pe.getArg(e,"source"))!==-1){var i=n.consumer.generatedPositionFor(e);if(i){var s={line:i.line+(n.generatedOffset.generatedLine-1),column:i.column+(n.generatedOffset.generatedLine===i.line?n.generatedOffset.generatedColumn-1:0)};return s}}}return{line:null,column:null}};En.prototype._parseMappings=function(e,t){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var i=this._sections[n],s=i.consumer._generatedMappings,o=0;o<s.length;o++){var a=s[o],u=i.consumer._sources.at(a.source);u=pe.computeSourceURL(i.consumer.sourceRoot,u,this._sourceMapURL),this._sources.add(u),u=this._sources.indexOf(u);var c=null;a.name&&(c=i.consumer._names.at(a.name),this._names.add(c),c=this._names.indexOf(c));var l={source:u,generatedLine:a.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:a.generatedColumn+(i.generatedOffset.generatedLine===a.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:a.originalLine,originalColumn:a.originalColumn,name:c};this.__generatedMappings.push(l),typeof l.originalLine=="number"&&this.__originalMappings.push(l)}va(this.__generatedMappings,pe.compareByGeneratedPositionsDeflated),va(this.__originalMappings,pe.compareByOriginalPositions)};Zu.IndexedSourceMapConsumer=En});var Eb=L(Sb=>{var zI=kp().SourceMapGenerator,ec=Qs(),GI=/(\r?\n)/,QI=10,Js="$$$isSourceNode$$$";function Qr(r,e,t,n,i){this.children=[],this.sourceContents={},this.line=r??null,this.column=e??null,this.source=t??null,this.name=i??null,this[Js]=!0,n!=null&&this.add(n)}Qr.fromStringWithSourceMap=function(e,t,n){var i=new Qr,s=e.split(GI),o=0,a=function(){var d=m(),h=m()||"";return d+h;function m(){return o<s.length?s[o++]:void 0}},u=1,c=0,l=null;return t.eachMapping(function(d){if(l!==null)if(u<d.generatedLine)f(l,a()),u++,c=0;else{var h=s[o]||"",m=h.substr(0,d.generatedColumn-c);s[o]=h.substr(d.generatedColumn-c),c=d.generatedColumn,f(l,m),l=d;return}for(;u<d.generatedLine;)i.add(a()),u++;if(c<d.generatedColumn){var h=s[o]||"";i.add(h.substr(0,d.generatedColumn)),s[o]=h.substr(d.generatedColumn),c=d.generatedColumn}l=d},this),o<s.length&&(l&&f(l,a()),i.add(s.splice(o).join(""))),t.sources.forEach(function(d){var h=t.sourceContentFor(d);h!=null&&(n!=null&&(d=ec.join(n,d)),i.setSourceContent(d,h))}),i;function f(d,h){if(d===null||d.source===void 0)i.add(h);else{var m=n?ec.join(n,d.source):d.source;i.add(new Qr(d.originalLine,d.originalColumn,m,h,d.name))}}};Qr.prototype.add=function(e){if(Array.isArray(e))e.forEach(function(t){this.add(t)},this);else if(e[Js]||typeof e=="string")e&&this.children.push(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};Qr.prototype.prepend=function(e){if(Array.isArray(e))for(var t=e.length-1;t>=0;t--)this.prepend(e[t]);else if(e[Js]||typeof e=="string")this.children.unshift(e);else throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);return this};Qr.prototype.walk=function(e){for(var t,n=0,i=this.children.length;n<i;n++)t=this.children[n],t[Js]?t.walk(e):t!==""&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})};Qr.prototype.join=function(e){var t,n,i=this.children.length;if(i>0){for(t=[],n=0;n<i-1;n++)t.push(this.children[n]),t.push(e);t.push(this.children[n]),this.children=t}return this};Qr.prototype.replaceRight=function(e,t){var n=this.children[this.children.length-1];return n[Js]?n.replaceRight(e,t):typeof n=="string"?this.children[this.children.length-1]=n.replace(e,t):this.children.push("".replace(e,t)),this};Qr.prototype.setSourceContent=function(e,t){this.sourceContents[ec.toSetString(e)]=t};Qr.prototype.walkSourceContents=function(e){for(var t=0,n=this.children.length;t<n;t++)this.children[t][Js]&&this.children[t].walkSourceContents(e);for(var i=Object.keys(this.sourceContents),t=0,n=i.length;t<n;t++)e(ec.fromSetString(i[t]),this.sourceContents[i[t]])};Qr.prototype.toString=function(){var e="";return this.walk(function(t){e+=t}),e};Qr.prototype.toStringWithSourceMap=function(e){var t={code:"",line:1,column:0},n=new zI(e),i=!1,s=null,o=null,a=null,u=null;return this.walk(function(c,l){t.code+=c,l.source!==null&&l.line!==null&&l.column!==null?((s!==l.source||o!==l.line||a!==l.column||u!==l.name)&&n.addMapping({source:l.source,original:{line:l.line,column:l.column},generated:{line:t.line,column:t.column},name:l.name}),s=l.source,o=l.line,a=l.column,u=l.name,i=!0):i&&(n.addMapping({generated:{line:t.line,column:t.column}}),s=null,i=!1);for(var f=0,d=c.length;f<d;f++)c.charCodeAt(f)===QI?(t.line++,t.column=0,f+1===d?(s=null,i=!1):i&&n.addMapping({source:l.source,original:{line:l.line,column:l.column},generated:{line:t.line,column:t.column},name:l.name})):t.column++}),this.walkSourceContents(function(c,l){n.setSourceContent(c,l)}),{code:t.code,map:n}};Sb.SourceNode=Qr});var Pb=L(tc=>{tc.SourceMapGenerator=kp().SourceMapGenerator;tc.SourceMapConsumer=Tb().SourceMapConsumer;tc.SourceNode=Eb().SourceNode});var kb=L((Dj,xb)=>{var YI=Object.prototype.toString,Ap=typeof Buffer<"u"&&typeof Buffer.alloc=="function"&&typeof Buffer.allocUnsafe=="function"&&typeof Buffer.from=="function";function JI(r){return YI.call(r).slice(8,-1)==="ArrayBuffer"}function ZI(r,e,t){e>>>=0;var n=r.byteLength-e;if(n<0)throw new RangeError("'offset' is out of bounds");if(t===void 0)t=n;else if(t>>>=0,t>n)throw new RangeError("'length' is out of bounds");return Ap?Buffer.from(r.slice(e,e+t)):new Buffer(new Uint8Array(r.slice(e,e+t)))}function eO(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!Buffer.isEncoding(e))throw new TypeError('"encoding" must be a valid string encoding');return Ap?Buffer.from(r,e):new Buffer(r,e)}function tO(r,e,t){if(typeof r=="number")throw new TypeError('"value" argument must not be a number');return JI(r)?ZI(r,e,t):typeof r=="string"?eO(r,e):Ap?Buffer.from(r):new Buffer(r)}xb.exports=tO});var Lb=L((ys,Mp)=>{var rO=Pb().SourceMapConsumer,Np=require("path"),Mn;try{Mn=require("fs"),(!Mn.existsSync||!Mn.readFileSync)&&(Mn=null)}catch{}var nO=kb();function Rb(r,e){return r.require(e)}var _b=!1,Ib=!1,Fp=!1,wa="auto",ws={},ya={},iO=/^data:application\/json[^,]+base64,/,_i=[],Ii=[];function qp(){return wa==="browser"?!0:wa==="node"?!1:typeof window<"u"&&typeof XMLHttpRequest=="function"&&!(window.require&&window.module&&window.process&&window.process.type==="renderer")}function sO(){return typeof process=="object"&&process!==null&&typeof process.on=="function"}function oO(){return typeof process=="object"&&process!==null?process.version:""}function aO(){if(typeof process=="object"&&process!==null)return process.stderr}function uO(r){if(typeof process=="object"&&process!==null&&typeof process.exit=="function")return process.exit(r)}function rc(r){return function(e){for(var t=0;t<r.length;t++){var n=r[t](e);if(n)return n}return null}}var jp=rc(_i);_i.push(function(r){if(r=r.trim(),/^file:/.test(r)&&(r=r.replace(/file:\/\/\/(\w:)?/,function(n,i){return i?"":"/"})),r in ws)return ws[r];var e="";try{if(Mn)Mn.existsSync(r)&&(e=Mn.readFileSync(r,"utf8"));else{var t=new XMLHttpRequest;t.open("GET",r,!1),t.send(null),t.readyState===4&&t.status===200&&(e=t.responseText)}}catch{}return ws[r]=e});function Lp(r,e){if(!r)return e;var t=Np.dirname(r),n=/^\w+:\/\/[^\/]*/.exec(t),i=n?n[0]:"",s=t.slice(i.length);return i&&/^\/\w\:/.test(s)?(i+="/",i+Np.resolve(t.slice(i.length),e).replace(/\\/g,"/")):i+Np.resolve(t.slice(i.length),e)}function cO(r){var e;if(qp())try{var t=new XMLHttpRequest;t.open("GET",r,!1),t.send(null),e=t.readyState===4?t.responseText:null;var n=t.getResponseHeader("SourceMap")||t.getResponseHeader("X-SourceMap");if(n)return n}catch{}e=jp(r);for(var i=/(?:\/\/[@#][\s]*sourceMappingURL=([^\s'"]+)[\s]*$)|(?:\/\*[@#][\s]*sourceMappingURL=([^\s*'"]+)[\s]*(?:\*\/)[\s]*$)/mg,s,o;o=i.exec(e);)s=o;return s?s[1]:null}var Up=rc(Ii);Ii.push(function(r){var e=cO(r);if(!e)return null;var t;if(iO.test(e)){var n=e.slice(e.indexOf(",")+1);t=nO(n,"base64").toString(),e=r}else e=Lp(r,e),t=jp(e);return t?{url:e,map:t}:null});function $p(r){var e=ya[r.source];if(!e){var t=Up(r.source);t?(e=ya[r.source]={url:t.url,map:new rO(t.map)},e.map.sourcesContent&&e.map.sources.forEach(function(i,s){var o=e.map.sourcesContent[s];if(o){var a=Lp(e.url,i);ws[a]=o}})):e=ya[r.source]={url:null,map:null}}if(e&&e.map&&typeof e.map.originalPositionFor=="function"){var n=e.map.originalPositionFor(r);if(n.source!==null)return n.source=Lp(e.url,n.source),n}return r}function Ab(r){var e=/^eval at ([^(]+) \((.+):(\d+):(\d+)\)$/.exec(r);if(e){var t=$p({source:e[2],line:+e[3],column:e[4]-1});return"eval at "+e[1]+" ("+t.source+":"+t.line+":"+(t.column+1)+")"}return e=/^eval at ([^(]+) \((.+)\)$/.exec(r),e?"eval at "+e[1]+" ("+Ab(e[2])+")":r}function lO(){var r,e="";if(this.isNative())e="native";else{r=this.getScriptNameOrSourceURL(),!r&&this.isEval()&&(e=this.getEvalOrigin(),e+=", "),r?e+=r:e+="<anonymous>";var t=this.getLineNumber();if(t!=null){e+=":"+t;var n=this.getColumnNumber();n&&(e+=":"+n)}}var i="",s=this.getFunctionName(),o=!0,a=this.isConstructor(),u=!(this.isToplevel()||a);if(u){var c=this.getTypeName();c==="[object Object]"&&(c="null");var l=this.getMethodName();s?(c&&s.indexOf(c)!=0&&(i+=c+"."),i+=s,l&&s.indexOf("."+l)!=s.length-l.length-1&&(i+=" [as "+l+"]")):i+=c+"."+(l||"<anonymous>")}else a?i+="new "+(s||"<anonymous>"):s?i+=s:(i+=e,o=!1);return o&&(i+=" ("+e+")"),i}function Ob(r){var e={};return Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach(function(t){e[t]=/^(?:is|get)/.test(t)?function(){return r[t].call(r)}:r[t]}),e.toString=lO,e}function Nb(r,e){if(e===void 0&&(e={nextPosition:null,curPosition:null}),r.isNative())return e.curPosition=null,r;var t=r.getFileName()||r.getScriptNameOrSourceURL();if(t){var n=r.getLineNumber(),i=r.getColumnNumber()-1,s=/^v(10\.1[6-9]|10\.[2-9][0-9]|10\.[0-9]{3,}|1[2-9]\d*|[2-9]\d|\d{3,}|11\.11)/,o=s.test(oO())?0:62;n===1&&i>o&&!qp()&&!r.isEval()&&(i-=o);var a=$p({source:t,line:n,column:i});e.curPosition=a,r=Ob(r);var u=r.getFunctionName;return r.getFunctionName=function(){return e.nextPosition==null?u():e.nextPosition.name||u()},r.getFileName=function(){return a.source},r.getLineNumber=function(){return a.line},r.getColumnNumber=function(){return a.column+1},r.getScriptNameOrSourceURL=function(){return a.source},r}var c=r.isEval()&&r.getEvalOrigin();return c&&(c=Ab(c),r=Ob(r),r.getEvalOrigin=function(){return c}),r}function dO(r,e){Fp&&(ws={},ya={});for(var t=r.name||"Error",n=r.message||"",i=t+": "+n,s={nextPosition:null,curPosition:null},o=[],a=e.length-1;a>=0;a--)o.push(`
    at `+Nb(e[a],s)),s.nextPosition=s.curPosition;return s.curPosition=s.nextPosition=null,i+o.reverse().join("")}function Fb(r){var e=/\n    at [^(]+ \((.*):(\d+):(\d+)\)/.exec(r.stack);if(e){var t=e[1],n=+e[2],i=+e[3],s=ws[t];if(!s&&Mn&&Mn.existsSync(t))try{s=Mn.readFileSync(t,"utf8")}catch{s=""}if(s){var o=s.split(/(?:\r\n|\r|\n)/)[n-1];if(o)return t+":"+n+`
`+o+`
`+new Array(i).join(" ")+"^"}}return null}function fO(r){var e=Fb(r),t=aO();t&&t._handle&&t._handle.setBlocking&&t._handle.setBlocking(!0),e&&(console.error(),console.error(e)),console.error(r.stack),uO(1)}function pO(){var r=process.emit;process.emit=function(e){if(e==="uncaughtException"){var t=arguments[1]&&arguments[1].stack,n=this.listeners(e).length>0;if(t&&!n)return fO(arguments[1])}return r.apply(this,arguments)}}var hO=_i.slice(0),gO=Ii.slice(0);ys.wrapCallSite=Nb;ys.getErrorSource=Fb;ys.mapSourcePosition=$p;ys.retrieveSourceMap=Up;ys.install=function(r){if(r=r||{},r.environment&&(wa=r.environment,["node","browser","auto"].indexOf(wa)===-1))throw new Error("environment "+wa+" was unknown. Available options are {auto, browser, node}");if(r.retrieveFile&&(r.overrideRetrieveFile&&(_i.length=0),_i.unshift(r.retrieveFile)),r.retrieveSourceMap&&(r.overrideRetrieveSourceMap&&(Ii.length=0),Ii.unshift(r.retrieveSourceMap)),r.hookRequire&&!qp()){var e=Rb(Mp,"module"),t=e.prototype._compile;t.__sourceMapSupport||(e.prototype._compile=function(s,o){return ws[o]=s,ya[o]=void 0,t.call(this,s,o)},e.prototype._compile.__sourceMapSupport=!0)}if(Fp||(Fp="emptyCacheBetweenOperations"in r?r.emptyCacheBetweenOperations:!1),_b||(_b=!0,Error.prepareStackTrace=dO),!Ib){var n="handleUncaughtExceptions"in r?r.handleUncaughtExceptions:!0;try{var i=Rb(Mp,"worker_threads");i.isMainThread===!1&&(n=!1)}catch{}n&&sO()&&(Ib=!0,pO())}};ys.resetRetrieveHandlers=function(){_i.length=0,Ii.length=0,_i=hO.slice(0),Ii=gO.slice(0),Up=rc(Ii),jp=rc(_i)}});var Vp=L((Sj,jb)=>{var mO="Expected a function",Mb=NaN,vO="[object Symbol]",wO=/^\s+|\s+$/g,yO=/^[-+]0x[0-9a-f]+$/i,bO=/^0b[01]+$/i,CO=/^0o[0-7]+$/i,DO=parseInt,TO=typeof global=="object"&&global&&global.Object===Object&&global,SO=typeof self=="object"&&self&&self.Object===Object&&self,EO=TO||SO||Function("return this")(),PO=Object.prototype,xO=PO.toString,kO=Math.max,RO=Math.min,Bp=function(){return EO.Date.now()};function _O(r,e,t){var n,i,s,o,a,u,c=0,l=!1,f=!1,d=!0;if(typeof r!="function")throw new TypeError(mO);e=qb(e)||0,Wp(t)&&(l=!!t.leading,f="maxWait"in t,s=f?kO(qb(t.maxWait)||0,e):s,d="trailing"in t?!!t.trailing:d);function h(g){var k=n,b=i;return n=i=void 0,c=g,o=r.apply(b,k),o}function m(g){return c=g,a=setTimeout(R,e),l?h(g):o}function D(g){var k=g-u,b=g-c,C=e-k;return f?RO(C,s-b):C}function _(g){var k=g-u,b=g-c;return u===void 0||k>=e||k<0||f&&b>=s}function R(){var g=Bp();if(_(g))return N(g);a=setTimeout(R,D(g))}function N(g){return a=void 0,d&&n?h(g):(n=i=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,n=u=i=a=void 0}function p(){return a===void 0?o:N(Bp())}function v(){var g=Bp(),k=_(g);if(n=arguments,i=this,u=g,k){if(a===void 0)return m(u);if(f)return a=setTimeout(R,e),h(u)}return a===void 0&&(a=setTimeout(R,e)),o}return v.cancel=w,v.flush=p,v}function Wp(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function IO(r){return!!r&&typeof r=="object"}function OO(r){return typeof r=="symbol"||IO(r)&&xO.call(r)==vO}function qb(r){if(typeof r=="number")return r;if(OO(r))return Mb;if(Wp(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Wp(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(wO,"");var t=bO.test(r);return t||CO.test(r)?DO(r.slice(2),t?2:8):yO.test(r)?Mb:+r}jb.exports=_O});var ba=L(to=>{"use strict";function MO(r,e,t){if(t===void 0&&(t=Array.prototype),r&&typeof t.find=="function")return t.find.call(r,e);for(var n=0;n<r.length;n++)if(Object.prototype.hasOwnProperty.call(r,n)){var i=r[n];if(e.call(void 0,i,n,r))return i}}function Hp(r,e){return e===void 0&&(e=Object),e&&typeof e.freeze=="function"?e.freeze(r):r}function qO(r,e){if(r===null||typeof r!="object")throw new TypeError("target is not an object");for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r}var Vb=Hp({HTML:"text/html",isHTML:function(r){return r===Vb.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),Hb=Hp({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(r){return r===Hb.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});to.assign=qO;to.find=MO;to.freeze=Hp;to.MIME_TYPE=Vb;to.NAMESPACE=Hb});var rh=L(Ai=>{var Zb=ba(),jn=Zb.find,Ca=Zb.NAMESPACE;function jO(r){return r!==""}function UO(r){return r?r.split(/[\t\n\f\r ]+/).filter(jO):[]}function $O(r,e){return r.hasOwnProperty(e)||(r[e]=!0),r}function Kb(r){if(!r)return[];var e=UO(r);return Object.keys(e.reduce($O,{}))}function BO(r){return function(e){return r&&r.indexOf(e)!==-1}}function Ta(r,e){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}function Nr(r,e){var t=r.prototype;if(!(t instanceof e)){let i=function(){};var n=i;i.prototype=e.prototype,i=new i,Ta(t,i),r.prototype=t=i}t.constructor!=r&&(typeof r!="function"&&console.error("unknown Class:"+r),t.constructor=r)}var Fr={},Pn=Fr.ELEMENT_NODE=1,no=Fr.ATTRIBUTE_NODE=2,ac=Fr.TEXT_NODE=3,eC=Fr.CDATA_SECTION_NODE=4,tC=Fr.ENTITY_REFERENCE_NODE=5,WO=Fr.ENTITY_NODE=6,rC=Fr.PROCESSING_INSTRUCTION_NODE=7,nC=Fr.COMMENT_NODE=8,iC=Fr.DOCUMENT_NODE=9,sC=Fr.DOCUMENT_TYPE_NODE=10,ui=Fr.DOCUMENT_FRAGMENT_NODE=11,VO=Fr.NOTATION_NODE=12,dr={},Zt={},Nj=dr.INDEX_SIZE_ERR=(Zt[1]="Index size error",1),Fj=dr.DOMSTRING_SIZE_ERR=(Zt[2]="DOMString size error",2),Ar=dr.HIERARCHY_REQUEST_ERR=(Zt[3]="Hierarchy request error",3),Lj=dr.WRONG_DOCUMENT_ERR=(Zt[4]="Wrong document",4),Mj=dr.INVALID_CHARACTER_ERR=(Zt[5]="Invalid character",5),qj=dr.NO_DATA_ALLOWED_ERR=(Zt[6]="No data allowed",6),jj=dr.NO_MODIFICATION_ALLOWED_ERR=(Zt[7]="No modification allowed",7),oC=dr.NOT_FOUND_ERR=(Zt[8]="Not found",8),Uj=dr.NOT_SUPPORTED_ERR=(Zt[9]="Not supported",9),Xb=dr.INUSE_ATTRIBUTE_ERR=(Zt[10]="Attribute in use",10),$j=dr.INVALID_STATE_ERR=(Zt[11]="Invalid state",11),Bj=dr.SYNTAX_ERR=(Zt[12]="Syntax error",12),Wj=dr.INVALID_MODIFICATION_ERR=(Zt[13]="Invalid modification",13),Vj=dr.NAMESPACE_ERR=(Zt[14]="Invalid namespace",14),Hj=dr.INVALID_ACCESS_ERR=(Zt[15]="Invalid access",15);function Mt(r,e){if(e instanceof Error)var t=e;else t=this,Error.call(this,Zt[r]),this.message=Zt[r],Error.captureStackTrace&&Error.captureStackTrace(this,Mt);return t.code=r,e&&(this.message=this.message+": "+e),t}Mt.prototype=Error.prototype;Ta(dr,Mt);function ai(){}ai.prototype={length:0,item:function(r){return r>=0&&r<this.length?this[r]:null},toString:function(r,e){for(var t=[],n=0;n<this.length;n++)ro(this[n],t,r,e);return t.join("")},filter:function(r){return Array.prototype.filter.call(this,r)},indexOf:function(r){return Array.prototype.indexOf.call(this,r)}};function io(r,e){this._node=r,this._refresh=e,zp(this)}function zp(r){var e=r._node._inc||r._node.ownerDocument._inc;if(r._inc!==e){var t=r._refresh(r._node);if(wC(r,"length",t.length),!r.$$length||t.length<r.$$length)for(var n=t.length;n in r;n++)Object.prototype.hasOwnProperty.call(r,n)&&delete r[n];Ta(t,r),r._inc=e}}io.prototype.item=function(r){return zp(this),this[r]||null};Nr(io,ai);function uc(){}function aC(r,e){for(var t=r.length;t--;)if(r[t]===e)return t}function zb(r,e,t,n){if(n?e[aC(e,n)]=t:e[e.length++]=t,r){t.ownerElement=r;var i=r.ownerDocument;i&&(n&&lC(i,r,n),HO(i,r,t))}}function Gb(r,e,t){var n=aC(e,t);if(n>=0){for(var i=e.length-1;n<i;)e[n]=e[++n];if(e.length=i,r){var s=r.ownerDocument;s&&(lC(s,r,t),t.ownerElement=null)}}else throw new Mt(oC,new Error(r.tagName+"@"+t))}uc.prototype={length:0,item:ai.prototype.item,getNamedItem:function(r){for(var e=this.length;e--;){var t=this[e];if(t.nodeName==r)return t}},setNamedItem:function(r){var e=r.ownerElement;if(e&&e!=this._ownerElement)throw new Mt(Xb);var t=this.getNamedItem(r.nodeName);return zb(this._ownerElement,this,r,t),t},setNamedItemNS:function(r){var e=r.ownerElement,t;if(e&&e!=this._ownerElement)throw new Mt(Xb);return t=this.getNamedItemNS(r.namespaceURI,r.localName),zb(this._ownerElement,this,r,t),t},removeNamedItem:function(r){var e=this.getNamedItem(r);return Gb(this._ownerElement,this,e),e},removeNamedItemNS:function(r,e){var t=this.getNamedItemNS(r,e);return Gb(this._ownerElement,this,t),t},getNamedItemNS:function(r,e){for(var t=this.length;t--;){var n=this[t];if(n.localName==e&&n.namespaceURI==r)return n}return null}};function uC(){}uC.prototype={hasFeature:function(r,e){return!0},createDocument:function(r,e,t){var n=new Sa;if(n.implementation=this,n.childNodes=new ai,n.doctype=t||null,t&&n.appendChild(t),e){var i=n.createElementNS(r,e);n.appendChild(i)}return n},createDocumentType:function(r,e,t){var n=new dc;return n.name=r,n.nodeName=r,n.publicId=e||"",n.systemId=t||"",n}};function rt(){}rt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(r,e){return cc(this,r,e)},replaceChild:function(r,e){cc(this,r,e,fC),e&&this.removeChild(e)},removeChild:function(r){return dC(this,r)},appendChild:function(r){return this.insertBefore(r,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(r){return Xp(this.ownerDocument||this,this,r)},normalize:function(){for(var r=this.firstChild;r;){var e=r.nextSibling;e&&e.nodeType==ac&&r.nodeType==ac?(this.removeChild(e),r.appendData(e.data)):(r.normalize(),r=e)}},isSupported:function(r,e){return this.ownerDocument.implementation.hasFeature(r,e)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(r){for(var e=this;e;){var t=e._nsMap;if(t){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&t[n]===r)return n}e=e.nodeType==no?e.ownerDocument:e.parentNode}return null},lookupNamespaceURI:function(r){for(var e=this;e;){var t=e._nsMap;if(t&&Object.prototype.hasOwnProperty.call(t,r))return t[r];e=e.nodeType==no?e.ownerDocument:e.parentNode}return null},isDefaultNamespace:function(r){var e=this.lookupPrefix(r);return e==null}};function cC(r){return r=="<"&&"&lt;"||r==">"&&"&gt;"||r=="&"&&"&amp;"||r=='"'&&"&quot;"||"&#"+r.charCodeAt()+";"}Ta(Fr,rt);Ta(Fr,rt.prototype);function Da(r,e){if(e(r))return!0;if(r=r.firstChild)do if(Da(r,e))return!0;while(r=r.nextSibling)}function Sa(){this.ownerDocument=this}function HO(r,e,t){r&&r._inc++;var n=t.namespaceURI;n===Ca.XMLNS&&(e._nsMap[t.prefix?t.localName:""]=t.value)}function lC(r,e,t,n){r&&r._inc++;var i=t.namespaceURI;i===Ca.XMLNS&&delete e._nsMap[t.prefix?t.localName:""]}function Gp(r,e,t){if(r&&r._inc){r._inc++;var n=e.childNodes;if(t)n[n.length++]=t;else{for(var i=e.firstChild,s=0;i;)n[s++]=i,i=i.nextSibling;n.length=s,delete n[n.length]}}}function dC(r,e){var t=e.previousSibling,n=e.nextSibling;return t?t.nextSibling=n:r.firstChild=n,n?n.previousSibling=t:r.lastChild=t,e.parentNode=null,e.previousSibling=null,e.nextSibling=null,Gp(r.ownerDocument,r),e}function KO(r){return r&&(r.nodeType===rt.DOCUMENT_NODE||r.nodeType===rt.DOCUMENT_FRAGMENT_NODE||r.nodeType===rt.ELEMENT_NODE)}function XO(r){return r&&(Un(r)||Qp(r)||ci(r)||r.nodeType===rt.DOCUMENT_FRAGMENT_NODE||r.nodeType===rt.COMMENT_NODE||r.nodeType===rt.PROCESSING_INSTRUCTION_NODE)}function ci(r){return r&&r.nodeType===rt.DOCUMENT_TYPE_NODE}function Un(r){return r&&r.nodeType===rt.ELEMENT_NODE}function Qp(r){return r&&r.nodeType===rt.TEXT_NODE}function Qb(r,e){var t=r.childNodes||[];if(jn(t,Un)||ci(e))return!1;var n=jn(t,ci);return!(e&&n&&t.indexOf(n)>t.indexOf(e))}function Yb(r,e){var t=r.childNodes||[];function n(s){return Un(s)&&s!==e}if(jn(t,n))return!1;var i=jn(t,ci);return!(e&&i&&t.indexOf(i)>t.indexOf(e))}function zO(r,e,t){if(!KO(r))throw new Mt(Ar,"Unexpected parent node type "+r.nodeType);if(t&&t.parentNode!==r)throw new Mt(oC,"child not in parent");if(!XO(e)||ci(e)&&r.nodeType!==rt.DOCUMENT_NODE)throw new Mt(Ar,"Unexpected node type "+e.nodeType+" for parent node type "+r.nodeType)}function GO(r,e,t){var n=r.childNodes||[],i=e.childNodes||[];if(e.nodeType===rt.DOCUMENT_FRAGMENT_NODE){var s=i.filter(Un);if(s.length>1||jn(i,Qp))throw new Mt(Ar,"More than one element or text in fragment");if(s.length===1&&!Qb(r,t))throw new Mt(Ar,"Element in fragment can not be inserted before doctype")}if(Un(e)&&!Qb(r,t))throw new Mt(Ar,"Only one element can be added and only after doctype");if(ci(e)){if(jn(n,ci))throw new Mt(Ar,"Only one doctype is allowed");var o=jn(n,Un);if(t&&n.indexOf(o)<n.indexOf(t))throw new Mt(Ar,"Doctype can only be inserted before an element");if(!t&&o)throw new Mt(Ar,"Doctype can not be appended since element is present")}}function fC(r,e,t){var n=r.childNodes||[],i=e.childNodes||[];if(e.nodeType===rt.DOCUMENT_FRAGMENT_NODE){var s=i.filter(Un);if(s.length>1||jn(i,Qp))throw new Mt(Ar,"More than one element or text in fragment");if(s.length===1&&!Yb(r,t))throw new Mt(Ar,"Element in fragment can not be inserted before doctype")}if(Un(e)&&!Yb(r,t))throw new Mt(Ar,"Only one element can be added and only after doctype");if(ci(e)){let u=function(c){return ci(c)&&c!==t};var a=u;if(jn(n,u))throw new Mt(Ar,"Only one doctype is allowed");var o=jn(n,Un);if(t&&n.indexOf(o)<n.indexOf(t))throw new Mt(Ar,"Doctype can only be inserted before an element")}}function cc(r,e,t,n){zO(r,e,t),r.nodeType===rt.DOCUMENT_NODE&&(n||GO)(r,e,t);var i=e.parentNode;if(i&&i.removeChild(e),e.nodeType===ui){var s=e.firstChild;if(s==null)return e;var o=e.lastChild}else s=o=e;var a=t?t.previousSibling:r.lastChild;s.previousSibling=a,o.nextSibling=t,a?a.nextSibling=s:r.firstChild=s,t==null?r.lastChild=o:t.previousSibling=o;do s.parentNode=r;while(s!==o&&(s=s.nextSibling));return Gp(r.ownerDocument||r,r),e.nodeType==ui&&(e.firstChild=e.lastChild=null),e}function QO(r,e){return e.parentNode&&e.parentNode.removeChild(e),e.parentNode=r,e.previousSibling=r.lastChild,e.nextSibling=null,e.previousSibling?e.previousSibling.nextSibling=e:r.firstChild=e,r.lastChild=e,Gp(r.ownerDocument,r,e),e}Sa.prototype={nodeName:"#document",nodeType:iC,doctype:null,documentElement:null,_inc:1,insertBefore:function(r,e){if(r.nodeType==ui){for(var t=r.firstChild;t;){var n=t.nextSibling;this.insertBefore(t,e),t=n}return r}return cc(this,r,e),r.ownerDocument=this,this.documentElement===null&&r.nodeType===Pn&&(this.documentElement=r),r},removeChild:function(r){return this.documentElement==r&&(this.documentElement=null),dC(this,r)},replaceChild:function(r,e){cc(this,r,e,fC),r.ownerDocument=this,e&&this.removeChild(e),Un(r)&&(this.documentElement=r)},importNode:function(r,e){return vC(this,r,e)},getElementById:function(r){var e=null;return Da(this.documentElement,function(t){if(t.nodeType==Pn&&t.getAttribute("id")==r)return e=t,!0}),e},getElementsByClassName:function(r){var e=Kb(r);return new io(this,function(t){var n=[];return e.length>0&&Da(t.documentElement,function(i){if(i!==t&&i.nodeType===Pn){var s=i.getAttribute("class");if(s){var o=r===s;if(!o){var a=Kb(s);o=e.every(BO(a))}o&&n.push(i)}}}),n})},createElement:function(r){var e=new bs;e.ownerDocument=this,e.nodeName=r,e.tagName=r,e.localName=r,e.childNodes=new ai;var t=e.attributes=new uc;return t._ownerElement=e,e},createDocumentFragment:function(){var r=new fc;return r.ownerDocument=this,r.childNodes=new ai,r},createTextNode:function(r){var e=new Yp;return e.ownerDocument=this,e.appendData(r),e},createComment:function(r){var e=new Jp;return e.ownerDocument=this,e.appendData(r),e},createCDATASection:function(r){var e=new Zp;return e.ownerDocument=this,e.appendData(r),e},createProcessingInstruction:function(r,e){var t=new th;return t.ownerDocument=this,t.tagName=t.nodeName=t.target=r,t.nodeValue=t.data=e,t},createAttribute:function(r){var e=new lc;return e.ownerDocument=this,e.name=r,e.nodeName=r,e.localName=r,e.specified=!0,e},createEntityReference:function(r){var e=new eh;return e.ownerDocument=this,e.nodeName=r,e},createElementNS:function(r,e){var t=new bs,n=e.split(":"),i=t.attributes=new uc;return t.childNodes=new ai,t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.namespaceURI=r,n.length==2?(t.prefix=n[0],t.localName=n[1]):t.localName=e,i._ownerElement=t,t},createAttributeNS:function(r,e){var t=new lc,n=e.split(":");return t.ownerDocument=this,t.nodeName=e,t.name=e,t.namespaceURI=r,t.specified=!0,n.length==2?(t.prefix=n[0],t.localName=n[1]):t.localName=e,t}};Nr(Sa,rt);function bs(){this._nsMap={}}bs.prototype={nodeType:Pn,hasAttribute:function(r){return this.getAttributeNode(r)!=null},getAttribute:function(r){var e=this.getAttributeNode(r);return e&&e.value||""},getAttributeNode:function(r){return this.attributes.getNamedItem(r)},setAttribute:function(r,e){var t=this.ownerDocument.createAttribute(r);t.value=t.nodeValue=""+e,this.setAttributeNode(t)},removeAttribute:function(r){var e=this.getAttributeNode(r);e&&this.removeAttributeNode(e)},appendChild:function(r){return r.nodeType===ui?this.insertBefore(r,null):QO(this,r)},setAttributeNode:function(r){return this.attributes.setNamedItem(r)},setAttributeNodeNS:function(r){return this.attributes.setNamedItemNS(r)},removeAttributeNode:function(r){return this.attributes.removeNamedItem(r.nodeName)},removeAttributeNS:function(r,e){var t=this.getAttributeNodeNS(r,e);t&&this.removeAttributeNode(t)},hasAttributeNS:function(r,e){return this.getAttributeNodeNS(r,e)!=null},getAttributeNS:function(r,e){var t=this.getAttributeNodeNS(r,e);return t&&t.value||""},setAttributeNS:function(r,e,t){var n=this.ownerDocument.createAttributeNS(r,e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},getAttributeNodeNS:function(r,e){return this.attributes.getNamedItemNS(r,e)},getElementsByTagName:function(r){return new io(this,function(e){var t=[];return Da(e,function(n){n!==e&&n.nodeType==Pn&&(r==="*"||n.tagName==r)&&t.push(n)}),t})},getElementsByTagNameNS:function(r,e){return new io(this,function(t){var n=[];return Da(t,function(i){i!==t&&i.nodeType===Pn&&(r==="*"||i.namespaceURI===r)&&(e==="*"||i.localName==e)&&n.push(i)}),n})}};Sa.prototype.getElementsByTagName=bs.prototype.getElementsByTagName;Sa.prototype.getElementsByTagNameNS=bs.prototype.getElementsByTagNameNS;Nr(bs,rt);function lc(){}lc.prototype.nodeType=no;Nr(lc,rt);function Ea(){}Ea.prototype={data:"",substringData:function(r,e){return this.data.substring(r,r+e)},appendData:function(r){r=this.data+r,this.nodeValue=this.data=r,this.length=r.length},insertData:function(r,e){this.replaceData(r,0,e)},appendChild:function(r){throw new Error(Zt[Ar])},deleteData:function(r,e){this.replaceData(r,e,"")},replaceData:function(r,e,t){var n=this.data.substring(0,r),i=this.data.substring(r+e);t=n+t+i,this.nodeValue=this.data=t,this.length=t.length}};Nr(Ea,rt);function Yp(){}Yp.prototype={nodeName:"#text",nodeType:ac,splitText:function(r){var e=this.data,t=e.substring(r);e=e.substring(0,r),this.data=this.nodeValue=e,this.length=e.length;var n=this.ownerDocument.createTextNode(t);return this.parentNode&&this.parentNode.insertBefore(n,this.nextSibling),n}};Nr(Yp,Ea);function Jp(){}Jp.prototype={nodeName:"#comment",nodeType:nC};Nr(Jp,Ea);function Zp(){}Zp.prototype={nodeName:"#cdata-section",nodeType:eC};Nr(Zp,Ea);function dc(){}dc.prototype.nodeType=sC;Nr(dc,rt);function pC(){}pC.prototype.nodeType=VO;Nr(pC,rt);function hC(){}hC.prototype.nodeType=WO;Nr(hC,rt);function eh(){}eh.prototype.nodeType=tC;Nr(eh,rt);function fc(){}fc.prototype.nodeName="#document-fragment";fc.prototype.nodeType=ui;Nr(fc,rt);function th(){}th.prototype.nodeType=rC;Nr(th,rt);function gC(){}gC.prototype.serializeToString=function(r,e,t){return mC.call(r,e,t)};rt.prototype.toString=mC;function mC(r,e){var t=[],n=this.nodeType==9&&this.documentElement||this,i=n.prefix,s=n.namespaceURI;if(s&&i==null){var i=n.lookupPrefix(s);if(i==null)var o=[{namespace:s,prefix:null}]}return ro(this,t,r,e,o),t.join("")}function Jb(r,e,t){var n=r.prefix||"",i=r.namespaceURI;if(!i||n==="xml"&&i===Ca.XML||i===Ca.XMLNS)return!1;for(var s=t.length;s--;){var o=t[s];if(o.prefix===n)return o.namespace!==i}return!0}function Kp(r,e,t){r.push(" ",e,'="',t.replace(/[<>&"\t\n\r]/g,cC),'"')}function ro(r,e,t,n,i){if(i||(i=[]),n)if(r=n(r),r){if(typeof r=="string"){e.push(r);return}}else return;switch(r.nodeType){case Pn:var s=r.attributes,o=s.length,R=r.firstChild,a=r.tagName;t=Ca.isHTML(r.namespaceURI)||t;var u=a;if(!t&&!r.prefix&&r.namespaceURI){for(var c,l=0;l<s.length;l++)if(s.item(l).name==="xmlns"){c=s.item(l).value;break}if(!c)for(var f=i.length-1;f>=0;f--){var d=i[f];if(d.prefix===""&&d.namespace===r.namespaceURI){c=d.namespace;break}}if(c!==r.namespaceURI)for(var f=i.length-1;f>=0;f--){var d=i[f];if(d.namespace===r.namespaceURI){d.prefix&&(u=d.prefix+":"+a);break}}}e.push("<",u);for(var h=0;h<o;h++){var m=s.item(h);m.prefix=="xmlns"?i.push({prefix:m.localName,namespace:m.value}):m.nodeName=="xmlns"&&i.push({prefix:"",namespace:m.value})}for(var h=0;h<o;h++){var m=s.item(h);if(Jb(m,t,i)){var D=m.prefix||"",_=m.namespaceURI;Kp(e,D?"xmlns:"+D:"xmlns",_),i.push({prefix:D,namespace:_})}ro(m,e,t,n,i)}if(a===u&&Jb(r,t,i)){var D=r.prefix||"",_=r.namespaceURI;Kp(e,D?"xmlns:"+D:"xmlns",_),i.push({prefix:D,namespace:_})}if(R||t&&!/^(?:meta|link|img|br|hr|input)$/i.test(a)){if(e.push(">"),t&&/^script$/i.test(a))for(;R;)R.data?e.push(R.data):ro(R,e,t,n,i.slice()),R=R.nextSibling;else for(;R;)ro(R,e,t,n,i.slice()),R=R.nextSibling;e.push("</",u,">")}else e.push("/>");return;case iC:case ui:for(var R=r.firstChild;R;)ro(R,e,t,n,i.slice()),R=R.nextSibling;return;case no:return Kp(e,r.name,r.value);case ac:return e.push(r.data.replace(/[<&>]/g,cC));case eC:return e.push("<![CDATA[",r.data,"]]>");case nC:return e.push("<!--",r.data,"-->");case sC:var N=r.publicId,w=r.systemId;if(e.push("<!DOCTYPE ",r.name),N)e.push(" PUBLIC ",N),w&&w!="."&&e.push(" ",w),e.push(">");else if(w&&w!=".")e.push(" SYSTEM ",w,">");else{var p=r.internalSubset;p&&e.push(" [",p,"]"),e.push(">")}return;case rC:return e.push("<?",r.target," ",r.data,"?>");case tC:return e.push("&",r.nodeName,";");default:e.push("??",r.nodeName)}}function vC(r,e,t){var n;switch(e.nodeType){case Pn:n=e.cloneNode(!1),n.ownerDocument=r;case ui:break;case no:t=!0;break}if(n||(n=e.cloneNode(!1)),n.ownerDocument=r,n.parentNode=null,t)for(var i=e.firstChild;i;)n.appendChild(vC(r,i,t)),i=i.nextSibling;return n}function Xp(r,e,t){var n=new e.constructor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var s=e[i];typeof s!="object"&&s!=n[i]&&(n[i]=s)}switch(e.childNodes&&(n.childNodes=new ai),n.ownerDocument=r,n.nodeType){case Pn:var o=e.attributes,a=n.attributes=new uc,u=o.length;a._ownerElement=n;for(var c=0;c<u;c++)n.setAttributeNode(Xp(r,o.item(c),!0));break;case no:t=!0}if(t)for(var l=e.firstChild;l;)n.appendChild(Xp(r,l,t)),l=l.nextSibling;return n}function wC(r,e,t){r[e]=t}try{if(Object.defineProperty){let r=function(e){switch(e.nodeType){case Pn:case ui:var t=[];for(e=e.firstChild;e;)e.nodeType!==7&&e.nodeType!==8&&t.push(r(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}};YO=r,Object.defineProperty(io.prototype,"length",{get:function(){return zp(this),this.$$length}}),Object.defineProperty(rt.prototype,"textContent",{get:function(){return r(this)},set:function(e){switch(this.nodeType){case Pn:case ui:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),wC=function(e,t,n){e["$$"+t]=n}}}catch{}var YO;Ai.DocumentType=dc;Ai.DOMException=Mt;Ai.DOMImplementation=uC;Ai.Element=bs;Ai.Node=rt;Ai.NodeList=ai;Ai.XMLSerializer=gC});var bC=L(Pa=>{"use strict";var yC=ba().freeze;Pa.XML_ENTITIES=yC({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'});Pa.HTML_ENTITIES=yC({Aacute:"\xC1",aacute:"\xE1",Abreve:"\u0102",abreve:"\u0103",ac:"\u223E",acd:"\u223F",acE:"\u223E\u0333",Acirc:"\xC2",acirc:"\xE2",acute:"\xB4",Acy:"\u0410",acy:"\u0430",AElig:"\xC6",aelig:"\xE6",af:"\u2061",Afr:"\u{1D504}",afr:"\u{1D51E}",Agrave:"\xC0",agrave:"\xE0",alefsym:"\u2135",aleph:"\u2135",Alpha:"\u0391",alpha:"\u03B1",Amacr:"\u0100",amacr:"\u0101",amalg:"\u2A3F",AMP:"&",amp:"&",And:"\u2A53",and:"\u2227",andand:"\u2A55",andd:"\u2A5C",andslope:"\u2A58",andv:"\u2A5A",ang:"\u2220",ange:"\u29A4",angle:"\u2220",angmsd:"\u2221",angmsdaa:"\u29A8",angmsdab:"\u29A9",angmsdac:"\u29AA",angmsdad:"\u29AB",angmsdae:"\u29AC",angmsdaf:"\u29AD",angmsdag:"\u29AE",angmsdah:"\u29AF",angrt:"\u221F",angrtvb:"\u22BE",angrtvbd:"\u299D",angsph:"\u2222",angst:"\xC5",angzarr:"\u237C",Aogon:"\u0104",aogon:"\u0105",Aopf:"\u{1D538}",aopf:"\u{1D552}",ap:"\u2248",apacir:"\u2A6F",apE:"\u2A70",ape:"\u224A",apid:"\u224B",apos:"'",ApplyFunction:"\u2061",approx:"\u2248",approxeq:"\u224A",Aring:"\xC5",aring:"\xE5",Ascr:"\u{1D49C}",ascr:"\u{1D4B6}",Assign:"\u2254",ast:"*",asymp:"\u2248",asympeq:"\u224D",Atilde:"\xC3",atilde:"\xE3",Auml:"\xC4",auml:"\xE4",awconint:"\u2233",awint:"\u2A11",backcong:"\u224C",backepsilon:"\u03F6",backprime:"\u2035",backsim:"\u223D",backsimeq:"\u22CD",Backslash:"\u2216",Barv:"\u2AE7",barvee:"\u22BD",Barwed:"\u2306",barwed:"\u2305",barwedge:"\u2305",bbrk:"\u23B5",bbrktbrk:"\u23B6",bcong:"\u224C",Bcy:"\u0411",bcy:"\u0431",bdquo:"\u201E",becaus:"\u2235",Because:"\u2235",because:"\u2235",bemptyv:"\u29B0",bepsi:"\u03F6",bernou:"\u212C",Bernoullis:"\u212C",Beta:"\u0392",beta:"\u03B2",beth:"\u2136",between:"\u226C",Bfr:"\u{1D505}",bfr:"\u{1D51F}",bigcap:"\u22C2",bigcirc:"\u25EF",bigcup:"\u22C3",bigodot:"\u2A00",bigoplus:"\u2A01",bigotimes:"\u2A02",bigsqcup:"\u2A06",bigstar:"\u2605",bigtriangledown:"\u25BD",bigtriangleup:"\u25B3",biguplus:"\u2A04",bigvee:"\u22C1",bigwedge:"\u22C0",bkarow:"\u290D",blacklozenge:"\u29EB",blacksquare:"\u25AA",blacktriangle:"\u25B4",blacktriangledown:"\u25BE",blacktriangleleft:"\u25C2",blacktriangleright:"\u25B8",blank:"\u2423",blk12:"\u2592",blk14:"\u2591",blk34:"\u2593",block:"\u2588",bne:"=\u20E5",bnequiv:"\u2261\u20E5",bNot:"\u2AED",bnot:"\u2310",Bopf:"\u{1D539}",bopf:"\u{1D553}",bot:"\u22A5",bottom:"\u22A5",bowtie:"\u22C8",boxbox:"\u29C9",boxDL:"\u2557",boxDl:"\u2556",boxdL:"\u2555",boxdl:"\u2510",boxDR:"\u2554",boxDr:"\u2553",boxdR:"\u2552",boxdr:"\u250C",boxH:"\u2550",boxh:"\u2500",boxHD:"\u2566",boxHd:"\u2564",boxhD:"\u2565",boxhd:"\u252C",boxHU:"\u2569",boxHu:"\u2567",boxhU:"\u2568",boxhu:"\u2534",boxminus:"\u229F",boxplus:"\u229E",boxtimes:"\u22A0",boxUL:"\u255D",boxUl:"\u255C",boxuL:"\u255B",boxul:"\u2518",boxUR:"\u255A",boxUr:"\u2559",boxuR:"\u2558",boxur:"\u2514",boxV:"\u2551",boxv:"\u2502",boxVH:"\u256C",boxVh:"\u256B",boxvH:"\u256A",boxvh:"\u253C",boxVL:"\u2563",boxVl:"\u2562",boxvL:"\u2561",boxvl:"\u2524",boxVR:"\u2560",boxVr:"\u255F",boxvR:"\u255E",boxvr:"\u251C",bprime:"\u2035",Breve:"\u02D8",breve:"\u02D8",brvbar:"\xA6",Bscr:"\u212C",bscr:"\u{1D4B7}",bsemi:"\u204F",bsim:"\u223D",bsime:"\u22CD",bsol:"\\",bsolb:"\u29C5",bsolhsub:"\u27C8",bull:"\u2022",bullet:"\u2022",bump:"\u224E",bumpE:"\u2AAE",bumpe:"\u224F",Bumpeq:"\u224E",bumpeq:"\u224F",Cacute:"\u0106",cacute:"\u0107",Cap:"\u22D2",cap:"\u2229",capand:"\u2A44",capbrcup:"\u2A49",capcap:"\u2A4B",capcup:"\u2A47",capdot:"\u2A40",CapitalDifferentialD:"\u2145",caps:"\u2229\uFE00",caret:"\u2041",caron:"\u02C7",Cayleys:"\u212D",ccaps:"\u2A4D",Ccaron:"\u010C",ccaron:"\u010D",Ccedil:"\xC7",ccedil:"\xE7",Ccirc:"\u0108",ccirc:"\u0109",Cconint:"\u2230",ccups:"\u2A4C",ccupssm:"\u2A50",Cdot:"\u010A",cdot:"\u010B",cedil:"\xB8",Cedilla:"\xB8",cemptyv:"\u29B2",cent:"\xA2",CenterDot:"\xB7",centerdot:"\xB7",Cfr:"\u212D",cfr:"\u{1D520}",CHcy:"\u0427",chcy:"\u0447",check:"\u2713",checkmark:"\u2713",Chi:"\u03A7",chi:"\u03C7",cir:"\u25CB",circ:"\u02C6",circeq:"\u2257",circlearrowleft:"\u21BA",circlearrowright:"\u21BB",circledast:"\u229B",circledcirc:"\u229A",circleddash:"\u229D",CircleDot:"\u2299",circledR:"\xAE",circledS:"\u24C8",CircleMinus:"\u2296",CirclePlus:"\u2295",CircleTimes:"\u2297",cirE:"\u29C3",cire:"\u2257",cirfnint:"\u2A10",cirmid:"\u2AEF",cirscir:"\u29C2",ClockwiseContourIntegral:"\u2232",CloseCurlyDoubleQuote:"\u201D",CloseCurlyQuote:"\u2019",clubs:"\u2663",clubsuit:"\u2663",Colon:"\u2237",colon:":",Colone:"\u2A74",colone:"\u2254",coloneq:"\u2254",comma:",",commat:"@",comp:"\u2201",compfn:"\u2218",complement:"\u2201",complexes:"\u2102",cong:"\u2245",congdot:"\u2A6D",Congruent:"\u2261",Conint:"\u222F",conint:"\u222E",ContourIntegral:"\u222E",Copf:"\u2102",copf:"\u{1D554}",coprod:"\u2210",Coproduct:"\u2210",COPY:"\xA9",copy:"\xA9",copysr:"\u2117",CounterClockwiseContourIntegral:"\u2233",crarr:"\u21B5",Cross:"\u2A2F",cross:"\u2717",Cscr:"\u{1D49E}",cscr:"\u{1D4B8}",csub:"\u2ACF",csube:"\u2AD1",csup:"\u2AD0",csupe:"\u2AD2",ctdot:"\u22EF",cudarrl:"\u2938",cudarrr:"\u2935",cuepr:"\u22DE",cuesc:"\u22DF",cularr:"\u21B6",cularrp:"\u293D",Cup:"\u22D3",cup:"\u222A",cupbrcap:"\u2A48",CupCap:"\u224D",cupcap:"\u2A46",cupcup:"\u2A4A",cupdot:"\u228D",cupor:"\u2A45",cups:"\u222A\uFE00",curarr:"\u21B7",curarrm:"\u293C",curlyeqprec:"\u22DE",curlyeqsucc:"\u22DF",curlyvee:"\u22CE",curlywedge:"\u22CF",curren:"\xA4",curvearrowleft:"\u21B6",curvearrowright:"\u21B7",cuvee:"\u22CE",cuwed:"\u22CF",cwconint:"\u2232",cwint:"\u2231",cylcty:"\u232D",Dagger:"\u2021",dagger:"\u2020",daleth:"\u2138",Darr:"\u21A1",dArr:"\u21D3",darr:"\u2193",dash:"\u2010",Dashv:"\u2AE4",dashv:"\u22A3",dbkarow:"\u290F",dblac:"\u02DD",Dcaron:"\u010E",dcaron:"\u010F",Dcy:"\u0414",dcy:"\u0434",DD:"\u2145",dd:"\u2146",ddagger:"\u2021",ddarr:"\u21CA",DDotrahd:"\u2911",ddotseq:"\u2A77",deg:"\xB0",Del:"\u2207",Delta:"\u0394",delta:"\u03B4",demptyv:"\u29B1",dfisht:"\u297F",Dfr:"\u{1D507}",dfr:"\u{1D521}",dHar:"\u2965",dharl:"\u21C3",dharr:"\u21C2",DiacriticalAcute:"\xB4",DiacriticalDot:"\u02D9",DiacriticalDoubleAcute:"\u02DD",DiacriticalGrave:"`",DiacriticalTilde:"\u02DC",diam:"\u22C4",Diamond:"\u22C4",diamond:"\u22C4",diamondsuit:"\u2666",diams:"\u2666",die:"\xA8",DifferentialD:"\u2146",digamma:"\u03DD",disin:"\u22F2",div:"\xF7",divide:"\xF7",divideontimes:"\u22C7",divonx:"\u22C7",DJcy:"\u0402",djcy:"\u0452",dlcorn:"\u231E",dlcrop:"\u230D",dollar:"$",Dopf:"\u{1D53B}",dopf:"\u{1D555}",Dot:"\xA8",dot:"\u02D9",DotDot:"\u20DC",doteq:"\u2250",doteqdot:"\u2251",DotEqual:"\u2250",dotminus:"\u2238",dotplus:"\u2214",dotsquare:"\u22A1",doublebarwedge:"\u2306",DoubleContourIntegral:"\u222F",DoubleDot:"\xA8",DoubleDownArrow:"\u21D3",DoubleLeftArrow:"\u21D0",DoubleLeftRightArrow:"\u21D4",DoubleLeftTee:"\u2AE4",DoubleLongLeftArrow:"\u27F8",DoubleLongLeftRightArrow:"\u27FA",DoubleLongRightArrow:"\u27F9",DoubleRightArrow:"\u21D2",DoubleRightTee:"\u22A8",DoubleUpArrow:"\u21D1",DoubleUpDownArrow:"\u21D5",DoubleVerticalBar:"\u2225",DownArrow:"\u2193",Downarrow:"\u21D3",downarrow:"\u2193",DownArrowBar:"\u2913",DownArrowUpArrow:"\u21F5",DownBreve:"\u0311",downdownarrows:"\u21CA",downharpoonleft:"\u21C3",downharpoonright:"\u21C2",DownLeftRightVector:"\u2950",DownLeftTeeVector:"\u295E",DownLeftVector:"\u21BD",DownLeftVectorBar:"\u2956",DownRightTeeVector:"\u295F",DownRightVector:"\u21C1",DownRightVectorBar:"\u2957",DownTee:"\u22A4",DownTeeArrow:"\u21A7",drbkarow:"\u2910",drcorn:"\u231F",drcrop:"\u230C",Dscr:"\u{1D49F}",dscr:"\u{1D4B9}",DScy:"\u0405",dscy:"\u0455",dsol:"\u29F6",Dstrok:"\u0110",dstrok:"\u0111",dtdot:"\u22F1",dtri:"\u25BF",dtrif:"\u25BE",duarr:"\u21F5",duhar:"\u296F",dwangle:"\u29A6",DZcy:"\u040F",dzcy:"\u045F",dzigrarr:"\u27FF",Eacute:"\xC9",eacute:"\xE9",easter:"\u2A6E",Ecaron:"\u011A",ecaron:"\u011B",ecir:"\u2256",Ecirc:"\xCA",ecirc:"\xEA",ecolon:"\u2255",Ecy:"\u042D",ecy:"\u044D",eDDot:"\u2A77",Edot:"\u0116",eDot:"\u2251",edot:"\u0117",ee:"\u2147",efDot:"\u2252",Efr:"\u{1D508}",efr:"\u{1D522}",eg:"\u2A9A",Egrave:"\xC8",egrave:"\xE8",egs:"\u2A96",egsdot:"\u2A98",el:"\u2A99",Element:"\u2208",elinters:"\u23E7",ell:"\u2113",els:"\u2A95",elsdot:"\u2A97",Emacr:"\u0112",emacr:"\u0113",empty:"\u2205",emptyset:"\u2205",EmptySmallSquare:"\u25FB",emptyv:"\u2205",EmptyVerySmallSquare:"\u25AB",emsp:"\u2003",emsp13:"\u2004",emsp14:"\u2005",ENG:"\u014A",eng:"\u014B",ensp:"\u2002",Eogon:"\u0118",eogon:"\u0119",Eopf:"\u{1D53C}",eopf:"\u{1D556}",epar:"\u22D5",eparsl:"\u29E3",eplus:"\u2A71",epsi:"\u03B5",Epsilon:"\u0395",epsilon:"\u03B5",epsiv:"\u03F5",eqcirc:"\u2256",eqcolon:"\u2255",eqsim:"\u2242",eqslantgtr:"\u2A96",eqslantless:"\u2A95",Equal:"\u2A75",equals:"=",EqualTilde:"\u2242",equest:"\u225F",Equilibrium:"\u21CC",equiv:"\u2261",equivDD:"\u2A78",eqvparsl:"\u29E5",erarr:"\u2971",erDot:"\u2253",Escr:"\u2130",escr:"\u212F",esdot:"\u2250",Esim:"\u2A73",esim:"\u2242",Eta:"\u0397",eta:"\u03B7",ETH:"\xD0",eth:"\xF0",Euml:"\xCB",euml:"\xEB",euro:"\u20AC",excl:"!",exist:"\u2203",Exists:"\u2203",expectation:"\u2130",ExponentialE:"\u2147",exponentiale:"\u2147",fallingdotseq:"\u2252",Fcy:"\u0424",fcy:"\u0444",female:"\u2640",ffilig:"\uFB03",fflig:"\uFB00",ffllig:"\uFB04",Ffr:"\u{1D509}",ffr:"\u{1D523}",filig:"\uFB01",FilledSmallSquare:"\u25FC",FilledVerySmallSquare:"\u25AA",fjlig:"fj",flat:"\u266D",fllig:"\uFB02",fltns:"\u25B1",fnof:"\u0192",Fopf:"\u{1D53D}",fopf:"\u{1D557}",ForAll:"\u2200",forall:"\u2200",fork:"\u22D4",forkv:"\u2AD9",Fouriertrf:"\u2131",fpartint:"\u2A0D",frac12:"\xBD",frac13:"\u2153",frac14:"\xBC",frac15:"\u2155",frac16:"\u2159",frac18:"\u215B",frac23:"\u2154",frac25:"\u2156",frac34:"\xBE",frac35:"\u2157",frac38:"\u215C",frac45:"\u2158",frac56:"\u215A",frac58:"\u215D",frac78:"\u215E",frasl:"\u2044",frown:"\u2322",Fscr:"\u2131",fscr:"\u{1D4BB}",gacute:"\u01F5",Gamma:"\u0393",gamma:"\u03B3",Gammad:"\u03DC",gammad:"\u03DD",gap:"\u2A86",Gbreve:"\u011E",gbreve:"\u011F",Gcedil:"\u0122",Gcirc:"\u011C",gcirc:"\u011D",Gcy:"\u0413",gcy:"\u0433",Gdot:"\u0120",gdot:"\u0121",gE:"\u2267",ge:"\u2265",gEl:"\u2A8C",gel:"\u22DB",geq:"\u2265",geqq:"\u2267",geqslant:"\u2A7E",ges:"\u2A7E",gescc:"\u2AA9",gesdot:"\u2A80",gesdoto:"\u2A82",gesdotol:"\u2A84",gesl:"\u22DB\uFE00",gesles:"\u2A94",Gfr:"\u{1D50A}",gfr:"\u{1D524}",Gg:"\u22D9",gg:"\u226B",ggg:"\u22D9",gimel:"\u2137",GJcy:"\u0403",gjcy:"\u0453",gl:"\u2277",gla:"\u2AA5",glE:"\u2A92",glj:"\u2AA4",gnap:"\u2A8A",gnapprox:"\u2A8A",gnE:"\u2269",gne:"\u2A88",gneq:"\u2A88",gneqq:"\u2269",gnsim:"\u22E7",Gopf:"\u{1D53E}",gopf:"\u{1D558}",grave:"`",GreaterEqual:"\u2265",GreaterEqualLess:"\u22DB",GreaterFullEqual:"\u2267",GreaterGreater:"\u2AA2",GreaterLess:"\u2277",GreaterSlantEqual:"\u2A7E",GreaterTilde:"\u2273",Gscr:"\u{1D4A2}",gscr:"\u210A",gsim:"\u2273",gsime:"\u2A8E",gsiml:"\u2A90",Gt:"\u226B",GT:">",gt:">",gtcc:"\u2AA7",gtcir:"\u2A7A",gtdot:"\u22D7",gtlPar:"\u2995",gtquest:"\u2A7C",gtrapprox:"\u2A86",gtrarr:"\u2978",gtrdot:"\u22D7",gtreqless:"\u22DB",gtreqqless:"\u2A8C",gtrless:"\u2277",gtrsim:"\u2273",gvertneqq:"\u2269\uFE00",gvnE:"\u2269\uFE00",Hacek:"\u02C7",hairsp:"\u200A",half:"\xBD",hamilt:"\u210B",HARDcy:"\u042A",hardcy:"\u044A",hArr:"\u21D4",harr:"\u2194",harrcir:"\u2948",harrw:"\u21AD",Hat:"^",hbar:"\u210F",Hcirc:"\u0124",hcirc:"\u0125",hearts:"\u2665",heartsuit:"\u2665",hellip:"\u2026",hercon:"\u22B9",Hfr:"\u210C",hfr:"\u{1D525}",HilbertSpace:"\u210B",hksearow:"\u2925",hkswarow:"\u2926",hoarr:"\u21FF",homtht:"\u223B",hookleftarrow:"\u21A9",hookrightarrow:"\u21AA",Hopf:"\u210D",hopf:"\u{1D559}",horbar:"\u2015",HorizontalLine:"\u2500",Hscr:"\u210B",hscr:"\u{1D4BD}",hslash:"\u210F",Hstrok:"\u0126",hstrok:"\u0127",HumpDownHump:"\u224E",HumpEqual:"\u224F",hybull:"\u2043",hyphen:"\u2010",Iacute:"\xCD",iacute:"\xED",ic:"\u2063",Icirc:"\xCE",icirc:"\xEE",Icy:"\u0418",icy:"\u0438",Idot:"\u0130",IEcy:"\u0415",iecy:"\u0435",iexcl:"\xA1",iff:"\u21D4",Ifr:"\u2111",ifr:"\u{1D526}",Igrave:"\xCC",igrave:"\xEC",ii:"\u2148",iiiint:"\u2A0C",iiint:"\u222D",iinfin:"\u29DC",iiota:"\u2129",IJlig:"\u0132",ijlig:"\u0133",Im:"\u2111",Imacr:"\u012A",imacr:"\u012B",image:"\u2111",ImaginaryI:"\u2148",imagline:"\u2110",imagpart:"\u2111",imath:"\u0131",imof:"\u22B7",imped:"\u01B5",Implies:"\u21D2",in:"\u2208",incare:"\u2105",infin:"\u221E",infintie:"\u29DD",inodot:"\u0131",Int:"\u222C",int:"\u222B",intcal:"\u22BA",integers:"\u2124",Integral:"\u222B",intercal:"\u22BA",Intersection:"\u22C2",intlarhk:"\u2A17",intprod:"\u2A3C",InvisibleComma:"\u2063",InvisibleTimes:"\u2062",IOcy:"\u0401",iocy:"\u0451",Iogon:"\u012E",iogon:"\u012F",Iopf:"\u{1D540}",iopf:"\u{1D55A}",Iota:"\u0399",iota:"\u03B9",iprod:"\u2A3C",iquest:"\xBF",Iscr:"\u2110",iscr:"\u{1D4BE}",isin:"\u2208",isindot:"\u22F5",isinE:"\u22F9",isins:"\u22F4",isinsv:"\u22F3",isinv:"\u2208",it:"\u2062",Itilde:"\u0128",itilde:"\u0129",Iukcy:"\u0406",iukcy:"\u0456",Iuml:"\xCF",iuml:"\xEF",Jcirc:"\u0134",jcirc:"\u0135",Jcy:"\u0419",jcy:"\u0439",Jfr:"\u{1D50D}",jfr:"\u{1D527}",jmath:"\u0237",Jopf:"\u{1D541}",jopf:"\u{1D55B}",Jscr:"\u{1D4A5}",jscr:"\u{1D4BF}",Jsercy:"\u0408",jsercy:"\u0458",Jukcy:"\u0404",jukcy:"\u0454",Kappa:"\u039A",kappa:"\u03BA",kappav:"\u03F0",Kcedil:"\u0136",kcedil:"\u0137",Kcy:"\u041A",kcy:"\u043A",Kfr:"\u{1D50E}",kfr:"\u{1D528}",kgreen:"\u0138",KHcy:"\u0425",khcy:"\u0445",KJcy:"\u040C",kjcy:"\u045C",Kopf:"\u{1D542}",kopf:"\u{1D55C}",Kscr:"\u{1D4A6}",kscr:"\u{1D4C0}",lAarr:"\u21DA",Lacute:"\u0139",lacute:"\u013A",laemptyv:"\u29B4",lagran:"\u2112",Lambda:"\u039B",lambda:"\u03BB",Lang:"\u27EA",lang:"\u27E8",langd:"\u2991",langle:"\u27E8",lap:"\u2A85",Laplacetrf:"\u2112",laquo:"\xAB",Larr:"\u219E",lArr:"\u21D0",larr:"\u2190",larrb:"\u21E4",larrbfs:"\u291F",larrfs:"\u291D",larrhk:"\u21A9",larrlp:"\u21AB",larrpl:"\u2939",larrsim:"\u2973",larrtl:"\u21A2",lat:"\u2AAB",lAtail:"\u291B",latail:"\u2919",late:"\u2AAD",lates:"\u2AAD\uFE00",lBarr:"\u290E",lbarr:"\u290C",lbbrk:"\u2772",lbrace:"{",lbrack:"[",lbrke:"\u298B",lbrksld:"\u298F",lbrkslu:"\u298D",Lcaron:"\u013D",lcaron:"\u013E",Lcedil:"\u013B",lcedil:"\u013C",lceil:"\u2308",lcub:"{",Lcy:"\u041B",lcy:"\u043B",ldca:"\u2936",ldquo:"\u201C",ldquor:"\u201E",ldrdhar:"\u2967",ldrushar:"\u294B",ldsh:"\u21B2",lE:"\u2266",le:"\u2264",LeftAngleBracket:"\u27E8",LeftArrow:"\u2190",Leftarrow:"\u21D0",leftarrow:"\u2190",LeftArrowBar:"\u21E4",LeftArrowRightArrow:"\u21C6",leftarrowtail:"\u21A2",LeftCeiling:"\u2308",LeftDoubleBracket:"\u27E6",LeftDownTeeVector:"\u2961",LeftDownVector:"\u21C3",LeftDownVectorBar:"\u2959",LeftFloor:"\u230A",leftharpoondown:"\u21BD",leftharpoonup:"\u21BC",leftleftarrows:"\u21C7",LeftRightArrow:"\u2194",Leftrightarrow:"\u21D4",leftrightarrow:"\u2194",leftrightarrows:"\u21C6",leftrightharpoons:"\u21CB",leftrightsquigarrow:"\u21AD",LeftRightVector:"\u294E",LeftTee:"\u22A3",LeftTeeArrow:"\u21A4",LeftTeeVector:"\u295A",leftthreetimes:"\u22CB",LeftTriangle:"\u22B2",LeftTriangleBar:"\u29CF",LeftTriangleEqual:"\u22B4",LeftUpDownVector:"\u2951",LeftUpTeeVector:"\u2960",LeftUpVector:"\u21BF",LeftUpVectorBar:"\u2958",LeftVector:"\u21BC",LeftVectorBar:"\u2952",lEg:"\u2A8B",leg:"\u22DA",leq:"\u2264",leqq:"\u2266",leqslant:"\u2A7D",les:"\u2A7D",lescc:"\u2AA8",lesdot:"\u2A7F",lesdoto:"\u2A81",lesdotor:"\u2A83",lesg:"\u22DA\uFE00",lesges:"\u2A93",lessapprox:"\u2A85",lessdot:"\u22D6",lesseqgtr:"\u22DA",lesseqqgtr:"\u2A8B",LessEqualGreater:"\u22DA",LessFullEqual:"\u2266",LessGreater:"\u2276",lessgtr:"\u2276",LessLess:"\u2AA1",lesssim:"\u2272",LessSlantEqual:"\u2A7D",LessTilde:"\u2272",lfisht:"\u297C",lfloor:"\u230A",Lfr:"\u{1D50F}",lfr:"\u{1D529}",lg:"\u2276",lgE:"\u2A91",lHar:"\u2962",lhard:"\u21BD",lharu:"\u21BC",lharul:"\u296A",lhblk:"\u2584",LJcy:"\u0409",ljcy:"\u0459",Ll:"\u22D8",ll:"\u226A",llarr:"\u21C7",llcorner:"\u231E",Lleftarrow:"\u21DA",llhard:"\u296B",lltri:"\u25FA",Lmidot:"\u013F",lmidot:"\u0140",lmoust:"\u23B0",lmoustache:"\u23B0",lnap:"\u2A89",lnapprox:"\u2A89",lnE:"\u2268",lne:"\u2A87",lneq:"\u2A87",lneqq:"\u2268",lnsim:"\u22E6",loang:"\u27EC",loarr:"\u21FD",lobrk:"\u27E6",LongLeftArrow:"\u27F5",Longleftarrow:"\u27F8",longleftarrow:"\u27F5",LongLeftRightArrow:"\u27F7",Longleftrightarrow:"\u27FA",longleftrightarrow:"\u27F7",longmapsto:"\u27FC",LongRightArrow:"\u27F6",Longrightarrow:"\u27F9",longrightarrow:"\u27F6",looparrowleft:"\u21AB",looparrowright:"\u21AC",lopar:"\u2985",Lopf:"\u{1D543}",lopf:"\u{1D55D}",loplus:"\u2A2D",lotimes:"\u2A34",lowast:"\u2217",lowbar:"_",LowerLeftArrow:"\u2199",LowerRightArrow:"\u2198",loz:"\u25CA",lozenge:"\u25CA",lozf:"\u29EB",lpar:"(",lparlt:"\u2993",lrarr:"\u21C6",lrcorner:"\u231F",lrhar:"\u21CB",lrhard:"\u296D",lrm:"\u200E",lrtri:"\u22BF",lsaquo:"\u2039",Lscr:"\u2112",lscr:"\u{1D4C1}",Lsh:"\u21B0",lsh:"\u21B0",lsim:"\u2272",lsime:"\u2A8D",lsimg:"\u2A8F",lsqb:"[",lsquo:"\u2018",lsquor:"\u201A",Lstrok:"\u0141",lstrok:"\u0142",Lt:"\u226A",LT:"<",lt:"<",ltcc:"\u2AA6",ltcir:"\u2A79",ltdot:"\u22D6",lthree:"\u22CB",ltimes:"\u22C9",ltlarr:"\u2976",ltquest:"\u2A7B",ltri:"\u25C3",ltrie:"\u22B4",ltrif:"\u25C2",ltrPar:"\u2996",lurdshar:"\u294A",luruhar:"\u2966",lvertneqq:"\u2268\uFE00",lvnE:"\u2268\uFE00",macr:"\xAF",male:"\u2642",malt:"\u2720",maltese:"\u2720",Map:"\u2905",map:"\u21A6",mapsto:"\u21A6",mapstodown:"\u21A7",mapstoleft:"\u21A4",mapstoup:"\u21A5",marker:"\u25AE",mcomma:"\u2A29",Mcy:"\u041C",mcy:"\u043C",mdash:"\u2014",mDDot:"\u223A",measuredangle:"\u2221",MediumSpace:"\u205F",Mellintrf:"\u2133",Mfr:"\u{1D510}",mfr:"\u{1D52A}",mho:"\u2127",micro:"\xB5",mid:"\u2223",midast:"*",midcir:"\u2AF0",middot:"\xB7",minus:"\u2212",minusb:"\u229F",minusd:"\u2238",minusdu:"\u2A2A",MinusPlus:"\u2213",mlcp:"\u2ADB",mldr:"\u2026",mnplus:"\u2213",models:"\u22A7",Mopf:"\u{1D544}",mopf:"\u{1D55E}",mp:"\u2213",Mscr:"\u2133",mscr:"\u{1D4C2}",mstpos:"\u223E",Mu:"\u039C",mu:"\u03BC",multimap:"\u22B8",mumap:"\u22B8",nabla:"\u2207",Nacute:"\u0143",nacute:"\u0144",nang:"\u2220\u20D2",nap:"\u2249",napE:"\u2A70\u0338",napid:"\u224B\u0338",napos:"\u0149",napprox:"\u2249",natur:"\u266E",natural:"\u266E",naturals:"\u2115",nbsp:"\xA0",nbump:"\u224E\u0338",nbumpe:"\u224F\u0338",ncap:"\u2A43",Ncaron:"\u0147",ncaron:"\u0148",Ncedil:"\u0145",ncedil:"\u0146",ncong:"\u2247",ncongdot:"\u2A6D\u0338",ncup:"\u2A42",Ncy:"\u041D",ncy:"\u043D",ndash:"\u2013",ne:"\u2260",nearhk:"\u2924",neArr:"\u21D7",nearr:"\u2197",nearrow:"\u2197",nedot:"\u2250\u0338",NegativeMediumSpace:"\u200B",NegativeThickSpace:"\u200B",NegativeThinSpace:"\u200B",NegativeVeryThinSpace:"\u200B",nequiv:"\u2262",nesear:"\u2928",nesim:"\u2242\u0338",NestedGreaterGreater:"\u226B",NestedLessLess:"\u226A",NewLine:`
`,nexist:"\u2204",nexists:"\u2204",Nfr:"\u{1D511}",nfr:"\u{1D52B}",ngE:"\u2267\u0338",nge:"\u2271",ngeq:"\u2271",ngeqq:"\u2267\u0338",ngeqslant:"\u2A7E\u0338",nges:"\u2A7E\u0338",nGg:"\u22D9\u0338",ngsim:"\u2275",nGt:"\u226B\u20D2",ngt:"\u226F",ngtr:"\u226F",nGtv:"\u226B\u0338",nhArr:"\u21CE",nharr:"\u21AE",nhpar:"\u2AF2",ni:"\u220B",nis:"\u22FC",nisd:"\u22FA",niv:"\u220B",NJcy:"\u040A",njcy:"\u045A",nlArr:"\u21CD",nlarr:"\u219A",nldr:"\u2025",nlE:"\u2266\u0338",nle:"\u2270",nLeftarrow:"\u21CD",nleftarrow:"\u219A",nLeftrightarrow:"\u21CE",nleftrightarrow:"\u21AE",nleq:"\u2270",nleqq:"\u2266\u0338",nleqslant:"\u2A7D\u0338",nles:"\u2A7D\u0338",nless:"\u226E",nLl:"\u22D8\u0338",nlsim:"\u2274",nLt:"\u226A\u20D2",nlt:"\u226E",nltri:"\u22EA",nltrie:"\u22EC",nLtv:"\u226A\u0338",nmid:"\u2224",NoBreak:"\u2060",NonBreakingSpace:"\xA0",Nopf:"\u2115",nopf:"\u{1D55F}",Not:"\u2AEC",not:"\xAC",NotCongruent:"\u2262",NotCupCap:"\u226D",NotDoubleVerticalBar:"\u2226",NotElement:"\u2209",NotEqual:"\u2260",NotEqualTilde:"\u2242\u0338",NotExists:"\u2204",NotGreater:"\u226F",NotGreaterEqual:"\u2271",NotGreaterFullEqual:"\u2267\u0338",NotGreaterGreater:"\u226B\u0338",NotGreaterLess:"\u2279",NotGreaterSlantEqual:"\u2A7E\u0338",NotGreaterTilde:"\u2275",NotHumpDownHump:"\u224E\u0338",NotHumpEqual:"\u224F\u0338",notin:"\u2209",notindot:"\u22F5\u0338",notinE:"\u22F9\u0338",notinva:"\u2209",notinvb:"\u22F7",notinvc:"\u22F6",NotLeftTriangle:"\u22EA",NotLeftTriangleBar:"\u29CF\u0338",NotLeftTriangleEqual:"\u22EC",NotLess:"\u226E",NotLessEqual:"\u2270",NotLessGreater:"\u2278",NotLessLess:"\u226A\u0338",NotLessSlantEqual:"\u2A7D\u0338",NotLessTilde:"\u2274",NotNestedGreaterGreater:"\u2AA2\u0338",NotNestedLessLess:"\u2AA1\u0338",notni:"\u220C",notniva:"\u220C",notnivb:"\u22FE",notnivc:"\u22FD",NotPrecedes:"\u2280",NotPrecedesEqual:"\u2AAF\u0338",NotPrecedesSlantEqual:"\u22E0",NotReverseElement:"\u220C",NotRightTriangle:"\u22EB",NotRightTriangleBar:"\u29D0\u0338",NotRightTriangleEqual:"\u22ED",NotSquareSubset:"\u228F\u0338",NotSquareSubsetEqual:"\u22E2",NotSquareSuperset:"\u2290\u0338",NotSquareSupersetEqual:"\u22E3",NotSubset:"\u2282\u20D2",NotSubsetEqual:"\u2288",NotSucceeds:"\u2281",NotSucceedsEqual:"\u2AB0\u0338",NotSucceedsSlantEqual:"\u22E1",NotSucceedsTilde:"\u227F\u0338",NotSuperset:"\u2283\u20D2",NotSupersetEqual:"\u2289",NotTilde:"\u2241",NotTildeEqual:"\u2244",NotTildeFullEqual:"\u2247",NotTildeTilde:"\u2249",NotVerticalBar:"\u2224",npar:"\u2226",nparallel:"\u2226",nparsl:"\u2AFD\u20E5",npart:"\u2202\u0338",npolint:"\u2A14",npr:"\u2280",nprcue:"\u22E0",npre:"\u2AAF\u0338",nprec:"\u2280",npreceq:"\u2AAF\u0338",nrArr:"\u21CF",nrarr:"\u219B",nrarrc:"\u2933\u0338",nrarrw:"\u219D\u0338",nRightarrow:"\u21CF",nrightarrow:"\u219B",nrtri:"\u22EB",nrtrie:"\u22ED",nsc:"\u2281",nsccue:"\u22E1",nsce:"\u2AB0\u0338",Nscr:"\u{1D4A9}",nscr:"\u{1D4C3}",nshortmid:"\u2224",nshortparallel:"\u2226",nsim:"\u2241",nsime:"\u2244",nsimeq:"\u2244",nsmid:"\u2224",nspar:"\u2226",nsqsube:"\u22E2",nsqsupe:"\u22E3",nsub:"\u2284",nsubE:"\u2AC5\u0338",nsube:"\u2288",nsubset:"\u2282\u20D2",nsubseteq:"\u2288",nsubseteqq:"\u2AC5\u0338",nsucc:"\u2281",nsucceq:"\u2AB0\u0338",nsup:"\u2285",nsupE:"\u2AC6\u0338",nsupe:"\u2289",nsupset:"\u2283\u20D2",nsupseteq:"\u2289",nsupseteqq:"\u2AC6\u0338",ntgl:"\u2279",Ntilde:"\xD1",ntilde:"\xF1",ntlg:"\u2278",ntriangleleft:"\u22EA",ntrianglelefteq:"\u22EC",ntriangleright:"\u22EB",ntrianglerighteq:"\u22ED",Nu:"\u039D",nu:"\u03BD",num:"#",numero:"\u2116",numsp:"\u2007",nvap:"\u224D\u20D2",nVDash:"\u22AF",nVdash:"\u22AE",nvDash:"\u22AD",nvdash:"\u22AC",nvge:"\u2265\u20D2",nvgt:">\u20D2",nvHarr:"\u2904",nvinfin:"\u29DE",nvlArr:"\u2902",nvle:"\u2264\u20D2",nvlt:"<\u20D2",nvltrie:"\u22B4\u20D2",nvrArr:"\u2903",nvrtrie:"\u22B5\u20D2",nvsim:"\u223C\u20D2",nwarhk:"\u2923",nwArr:"\u21D6",nwarr:"\u2196",nwarrow:"\u2196",nwnear:"\u2927",Oacute:"\xD3",oacute:"\xF3",oast:"\u229B",ocir:"\u229A",Ocirc:"\xD4",ocirc:"\xF4",Ocy:"\u041E",ocy:"\u043E",odash:"\u229D",Odblac:"\u0150",odblac:"\u0151",odiv:"\u2A38",odot:"\u2299",odsold:"\u29BC",OElig:"\u0152",oelig:"\u0153",ofcir:"\u29BF",Ofr:"\u{1D512}",ofr:"\u{1D52C}",ogon:"\u02DB",Ograve:"\xD2",ograve:"\xF2",ogt:"\u29C1",ohbar:"\u29B5",ohm:"\u03A9",oint:"\u222E",olarr:"\u21BA",olcir:"\u29BE",olcross:"\u29BB",oline:"\u203E",olt:"\u29C0",Omacr:"\u014C",omacr:"\u014D",Omega:"\u03A9",omega:"\u03C9",Omicron:"\u039F",omicron:"\u03BF",omid:"\u29B6",ominus:"\u2296",Oopf:"\u{1D546}",oopf:"\u{1D560}",opar:"\u29B7",OpenCurlyDoubleQuote:"\u201C",OpenCurlyQuote:"\u2018",operp:"\u29B9",oplus:"\u2295",Or:"\u2A54",or:"\u2228",orarr:"\u21BB",ord:"\u2A5D",order:"\u2134",orderof:"\u2134",ordf:"\xAA",ordm:"\xBA",origof:"\u22B6",oror:"\u2A56",orslope:"\u2A57",orv:"\u2A5B",oS:"\u24C8",Oscr:"\u{1D4AA}",oscr:"\u2134",Oslash:"\xD8",oslash:"\xF8",osol:"\u2298",Otilde:"\xD5",otilde:"\xF5",Otimes:"\u2A37",otimes:"\u2297",otimesas:"\u2A36",Ouml:"\xD6",ouml:"\xF6",ovbar:"\u233D",OverBar:"\u203E",OverBrace:"\u23DE",OverBracket:"\u23B4",OverParenthesis:"\u23DC",par:"\u2225",para:"\xB6",parallel:"\u2225",parsim:"\u2AF3",parsl:"\u2AFD",part:"\u2202",PartialD:"\u2202",Pcy:"\u041F",pcy:"\u043F",percnt:"%",period:".",permil:"\u2030",perp:"\u22A5",pertenk:"\u2031",Pfr:"\u{1D513}",pfr:"\u{1D52D}",Phi:"\u03A6",phi:"\u03C6",phiv:"\u03D5",phmmat:"\u2133",phone:"\u260E",Pi:"\u03A0",pi:"\u03C0",pitchfork:"\u22D4",piv:"\u03D6",planck:"\u210F",planckh:"\u210E",plankv:"\u210F",plus:"+",plusacir:"\u2A23",plusb:"\u229E",pluscir:"\u2A22",plusdo:"\u2214",plusdu:"\u2A25",pluse:"\u2A72",PlusMinus:"\xB1",plusmn:"\xB1",plussim:"\u2A26",plustwo:"\u2A27",pm:"\xB1",Poincareplane:"\u210C",pointint:"\u2A15",Popf:"\u2119",popf:"\u{1D561}",pound:"\xA3",Pr:"\u2ABB",pr:"\u227A",prap:"\u2AB7",prcue:"\u227C",prE:"\u2AB3",pre:"\u2AAF",prec:"\u227A",precapprox:"\u2AB7",preccurlyeq:"\u227C",Precedes:"\u227A",PrecedesEqual:"\u2AAF",PrecedesSlantEqual:"\u227C",PrecedesTilde:"\u227E",preceq:"\u2AAF",precnapprox:"\u2AB9",precneqq:"\u2AB5",precnsim:"\u22E8",precsim:"\u227E",Prime:"\u2033",prime:"\u2032",primes:"\u2119",prnap:"\u2AB9",prnE:"\u2AB5",prnsim:"\u22E8",prod:"\u220F",Product:"\u220F",profalar:"\u232E",profline:"\u2312",profsurf:"\u2313",prop:"\u221D",Proportion:"\u2237",Proportional:"\u221D",propto:"\u221D",prsim:"\u227E",prurel:"\u22B0",Pscr:"\u{1D4AB}",pscr:"\u{1D4C5}",Psi:"\u03A8",psi:"\u03C8",puncsp:"\u2008",Qfr:"\u{1D514}",qfr:"\u{1D52E}",qint:"\u2A0C",Qopf:"\u211A",qopf:"\u{1D562}",qprime:"\u2057",Qscr:"\u{1D4AC}",qscr:"\u{1D4C6}",quaternions:"\u210D",quatint:"\u2A16",quest:"?",questeq:"\u225F",QUOT:'"',quot:'"',rAarr:"\u21DB",race:"\u223D\u0331",Racute:"\u0154",racute:"\u0155",radic:"\u221A",raemptyv:"\u29B3",Rang:"\u27EB",rang:"\u27E9",rangd:"\u2992",range:"\u29A5",rangle:"\u27E9",raquo:"\xBB",Rarr:"\u21A0",rArr:"\u21D2",rarr:"\u2192",rarrap:"\u2975",rarrb:"\u21E5",rarrbfs:"\u2920",rarrc:"\u2933",rarrfs:"\u291E",rarrhk:"\u21AA",rarrlp:"\u21AC",rarrpl:"\u2945",rarrsim:"\u2974",Rarrtl:"\u2916",rarrtl:"\u21A3",rarrw:"\u219D",rAtail:"\u291C",ratail:"\u291A",ratio:"\u2236",rationals:"\u211A",RBarr:"\u2910",rBarr:"\u290F",rbarr:"\u290D",rbbrk:"\u2773",rbrace:"}",rbrack:"]",rbrke:"\u298C",rbrksld:"\u298E",rbrkslu:"\u2990",Rcaron:"\u0158",rcaron:"\u0159",Rcedil:"\u0156",rcedil:"\u0157",rceil:"\u2309",rcub:"}",Rcy:"\u0420",rcy:"\u0440",rdca:"\u2937",rdldhar:"\u2969",rdquo:"\u201D",rdquor:"\u201D",rdsh:"\u21B3",Re:"\u211C",real:"\u211C",realine:"\u211B",realpart:"\u211C",reals:"\u211D",rect:"\u25AD",REG:"\xAE",reg:"\xAE",ReverseElement:"\u220B",ReverseEquilibrium:"\u21CB",ReverseUpEquilibrium:"\u296F",rfisht:"\u297D",rfloor:"\u230B",Rfr:"\u211C",rfr:"\u{1D52F}",rHar:"\u2964",rhard:"\u21C1",rharu:"\u21C0",rharul:"\u296C",Rho:"\u03A1",rho:"\u03C1",rhov:"\u03F1",RightAngleBracket:"\u27E9",RightArrow:"\u2192",Rightarrow:"\u21D2",rightarrow:"\u2192",RightArrowBar:"\u21E5",RightArrowLeftArrow:"\u21C4",rightarrowtail:"\u21A3",RightCeiling:"\u2309",RightDoubleBracket:"\u27E7",RightDownTeeVector:"\u295D",RightDownVector:"\u21C2",RightDownVectorBar:"\u2955",RightFloor:"\u230B",rightharpoondown:"\u21C1",rightharpoonup:"\u21C0",rightleftarrows:"\u21C4",rightleftharpoons:"\u21CC",rightrightarrows:"\u21C9",rightsquigarrow:"\u219D",RightTee:"\u22A2",RightTeeArrow:"\u21A6",RightTeeVector:"\u295B",rightthreetimes:"\u22CC",RightTriangle:"\u22B3",RightTriangleBar:"\u29D0",RightTriangleEqual:"\u22B5",RightUpDownVector:"\u294F",RightUpTeeVector:"\u295C",RightUpVector:"\u21BE",RightUpVectorBar:"\u2954",RightVector:"\u21C0",RightVectorBar:"\u2953",ring:"\u02DA",risingdotseq:"\u2253",rlarr:"\u21C4",rlhar:"\u21CC",rlm:"\u200F",rmoust:"\u23B1",rmoustache:"\u23B1",rnmid:"\u2AEE",roang:"\u27ED",roarr:"\u21FE",robrk:"\u27E7",ropar:"\u2986",Ropf:"\u211D",ropf:"\u{1D563}",roplus:"\u2A2E",rotimes:"\u2A35",RoundImplies:"\u2970",rpar:")",rpargt:"\u2994",rppolint:"\u2A12",rrarr:"\u21C9",Rrightarrow:"\u21DB",rsaquo:"\u203A",Rscr:"\u211B",rscr:"\u{1D4C7}",Rsh:"\u21B1",rsh:"\u21B1",rsqb:"]",rsquo:"\u2019",rsquor:"\u2019",rthree:"\u22CC",rtimes:"\u22CA",rtri:"\u25B9",rtrie:"\u22B5",rtrif:"\u25B8",rtriltri:"\u29CE",RuleDelayed:"\u29F4",ruluhar:"\u2968",rx:"\u211E",Sacute:"\u015A",sacute:"\u015B",sbquo:"\u201A",Sc:"\u2ABC",sc:"\u227B",scap:"\u2AB8",Scaron:"\u0160",scaron:"\u0161",sccue:"\u227D",scE:"\u2AB4",sce:"\u2AB0",Scedil:"\u015E",scedil:"\u015F",Scirc:"\u015C",scirc:"\u015D",scnap:"\u2ABA",scnE:"\u2AB6",scnsim:"\u22E9",scpolint:"\u2A13",scsim:"\u227F",Scy:"\u0421",scy:"\u0441",sdot:"\u22C5",sdotb:"\u22A1",sdote:"\u2A66",searhk:"\u2925",seArr:"\u21D8",searr:"\u2198",searrow:"\u2198",sect:"\xA7",semi:";",seswar:"\u2929",setminus:"\u2216",setmn:"\u2216",sext:"\u2736",Sfr:"\u{1D516}",sfr:"\u{1D530}",sfrown:"\u2322",sharp:"\u266F",SHCHcy:"\u0429",shchcy:"\u0449",SHcy:"\u0428",shcy:"\u0448",ShortDownArrow:"\u2193",ShortLeftArrow:"\u2190",shortmid:"\u2223",shortparallel:"\u2225",ShortRightArrow:"\u2192",ShortUpArrow:"\u2191",shy:"\xAD",Sigma:"\u03A3",sigma:"\u03C3",sigmaf:"\u03C2",sigmav:"\u03C2",sim:"\u223C",simdot:"\u2A6A",sime:"\u2243",simeq:"\u2243",simg:"\u2A9E",simgE:"\u2AA0",siml:"\u2A9D",simlE:"\u2A9F",simne:"\u2246",simplus:"\u2A24",simrarr:"\u2972",slarr:"\u2190",SmallCircle:"\u2218",smallsetminus:"\u2216",smashp:"\u2A33",smeparsl:"\u29E4",smid:"\u2223",smile:"\u2323",smt:"\u2AAA",smte:"\u2AAC",smtes:"\u2AAC\uFE00",SOFTcy:"\u042C",softcy:"\u044C",sol:"/",solb:"\u29C4",solbar:"\u233F",Sopf:"\u{1D54A}",sopf:"\u{1D564}",spades:"\u2660",spadesuit:"\u2660",spar:"\u2225",sqcap:"\u2293",sqcaps:"\u2293\uFE00",sqcup:"\u2294",sqcups:"\u2294\uFE00",Sqrt:"\u221A",sqsub:"\u228F",sqsube:"\u2291",sqsubset:"\u228F",sqsubseteq:"\u2291",sqsup:"\u2290",sqsupe:"\u2292",sqsupset:"\u2290",sqsupseteq:"\u2292",squ:"\u25A1",Square:"\u25A1",square:"\u25A1",SquareIntersection:"\u2293",SquareSubset:"\u228F",SquareSubsetEqual:"\u2291",SquareSuperset:"\u2290",SquareSupersetEqual:"\u2292",SquareUnion:"\u2294",squarf:"\u25AA",squf:"\u25AA",srarr:"\u2192",Sscr:"\u{1D4AE}",sscr:"\u{1D4C8}",ssetmn:"\u2216",ssmile:"\u2323",sstarf:"\u22C6",Star:"\u22C6",star:"\u2606",starf:"\u2605",straightepsilon:"\u03F5",straightphi:"\u03D5",strns:"\xAF",Sub:"\u22D0",sub:"\u2282",subdot:"\u2ABD",subE:"\u2AC5",sube:"\u2286",subedot:"\u2AC3",submult:"\u2AC1",subnE:"\u2ACB",subne:"\u228A",subplus:"\u2ABF",subrarr:"\u2979",Subset:"\u22D0",subset:"\u2282",subseteq:"\u2286",subseteqq:"\u2AC5",SubsetEqual:"\u2286",subsetneq:"\u228A",subsetneqq:"\u2ACB",subsim:"\u2AC7",subsub:"\u2AD5",subsup:"\u2AD3",succ:"\u227B",succapprox:"\u2AB8",succcurlyeq:"\u227D",Succeeds:"\u227B",SucceedsEqual:"\u2AB0",SucceedsSlantEqual:"\u227D",SucceedsTilde:"\u227F",succeq:"\u2AB0",succnapprox:"\u2ABA",succneqq:"\u2AB6",succnsim:"\u22E9",succsim:"\u227F",SuchThat:"\u220B",Sum:"\u2211",sum:"\u2211",sung:"\u266A",Sup:"\u22D1",sup:"\u2283",sup1:"\xB9",sup2:"\xB2",sup3:"\xB3",supdot:"\u2ABE",supdsub:"\u2AD8",supE:"\u2AC6",supe:"\u2287",supedot:"\u2AC4",Superset:"\u2283",SupersetEqual:"\u2287",suphsol:"\u27C9",suphsub:"\u2AD7",suplarr:"\u297B",supmult:"\u2AC2",supnE:"\u2ACC",supne:"\u228B",supplus:"\u2AC0",Supset:"\u22D1",supset:"\u2283",supseteq:"\u2287",supseteqq:"\u2AC6",supsetneq:"\u228B",supsetneqq:"\u2ACC",supsim:"\u2AC8",supsub:"\u2AD4",supsup:"\u2AD6",swarhk:"\u2926",swArr:"\u21D9",swarr:"\u2199",swarrow:"\u2199",swnwar:"\u292A",szlig:"\xDF",Tab:"	",target:"\u2316",Tau:"\u03A4",tau:"\u03C4",tbrk:"\u23B4",Tcaron:"\u0164",tcaron:"\u0165",Tcedil:"\u0162",tcedil:"\u0163",Tcy:"\u0422",tcy:"\u0442",tdot:"\u20DB",telrec:"\u2315",Tfr:"\u{1D517}",tfr:"\u{1D531}",there4:"\u2234",Therefore:"\u2234",therefore:"\u2234",Theta:"\u0398",theta:"\u03B8",thetasym:"\u03D1",thetav:"\u03D1",thickapprox:"\u2248",thicksim:"\u223C",ThickSpace:"\u205F\u200A",thinsp:"\u2009",ThinSpace:"\u2009",thkap:"\u2248",thksim:"\u223C",THORN:"\xDE",thorn:"\xFE",Tilde:"\u223C",tilde:"\u02DC",TildeEqual:"\u2243",TildeFullEqual:"\u2245",TildeTilde:"\u2248",times:"\xD7",timesb:"\u22A0",timesbar:"\u2A31",timesd:"\u2A30",tint:"\u222D",toea:"\u2928",top:"\u22A4",topbot:"\u2336",topcir:"\u2AF1",Topf:"\u{1D54B}",topf:"\u{1D565}",topfork:"\u2ADA",tosa:"\u2929",tprime:"\u2034",TRADE:"\u2122",trade:"\u2122",triangle:"\u25B5",triangledown:"\u25BF",triangleleft:"\u25C3",trianglelefteq:"\u22B4",triangleq:"\u225C",triangleright:"\u25B9",trianglerighteq:"\u22B5",tridot:"\u25EC",trie:"\u225C",triminus:"\u2A3A",TripleDot:"\u20DB",triplus:"\u2A39",trisb:"\u29CD",tritime:"\u2A3B",trpezium:"\u23E2",Tscr:"\u{1D4AF}",tscr:"\u{1D4C9}",TScy:"\u0426",tscy:"\u0446",TSHcy:"\u040B",tshcy:"\u045B",Tstrok:"\u0166",tstrok:"\u0167",twixt:"\u226C",twoheadleftarrow:"\u219E",twoheadrightarrow:"\u21A0",Uacute:"\xDA",uacute:"\xFA",Uarr:"\u219F",uArr:"\u21D1",uarr:"\u2191",Uarrocir:"\u2949",Ubrcy:"\u040E",ubrcy:"\u045E",Ubreve:"\u016C",ubreve:"\u016D",Ucirc:"\xDB",ucirc:"\xFB",Ucy:"\u0423",ucy:"\u0443",udarr:"\u21C5",Udblac:"\u0170",udblac:"\u0171",udhar:"\u296E",ufisht:"\u297E",Ufr:"\u{1D518}",ufr:"\u{1D532}",Ugrave:"\xD9",ugrave:"\xF9",uHar:"\u2963",uharl:"\u21BF",uharr:"\u21BE",uhblk:"\u2580",ulcorn:"\u231C",ulcorner:"\u231C",ulcrop:"\u230F",ultri:"\u25F8",Umacr:"\u016A",umacr:"\u016B",uml:"\xA8",UnderBar:"_",UnderBrace:"\u23DF",UnderBracket:"\u23B5",UnderParenthesis:"\u23DD",Union:"\u22C3",UnionPlus:"\u228E",Uogon:"\u0172",uogon:"\u0173",Uopf:"\u{1D54C}",uopf:"\u{1D566}",UpArrow:"\u2191",Uparrow:"\u21D1",uparrow:"\u2191",UpArrowBar:"\u2912",UpArrowDownArrow:"\u21C5",UpDownArrow:"\u2195",Updownarrow:"\u21D5",updownarrow:"\u2195",UpEquilibrium:"\u296E",upharpoonleft:"\u21BF",upharpoonright:"\u21BE",uplus:"\u228E",UpperLeftArrow:"\u2196",UpperRightArrow:"\u2197",Upsi:"\u03D2",upsi:"\u03C5",upsih:"\u03D2",Upsilon:"\u03A5",upsilon:"\u03C5",UpTee:"\u22A5",UpTeeArrow:"\u21A5",upuparrows:"\u21C8",urcorn:"\u231D",urcorner:"\u231D",urcrop:"\u230E",Uring:"\u016E",uring:"\u016F",urtri:"\u25F9",Uscr:"\u{1D4B0}",uscr:"\u{1D4CA}",utdot:"\u22F0",Utilde:"\u0168",utilde:"\u0169",utri:"\u25B5",utrif:"\u25B4",uuarr:"\u21C8",Uuml:"\xDC",uuml:"\xFC",uwangle:"\u29A7",vangrt:"\u299C",varepsilon:"\u03F5",varkappa:"\u03F0",varnothing:"\u2205",varphi:"\u03D5",varpi:"\u03D6",varpropto:"\u221D",vArr:"\u21D5",varr:"\u2195",varrho:"\u03F1",varsigma:"\u03C2",varsubsetneq:"\u228A\uFE00",varsubsetneqq:"\u2ACB\uFE00",varsupsetneq:"\u228B\uFE00",varsupsetneqq:"\u2ACC\uFE00",vartheta:"\u03D1",vartriangleleft:"\u22B2",vartriangleright:"\u22B3",Vbar:"\u2AEB",vBar:"\u2AE8",vBarv:"\u2AE9",Vcy:"\u0412",vcy:"\u0432",VDash:"\u22AB",Vdash:"\u22A9",vDash:"\u22A8",vdash:"\u22A2",Vdashl:"\u2AE6",Vee:"\u22C1",vee:"\u2228",veebar:"\u22BB",veeeq:"\u225A",vellip:"\u22EE",Verbar:"\u2016",verbar:"|",Vert:"\u2016",vert:"|",VerticalBar:"\u2223",VerticalLine:"|",VerticalSeparator:"\u2758",VerticalTilde:"\u2240",VeryThinSpace:"\u200A",Vfr:"\u{1D519}",vfr:"\u{1D533}",vltri:"\u22B2",vnsub:"\u2282\u20D2",vnsup:"\u2283\u20D2",Vopf:"\u{1D54D}",vopf:"\u{1D567}",vprop:"\u221D",vrtri:"\u22B3",Vscr:"\u{1D4B1}",vscr:"\u{1D4CB}",vsubnE:"\u2ACB\uFE00",vsubne:"\u228A\uFE00",vsupnE:"\u2ACC\uFE00",vsupne:"\u228B\uFE00",Vvdash:"\u22AA",vzigzag:"\u299A",Wcirc:"\u0174",wcirc:"\u0175",wedbar:"\u2A5F",Wedge:"\u22C0",wedge:"\u2227",wedgeq:"\u2259",weierp:"\u2118",Wfr:"\u{1D51A}",wfr:"\u{1D534}",Wopf:"\u{1D54E}",wopf:"\u{1D568}",wp:"\u2118",wr:"\u2240",wreath:"\u2240",Wscr:"\u{1D4B2}",wscr:"\u{1D4CC}",xcap:"\u22C2",xcirc:"\u25EF",xcup:"\u22C3",xdtri:"\u25BD",Xfr:"\u{1D51B}",xfr:"\u{1D535}",xhArr:"\u27FA",xharr:"\u27F7",Xi:"\u039E",xi:"\u03BE",xlArr:"\u27F8",xlarr:"\u27F5",xmap:"\u27FC",xnis:"\u22FB",xodot:"\u2A00",Xopf:"\u{1D54F}",xopf:"\u{1D569}",xoplus:"\u2A01",xotime:"\u2A02",xrArr:"\u27F9",xrarr:"\u27F6",Xscr:"\u{1D4B3}",xscr:"\u{1D4CD}",xsqcup:"\u2A06",xuplus:"\u2A04",xutri:"\u25B3",xvee:"\u22C1",xwedge:"\u22C0",Yacute:"\xDD",yacute:"\xFD",YAcy:"\u042F",yacy:"\u044F",Ycirc:"\u0176",ycirc:"\u0177",Ycy:"\u042B",ycy:"\u044B",yen:"\xA5",Yfr:"\u{1D51C}",yfr:"\u{1D536}",YIcy:"\u0407",yicy:"\u0457",Yopf:"\u{1D550}",yopf:"\u{1D56A}",Yscr:"\u{1D4B4}",yscr:"\u{1D4CE}",YUcy:"\u042E",yucy:"\u044E",Yuml:"\u0178",yuml:"\xFF",Zacute:"\u0179",zacute:"\u017A",Zcaron:"\u017D",zcaron:"\u017E",Zcy:"\u0417",zcy:"\u0437",Zdot:"\u017B",zdot:"\u017C",zeetrf:"\u2128",ZeroWidthSpace:"\u200B",Zeta:"\u0396",zeta:"\u03B6",Zfr:"\u2128",zfr:"\u{1D537}",ZHcy:"\u0416",zhcy:"\u0436",zigrarr:"\u21DD",Zopf:"\u2124",zopf:"\u{1D56B}",Zscr:"\u{1D4B5}",zscr:"\u{1D4CF}",zwj:"\u200D",zwnj:"\u200C"});Pa.entityMap=Pa.HTML_ENTITIES});var kC=L(ih=>{var _a=ba().NAMESPACE,nh=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,CC=new RegExp("[\\-\\.0-9"+nh.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),DC=new RegExp("^"+nh.source+CC.source+"*(?::"+nh.source+CC.source+"*)?$"),xa=0,Ni=1,so=2,ka=3,oo=4,ao=5,Ra=6,pc=7;function uo(r,e){this.message=r,this.locator=e,Error.captureStackTrace&&Error.captureStackTrace(this,uo)}uo.prototype=new Error;uo.prototype.name=uo.name;function EC(){}EC.prototype={parse:function(r,e,t){var n=this.domBuilder;n.startDocument(),PC(e,e={}),JO(r,e,t,n,this.errorHandler),n.endDocument()}};function JO(r,e,t,n,i){function s(Q){if(Q>65535){Q-=65536;var se=55296+(Q>>10),fe=56320+(Q&1023);return String.fromCharCode(se,fe)}else return String.fromCharCode(Q)}function o(Q){var se=Q.slice(1,-1);return Object.hasOwnProperty.call(t,se)?t[se]:se.charAt(0)==="#"?s(parseInt(se.substr(1).replace("x","0x"))):(i.error("entity not found:"+Q),Q)}function a(Q){if(Q>D){var se=r.substring(D,Q).replace(/&#?\w+;/g,o);d&&u(D),n.characters(se,0,Q-D),D=Q}}function u(Q,se){for(;Q>=l&&(se=f.exec(r));)c=se.index,l=c+se[0].length,d.lineNumber++;d.columnNumber=Q-c+1}for(var c=0,l=0,f=/.*(?:\r\n?|\n)|.*$/g,d=n.locator,h=[{currentNSMap:e}],m={},D=0;;){try{var _=r.indexOf("<",D);if(_<0){if(!r.substr(D).match(/^\s*$/)){var R=n.doc,N=R.createTextNode(r.substr(D));R.appendChild(N),n.currentElement=N}return}switch(_>D&&a(_),r.charAt(_+1)){case"/":var I=r.indexOf(">",_+3),w=r.substring(_+2,I).replace(/[ \t\n\r]+$/g,""),p=h.pop();I<0?(w=r.substring(_+2).replace(/[\s<].*/,""),i.error("end tag name: "+w+" is not complete:"+p.tagName),I=_+1+w.length):w.match(/\s</)&&(w=w.replace(/[\s<].*/,""),i.error("end tag name: "+w+" maybe not complete"),I=_+1+w.length);var v=p.localNSMap,g=p.tagName==w,k=g||p.tagName&&p.tagName.toLowerCase()==w.toLowerCase();if(k){if(n.endElement(p.uri,p.localName,w),v)for(var b in v)Object.prototype.hasOwnProperty.call(v,b)&&n.endPrefixMapping(b);g||i.fatalError("end tag name: "+w+" is not match the current start tagName:"+p.tagName)}else h.push(p);I++;break;case"?":d&&u(_),I=nA(r,_,n);break;case"!":d&&u(_),I=rA(r,_,n,i);break;default:d&&u(_);var C=new xC,E=h[h.length-1].currentNSMap,I=ZO(r,_,C,E,o,i),B=C.length;if(!C.closed&&tA(r,I,C.tagName,m)&&(C.closed=!0,t.nbsp||i.warning("unclosed xml attribute")),d&&B){for(var z=TC(d,{}),te=0;te<B;te++){var ue=C[te];u(ue.offset),ue.locator=TC(d,{})}n.locator=z,SC(C,n,E)&&h.push(C),n.locator=d}else SC(C,n,E)&&h.push(C);_a.isHTML(C.uri)&&!C.closed?I=eA(r,I,C.tagName,o,n):I++}}catch(Q){if(Q instanceof uo)throw Q;i.error("element parse error: "+Q),I=-1}I>D?D=I:a(Math.max(_,D)+1)}}function TC(r,e){return e.lineNumber=r.lineNumber,e.columnNumber=r.columnNumber,e}function ZO(r,e,t,n,i,s){function o(h,m,D){t.attributeNames.hasOwnProperty(h)&&s.fatalError("Attribute "+h+" redefined"),t.addValue(h,m.replace(/[\t\n\r]/g," ").replace(/&#?\w+;/g,i),D)}for(var a,u,c=++e,l=xa;;){var f=r.charAt(c);switch(f){case"=":if(l===Ni)a=r.slice(e,c),l=ka;else if(l===so)l=ka;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(l===ka||l===Ni)if(l===Ni&&(s.warning('attribute value must after "="'),a=r.slice(e,c)),e=c+1,c=r.indexOf(f,e),c>0)u=r.slice(e,c),o(a,u,e-1),l=ao;else throw new Error("attribute value no end '"+f+"' match");else if(l==oo)u=r.slice(e,c),o(a,u,e),s.warning('attribute "'+a+'" missed start quot('+f+")!!"),e=c+1,l=ao;else throw new Error('attribute value must after "="');break;case"/":switch(l){case xa:t.setTagName(r.slice(e,c));case ao:case Ra:case pc:l=pc,t.closed=!0;case oo:case Ni:break;case so:t.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return s.error("unexpected end of input"),l==xa&&t.setTagName(r.slice(e,c)),c;case">":switch(l){case xa:t.setTagName(r.slice(e,c));case ao:case Ra:case pc:break;case oo:case Ni:u=r.slice(e,c),u.slice(-1)==="/"&&(t.closed=!0,u=u.slice(0,-1));case so:l===so&&(u=a),l==oo?(s.warning('attribute "'+u+'" missed quot(")!'),o(a,u,e)):((!_a.isHTML(n[""])||!u.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+u+'" missed value!! "'+u+'" instead!!'),o(u,u,e));break;case ka:throw new Error("attribute value missed!!")}return c;case"\x80":f=" ";default:if(f<=" ")switch(l){case xa:t.setTagName(r.slice(e,c)),l=Ra;break;case Ni:a=r.slice(e,c),l=so;break;case oo:var u=r.slice(e,c);s.warning('attribute "'+u+'" missed quot(")!!'),o(a,u,e);case ao:l=Ra;break}else switch(l){case so:var d=t.tagName;(!_a.isHTML(n[""])||!a.match(/^(?:disabled|checked|selected)$/i))&&s.warning('attribute "'+a+'" missed value!! "'+a+'" instead2!!'),o(a,a,e),e=c,l=Ni;break;case ao:s.warning('attribute space is required"'+a+'"!!');case Ra:l=Ni,e=c;break;case ka:l=oo,e=c;break;case pc:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}function SC(r,e,t){for(var n=r.tagName,i=null,f=r.length;f--;){var s=r[f],o=s.qName,a=s.value,d=o.indexOf(":");if(d>0)var u=s.prefix=o.slice(0,d),c=o.slice(d+1),l=u==="xmlns"&&c;else c=o,u=null,l=o==="xmlns"&&"";s.localName=c,l!==!1&&(i==null&&(i={},PC(t,t={})),t[l]=i[l]=a,s.uri=_a.XMLNS,e.startPrefixMapping(l,a))}for(var f=r.length;f--;){s=r[f];var u=s.prefix;u&&(u==="xml"&&(s.uri=_a.XML),u!=="xmlns"&&(s.uri=t[u||""]))}var d=n.indexOf(":");d>0?(u=r.prefix=n.slice(0,d),c=r.localName=n.slice(d+1)):(u=null,c=r.localName=n);var h=r.uri=t[u||""];if(e.startElement(h,c,n,r),r.closed){if(e.endElement(h,c,n),i)for(u in i)Object.prototype.hasOwnProperty.call(i,u)&&e.endPrefixMapping(u)}else return r.currentNSMap=t,r.localNSMap=i,!0}function eA(r,e,t,n,i){if(/^(?:script|textarea)$/i.test(t)){var s=r.indexOf("</"+t+">",e),o=r.substring(e+1,s);if(/[&<]/.test(o))return/^script$/i.test(t)?(i.characters(o,0,o.length),s):(o=o.replace(/&#?\w+;/g,n),i.characters(o,0,o.length),s)}return e+1}function tA(r,e,t,n){var i=n[t];return i==null&&(i=r.lastIndexOf("</"+t+">"),i<e&&(i=r.lastIndexOf("</"+t)),n[t]=i),i<e}function PC(r,e){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}function rA(r,e,t,n){var i=r.charAt(e+2);switch(i){case"-":if(r.charAt(e+3)==="-"){var s=r.indexOf("-->",e+4);return s>e?(t.comment(r,e+4,s-e-4),s+3):(n.error("Unclosed comment"),-1)}else return-1;default:if(r.substr(e+3,6)=="CDATA["){var s=r.indexOf("]]>",e+9);return t.startCDATA(),t.characters(r,e+9,s-e-9),t.endCDATA(),s+3}var o=iA(r,e),a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var u=o[1][0],c=!1,l=!1;a>3&&(/^public$/i.test(o[2][0])?(c=o[3][0],l=a>4&&o[4][0]):/^system$/i.test(o[2][0])&&(l=o[3][0]));var f=o[a-1];return t.startDTD(u,c,l),t.endDTD(),f.index+f[0].length}}return-1}function nA(r,e,t){var n=r.indexOf("?>",e);if(n){var i=r.substring(e,n).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){var s=i[0].length;return t.processingInstruction(i[1],i[2]),n+2}else return-1}return-1}function xC(){this.attributeNames={}}xC.prototype={setTagName:function(r){if(!DC.test(r))throw new Error("invalid tagName:"+r);this.tagName=r},addValue:function(r,e,t){if(!DC.test(r))throw new Error("invalid attribute:"+r);this.attributeNames[r]=this.length,this[this.length++]={qName:r,value:e,offset:t}},length:0,getLocalName:function(r){return this[r].localName},getLocator:function(r){return this[r].locator},getQName:function(r){return this[r].qName},getURI:function(r){return this[r].uri},getValue:function(r){return this[r].value}};function iA(r,e){var t,n=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=e,i.exec(r);t=i.exec(r);)if(n.push(t),t[1])return n}ih.XMLReader=EC;ih.ParseError=uo});var FC=L(gc=>{var sA=ba(),oA=rh(),RC=bC(),OC=kC(),aA=oA.DOMImplementation,_C=sA.NAMESPACE,uA=OC.ParseError,cA=OC.XMLReader;function AC(r){return r.replace(/\r[\n\u0085]/g,`
`).replace(/[\r\u0085\u2028]/g,`
`)}function NC(r){this.options=r||{locator:{}}}NC.prototype.parseFromString=function(r,e){var t=this.options,n=new cA,i=t.domBuilder||new Ia,s=t.errorHandler,o=t.locator,a=t.xmlns||{},u=/\/x?html?$/.test(e),c=u?RC.HTML_ENTITIES:RC.XML_ENTITIES;o&&i.setDocumentLocator(o),n.errorHandler=lA(s,i,o),n.domBuilder=t.domBuilder||i,u&&(a[""]=_C.HTML),a.xml=a.xml||_C.XML;var l=t.normalizeLineEndings||AC;return r&&typeof r=="string"?n.parse(l(r),a,c):n.errorHandler.error("invalid doc source"),i.doc};function lA(r,e,t){if(!r){if(e instanceof Ia)return e;r=e}var n={},i=r instanceof Function;t=t||{};function s(o){var a=r[o];!a&&i&&(a=r.length==2?function(u){r(o,u)}:r),n[o]=a&&function(u){a("[xmldom "+o+"]	"+u+sh(t))}||function(){}}return s("warning"),s("error"),s("fatalError"),n}function Ia(){this.cdata=!1}function co(r,e){e.lineNumber=r.lineNumber,e.columnNumber=r.columnNumber}Ia.prototype={startDocument:function(){this.doc=new aA().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(r,e,t,n){var i=this.doc,s=i.createElementNS(r,t||e),o=n.length;hc(this,s),this.currentElement=s,this.locator&&co(this.locator,s);for(var a=0;a<o;a++){var r=n.getURI(a),u=n.getValue(a),t=n.getQName(a),c=i.createAttributeNS(r,t);this.locator&&co(n.getLocator(a),c),c.value=c.nodeValue=u,s.setAttributeNode(c)}},endElement:function(r,e,t){var n=this.currentElement,i=n.tagName;this.currentElement=n.parentNode},startPrefixMapping:function(r,e){},endPrefixMapping:function(r){},processingInstruction:function(r,e){var t=this.doc.createProcessingInstruction(r,e);this.locator&&co(this.locator,t),hc(this,t)},ignorableWhitespace:function(r,e,t){},characters:function(r,e,t){if(r=IC.apply(this,arguments),r){if(this.cdata)var n=this.doc.createCDATASection(r);else var n=this.doc.createTextNode(r);this.currentElement?this.currentElement.appendChild(n):/^\s*$/.test(r)&&this.doc.appendChild(n),this.locator&&co(this.locator,n)}},skippedEntity:function(r){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(r){(this.locator=r)&&(r.lineNumber=0)},comment:function(r,e,t){r=IC.apply(this,arguments);var n=this.doc.createComment(r);this.locator&&co(this.locator,n),hc(this,n)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(r,e,t){var n=this.doc.implementation;if(n&&n.createDocumentType){var i=n.createDocumentType(r,e,t);this.locator&&co(this.locator,i),hc(this,i),this.doc.doctype=i}},warning:function(r){console.warn("[xmldom warning]	"+r,sh(this.locator))},error:function(r){console.error("[xmldom error]	"+r,sh(this.locator))},fatalError:function(r){throw new uA(r,this.locator)}};function sh(r){if(r)return`
@`+(r.systemId||"")+"#[line:"+r.lineNumber+",col:"+r.columnNumber+"]"}function IC(r,e,t){return typeof r=="string"?r.substr(e,t):r.length>=e+t||e?new java.lang.String(r,e,t)+"":r}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(r){Ia.prototype[r]=function(){return null}});function hc(r,e){r.currentElement?r.currentElement.appendChild(e):r.doc.appendChild(e)}gc.__DOMHandler=Ia;gc.normalizeLineEndings=AC;gc.DOMParser=NC});var MC=L(mc=>{var LC=rh();mc.DOMImplementation=LC.DOMImplementation;mc.XMLSerializer=LC.XMLSerializer;mc.DOMParser=FC().DOMParser});var UC=L(jC=>{var{DOMParser:dA}=MC();jC.parse=pA;var vc=3,qC=4,fA=8;function oh(r){return r.nodeType===vc||r.nodeType===fA||r.nodeType===qC}function li(r){return!r.childNodes||r.childNodes.length===0}function Cs(r,e){if(!r)throw new Error(e)}function pA(r){var e=new dA().parseFromString(r);Cs(e.documentElement.nodeName==="plist","malformed document. First element should be <plist>");var t=lo(e.documentElement);return t.length==1&&(t=t[0]),t}function lo(r){var e,t,n,i,s,o,a,u;if(!r)return null;if(r.nodeName==="plist"){if(s=[],li(r))return s;for(e=0;e<r.childNodes.length;e++)oh(r.childNodes[e])||s.push(lo(r.childNodes[e]));return s}else if(r.nodeName==="dict"){if(t={},n=null,a=0,li(r))return t;for(e=0;e<r.childNodes.length;e++)oh(r.childNodes[e])||(a%2===0?(Cs(r.childNodes[e].nodeName==="key","Missing key while parsing <dict/>."),n=lo(r.childNodes[e])):(Cs(r.childNodes[e].nodeName!=="key",'Unexpected key "'+lo(r.childNodes[e])+'" while parsing <dict/>.'),t[n]=lo(r.childNodes[e])),a+=1);return a%2===1&&(t[n]=""),t}else if(r.nodeName==="array"){if(s=[],li(r))return s;for(e=0;e<r.childNodes.length;e++)oh(r.childNodes[e])||(o=lo(r.childNodes[e]),o!=null&&s.push(o));return s}else if(r.nodeName!=="#text"){if(r.nodeName==="key")return li(r)?"":(Cs(r.childNodes[0].nodeValue!=="__proto__","__proto__ keys can lead to prototype pollution. More details on CVE-2022-22912"),r.childNodes[0].nodeValue);if(r.nodeName==="string"){if(o="",li(r))return o;for(e=0;e<r.childNodes.length;e++){var u=r.childNodes[e].nodeType;(u===vc||u===qC)&&(o+=r.childNodes[e].nodeValue)}return o}else{if(r.nodeName==="integer")return Cs(!li(r),'Cannot parse "" as integer.'),parseInt(r.childNodes[0].nodeValue,10);if(r.nodeName==="real"){for(Cs(!li(r),'Cannot parse "" as real.'),o="",e=0;e<r.childNodes.length;e++)r.childNodes[e].nodeType===vc&&(o+=r.childNodes[e].nodeValue);return parseFloat(o)}else if(r.nodeName==="data"){if(o="",li(r))return Buffer.from(o,"base64");for(e=0;e<r.childNodes.length;e++)r.childNodes[e].nodeType===vc&&(o+=r.childNodes[e].nodeValue.replace(/\s+/g,""));return Buffer.from(o,"base64")}else{if(r.nodeName==="date")return Cs(!li(r),'Cannot parse "" as Date.'),new Date(r.childNodes[0].nodeValue);if(r.nodeName==="null")return null;if(r.nodeName==="true")return!0;if(r.nodeName==="false")return!1;throw new Error("Invalid PLIST tag "+r.nodeName)}}}}});var WC=L(wc=>{"use strict";wc.byteLength=gA;wc.toByteArray=vA;wc.fromByteArray=bA;var $n=[],fn=[],hA=typeof Uint8Array<"u"?Uint8Array:Array,ah="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Ds=0,$C=ah.length;Ds<$C;++Ds)$n[Ds]=ah[Ds],fn[ah.charCodeAt(Ds)]=Ds;var Ds,$C;fn[45]=62;fn[95]=63;function BC(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function gA(r){var e=BC(r),t=e[0],n=e[1];return(t+n)*3/4-n}function mA(r,e,t){return(e+t)*3/4-t}function vA(r){var e,t=BC(r),n=t[0],i=t[1],s=new hA(mA(r,n,i)),o=0,a=i>0?n-4:n,u;for(u=0;u<a;u+=4)e=fn[r.charCodeAt(u)]<<18|fn[r.charCodeAt(u+1)]<<12|fn[r.charCodeAt(u+2)]<<6|fn[r.charCodeAt(u+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=fn[r.charCodeAt(u)]<<2|fn[r.charCodeAt(u+1)]>>4,s[o++]=e&255),i===1&&(e=fn[r.charCodeAt(u)]<<10|fn[r.charCodeAt(u+1)]<<4|fn[r.charCodeAt(u+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function wA(r){return $n[r>>18&63]+$n[r>>12&63]+$n[r>>6&63]+$n[r&63]}function yA(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push(wA(n));return i.join("")}function bA(r){for(var e,t=r.length,n=t%3,i=[],s=16383,o=0,a=t-n;o<a;o+=s)i.push(yA(r,o,o+s>a?a:o+s));return n===1?(e=r[t-1],i.push($n[e>>2]+$n[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push($n[e>>10]+$n[e>>4&63]+$n[e<<2&63]+"=")),i.join("")}});var Bn=L((VC,Fi)=>{(function(){var r,e,t,n,i,s,o,a={}.hasOwnProperty;r=function(u,...c){var l,f,d,h;if(i(Object.assign))Object.assign.apply(null,arguments);else for(l=0,d=c.length;l<d;l++)if(h=c[l],h!=null)for(f in h)a.call(h,f)&&(u[f]=h[f]);return u},i=function(u){return!!u&&Object.prototype.toString.call(u)==="[object Function]"},s=function(u){var c;return!!u&&((c=typeof u)=="function"||c==="object")},t=function(u){return i(Array.isArray)?Array.isArray(u):Object.prototype.toString.call(u)==="[object Array]"},n=function(u){var c;if(t(u))return!u.length;for(c in u)if(a.call(u,c))return!1;return!0},o=function(u){var c,l;return s(u)&&(l=Object.getPrototypeOf(u))&&(c=l.constructor)&&typeof c=="function"&&c instanceof c&&Function.prototype.toString.call(c)===Function.prototype.toString.call(Object)},e=function(u){return i(u.valueOf)?u.valueOf():u},Fi.exports.assign=r,Fi.exports.isFunction=i,Fi.exports.isObject=s,Fi.exports.isArray=t,Fi.exports.isEmpty=n,Fi.exports.isPlainObject=o,Fi.exports.getValue=e}).call(VC)});var uh=L((HC,KC)=>{(function(){var r;KC.exports=r=class{hasFeature(t,n){return!0}createDocumentType(t,n,i){throw new Error("This DOM method is not implemented.")}createDocument(t,n,i){throw new Error("This DOM method is not implemented.")}createHTMLDocument(t){throw new Error("This DOM method is not implemented.")}getFeature(t,n){throw new Error("This DOM method is not implemented.")}}}).call(HC)});var GC=L((XC,zC)=>{(function(){var r;zC.exports=r=class{constructor(){}handleError(t){throw new Error(t)}}}).call(XC)});var JC=L((QC,YC)=>{(function(){var r;YC.exports=r=function(){class e{constructor(n){this.arr=n||[]}item(n){return this.arr[n]||null}contains(n){return this.arr.indexOf(n)!==-1}}return Object.defineProperty(e.prototype,"length",{get:function(){return this.arr.length}}),e}.call(this)}).call(QC)});var tD=L((ZC,eD)=>{(function(){var r,e,t;e=GC(),t=JC(),eD.exports=r=function(){class n{constructor(){var s;this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=s=Object.create(this.defaultParams)}getParameter(s){return this.params.hasOwnProperty(s)?this.params[s]:null}canSetParameter(s,o){return!0}setParameter(s,o){return o!=null?this.params[s]=o:delete this.params[s]}}return Object.defineProperty(n.prototype,"parameterNames",{get:function(){return new t(Object.keys(this.defaultParams))}}),n}.call(this)}).call(ZC)});var qt=L((rD,nD)=>{(function(){nD.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(rD)});var ch=L((iD,sD)=>{(function(){var r,e,t;r=qt(),t=Yr(),sD.exports=e=function(){class n{constructor(s,o,a){if(this.parent=s,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),o==null)throw new Error("Missing attribute name. "+this.debugInfo(o));this.name=this.stringify.name(o),this.value=this.stringify.attValue(a),this.type=r.Attribute,this.isId=!1,this.schemaTypeInfo=null}clone(){return Object.create(this)}toString(s){return this.options.writer.attribute(this,this.options.writer.filterOptions(s))}debugInfo(s){return s=s||this.name,s==null?"parent: <"+this.parent.name+">":"attribute: {"+s+"}, parent: <"+this.parent.name+">"}isEqualNode(s){return!(s.namespaceURI!==this.namespaceURI||s.prefix!==this.prefix||s.localName!==this.localName||s.value!==this.value)}}return Object.defineProperty(n.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(n.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(n.prototype,"textContent",{get:function(){return this.value},set:function(i){return this.value=i||""}}),Object.defineProperty(n.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(n.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(n.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(n.prototype,"specified",{get:function(){return!0}}),n}.call(this)}).call(iD)});var yc=L((oD,aD)=>{(function(){var r;aD.exports=r=function(){class e{constructor(n){this.nodes=n}clone(){return this.nodes=null}getNamedItem(n){return this.nodes[n]}setNamedItem(n){var i;return i=this.nodes[n.nodeName],this.nodes[n.nodeName]=n,i||null}removeNamedItem(n){var i;return i=this.nodes[n],delete this.nodes[n],i||null}item(n){return this.nodes[Object.keys(this.nodes)[n]]||null}getNamedItemNS(n,i){throw new Error("This DOM method is not implemented.")}setNamedItemNS(n){throw new Error("This DOM method is not implemented.")}removeNamedItemNS(n,i){throw new Error("This DOM method is not implemented.")}}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),e}.call(this)}).call(oD)});var bc=L((uD,cD)=>{(function(){var r,e,t,n,i,s,o,a,u={}.hasOwnProperty;({isObject:a,isFunction:o,getValue:s}=Bn()),i=Yr(),r=qt(),e=ch(),n=yc(),cD.exports=t=function(){class c extends i{constructor(f,d,h){var m,D,_,R;if(super(f),d==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(d),this.type=r.Element,this.attribs={},this.schemaTypeInfo=null,h!=null&&this.attribute(h),f.type===r.Document&&(this.isRoot=!0,this.documentObject=f,f.rootObject=this,f.children)){for(R=f.children,D=0,_=R.length;D<_;D++)if(m=R[D],m.type===r.DocType){m.name=this.name;break}}}clone(){var f,d,h,m;h=Object.create(this),h.isRoot&&(h.documentObject=null),h.attribs={},m=this.attribs;for(d in m)u.call(m,d)&&(f=m[d],h.attribs[d]=f.clone());return h.children=[],this.children.forEach(function(D){var _;return _=D.clone(),_.parent=h,h.children.push(_)}),h}attribute(f,d){var h,m;if(f!=null&&(f=s(f)),a(f))for(h in f)u.call(f,h)&&(m=f[h],this.attribute(h,m));else o(d)&&(d=d.apply()),this.options.keepNullAttributes&&d==null?this.attribs[f]=new e(this,f,""):d!=null&&(this.attribs[f]=new e(this,f,d));return this}removeAttribute(f){var d,h,m;if(f==null)throw new Error("Missing attribute name. "+this.debugInfo());if(f=s(f),Array.isArray(f))for(h=0,m=f.length;h<m;h++)d=f[h],delete this.attribs[d];else delete this.attribs[f];return this}toString(f){return this.options.writer.element(this,this.options.writer.filterOptions(f))}att(f,d){return this.attribute(f,d)}a(f,d){return this.attribute(f,d)}getAttribute(f){return this.attribs.hasOwnProperty(f)?this.attribs[f].value:null}setAttribute(f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNode(f){return this.attribs.hasOwnProperty(f)?this.attribs[f]:null}setAttributeNode(f){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNode(f){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(f){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNS(f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNS(f,d,h){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeAttributeNS(f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}getAttributeNodeNS(f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}setAttributeNodeNS(f){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasAttribute(f){return this.attribs.hasOwnProperty(f)}hasAttributeNS(f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttribute(f,d){return this.attribs.hasOwnProperty(f)?this.attribs[f].isId:d}setIdAttributeNS(f,d,h){throw new Error("This DOM method is not implemented."+this.debugInfo())}setIdAttributeNode(f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(f){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(f){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(f){var d,h,m;if(!super.isEqualNode(f)||f.namespaceURI!==this.namespaceURI||f.prefix!==this.prefix||f.localName!==this.localName||f.attribs.length!==this.attribs.length)return!1;for(d=h=0,m=this.attribs.length-1;0<=m?h<=m:h>=m;d=0<=m?++h:--h)if(!this.attribs[d].isEqualNode(f.attribs[d]))return!1;return!0}}return Object.defineProperty(c.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(c.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(c.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(c.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(c.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(c.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(c.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(c.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new n(this.attribs)),this.attributeMap}}),c}.call(this)}).call(uD)});var Oa=L((lD,dD)=>{(function(){var r,e;e=Yr(),dD.exports=r=function(){class t extends e{constructor(i){super(i),this.value=""}clone(){return Object.create(this)}substringData(i,s){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendData(i){throw new Error("This DOM method is not implemented."+this.debugInfo())}insertData(i,s){throw new Error("This DOM method is not implemented."+this.debugInfo())}deleteData(i,s){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceData(i,s,o){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(i){return!(!super.isEqualNode(i)||i.data!==this.data)}}return Object.defineProperty(t.prototype,"data",{get:function(){return this.value},set:function(n){return this.value=n||""}}),Object.defineProperty(t.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(t.prototype,"textContent",{get:function(){return this.value},set:function(n){return this.value=n||""}}),t}.call(this)}).call(lD)});var Cc=L((fD,pD)=>{(function(){var r,e,t;r=qt(),t=Oa(),pD.exports=e=class extends t{constructor(i,s){if(super(i),s==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=r.CData,this.value=this.stringify.cdata(s)}clone(){return Object.create(this)}toString(i){return this.options.writer.cdata(this,this.options.writer.filterOptions(i))}}}).call(fD)});var Dc=L((hD,gD)=>{(function(){var r,e,t;r=qt(),e=Oa(),gD.exports=t=class extends e{constructor(i,s){if(super(i),s==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=r.Comment,this.value=this.stringify.comment(s)}clone(){return Object.create(this)}toString(i){return this.options.writer.comment(this,this.options.writer.filterOptions(i))}}}).call(hD)});var Tc=L((mD,vD)=>{(function(){var r,e,t,n;({isObject:n}=Bn()),t=Yr(),r=qt(),vD.exports=e=class extends t{constructor(s,o,a,u){super(s),n(o)&&({version:o,encoding:a,standalone:u}=o),o||(o="1.0"),this.type=r.Declaration,this.version=this.stringify.xmlVersion(o),a!=null&&(this.encoding=this.stringify.xmlEncoding(a)),u!=null&&(this.standalone=this.stringify.xmlStandalone(u))}toString(s){return this.options.writer.declaration(this,this.options.writer.filterOptions(s))}}}).call(mD)});var Sc=L((wD,yD)=>{(function(){var r,e,t;t=Yr(),r=qt(),yD.exports=e=class extends t{constructor(i,s,o,a,u,c){if(super(i),s==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(o==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(s));if(!a)throw new Error("Missing DTD attribute type. "+this.debugInfo(s));if(!u)throw new Error("Missing DTD attribute default. "+this.debugInfo(s));if(u.indexOf("#")!==0&&(u="#"+u),!u.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(s));if(c&&!u.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(s));this.elementName=this.stringify.name(s),this.type=r.AttributeDeclaration,this.attributeName=this.stringify.name(o),this.attributeType=this.stringify.dtdAttType(a),c&&(this.defaultValue=this.stringify.dtdAttDefault(c)),this.defaultValueType=u}toString(i){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(i))}}}).call(wD)});var Ec=L((bD,CD)=>{(function(){var r,e,t,n;({isObject:n}=Bn()),t=Yr(),r=qt(),CD.exports=e=function(){class i extends t{constructor(o,a,u,c){if(super(o),u==null)throw new Error("Missing DTD entity name. "+this.debugInfo(u));if(c==null)throw new Error("Missing DTD entity value. "+this.debugInfo(u));if(this.pe=!!a,this.name=this.stringify.name(u),this.type=r.EntityDeclaration,!n(c))this.value=this.stringify.dtdEntityValue(c),this.internal=!0;else{if(!c.pubID&&!c.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(u));if(c.pubID&&!c.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(u));if(this.internal=!1,c.pubID!=null&&(this.pubID=this.stringify.dtdPubID(c.pubID)),c.sysID!=null&&(this.sysID=this.stringify.dtdSysID(c.sysID)),c.nData!=null&&(this.nData=this.stringify.dtdNData(c.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(u))}}toString(o){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(o))}}return Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return null}}),i}.call(this)}).call(bD)});var Pc=L((DD,TD)=>{(function(){var r,e,t;t=Yr(),r=qt(),TD.exports=e=class extends t{constructor(i,s,o){if(super(i),s==null)throw new Error("Missing DTD element name. "+this.debugInfo());o||(o="(#PCDATA)"),Array.isArray(o)&&(o="("+o.join(",")+")"),this.name=this.stringify.name(s),this.type=r.ElementDeclaration,this.value=this.stringify.dtdElementValue(o)}toString(i){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(i))}}}).call(DD)});var xc=L((SD,ED)=>{(function(){var r,e,t;t=Yr(),r=qt(),ED.exports=e=function(){class n extends t{constructor(s,o,a){if(super(s),o==null)throw new Error("Missing DTD notation name. "+this.debugInfo(o));if(!a.pubID&&!a.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(o));this.name=this.stringify.name(o),this.type=r.NotationDeclaration,a.pubID!=null&&(this.pubID=this.stringify.dtdPubID(a.pubID)),a.sysID!=null&&(this.sysID=this.stringify.dtdSysID(a.sysID))}toString(s){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(s))}}return Object.defineProperty(n.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(n.prototype,"systemId",{get:function(){return this.sysID}}),n}.call(this)}).call(SD)});var kc=L((PD,xD)=>{(function(){var r,e,t,n,i,s,o,a,u;({isObject:u}=Bn()),a=Yr(),r=qt(),e=Sc(),n=Ec(),t=Pc(),i=xc(),o=yc(),xD.exports=s=function(){class c extends a{constructor(f,d,h){var m,D,_,R;if(super(f),this.type=r.DocType,f.children){for(R=f.children,D=0,_=R.length;D<_;D++)if(m=R[D],m.type===r.Element){this.name=m.name;break}}this.documentObject=f,u(d)&&({pubID:d,sysID:h}=d),h==null&&([h,d]=[d,h]),d!=null&&(this.pubID=this.stringify.dtdPubID(d)),h!=null&&(this.sysID=this.stringify.dtdSysID(h))}element(f,d){var h;return h=new t(this,f,d),this.children.push(h),this}attList(f,d,h,m,D){var _;return _=new e(this,f,d,h,m,D),this.children.push(_),this}entity(f,d){var h;return h=new n(this,!1,f,d),this.children.push(h),this}pEntity(f,d){var h;return h=new n(this,!0,f,d),this.children.push(h),this}notation(f,d){var h;return h=new i(this,f,d),this.children.push(h),this}toString(f){return this.options.writer.docType(this,this.options.writer.filterOptions(f))}ele(f,d){return this.element(f,d)}att(f,d,h,m,D){return this.attList(f,d,h,m,D)}ent(f,d){return this.entity(f,d)}pent(f,d){return this.pEntity(f,d)}not(f,d){return this.notation(f,d)}up(){return this.root()||this.documentObject}isEqualNode(f){return!(!super.isEqualNode(f)||f.name!==this.name||f.publicId!==this.publicId||f.systemId!==this.systemId)}}return Object.defineProperty(c.prototype,"entities",{get:function(){var l,f,d,h,m;for(h={},m=this.children,f=0,d=m.length;f<d;f++)l=m[f],l.type===r.EntityDeclaration&&!l.pe&&(h[l.name]=l);return new o(h)}}),Object.defineProperty(c.prototype,"notations",{get:function(){var l,f,d,h,m;for(h={},m=this.children,f=0,d=m.length;f<d;f++)l=m[f],l.type===r.NotationDeclaration&&(h[l.name]=l);return new o(h)}}),Object.defineProperty(c.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(c.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(c.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),c}.call(this)}).call(PD)});var Rc=L((kD,RD)=>{(function(){var r,e,t;r=qt(),e=Yr(),RD.exports=t=class extends e{constructor(i,s){if(super(i),s==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=r.Raw,this.value=this.stringify.raw(s)}clone(){return Object.create(this)}toString(i){return this.options.writer.raw(this,this.options.writer.filterOptions(i))}}}).call(kD)});var _c=L((_D,ID)=>{(function(){var r,e,t;r=qt(),e=Oa(),ID.exports=t=function(){class n extends e{constructor(s,o){if(super(s),o==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=r.Text,this.value=this.stringify.text(o)}clone(){return Object.create(this)}toString(s){return this.options.writer.text(this,this.options.writer.filterOptions(s))}splitText(s){throw new Error("This DOM method is not implemented."+this.debugInfo())}replaceWholeText(s){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(n.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(n.prototype,"wholeText",{get:function(){var i,s,o;for(o="",s=this.previousSibling;s;)o=s.data+o,s=s.previousSibling;for(o+=this.data,i=this.nextSibling;i;)o=o+i.data,i=i.nextSibling;return o}}),n}.call(this)}).call(_D)});var Ic=L((OD,AD)=>{(function(){var r,e,t;r=qt(),e=Oa(),AD.exports=t=class extends e{constructor(i,s,o){if(super(i),s==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=r.ProcessingInstruction,this.target=this.stringify.insTarget(s),this.name=this.target,o&&(this.value=this.stringify.insValue(o))}clone(){return Object.create(this)}toString(i){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(i))}isEqualNode(i){return!(!super.isEqualNode(i)||i.target!==this.target)}}}).call(OD)});var lh=L((ND,FD)=>{(function(){var r,e,t;t=Yr(),r=qt(),FD.exports=e=class extends t{constructor(i){super(i),this.type=r.Dummy}clone(){return Object.create(this)}toString(i){return""}}}).call(ND)});var qD=L((LD,MD)=>{(function(){var r;MD.exports=r=function(){class e{constructor(n){this.nodes=n}clone(){return this.nodes=null}item(n){return this.nodes[n]||null}}return Object.defineProperty(e.prototype,"length",{get:function(){return this.nodes.length||0}}),e}.call(this)}).call(LD)});var $D=L((jD,UD)=>{(function(){UD.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(jD)});var Yr=L((BD,WD)=>{(function(){var r,e,t,n,i,s,o,a,u,c,l,f,d,h,m,D,_,R,N={}.hasOwnProperty,w=[].splice;({isObject:R,isFunction:_,isEmpty:D,getValue:m}=Bn()),a=null,t=null,n=null,i=null,s=null,d=null,h=null,f=null,o=null,e=null,l=null,u=null,r=null,WD.exports=c=function(){class p{constructor(g){this.parent=g,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,a||(a=bc(),t=Cc(),n=Dc(),i=Tc(),s=kc(),d=Rc(),h=_c(),f=Ic(),o=lh(),e=qt(),l=qD(),u=yc(),r=$D())}setParent(g){var k,b,C,E,I;for(this.parent=g,g&&(this.options=g.options,this.stringify=g.stringify),E=this.children,I=[],b=0,C=E.length;b<C;b++)k=E[b],I.push(k.setParent(this));return I}element(g,k,b){var C,E,I,B,z,te,ue,Q,se;if(te=null,k===null&&b==null&&([k,b]=[{},null]),k==null&&(k={}),k=m(k),R(k)||([b,k]=[k,b]),g!=null&&(g=m(g)),Array.isArray(g))for(I=0,ue=g.length;I<ue;I++)E=g[I],te=this.element(E);else if(_(g))te=this.element(g.apply());else if(R(g)){for(z in g)if(N.call(g,z))if(se=g[z],_(se)&&(se=se.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&z.indexOf(this.stringify.convertAttKey)===0)te=this.attribute(z.substr(this.stringify.convertAttKey.length),se);else if(!this.options.separateArrayItems&&Array.isArray(se)&&D(se))te=this.dummy();else if(R(se)&&D(se))te=this.element(z);else if(!this.options.keepNullNodes&&se==null)te=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(se))for(B=0,Q=se.length;B<Q;B++)E=se[B],C={},C[z]=E,te=this.element(C);else R(se)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&z.indexOf(this.stringify.convertTextKey)===0?te=this.element(se):(te=this.element(z),te.element(se)):te=this.element(z,se)}else!this.options.keepNullNodes&&b===null?te=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&g.indexOf(this.stringify.convertTextKey)===0?te=this.text(b):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&g.indexOf(this.stringify.convertCDataKey)===0?te=this.cdata(b):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&g.indexOf(this.stringify.convertCommentKey)===0?te=this.comment(b):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&g.indexOf(this.stringify.convertRawKey)===0?te=this.raw(b):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&g.indexOf(this.stringify.convertPIKey)===0?te=this.instruction(g.substr(this.stringify.convertPIKey.length),b):te=this.node(g,k,b);if(te==null)throw new Error("Could not create any elements with: "+g+". "+this.debugInfo());return te}insertBefore(g,k,b){var C,E,I,B,z;if(g?.type)return I=g,B=k,I.setParent(this),B?(E=children.indexOf(B),z=children.splice(E),children.push(I),Array.prototype.push.apply(children,z)):children.push(I),I;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(g));return E=this.parent.children.indexOf(this),z=this.parent.children.splice(E),C=this.parent.element(g,k,b),Array.prototype.push.apply(this.parent.children,z),C}insertAfter(g,k,b){var C,E,I;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(g));return E=this.parent.children.indexOf(this),I=this.parent.children.splice(E+1),C=this.parent.element(g,k,b),Array.prototype.push.apply(this.parent.children,I),C}remove(){var g,k;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return g=this.parent.children.indexOf(this),w.apply(this.parent.children,[g,g-g+1].concat(k=[])),this.parent}node(g,k,b){var C;return g!=null&&(g=m(g)),k||(k={}),k=m(k),R(k)||([b,k]=[k,b]),C=new a(this,g,k),b!=null&&C.text(b),this.children.push(C),C}text(g){var k;return R(g)&&this.element(g),k=new h(this,g),this.children.push(k),this}cdata(g){var k;return k=new t(this,g),this.children.push(k),this}comment(g){var k;return k=new n(this,g),this.children.push(k),this}commentBefore(g){var k,b,C;return b=this.parent.children.indexOf(this),C=this.parent.children.splice(b),k=this.parent.comment(g),Array.prototype.push.apply(this.parent.children,C),this}commentAfter(g){var k,b,C;return b=this.parent.children.indexOf(this),C=this.parent.children.splice(b+1),k=this.parent.comment(g),Array.prototype.push.apply(this.parent.children,C),this}raw(g){var k;return k=new d(this,g),this.children.push(k),this}dummy(){var g;return g=new o(this),g}instruction(g,k){var b,C,E,I,B;if(g!=null&&(g=m(g)),k!=null&&(k=m(k)),Array.isArray(g))for(I=0,B=g.length;I<B;I++)b=g[I],this.instruction(b);else if(R(g))for(b in g)N.call(g,b)&&(C=g[b],this.instruction(b,C));else _(k)&&(k=k.apply()),E=new f(this,g,k),this.children.push(E);return this}instructionBefore(g,k){var b,C,E;return C=this.parent.children.indexOf(this),E=this.parent.children.splice(C),b=this.parent.instruction(g,k),Array.prototype.push.apply(this.parent.children,E),this}instructionAfter(g,k){var b,C,E;return C=this.parent.children.indexOf(this),E=this.parent.children.splice(C+1),b=this.parent.instruction(g,k),Array.prototype.push.apply(this.parent.children,E),this}declaration(g,k,b){var C,E;return C=this.document(),E=new i(C,g,k,b),C.children.length===0?C.children.unshift(E):C.children[0].type===e.Declaration?C.children[0]=E:C.children.unshift(E),C.root()||C}dtd(g,k){var b,C,E,I,B,z,te,ue,Q,se;for(C=this.document(),E=new s(C,g,k),Q=C.children,I=B=0,te=Q.length;B<te;I=++B)if(b=Q[I],b.type===e.DocType)return C.children[I]=E,E;for(se=C.children,I=z=0,ue=se.length;z<ue;I=++z)if(b=se[I],b.isRoot)return C.children.splice(I,0,E),E;return C.children.push(E),E}up(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent}root(){var g;for(g=this;g;){if(g.type===e.Document)return g.rootObject;if(g.isRoot)return g;g=g.parent}}document(){var g;for(g=this;g;){if(g.type===e.Document)return g;g=g.parent}}end(g){return this.document().end(g)}prev(){var g;if(g=this.parent.children.indexOf(this),g<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[g-1]}next(){var g;if(g=this.parent.children.indexOf(this),g===-1||g===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[g+1]}importDocument(g){var k,b,C,E,I;if(b=g.root().clone(),b.parent=this,b.isRoot=!1,this.children.push(b),this.type===e.Document&&(b.isRoot=!0,b.documentObject=this,this.rootObject=b,this.children)){for(I=this.children,C=0,E=I.length;C<E;C++)if(k=I[C],k.type===e.DocType){k.name=b.name;break}}return this}debugInfo(g){var k,b;return g=g||this.name,g==null&&!((k=this.parent)!=null&&k.name)?"":g==null?"parent: <"+this.parent.name+">":(b=this.parent)!=null&&b.name?"node: <"+g+">, parent: <"+this.parent.name+">":"node: <"+g+">"}ele(g,k,b){return this.element(g,k,b)}nod(g,k,b){return this.node(g,k,b)}txt(g){return this.text(g)}dat(g){return this.cdata(g)}com(g){return this.comment(g)}ins(g,k){return this.instruction(g,k)}doc(){return this.document()}dec(g,k,b){return this.declaration(g,k,b)}e(g,k,b){return this.element(g,k,b)}n(g,k,b){return this.node(g,k,b)}t(g){return this.text(g)}d(g){return this.cdata(g)}c(g){return this.comment(g)}r(g){return this.raw(g)}i(g,k){return this.instruction(g,k)}u(){return this.up()}importXMLBuilder(g){return this.importDocument(g)}attribute(g,k){throw new Error("attribute() applies to element nodes only.")}att(g,k){return this.attribute(g,k)}a(g,k){return this.attribute(g,k)}removeAttribute(g){throw new Error("attribute() applies to element nodes only.")}replaceChild(g,k){throw new Error("This DOM method is not implemented."+this.debugInfo())}removeChild(g){throw new Error("This DOM method is not implemented."+this.debugInfo())}appendChild(g){throw new Error("This DOM method is not implemented."+this.debugInfo())}hasChildNodes(){return this.children.length!==0}cloneNode(g){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalize(){throw new Error("This DOM method is not implemented."+this.debugInfo())}isSupported(g,k){return!0}hasAttributes(){return this.attribs.length!==0}compareDocumentPosition(g){var k,b;return k=this,k===g?0:this.document()!==g.document()?(b=r.Disconnected|r.ImplementationSpecific,Math.random()<.5?b|=r.Preceding:b|=r.Following,b):k.isAncestor(g)?r.Contains|r.Preceding:k.isDescendant(g)?r.Contains|r.Following:k.isPreceding(g)?r.Preceding:r.Following}isSameNode(g){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupPrefix(g){throw new Error("This DOM method is not implemented."+this.debugInfo())}isDefaultNamespace(g){throw new Error("This DOM method is not implemented."+this.debugInfo())}lookupNamespaceURI(g){throw new Error("This DOM method is not implemented."+this.debugInfo())}isEqualNode(g){var k,b,C;if(g.nodeType!==this.nodeType||g.children.length!==this.children.length)return!1;for(k=b=0,C=this.children.length-1;0<=C?b<=C:b>=C;k=0<=C?++b:--b)if(!this.children[k].isEqualNode(g.children[k]))return!1;return!0}getFeature(g,k){throw new Error("This DOM method is not implemented."+this.debugInfo())}setUserData(g,k,b){throw new Error("This DOM method is not implemented."+this.debugInfo())}getUserData(g){throw new Error("This DOM method is not implemented."+this.debugInfo())}contains(g){return g?g===this||this.isDescendant(g):!1}isDescendant(g){var k,b,C,E,I;for(I=this.children,C=0,E=I.length;C<E;C++)if(k=I[C],g===k||(b=k.isDescendant(g),b))return!0;return!1}isAncestor(g){return g.isDescendant(this)}isPreceding(g){var k,b;return k=this.treePosition(g),b=this.treePosition(this),k===-1||b===-1?!1:k<b}isFollowing(g){var k,b;return k=this.treePosition(g),b=this.treePosition(this),k===-1||b===-1?!1:k>b}treePosition(g){var k,b;return b=0,k=!1,this.foreachTreeNode(this.document(),function(C){if(b++,!k&&C===g)return k=!0}),k?b:-1}foreachTreeNode(g,k){var b,C,E,I,B;for(g||(g=this.document()),I=g.children,C=0,E=I.length;C<E;C++){if(b=I[C],B=k(b))return B;if(B=this.foreachTreeNode(b,k),B)return B}}}return Object.defineProperty(p.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(p.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(p.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(p.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(p.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new l(this.children)),this.childNodeList}}),Object.defineProperty(p.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(p.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(p.prototype,"previousSibling",{get:function(){var v;return v=this.parent.children.indexOf(this),this.parent.children[v-1]||null}}),Object.defineProperty(p.prototype,"nextSibling",{get:function(){var v;return v=this.parent.children.indexOf(this),this.parent.children[v+1]||null}}),Object.defineProperty(p.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(p.prototype,"textContent",{get:function(){var v,g,k,b,C;if(this.nodeType===e.Element||this.nodeType===e.DocumentFragment){for(C="",b=this.children,g=0,k=b.length;g<k;g++)v=b[g],v.textContent&&(C+=v.textContent);return C}else return null},set:function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),p}.call(this)}).call(BD)});var dh=L((VD,HD)=>{(function(){var r,e={}.hasOwnProperty;HD.exports=r=function(){class t{constructor(i){var s,o,a;this.assertLegalChar=this.assertLegalChar.bind(this),this.assertLegalName=this.assertLegalName.bind(this),i||(i={}),this.options=i,this.options.version||(this.options.version="1.0"),o=i.stringify||{};for(s in o)e.call(o,s)&&(a=o[s],this[s]=a)}name(i){return this.options.noValidation?i:this.assertLegalName(""+i||"")}text(i){return this.options.noValidation?i:this.assertLegalChar(this.textEscape(""+i||""))}cdata(i){return this.options.noValidation?i:(i=""+i||"",i=i.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(i))}comment(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+i);return this.assertLegalChar(i)}raw(i){return this.options.noValidation?i:""+i||""}attValue(i){return this.options.noValidation?i:this.assertLegalChar(this.attEscape(i=""+i||""))}insTarget(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")}insValue(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/\?>/))throw new Error("Invalid processing instruction value: "+i);return this.assertLegalChar(i)}xmlVersion(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+i);return i}xmlEncoding(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+i);return this.assertLegalChar(i)}xmlStandalone(i){return this.options.noValidation?i:i?"yes":"no"}dtdPubID(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")}dtdSysID(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")}dtdElementValue(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")}dtdAttType(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")}dtdAttDefault(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")}dtdEntityValue(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")}dtdNData(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")}assertLegalChar(i){var s,o;if(this.options.noValidation)return i;if(this.options.version==="1.0"){if(s=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g,this.options.invalidCharReplacement!==void 0)i=i.replace(s,this.options.invalidCharReplacement);else if(o=i.match(s))throw new Error(`Invalid character in string: ${i} at index ${o.index}`)}else if(this.options.version==="1.1"){if(s=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/g,this.options.invalidCharReplacement!==void 0)i=i.replace(s,this.options.invalidCharReplacement);else if(o=i.match(s))throw new Error(`Invalid character in string: ${i} at index ${o.index}`)}return i}assertLegalName(i){var s;if(this.options.noValidation)return i;if(i=this.assertLegalChar(i),s=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!i.match(s))throw new Error(`Invalid character in name: ${i}`);return i}textEscape(i){var s;return this.options.noValidation?i:(s=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))}attEscape(i){var s;return this.options.noValidation?i:(s=this.options.noDoubleEncoding?/(?!&(lt|gt|amp|apos|quot);)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))}}return t.prototype.convertAttKey="@",t.prototype.convertPIKey="?",t.prototype.convertTextKey="#text",t.prototype.convertCDataKey="#cdata",t.prototype.convertCommentKey="#comment",t.prototype.convertRawKey="#raw",t}.call(this)}).call(VD)});var Aa=L((KD,XD)=>{(function(){XD.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(KD)});var fh=L((zD,GD)=>{(function(){var r,e,t,n,i,s,o,a,u,c,l,f,d,h,m,D,_,R={}.hasOwnProperty;({assign:_}=Bn()),r=qt(),u=Tc(),c=kc(),t=Cc(),n=Dc(),f=bc(),h=Rc(),m=_c(),d=Ic(),l=lh(),i=Sc(),s=Pc(),o=Ec(),a=xc(),e=Aa(),GD.exports=D=class{constructor(w){var p,v,g;w||(w={}),this.options=w,v=w.writer||{};for(p in v)R.call(v,p)&&(g=v[p],this["_"+p]=this[p],this[p]=g)}filterOptions(w){var p,v,g,k,b,C,E,I,B;return w||(w={}),w=_({},this.options,w),p={writer:this},p.pretty=w.pretty||!1,p.allowEmpty=w.allowEmpty||!1,p.indent=(v=w.indent)!=null?v:"  ",p.newline=(g=w.newline)!=null?g:`
`,p.offset=(k=w.offset)!=null?k:0,p.width=(b=w.width)!=null?b:0,p.dontPrettyTextNodes=(C=(E=w.dontPrettyTextNodes)!=null?E:w.dontprettytextnodes)!=null?C:0,p.spaceBeforeSlash=(I=(B=w.spaceBeforeSlash)!=null?B:w.spacebeforeslash)!=null?I:"",p.spaceBeforeSlash===!0&&(p.spaceBeforeSlash=" "),p.suppressPrettyCount=0,p.user={},p.state=e.None,p}indent(w,p,v){var g;return!p.pretty||p.suppressPrettyCount?"":p.pretty&&(g=(v||0)+p.offset+1,g>0)?new Array(g).join(p.indent):""}endline(w,p,v){return!p.pretty||p.suppressPrettyCount?"":p.newline}attribute(w,p,v){var g;return this.openAttribute(w,p,v),p.pretty&&p.width>0?g=w.name+'="'+w.value+'"':g=" "+w.name+'="'+w.value+'"',this.closeAttribute(w,p,v),g}cdata(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<![CDATA[",p.state=e.InsideTag,g+=w.value,p.state=e.CloseTag,g+="]]>"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}comment(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!-- ",p.state=e.InsideTag,g+=w.value,p.state=e.CloseTag,g+=" -->"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}declaration(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<?xml",p.state=e.InsideTag,g+=' version="'+w.version+'"',w.encoding!=null&&(g+=' encoding="'+w.encoding+'"'),w.standalone!=null&&(g+=' standalone="'+w.standalone+'"'),p.state=e.CloseTag,g+=p.spaceBeforeSlash+"?>",g+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}docType(w,p,v){var g,k,b,C,E;if(v||(v=0),this.openNode(w,p,v),p.state=e.OpenTag,C=this.indent(w,p,v),C+="<!DOCTYPE "+w.root().name,w.pubID&&w.sysID?C+=' PUBLIC "'+w.pubID+'" "'+w.sysID+'"':w.sysID&&(C+=' SYSTEM "'+w.sysID+'"'),w.children.length>0){for(C+=" [",C+=this.endline(w,p,v),p.state=e.InsideTag,E=w.children,k=0,b=E.length;k<b;k++)g=E[k],C+=this.writeChildNode(g,p,v+1);p.state=e.CloseTag,C+="]"}return p.state=e.CloseTag,C+=p.spaceBeforeSlash+">",C+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),C}element(w,p,v){var g,k,b,C,E,I,B,z,te,ue,Q,se,fe,_e,Ke,gt,Tt,br,$t;if(v||(v=0),se=!1,this.openNode(w,p,v),p.state=e.OpenTag,fe=this.indent(w,p,v)+"<"+w.name,p.pretty&&p.width>0){z=fe.length,Ke=w.attribs;for(Q in Ke)R.call(Ke,Q)&&(g=Ke[Q],_e=this.attribute(g,p,v),k=_e.length,z+k>p.width?($t=this.indent(w,p,v+1)+_e,fe+=this.endline(w,p,v)+$t,z=$t.length):($t=" "+_e,fe+=$t,z+=$t.length))}else{gt=w.attribs;for(Q in gt)R.call(gt,Q)&&(g=gt[Q],fe+=this.attribute(g,p,v))}if(C=w.children.length,E=C===0?null:w.children[0],C===0||w.children.every(function(nr){return(nr.type===r.Text||nr.type===r.Raw||nr.type===r.CData)&&nr.value===""}))p.allowEmpty?(fe+=">",p.state=e.CloseTag,fe+="</"+w.name+">"+this.endline(w,p,v)):(p.state=e.CloseTag,fe+=p.spaceBeforeSlash+"/>"+this.endline(w,p,v));else if(p.pretty&&C===1&&(E.type===r.Text||E.type===r.Raw||E.type===r.CData)&&E.value!=null)fe+=">",p.state=e.InsideTag,p.suppressPrettyCount++,se=!0,fe+=this.writeChildNode(E,p,v+1),p.suppressPrettyCount--,se=!1,p.state=e.CloseTag,fe+="</"+w.name+">"+this.endline(w,p,v);else{if(p.dontPrettyTextNodes){for(Tt=w.children,I=0,te=Tt.length;I<te;I++)if(b=Tt[I],(b.type===r.Text||b.type===r.Raw||b.type===r.CData)&&b.value!=null){p.suppressPrettyCount++,se=!0;break}}for(fe+=">"+this.endline(w,p,v),p.state=e.InsideTag,br=w.children,B=0,ue=br.length;B<ue;B++)b=br[B],fe+=this.writeChildNode(b,p,v+1);p.state=e.CloseTag,fe+=this.indent(w,p,v)+"</"+w.name+">",se&&p.suppressPrettyCount--,fe+=this.endline(w,p,v),p.state=e.None}return this.closeNode(w,p,v),fe}writeChildNode(w,p,v){switch(w.type){case r.CData:return this.cdata(w,p,v);case r.Comment:return this.comment(w,p,v);case r.Element:return this.element(w,p,v);case r.Raw:return this.raw(w,p,v);case r.Text:return this.text(w,p,v);case r.ProcessingInstruction:return this.processingInstruction(w,p,v);case r.Dummy:return"";case r.Declaration:return this.declaration(w,p,v);case r.DocType:return this.docType(w,p,v);case r.AttributeDeclaration:return this.dtdAttList(w,p,v);case r.ElementDeclaration:return this.dtdElement(w,p,v);case r.EntityDeclaration:return this.dtdEntity(w,p,v);case r.NotationDeclaration:return this.dtdNotation(w,p,v);default:throw new Error("Unknown XML node type: "+w.constructor.name)}}processingInstruction(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<?",p.state=e.InsideTag,g+=w.target,w.value&&(g+=" "+w.value),p.state=e.CloseTag,g+=p.spaceBeforeSlash+"?>",g+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}raw(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v),p.state=e.InsideTag,g+=w.value,p.state=e.CloseTag,g+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}text(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v),p.state=e.InsideTag,g+=w.value,p.state=e.CloseTag,g+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}dtdAttList(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!ATTLIST",p.state=e.InsideTag,g+=" "+w.elementName+" "+w.attributeName+" "+w.attributeType,w.defaultValueType!=="#DEFAULT"&&(g+=" "+w.defaultValueType),w.defaultValue&&(g+=' "'+w.defaultValue+'"'),p.state=e.CloseTag,g+=p.spaceBeforeSlash+">"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}dtdElement(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!ELEMENT",p.state=e.InsideTag,g+=" "+w.name+" "+w.value,p.state=e.CloseTag,g+=p.spaceBeforeSlash+">"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}dtdEntity(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!ENTITY",p.state=e.InsideTag,w.pe&&(g+=" %"),g+=" "+w.name,w.value?g+=' "'+w.value+'"':(w.pubID&&w.sysID?g+=' PUBLIC "'+w.pubID+'" "'+w.sysID+'"':w.sysID&&(g+=' SYSTEM "'+w.sysID+'"'),w.nData&&(g+=" NDATA "+w.nData)),p.state=e.CloseTag,g+=p.spaceBeforeSlash+">"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}dtdNotation(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!NOTATION",p.state=e.InsideTag,g+=" "+w.name,w.pubID&&w.sysID?g+=' PUBLIC "'+w.pubID+'" "'+w.sysID+'"':w.pubID?g+=' PUBLIC "'+w.pubID+'"':w.sysID&&(g+=' SYSTEM "'+w.sysID+'"'),p.state=e.CloseTag,g+=p.spaceBeforeSlash+">"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g}openNode(w,p,v){}closeNode(w,p,v){}openAttribute(w,p,v){}closeAttribute(w,p,v){}}}).call(zD)});var Oc=L((QD,YD)=>{(function(){var r,e;e=fh(),YD.exports=r=class extends e{constructor(n){super(n)}document(n,i){var s,o,a,u,c;for(i=this.filterOptions(i),u="",c=n.children,o=0,a=c.length;o<a;o++)s=c[o],u+=this.writeChildNode(s,i,0);return i.pretty&&u.slice(-i.newline.length)===i.newline&&(u=u.slice(0,-i.newline.length)),u}}}).call(QD)});var ph=L((JD,ZD)=>{(function(){var r,e,t,n,i,s,o,a;({isPlainObject:a}=Bn()),t=uh(),e=tD(),i=Yr(),r=qt(),o=dh(),s=Oc(),ZD.exports=n=function(){class u extends i{constructor(l){super(null),this.name="#document",this.type=r.Document,this.documentURI=null,this.domConfig=new e,l||(l={}),l.writer||(l.writer=new s),this.options=l,this.stringify=new o(l)}end(l){var f;return f={},l?a(l)&&(f=l,l=this.options.writer):l=this.options.writer,l.document(this,l.filterOptions(f))}toString(l){return this.options.writer.document(this,this.options.writer.filterOptions(l))}createElement(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}createDocumentFragment(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTextNode(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}createComment(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}createCDATASection(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}createProcessingInstruction(l,f){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttribute(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEntityReference(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagName(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}importNode(l,f){throw new Error("This DOM method is not implemented."+this.debugInfo())}createElementNS(l,f){throw new Error("This DOM method is not implemented."+this.debugInfo())}createAttributeNS(l,f){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByTagNameNS(l,f){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementById(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}adoptNode(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}normalizeDocument(){throw new Error("This DOM method is not implemented."+this.debugInfo())}renameNode(l,f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}getElementsByClassName(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}createEvent(l){throw new Error("This DOM method is not implemented."+this.debugInfo())}createRange(){throw new Error("This DOM method is not implemented."+this.debugInfo())}createNodeIterator(l,f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}createTreeWalker(l,f,d){throw new Error("This DOM method is not implemented."+this.debugInfo())}}return Object.defineProperty(u.prototype,"implementation",{value:new t}),Object.defineProperty(u.prototype,"doctype",{get:function(){var c,l,f,d;for(d=this.children,l=0,f=d.length;l<f;l++)if(c=d[l],c.type===r.DocType)return c;return null}}),Object.defineProperty(u.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(u.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(u.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(u.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].encoding:null}}),Object.defineProperty(u.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(u.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(u.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(u.prototype,"origin",{get:function(){return null}}),Object.defineProperty(u.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(u.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(u.prototype,"contentType",{get:function(){return null}}),u}.call(this)}).call(JD)});var rT=L((eT,tT)=>{(function(){var r,e,t,n,i,s,o,a,u,c,l,f,d,h,m,D,_,R,N,w,p,v,g,k={}.hasOwnProperty;({isObject:v,isFunction:p,isPlainObject:g,getValue:w}=Bn()),r=qt(),f=ph(),h=bc(),n=Cc(),i=Dc(),D=Rc(),N=_c(),m=Ic(),c=Tc(),l=kc(),s=Sc(),a=Ec(),o=Pc(),u=xc(),t=ch(),R=dh(),_=Oc(),e=Aa(),tT.exports=d=class{constructor(C,E,I){var B;this.name="?xml",this.type=r.Document,C||(C={}),B={},C.writer?g(C.writer)&&(B=C.writer,C.writer=new _):C.writer=new _,this.options=C,this.writer=C.writer,this.writerOptions=this.writer.filterOptions(B),this.stringify=new R(C),this.onDataCallback=E||function(){},this.onEndCallback=I||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}createChildNode(C){var E,I,B,z,te,ue,Q,se;switch(C.type){case r.CData:this.cdata(C.value);break;case r.Comment:this.comment(C.value);break;case r.Element:B={},Q=C.attribs;for(I in Q)k.call(Q,I)&&(E=Q[I],B[I]=E.value);this.node(C.name,B);break;case r.Dummy:this.dummy();break;case r.Raw:this.raw(C.value);break;case r.Text:this.text(C.value);break;case r.ProcessingInstruction:this.instruction(C.target,C.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+C.constructor.name)}for(se=C.children,te=0,ue=se.length;te<ue;te++)z=se[te],this.createChildNode(z),z.type===r.Element&&this.up();return this}dummy(){return this}node(C,E,I){if(C==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(C));return this.openCurrent(),C=w(C),E==null&&(E={}),E=w(E),v(E)||([I,E]=[E,I]),this.currentNode=new h(this,C,E),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,I!=null&&this.text(I),this}element(C,E,I){var B,z,te,ue,Q,se;if(this.currentNode&&this.currentNode.type===r.DocType)this.dtdElement(...arguments);else if(Array.isArray(C)||v(C)||p(C))for(ue=this.options.noValidation,this.options.noValidation=!0,se=new f(this.options).element("TEMP_ROOT"),se.element(C),this.options.noValidation=ue,Q=se.children,z=0,te=Q.length;z<te;z++)B=Q[z],this.createChildNode(B),B.type===r.Element&&this.up();else this.node(C,E,I);return this}attribute(C,E){var I,B;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(C));if(C!=null&&(C=w(C)),v(C))for(I in C)k.call(C,I)&&(B=C[I],this.attribute(I,B));else p(E)&&(E=E.apply()),this.options.keepNullAttributes&&E==null?this.currentNode.attribs[C]=new t(this,C,""):E!=null&&(this.currentNode.attribs[C]=new t(this,C,E));return this}text(C){var E;return this.openCurrent(),E=new N(this,C),this.onData(this.writer.text(E,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}cdata(C){var E;return this.openCurrent(),E=new n(this,C),this.onData(this.writer.cdata(E,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}comment(C){var E;return this.openCurrent(),E=new i(this,C),this.onData(this.writer.comment(E,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}raw(C){var E;return this.openCurrent(),E=new D(this,C),this.onData(this.writer.raw(E,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}instruction(C,E){var I,B,z,te,ue;if(this.openCurrent(),C!=null&&(C=w(C)),E!=null&&(E=w(E)),Array.isArray(C))for(I=0,te=C.length;I<te;I++)B=C[I],this.instruction(B);else if(v(C))for(B in C)k.call(C,B)&&(z=C[B],this.instruction(B,z));else p(E)&&(E=E.apply()),ue=new m(this,C,E),this.onData(this.writer.processingInstruction(ue,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this}declaration(C,E,I){var B;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return B=new c(this,C,E,I),this.onData(this.writer.declaration(B,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}doctype(C,E,I){if(this.openCurrent(),C==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new l(this,E,I),this.currentNode.rootNodeName=C,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this}dtdElement(C,E){var I;return this.openCurrent(),I=new o(this,C,E),this.onData(this.writer.dtdElement(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}attList(C,E,I,B,z){var te;return this.openCurrent(),te=new s(this,C,E,I,B,z),this.onData(this.writer.dtdAttList(te,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}entity(C,E){var I;return this.openCurrent(),I=new a(this,!1,C,E),this.onData(this.writer.dtdEntity(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}pEntity(C,E){var I;return this.openCurrent(),I=new a(this,!0,C,E),this.onData(this.writer.dtdEntity(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}notation(C,E){var I;return this.openCurrent(),I=new u(this,C,E),this.onData(this.writer.dtdNotation(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this}up(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this}end(){for(;this.currentLevel>=0;)this.up();return this.onEnd()}openCurrent(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)}openNode(C){var E,I,B,z;if(!C.isOpen){if(!this.root&&this.currentLevel===0&&C.type===r.Element&&(this.root=C),I="",C.type===r.Element){this.writerOptions.state=e.OpenTag,I=this.writer.indent(C,this.writerOptions,this.currentLevel)+"<"+C.name,z=C.attribs;for(B in z)k.call(z,B)&&(E=z[B],I+=this.writer.attribute(E,this.writerOptions,this.currentLevel));I+=(C.children?">":"/>")+this.writer.endline(C,this.writerOptions,this.currentLevel),this.writerOptions.state=e.InsideTag}else this.writerOptions.state=e.OpenTag,I=this.writer.indent(C,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+C.rootNodeName,C.pubID&&C.sysID?I+=' PUBLIC "'+C.pubID+'" "'+C.sysID+'"':C.sysID&&(I+=' SYSTEM "'+C.sysID+'"'),C.children?(I+=" [",this.writerOptions.state=e.InsideTag):(this.writerOptions.state=e.CloseTag,I+=">"),I+=this.writer.endline(C,this.writerOptions,this.currentLevel);return this.onData(I,this.currentLevel),C.isOpen=!0}}closeNode(C){var E;if(!C.isClosed)return E="",this.writerOptions.state=e.CloseTag,C.type===r.Element?E=this.writer.indent(C,this.writerOptions,this.currentLevel)+"</"+C.name+">"+this.writer.endline(C,this.writerOptions,this.currentLevel):E=this.writer.indent(C,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(C,this.writerOptions,this.currentLevel),this.writerOptions.state=e.None,this.onData(E,this.currentLevel),C.isClosed=!0}onData(C,E){return this.documentStarted=!0,this.onDataCallback(C,E+1)}onEnd(){return this.documentCompleted=!0,this.onEndCallback()}debugInfo(C){return C==null?"":"node: <"+C+">"}ele(){return this.element(...arguments)}nod(C,E,I){return this.node(C,E,I)}txt(C){return this.text(C)}dat(C){return this.cdata(C)}com(C){return this.comment(C)}ins(C,E){return this.instruction(C,E)}dec(C,E,I){return this.declaration(C,E,I)}dtd(C,E,I){return this.doctype(C,E,I)}e(C,E,I){return this.element(C,E,I)}n(C,E,I){return this.node(C,E,I)}t(C){return this.text(C)}d(C){return this.cdata(C)}c(C){return this.comment(C)}r(C){return this.raw(C)}i(C,E){return this.instruction(C,E)}att(){return this.currentNode&&this.currentNode.type===r.DocType?this.attList(...arguments):this.attribute(...arguments)}a(){return this.currentNode&&this.currentNode.type===r.DocType?this.attList(...arguments):this.attribute(...arguments)}ent(C,E){return this.entity(C,E)}pent(C,E){return this.pEntity(C,E)}not(C,E){return this.notation(C,E)}}}).call(eT)});var sT=L((nT,iT)=>{(function(){var r,e,t,n,i={}.hasOwnProperty;r=qt(),n=fh(),e=Aa(),iT.exports=t=class extends n{constructor(o,a){super(a),this.stream=o}endline(o,a,u){return o.isLastRootNode&&a.state===e.CloseTag?"":super.endline(o,a,u)}document(o,a){var u,c,l,f,d,h,m,D,_;for(m=o.children,c=l=0,d=m.length;l<d;c=++l)u=m[c],u.isLastRootNode=c===o.children.length-1;for(a=this.filterOptions(a),D=o.children,_=[],f=0,h=D.length;f<h;f++)u=D[f],_.push(this.writeChildNode(u,a,0));return _}cdata(o,a,u){return this.stream.write(super.cdata(o,a,u))}comment(o,a,u){return this.stream.write(super.comment(o,a,u))}declaration(o,a,u){return this.stream.write(super.declaration(o,a,u))}docType(o,a,u){var c,l,f,d;if(u||(u=0),this.openNode(o,a,u),a.state=e.OpenTag,this.stream.write(this.indent(o,a,u)),this.stream.write("<!DOCTYPE "+o.root().name),o.pubID&&o.sysID?this.stream.write(' PUBLIC "'+o.pubID+'" "'+o.sysID+'"'):o.sysID&&this.stream.write(' SYSTEM "'+o.sysID+'"'),o.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(o,a,u)),a.state=e.InsideTag,d=o.children,l=0,f=d.length;l<f;l++)c=d[l],this.writeChildNode(c,a,u+1);a.state=e.CloseTag,this.stream.write("]")}return a.state=e.CloseTag,this.stream.write(a.spaceBeforeSlash+">"),this.stream.write(this.endline(o,a,u)),a.state=e.None,this.closeNode(o,a,u)}element(o,a,u){var c,l,f,d,h,m,D,_,R,N,w,p,v,g,k,b;if(u||(u=0),this.openNode(o,a,u),a.state=e.OpenTag,w=this.indent(o,a,u)+"<"+o.name,a.pretty&&a.width>0){D=w.length,v=o.attribs;for(R in v)i.call(v,R)&&(c=v[R],p=this.attribute(c,a,u),l=p.length,D+l>a.width?(b=this.indent(o,a,u+1)+p,w+=this.endline(o,a,u)+b,D=b.length):(b=" "+p,w+=b,D+=b.length))}else{g=o.attribs;for(R in g)i.call(g,R)&&(c=g[R],w+=this.attribute(c,a,u))}if(this.stream.write(w),d=o.children.length,h=d===0?null:o.children[0],d===0||o.children.every(function(C){return(C.type===r.Text||C.type===r.Raw||C.type===r.CData)&&C.value===""}))a.allowEmpty?(this.stream.write(">"),a.state=e.CloseTag,this.stream.write("</"+o.name+">")):(a.state=e.CloseTag,this.stream.write(a.spaceBeforeSlash+"/>"));else if(a.pretty&&d===1&&(h.type===r.Text||h.type===r.Raw||h.type===r.CData)&&h.value!=null)this.stream.write(">"),a.state=e.InsideTag,a.suppressPrettyCount++,N=!0,this.writeChildNode(h,a,u+1),a.suppressPrettyCount--,N=!1,a.state=e.CloseTag,this.stream.write("</"+o.name+">");else{for(this.stream.write(">"+this.endline(o,a,u)),a.state=e.InsideTag,k=o.children,m=0,_=k.length;m<_;m++)f=k[m],this.writeChildNode(f,a,u+1);a.state=e.CloseTag,this.stream.write(this.indent(o,a,u)+"</"+o.name+">")}return this.stream.write(this.endline(o,a,u)),a.state=e.None,this.closeNode(o,a,u)}processingInstruction(o,a,u){return this.stream.write(super.processingInstruction(o,a,u))}raw(o,a,u){return this.stream.write(super.raw(o,a,u))}text(o,a,u){return this.stream.write(super.text(o,a,u))}dtdAttList(o,a,u){return this.stream.write(super.dtdAttList(o,a,u))}dtdElement(o,a,u){return this.stream.write(super.dtdElement(o,a,u))}dtdEntity(o,a,u){return this.stream.write(super.dtdEntity(o,a,u))}dtdNotation(o,a,u){return this.stream.write(super.dtdNotation(o,a,u))}}}).call(nT)});var aT=L((oT,Li)=>{(function(){var r,e,t,n,i,s,o,a,u;({assign:a,isFunction:u}=Bn()),t=uh(),n=ph(),i=rT(),o=Oc(),s=sT(),r=qt(),e=Aa(),Li.exports.create=function(c,l,f,d){var h,m;if(c==null)throw new Error("Root element needs a name.");return d=a({},l,f,d),h=new n(d),m=h.element(c),d.headless||(h.declaration(d),(d.pubID!=null||d.sysID!=null)&&h.dtd(d)),m},Li.exports.begin=function(c,l,f){return u(c)&&([l,f]=[c,l],c={}),l?new i(c,l,f):new n(c)},Li.exports.stringWriter=function(c){return new o(c)},Li.exports.streamWriter=function(c,l){return new s(c,l)},Li.exports.implementation=new t,Li.exports.nodeType=r,Li.exports.writerState=e}).call(oT)});var dT=L(lT=>{var uT=WC(),CA=aT();lT.build=SA;function DA(r){function e(t){return t<10?"0"+t:t}return r.getUTCFullYear()+"-"+e(r.getUTCMonth()+1)+"-"+e(r.getUTCDate())+"T"+e(r.getUTCHours())+":"+e(r.getUTCMinutes())+":"+e(r.getUTCSeconds())+"Z"}var TA=Object.prototype.toString;function cT(r){var e=TA.call(r).match(/\[object (.*)\]/);return e&&e[1]}function SA(r,e){var t={version:"1.0",encoding:"UTF-8"},n={pubid:"-//Apple//DTD PLIST 1.0//EN",sysid:"http://www.apple.com/DTDs/PropertyList-1.0.dtd"},i=CA.create("plist");return i.dec(t.version,t.encoding,t.standalone),i.dtd(n.pubid,n.sysid),i.att("version","1.0"),hh(r,i),e||(e={}),e.pretty=e.pretty!==!1,i.end(e)}function hh(r,e){var t,n,i,s=cT(r);if(s!="Undefined")if(Array.isArray(r))for(e=e.ele("array"),n=0;n<r.length;n++)hh(r[n],e);else if(Buffer.isBuffer(r))e.ele("data").raw(r.toString("base64"));else if(s=="Object"){e=e.ele("dict");for(i in r)r.hasOwnProperty(i)&&(e.ele("key").txt(i),hh(r[i],e))}else s=="Number"?(t=r%1===0?"integer":"real",e.ele(t).txt(r.toString())):s=="BigInt"?e.ele("integer").txt(r):s=="Date"?e.ele("date").txt(DA(new Date(r))):s=="Boolean"?e.ele(r?"true":"false"):s=="String"?e.ele("string").txt(r):s=="ArrayBuffer"?e.ele("data").raw(uT.fromByteArray(r)):r&&r.buffer&&cT(r.buffer)=="ArrayBuffer"?e.ele("data").raw(uT.fromByteArray(new Uint8Array(r.buffer),e)):s==="Null"&&e.ele("null").txt("")}});var hT=L(gh=>{var fT=UC();Object.keys(fT).forEach(function(r){gh[r]=fT[r]});var pT=dT();Object.keys(pT).forEach(function(r){gh[r]=pT[r]})});var FT=L((IU,NT)=>{"use strict";NT.exports=({onlyFirst:r=!1}={})=>{let e=["[\\u001B\\u009B][[\\]()#;?]*(?:(?:(?:(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]+)*|[a-zA-Z\\d]+(?:;[-a-zA-Z\\d\\/#&.:=?%@~_]*)*)?\\u0007)","(?:(?:\\d{1,4}(?:;\\d{0,4})*)?[\\dA-PR-TZcf-ntqry=><~]))"].join("|");return new RegExp(e,r?void 0:"g")}});var Va=L((OU,LT)=>{"use strict";var BA=FT();LT.exports=r=>typeof r=="string"?r.replace(BA(),""):r});var el=L(Ih=>{(function(){Ih.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(Ih)});var Kn=L((BT,Bi)=>{(function(){var r,e,t,n,i,s,o,a=[].slice,u={}.hasOwnProperty;r=function(){var c,l,f,d,h,m;if(m=arguments[0],h=2<=arguments.length?a.call(arguments,1):[],i(Object.assign))Object.assign.apply(null,arguments);else for(c=0,f=h.length;c<f;c++)if(d=h[c],d!=null)for(l in d)u.call(d,l)&&(m[l]=d[l]);return m},i=function(c){return!!c&&Object.prototype.toString.call(c)==="[object Function]"},s=function(c){var l;return!!c&&((l=typeof c)=="function"||l==="object")},t=function(c){return i(Array.isArray)?Array.isArray(c):Object.prototype.toString.call(c)==="[object Array]"},n=function(c){var l;if(t(c))return!c.length;for(l in c)if(u.call(c,l))return!1;return!0},o=function(c){var l,f;return s(c)&&(f=Object.getPrototypeOf(c))&&(l=f.constructor)&&typeof l=="function"&&l instanceof l&&Function.prototype.toString.call(l)===Function.prototype.toString.call(Object)},e=function(c){return i(c.valueOf)?c.valueOf():c},Bi.exports.assign=r,Bi.exports.isFunction=i,Bi.exports.isObject=s,Bi.exports.isArray=t,Bi.exports.isEmpty=n,Bi.exports.isPlainObject=o,Bi.exports.getValue=e}).call(BT)});var Oh=L((WT,VT)=>{(function(){var r;VT.exports=r=function(){function e(){}return e.prototype.hasFeature=function(t,n){return!0},e.prototype.createDocumentType=function(t,n,i){throw new Error("This DOM method is not implemented.")},e.prototype.createDocument=function(t,n,i){throw new Error("This DOM method is not implemented.")},e.prototype.createHTMLDocument=function(t){throw new Error("This DOM method is not implemented.")},e.prototype.getFeature=function(t,n){throw new Error("This DOM method is not implemented.")},e}()}).call(WT)});var XT=L((HT,KT)=>{(function(){var r;KT.exports=r=function(){function e(){}return e.prototype.handleError=function(t){throw new Error(t)},e}()}).call(HT)});var QT=L((zT,GT)=>{(function(){var r;GT.exports=r=function(){function e(t){this.arr=t||[]}return Object.defineProperty(e.prototype,"length",{get:function(){return this.arr.length}}),e.prototype.item=function(t){return this.arr[t]||null},e.prototype.contains=function(t){return this.arr.indexOf(t)!==-1},e}()}).call(zT)});var ZT=L((YT,JT)=>{(function(){var r,e,t;e=XT(),t=QT(),JT.exports=r=function(){function n(){var i;this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new e,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=i=Object.create(this.defaultParams)}return Object.defineProperty(n.prototype,"parameterNames",{get:function(){return new t(Object.keys(this.defaultParams))}}),n.prototype.getParameter=function(i){return this.params.hasOwnProperty(i)?this.params[i]:null},n.prototype.canSetParameter=function(i,s){return!0},n.prototype.setParameter=function(i,s){return s!=null?this.params[i]=s:delete this.params[i]},n}()}).call(YT)});var jt=L((eS,tS)=>{(function(){tS.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(eS)});var Ah=L((rS,nS)=>{(function(){var r,e,t;r=jt(),t=Jr(),nS.exports=e=function(){function n(i,s,o){if(this.parent=i,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),s==null)throw new Error("Missing attribute name. "+this.debugInfo(s));this.name=this.stringify.name(s),this.value=this.stringify.attValue(o),this.type=r.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(n.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(n.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(n.prototype,"textContent",{get:function(){return this.value},set:function(i){return this.value=i||""}}),Object.defineProperty(n.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(n.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(n.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(n.prototype,"specified",{get:function(){return!0}}),n.prototype.clone=function(){return Object.create(this)},n.prototype.toString=function(i){return this.options.writer.attribute(this,this.options.writer.filterOptions(i))},n.prototype.debugInfo=function(i){return i=i||this.name,i==null?"parent: <"+this.parent.name+">":"attribute: {"+i+"}, parent: <"+this.parent.name+">"},n.prototype.isEqualNode=function(i){return!(i.namespaceURI!==this.namespaceURI||i.prefix!==this.prefix||i.localName!==this.localName||i.value!==this.value)},n}()}).call(rS)});var tl=L((iS,sS)=>{(function(){var r;sS.exports=r=function(){function e(t){this.nodes=t}return Object.defineProperty(e.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.getNamedItem=function(t){return this.nodes[t]},e.prototype.setNamedItem=function(t){var n;return n=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,n||null},e.prototype.removeNamedItem=function(t){var n;return n=this.nodes[t],delete this.nodes[t],n||null},e.prototype.item=function(t){return this.nodes[Object.keys(this.nodes)[t]]||null},e.prototype.getNamedItemNS=function(t,n){throw new Error("This DOM method is not implemented.")},e.prototype.setNamedItemNS=function(t){throw new Error("This DOM method is not implemented.")},e.prototype.removeNamedItemNS=function(t,n){throw new Error("This DOM method is not implemented.")},e}()}).call(iS)});var rl=L((oS,aS)=>{(function(){var r,e,t,n,i,s,o,a,u,c=function(f,d){for(var h in d)l.call(d,h)&&(f[h]=d[h]);function m(){this.constructor=f}return m.prototype=d.prototype,f.prototype=new m,f.__super__=d.prototype,f},l={}.hasOwnProperty;u=Kn(),a=u.isObject,o=u.isFunction,s=u.getValue,i=Jr(),r=jt(),e=Ah(),n=tl(),aS.exports=t=function(f){c(d,f);function d(h,m,D){var _,R,N,w;if(d.__super__.constructor.call(this,h),m==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(m),this.type=r.Element,this.attribs={},this.schemaTypeInfo=null,D!=null&&this.attribute(D),h.type===r.Document&&(this.isRoot=!0,this.documentObject=h,h.rootObject=this,h.children)){for(w=h.children,R=0,N=w.length;R<N;R++)if(_=w[R],_.type===r.DocType){_.name=this.name;break}}}return Object.defineProperty(d.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(d.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(d.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(d.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(d.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(d.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(d.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(d.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new n(this.attribs)),this.attributeMap}}),d.prototype.clone=function(){var h,m,D,_;D=Object.create(this),D.isRoot&&(D.documentObject=null),D.attribs={},_=this.attribs;for(m in _)l.call(_,m)&&(h=_[m],D.attribs[m]=h.clone());return D.children=[],this.children.forEach(function(R){var N;return N=R.clone(),N.parent=D,D.children.push(N)}),D},d.prototype.attribute=function(h,m){var D,_;if(h!=null&&(h=s(h)),a(h))for(D in h)l.call(h,D)&&(_=h[D],this.attribute(D,_));else o(m)&&(m=m.apply()),this.options.keepNullAttributes&&m==null?this.attribs[h]=new e(this,h,""):m!=null&&(this.attribs[h]=new e(this,h,m));return this},d.prototype.removeAttribute=function(h){var m,D,_;if(h==null)throw new Error("Missing attribute name. "+this.debugInfo());if(h=s(h),Array.isArray(h))for(D=0,_=h.length;D<_;D++)m=h[D],delete this.attribs[m];else delete this.attribs[h];return this},d.prototype.toString=function(h){return this.options.writer.element(this,this.options.writer.filterOptions(h))},d.prototype.att=function(h,m){return this.attribute(h,m)},d.prototype.a=function(h,m){return this.attribute(h,m)},d.prototype.getAttribute=function(h){return this.attribs.hasOwnProperty(h)?this.attribs[h].value:null},d.prototype.setAttribute=function(h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.getAttributeNode=function(h){return this.attribs.hasOwnProperty(h)?this.attribs[h]:null},d.prototype.setAttributeNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.removeAttributeNode=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.getElementsByTagName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.getAttributeNS=function(h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.setAttributeNS=function(h,m,D){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.removeAttributeNS=function(h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.getAttributeNodeNS=function(h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.setAttributeNodeNS=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.getElementsByTagNameNS=function(h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.hasAttribute=function(h){return this.attribs.hasOwnProperty(h)},d.prototype.hasAttributeNS=function(h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.setIdAttribute=function(h,m){return this.attribs.hasOwnProperty(h)?this.attribs[h].isId:m},d.prototype.setIdAttributeNS=function(h,m,D){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.setIdAttributeNode=function(h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.getElementsByTagName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.getElementsByTagNameNS=function(h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.getElementsByClassName=function(h){throw new Error("This DOM method is not implemented."+this.debugInfo())},d.prototype.isEqualNode=function(h){var m,D,_;if(!d.__super__.isEqualNode.apply(this,arguments).isEqualNode(h)||h.namespaceURI!==this.namespaceURI||h.prefix!==this.prefix||h.localName!==this.localName||h.attribs.length!==this.attribs.length)return!1;for(m=D=0,_=this.attribs.length-1;0<=_?D<=_:D>=_;m=0<=_?++D:--D)if(!this.attribs[m].isEqualNode(h.attribs[m]))return!1;return!0},d}(i)}).call(oS)});var Ga=L((uS,cS)=>{(function(){var r,e,t=function(i,s){for(var o in s)n.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},n={}.hasOwnProperty;e=Jr(),cS.exports=r=function(i){t(s,i);function s(o){s.__super__.constructor.call(this,o),this.value=""}return Object.defineProperty(s.prototype,"data",{get:function(){return this.value},set:function(o){return this.value=o||""}}),Object.defineProperty(s.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(s.prototype,"textContent",{get:function(){return this.value},set:function(o){return this.value=o||""}}),s.prototype.clone=function(){return Object.create(this)},s.prototype.substringData=function(o,a){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.appendData=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.insertData=function(o,a){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.deleteData=function(o,a){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.replaceData=function(o,a,u){throw new Error("This DOM method is not implemented."+this.debugInfo())},s.prototype.isEqualNode=function(o){return!(!s.__super__.isEqualNode.apply(this,arguments).isEqualNode(o)||o.data!==this.data)},s}(e)}).call(uS)});var nl=L((lS,dS)=>{(function(){var r,e,t,n=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function u(){this.constructor=s}return u.prototype=o.prototype,s.prototype=new u,s.__super__=o.prototype,s},i={}.hasOwnProperty;r=jt(),t=Ga(),dS.exports=e=function(s){n(o,s);function o(a,u){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=r.CData,this.value=this.stringify.cdata(u)}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(a){return this.options.writer.cdata(this,this.options.writer.filterOptions(a))},o}(t)}).call(lS)});var il=L((fS,pS)=>{(function(){var r,e,t,n=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function u(){this.constructor=s}return u.prototype=o.prototype,s.prototype=new u,s.__super__=o.prototype,s},i={}.hasOwnProperty;r=jt(),e=Ga(),pS.exports=t=function(s){n(o,s);function o(a,u){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=r.Comment,this.value=this.stringify.comment(u)}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(a){return this.options.writer.comment(this,this.options.writer.filterOptions(a))},o}(e)}).call(fS)});var sl=L((hS,gS)=>{(function(){var r,e,t,n,i=function(o,a){for(var u in a)s.call(a,u)&&(o[u]=a[u]);function c(){this.constructor=o}return c.prototype=a.prototype,o.prototype=new c,o.__super__=a.prototype,o},s={}.hasOwnProperty;n=Kn().isObject,t=Jr(),r=jt(),gS.exports=e=function(o){i(a,o);function a(u,c,l,f){var d;a.__super__.constructor.call(this,u),n(c)&&(d=c,c=d.version,l=d.encoding,f=d.standalone),c||(c="1.0"),this.type=r.Declaration,this.version=this.stringify.xmlVersion(c),l!=null&&(this.encoding=this.stringify.xmlEncoding(l)),f!=null&&(this.standalone=this.stringify.xmlStandalone(f))}return a.prototype.toString=function(u){return this.options.writer.declaration(this,this.options.writer.filterOptions(u))},a}(t)}).call(hS)});var ol=L((mS,vS)=>{(function(){var r,e,t,n=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function u(){this.constructor=s}return u.prototype=o.prototype,s.prototype=new u,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=Jr(),r=jt(),vS.exports=e=function(s){n(o,s);function o(a,u,c,l,f,d){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(c==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(u));if(!l)throw new Error("Missing DTD attribute type. "+this.debugInfo(u));if(!f)throw new Error("Missing DTD attribute default. "+this.debugInfo(u));if(f.indexOf("#")!==0&&(f="#"+f),!f.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(u));if(d&&!f.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(u));this.elementName=this.stringify.name(u),this.type=r.AttributeDeclaration,this.attributeName=this.stringify.name(c),this.attributeType=this.stringify.dtdAttType(l),d&&(this.defaultValue=this.stringify.dtdAttDefault(d)),this.defaultValueType=f}return o.prototype.toString=function(a){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(a))},o}(t)}).call(mS)});var al=L((wS,yS)=>{(function(){var r,e,t,n,i=function(o,a){for(var u in a)s.call(a,u)&&(o[u]=a[u]);function c(){this.constructor=o}return c.prototype=a.prototype,o.prototype=new c,o.__super__=a.prototype,o},s={}.hasOwnProperty;n=Kn().isObject,t=Jr(),r=jt(),yS.exports=e=function(o){i(a,o);function a(u,c,l,f){if(a.__super__.constructor.call(this,u),l==null)throw new Error("Missing DTD entity name. "+this.debugInfo(l));if(f==null)throw new Error("Missing DTD entity value. "+this.debugInfo(l));if(this.pe=!!c,this.name=this.stringify.name(l),this.type=r.EntityDeclaration,!n(f))this.value=this.stringify.dtdEntityValue(f),this.internal=!0;else{if(!f.pubID&&!f.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(l));if(f.pubID&&!f.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(l));if(this.internal=!1,f.pubID!=null&&(this.pubID=this.stringify.dtdPubID(f.pubID)),f.sysID!=null&&(this.sysID=this.stringify.dtdSysID(f.sysID)),f.nData!=null&&(this.nData=this.stringify.dtdNData(f.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(l))}}return Object.defineProperty(a.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(a.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(a.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(a.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(a.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(a.prototype,"xmlVersion",{get:function(){return null}}),a.prototype.toString=function(u){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(u))},a}(t)}).call(wS)});var ul=L((bS,CS)=>{(function(){var r,e,t,n=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function u(){this.constructor=s}return u.prototype=o.prototype,s.prototype=new u,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=Jr(),r=jt(),CS.exports=e=function(s){n(o,s);function o(a,u,c){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing DTD element name. "+this.debugInfo());c||(c="(#PCDATA)"),Array.isArray(c)&&(c="("+c.join(",")+")"),this.name=this.stringify.name(u),this.type=r.ElementDeclaration,this.value=this.stringify.dtdElementValue(c)}return o.prototype.toString=function(a){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(a))},o}(t)}).call(bS)});var cl=L((DS,TS)=>{(function(){var r,e,t,n=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function u(){this.constructor=s}return u.prototype=o.prototype,s.prototype=new u,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=Jr(),r=jt(),TS.exports=e=function(s){n(o,s);function o(a,u,c){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing DTD notation name. "+this.debugInfo(u));if(!c.pubID&&!c.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(u));this.name=this.stringify.name(u),this.type=r.NotationDeclaration,c.pubID!=null&&(this.pubID=this.stringify.dtdPubID(c.pubID)),c.sysID!=null&&(this.sysID=this.stringify.dtdSysID(c.sysID))}return Object.defineProperty(o.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(o.prototype,"systemId",{get:function(){return this.sysID}}),o.prototype.toString=function(a){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(a))},o}(t)}).call(DS)});var ll=L((SS,ES)=>{(function(){var r,e,t,n,i,s,o,a,u,c=function(f,d){for(var h in d)l.call(d,h)&&(f[h]=d[h]);function m(){this.constructor=f}return m.prototype=d.prototype,f.prototype=new m,f.__super__=d.prototype,f},l={}.hasOwnProperty;u=Kn().isObject,a=Jr(),r=jt(),e=ol(),n=al(),t=ul(),i=cl(),o=tl(),ES.exports=s=function(f){c(d,f);function d(h,m,D){var _,R,N,w,p,v;if(d.__super__.constructor.call(this,h),this.type=r.DocType,h.children){for(w=h.children,R=0,N=w.length;R<N;R++)if(_=w[R],_.type===r.Element){this.name=_.name;break}}this.documentObject=h,u(m)&&(p=m,m=p.pubID,D=p.sysID),D==null&&(v=[m,D],D=v[0],m=v[1]),m!=null&&(this.pubID=this.stringify.dtdPubID(m)),D!=null&&(this.sysID=this.stringify.dtdSysID(D))}return Object.defineProperty(d.prototype,"entities",{get:function(){var h,m,D,_,R;for(_={},R=this.children,m=0,D=R.length;m<D;m++)h=R[m],h.type===r.EntityDeclaration&&!h.pe&&(_[h.name]=h);return new o(_)}}),Object.defineProperty(d.prototype,"notations",{get:function(){var h,m,D,_,R;for(_={},R=this.children,m=0,D=R.length;m<D;m++)h=R[m],h.type===r.NotationDeclaration&&(_[h.name]=h);return new o(_)}}),Object.defineProperty(d.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(d.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(d.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),d.prototype.element=function(h,m){var D;return D=new t(this,h,m),this.children.push(D),this},d.prototype.attList=function(h,m,D,_,R){var N;return N=new e(this,h,m,D,_,R),this.children.push(N),this},d.prototype.entity=function(h,m){var D;return D=new n(this,!1,h,m),this.children.push(D),this},d.prototype.pEntity=function(h,m){var D;return D=new n(this,!0,h,m),this.children.push(D),this},d.prototype.notation=function(h,m){var D;return D=new i(this,h,m),this.children.push(D),this},d.prototype.toString=function(h){return this.options.writer.docType(this,this.options.writer.filterOptions(h))},d.prototype.ele=function(h,m){return this.element(h,m)},d.prototype.att=function(h,m,D,_,R){return this.attList(h,m,D,_,R)},d.prototype.ent=function(h,m){return this.entity(h,m)},d.prototype.pent=function(h,m){return this.pEntity(h,m)},d.prototype.not=function(h,m){return this.notation(h,m)},d.prototype.up=function(){return this.root()||this.documentObject},d.prototype.isEqualNode=function(h){return!(!d.__super__.isEqualNode.apply(this,arguments).isEqualNode(h)||h.name!==this.name||h.publicId!==this.publicId||h.systemId!==this.systemId)},d}(a)}).call(SS)});var dl=L((PS,xS)=>{(function(){var r,e,t,n=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function u(){this.constructor=s}return u.prototype=o.prototype,s.prototype=new u,s.__super__=o.prototype,s},i={}.hasOwnProperty;r=jt(),e=Jr(),xS.exports=t=function(s){n(o,s);function o(a,u){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=r.Raw,this.value=this.stringify.raw(u)}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(a){return this.options.writer.raw(this,this.options.writer.filterOptions(a))},o}(e)}).call(PS)});var fl=L((kS,RS)=>{(function(){var r,e,t,n=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function u(){this.constructor=s}return u.prototype=o.prototype,s.prototype=new u,s.__super__=o.prototype,s},i={}.hasOwnProperty;r=jt(),e=Ga(),RS.exports=t=function(s){n(o,s);function o(a,u){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=r.Text,this.value=this.stringify.text(u)}return Object.defineProperty(o.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(o.prototype,"wholeText",{get:function(){var a,u,c;for(c="",u=this.previousSibling;u;)c=u.data+c,u=u.previousSibling;for(c+=this.data,a=this.nextSibling;a;)c=c+a.data,a=a.nextSibling;return c}}),o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(a){return this.options.writer.text(this,this.options.writer.filterOptions(a))},o.prototype.splitText=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},o.prototype.replaceWholeText=function(a){throw new Error("This DOM method is not implemented."+this.debugInfo())},o}(e)}).call(kS)});var pl=L((_S,IS)=>{(function(){var r,e,t,n=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function u(){this.constructor=s}return u.prototype=o.prototype,s.prototype=new u,s.__super__=o.prototype,s},i={}.hasOwnProperty;r=jt(),e=Ga(),IS.exports=t=function(s){n(o,s);function o(a,u,c){if(o.__super__.constructor.call(this,a),u==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=r.ProcessingInstruction,this.target=this.stringify.insTarget(u),this.name=this.target,c&&(this.value=this.stringify.insValue(c))}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(a){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(a))},o.prototype.isEqualNode=function(a){return!(!o.__super__.isEqualNode.apply(this,arguments).isEqualNode(a)||a.target!==this.target)},o}(e)}).call(_S)});var Nh=L((OS,AS)=>{(function(){var r,e,t,n=function(s,o){for(var a in o)i.call(o,a)&&(s[a]=o[a]);function u(){this.constructor=s}return u.prototype=o.prototype,s.prototype=new u,s.__super__=o.prototype,s},i={}.hasOwnProperty;t=Jr(),r=jt(),AS.exports=e=function(s){n(o,s);function o(a){o.__super__.constructor.call(this,a),this.type=r.Dummy}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(a){return""},o}(t)}).call(OS)});var LS=L((NS,FS)=>{(function(){var r;FS.exports=r=function(){function e(t){this.nodes=t}return Object.defineProperty(e.prototype,"length",{get:function(){return this.nodes.length||0}}),e.prototype.clone=function(){return this.nodes=null},e.prototype.item=function(t){return this.nodes[t]||null},e}()}).call(NS)});var jS=L((MS,qS)=>{(function(){qS.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(MS)});var Jr=L((US,$S)=>{(function(){var r,e,t,n,i,s,o,a,u,c,l,f,d,h,m,D,_,R,N,w={}.hasOwnProperty;N=Kn(),R=N.isObject,_=N.isFunction,D=N.isEmpty,m=N.getValue,a=null,t=null,n=null,i=null,s=null,d=null,h=null,f=null,o=null,e=null,l=null,u=null,r=null,$S.exports=c=function(){function p(v){this.parent=v,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,a||(a=rl(),t=nl(),n=il(),i=sl(),s=ll(),d=dl(),h=fl(),f=pl(),o=Nh(),e=jt(),l=LS(),u=tl(),r=jS())}return Object.defineProperty(p.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(p.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(p.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(p.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(p.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new l(this.children)),this.childNodeList}}),Object.defineProperty(p.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(p.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(p.prototype,"previousSibling",{get:function(){var v;return v=this.parent.children.indexOf(this),this.parent.children[v-1]||null}}),Object.defineProperty(p.prototype,"nextSibling",{get:function(){var v;return v=this.parent.children.indexOf(this),this.parent.children[v+1]||null}}),Object.defineProperty(p.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(p.prototype,"textContent",{get:function(){var v,g,k,b,C;if(this.nodeType===e.Element||this.nodeType===e.DocumentFragment){for(C="",b=this.children,g=0,k=b.length;g<k;g++)v=b[g],v.textContent&&(C+=v.textContent);return C}else return null},set:function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),p.prototype.setParent=function(v){var g,k,b,C,E;for(this.parent=v,v&&(this.options=v.options,this.stringify=v.stringify),C=this.children,E=[],k=0,b=C.length;k<b;k++)g=C[k],E.push(g.setParent(this));return E},p.prototype.element=function(v,g,k){var b,C,E,I,B,z,te,ue,Q,se,fe;if(z=null,g===null&&k==null&&(Q=[{},null],g=Q[0],k=Q[1]),g==null&&(g={}),g=m(g),R(g)||(se=[g,k],k=se[0],g=se[1]),v!=null&&(v=m(v)),Array.isArray(v))for(E=0,te=v.length;E<te;E++)C=v[E],z=this.element(C);else if(_(v))z=this.element(v.apply());else if(R(v)){for(B in v)if(w.call(v,B))if(fe=v[B],_(fe)&&(fe=fe.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&B.indexOf(this.stringify.convertAttKey)===0)z=this.attribute(B.substr(this.stringify.convertAttKey.length),fe);else if(!this.options.separateArrayItems&&Array.isArray(fe)&&D(fe))z=this.dummy();else if(R(fe)&&D(fe))z=this.element(B);else if(!this.options.keepNullNodes&&fe==null)z=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(fe))for(I=0,ue=fe.length;I<ue;I++)C=fe[I],b={},b[B]=C,z=this.element(b);else R(fe)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&B.indexOf(this.stringify.convertTextKey)===0?z=this.element(fe):(z=this.element(B),z.element(fe)):z=this.element(B,fe)}else!this.options.keepNullNodes&&k===null?z=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&v.indexOf(this.stringify.convertTextKey)===0?z=this.text(k):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&v.indexOf(this.stringify.convertCDataKey)===0?z=this.cdata(k):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&v.indexOf(this.stringify.convertCommentKey)===0?z=this.comment(k):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&v.indexOf(this.stringify.convertRawKey)===0?z=this.raw(k):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&v.indexOf(this.stringify.convertPIKey)===0?z=this.instruction(v.substr(this.stringify.convertPIKey.length),k):z=this.node(v,g,k);if(z==null)throw new Error("Could not create any elements with: "+v+". "+this.debugInfo());return z},p.prototype.insertBefore=function(v,g,k){var b,C,E,I,B;if(v?.type)return E=v,I=g,E.setParent(this),I?(C=children.indexOf(I),B=children.splice(C),children.push(E),Array.prototype.push.apply(children,B)):children.push(E),E;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(v));return C=this.parent.children.indexOf(this),B=this.parent.children.splice(C),b=this.parent.element(v,g,k),Array.prototype.push.apply(this.parent.children,B),b},p.prototype.insertAfter=function(v,g,k){var b,C,E;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(v));return C=this.parent.children.indexOf(this),E=this.parent.children.splice(C+1),b=this.parent.element(v,g,k),Array.prototype.push.apply(this.parent.children,E),b},p.prototype.remove=function(){var v,g;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return v=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[v,v-v+1].concat(g=[])),this.parent},p.prototype.node=function(v,g,k){var b,C;return v!=null&&(v=m(v)),g||(g={}),g=m(g),R(g)||(C=[g,k],k=C[0],g=C[1]),b=new a(this,v,g),k!=null&&b.text(k),this.children.push(b),b},p.prototype.text=function(v){var g;return R(v)&&this.element(v),g=new h(this,v),this.children.push(g),this},p.prototype.cdata=function(v){var g;return g=new t(this,v),this.children.push(g),this},p.prototype.comment=function(v){var g;return g=new n(this,v),this.children.push(g),this},p.prototype.commentBefore=function(v){var g,k,b;return k=this.parent.children.indexOf(this),b=this.parent.children.splice(k),g=this.parent.comment(v),Array.prototype.push.apply(this.parent.children,b),this},p.prototype.commentAfter=function(v){var g,k,b;return k=this.parent.children.indexOf(this),b=this.parent.children.splice(k+1),g=this.parent.comment(v),Array.prototype.push.apply(this.parent.children,b),this},p.prototype.raw=function(v){var g;return g=new d(this,v),this.children.push(g),this},p.prototype.dummy=function(){var v;return v=new o(this),v},p.prototype.instruction=function(v,g){var k,b,C,E,I;if(v!=null&&(v=m(v)),g!=null&&(g=m(g)),Array.isArray(v))for(E=0,I=v.length;E<I;E++)k=v[E],this.instruction(k);else if(R(v))for(k in v)w.call(v,k)&&(b=v[k],this.instruction(k,b));else _(g)&&(g=g.apply()),C=new f(this,v,g),this.children.push(C);return this},p.prototype.instructionBefore=function(v,g){var k,b,C;return b=this.parent.children.indexOf(this),C=this.parent.children.splice(b),k=this.parent.instruction(v,g),Array.prototype.push.apply(this.parent.children,C),this},p.prototype.instructionAfter=function(v,g){var k,b,C;return b=this.parent.children.indexOf(this),C=this.parent.children.splice(b+1),k=this.parent.instruction(v,g),Array.prototype.push.apply(this.parent.children,C),this},p.prototype.declaration=function(v,g,k){var b,C;return b=this.document(),C=new i(b,v,g,k),b.children.length===0?b.children.unshift(C):b.children[0].type===e.Declaration?b.children[0]=C:b.children.unshift(C),b.root()||b},p.prototype.dtd=function(v,g){var k,b,C,E,I,B,z,te,ue,Q;for(b=this.document(),C=new s(b,v,g),ue=b.children,E=I=0,z=ue.length;I<z;E=++I)if(k=ue[E],k.type===e.DocType)return b.children[E]=C,C;for(Q=b.children,E=B=0,te=Q.length;B<te;E=++B)if(k=Q[E],k.isRoot)return b.children.splice(E,0,C),C;return b.children.push(C),C},p.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},p.prototype.root=function(){var v;for(v=this;v;){if(v.type===e.Document)return v.rootObject;if(v.isRoot)return v;v=v.parent}},p.prototype.document=function(){var v;for(v=this;v;){if(v.type===e.Document)return v;v=v.parent}},p.prototype.end=function(v){return this.document().end(v)},p.prototype.prev=function(){var v;if(v=this.parent.children.indexOf(this),v<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[v-1]},p.prototype.next=function(){var v;if(v=this.parent.children.indexOf(this),v===-1||v===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[v+1]},p.prototype.importDocument=function(v){var g;return g=v.root().clone(),g.parent=this,g.isRoot=!1,this.children.push(g),this},p.prototype.debugInfo=function(v){var g,k;return v=v||this.name,v==null&&!((g=this.parent)!=null&&g.name)?"":v==null?"parent: <"+this.parent.name+">":(k=this.parent)!=null&&k.name?"node: <"+v+">, parent: <"+this.parent.name+">":"node: <"+v+">"},p.prototype.ele=function(v,g,k){return this.element(v,g,k)},p.prototype.nod=function(v,g,k){return this.node(v,g,k)},p.prototype.txt=function(v){return this.text(v)},p.prototype.dat=function(v){return this.cdata(v)},p.prototype.com=function(v){return this.comment(v)},p.prototype.ins=function(v,g){return this.instruction(v,g)},p.prototype.doc=function(){return this.document()},p.prototype.dec=function(v,g,k){return this.declaration(v,g,k)},p.prototype.e=function(v,g,k){return this.element(v,g,k)},p.prototype.n=function(v,g,k){return this.node(v,g,k)},p.prototype.t=function(v){return this.text(v)},p.prototype.d=function(v){return this.cdata(v)},p.prototype.c=function(v){return this.comment(v)},p.prototype.r=function(v){return this.raw(v)},p.prototype.i=function(v,g){return this.instruction(v,g)},p.prototype.u=function(){return this.up()},p.prototype.importXMLBuilder=function(v){return this.importDocument(v)},p.prototype.replaceChild=function(v,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.removeChild=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.appendChild=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.hasChildNodes=function(){return this.children.length!==0},p.prototype.cloneNode=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.isSupported=function(v,g){return!0},p.prototype.hasAttributes=function(){return this.attribs.length!==0},p.prototype.compareDocumentPosition=function(v){var g,k;return g=this,g===v?0:this.document()!==v.document()?(k=r.Disconnected|r.ImplementationSpecific,Math.random()<.5?k|=r.Preceding:k|=r.Following,k):g.isAncestor(v)?r.Contains|r.Preceding:g.isDescendant(v)?r.Contains|r.Following:g.isPreceding(v)?r.Preceding:r.Following},p.prototype.isSameNode=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.lookupPrefix=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.isDefaultNamespace=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.lookupNamespaceURI=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.isEqualNode=function(v){var g,k,b;if(v.nodeType!==this.nodeType||v.children.length!==this.children.length)return!1;for(g=k=0,b=this.children.length-1;0<=b?k<=b:k>=b;g=0<=b?++k:--k)if(!this.children[g].isEqualNode(v.children[g]))return!1;return!0},p.prototype.getFeature=function(v,g){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.setUserData=function(v,g,k){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.getUserData=function(v){throw new Error("This DOM method is not implemented."+this.debugInfo())},p.prototype.contains=function(v){return v?v===this||this.isDescendant(v):!1},p.prototype.isDescendant=function(v){var g,k,b,C,E;for(E=this.children,b=0,C=E.length;b<C;b++)if(g=E[b],v===g||(k=g.isDescendant(v),k))return!0;return!1},p.prototype.isAncestor=function(v){return v.isDescendant(this)},p.prototype.isPreceding=function(v){var g,k;return g=this.treePosition(v),k=this.treePosition(this),g===-1||k===-1?!1:g<k},p.prototype.isFollowing=function(v){var g,k;return g=this.treePosition(v),k=this.treePosition(this),g===-1||k===-1?!1:g>k},p.prototype.treePosition=function(v){var g,k;return k=0,g=!1,this.foreachTreeNode(this.document(),function(b){if(k++,!g&&b===v)return g=!0}),g?k:-1},p.prototype.foreachTreeNode=function(v,g){var k,b,C,E,I;for(v||(v=this.document()),E=v.children,b=0,C=E.length;b<C;b++){if(k=E[b],I=g(k))return I;if(I=this.foreachTreeNode(k,g),I)return I}},p}()}).call(US)});var Fh=L((BS,WS)=>{(function(){var r,e=function(n,i){return function(){return n.apply(i,arguments)}},t={}.hasOwnProperty;WS.exports=r=function(){function n(i){this.assertLegalName=e(this.assertLegalName,this),this.assertLegalChar=e(this.assertLegalChar,this);var s,o,a;i||(i={}),this.options=i,this.options.version||(this.options.version="1.0"),o=i.stringify||{};for(s in o)t.call(o,s)&&(a=o[s],this[s]=a)}return n.prototype.name=function(i){return this.options.noValidation?i:this.assertLegalName(""+i||"")},n.prototype.text=function(i){return this.options.noValidation?i:this.assertLegalChar(this.textEscape(""+i||""))},n.prototype.cdata=function(i){return this.options.noValidation?i:(i=""+i||"",i=i.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(i))},n.prototype.comment=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+i);return this.assertLegalChar(i)},n.prototype.raw=function(i){return this.options.noValidation?i:""+i||""},n.prototype.attValue=function(i){return this.options.noValidation?i:this.assertLegalChar(this.attEscape(i=""+i||""))},n.prototype.insTarget=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.insValue=function(i){if(this.options.noValidation)return i;if(i=""+i||"",i.match(/\?>/))throw new Error("Invalid processing instruction value: "+i);return this.assertLegalChar(i)},n.prototype.xmlVersion=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+i);return i},n.prototype.xmlEncoding=function(i){if(this.options.noValidation)return i;if(i=""+i||"",!i.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+i);return this.assertLegalChar(i)},n.prototype.xmlStandalone=function(i){return this.options.noValidation?i:i?"yes":"no"},n.prototype.dtdPubID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdSysID=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdElementValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttType=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdAttDefault=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdEntityValue=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.dtdNData=function(i){return this.options.noValidation?i:this.assertLegalChar(""+i||"")},n.prototype.convertAttKey="@",n.prototype.convertPIKey="?",n.prototype.convertTextKey="#text",n.prototype.convertCDataKey="#cdata",n.prototype.convertCommentKey="#comment",n.prototype.convertRawKey="#raw",n.prototype.assertLegalChar=function(i){var s,o;if(this.options.noValidation)return i;if(s="",this.options.version==="1.0"){if(s=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,o=i.match(s))throw new Error("Invalid character in string: "+i+" at index "+o.index)}else if(this.options.version==="1.1"&&(s=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,o=i.match(s)))throw new Error("Invalid character in string: "+i+" at index "+o.index);return i},n.prototype.assertLegalName=function(i){var s;if(this.options.noValidation)return i;if(this.assertLegalChar(i),s=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!i.match(s))throw new Error("Invalid character in name");return i},n.prototype.textEscape=function(i){var s;return this.options.noValidation?i:(s=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},n.prototype.attEscape=function(i){var s;return this.options.noValidation?i:(s=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,i.replace(s,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},n}()}).call(BS)});var Qa=L((VS,HS)=>{(function(){HS.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(VS)});var Lh=L((KS,XS)=>{(function(){var r,e,t,n,i,s,o,a,u,c,l,f,d,h,m,D,_,R={}.hasOwnProperty;_=Kn().assign,r=jt(),u=sl(),c=ll(),t=nl(),n=il(),f=rl(),h=dl(),m=fl(),d=pl(),l=Nh(),i=ol(),s=ul(),o=al(),a=cl(),e=Qa(),XS.exports=D=function(){function N(w){var p,v,g;w||(w={}),this.options=w,v=w.writer||{};for(p in v)R.call(v,p)&&(g=v[p],this["_"+p]=this[p],this[p]=g)}return N.prototype.filterOptions=function(w){var p,v,g,k,b,C,E,I;return w||(w={}),w=_({},this.options,w),p={writer:this},p.pretty=w.pretty||!1,p.allowEmpty=w.allowEmpty||!1,p.indent=(v=w.indent)!=null?v:"  ",p.newline=(g=w.newline)!=null?g:`
`,p.offset=(k=w.offset)!=null?k:0,p.dontPrettyTextNodes=(b=(C=w.dontPrettyTextNodes)!=null?C:w.dontprettytextnodes)!=null?b:0,p.spaceBeforeSlash=(E=(I=w.spaceBeforeSlash)!=null?I:w.spacebeforeslash)!=null?E:"",p.spaceBeforeSlash===!0&&(p.spaceBeforeSlash=" "),p.suppressPrettyCount=0,p.user={},p.state=e.None,p},N.prototype.indent=function(w,p,v){var g;return!p.pretty||p.suppressPrettyCount?"":p.pretty&&(g=(v||0)+p.offset+1,g>0)?new Array(g).join(p.indent):""},N.prototype.endline=function(w,p,v){return!p.pretty||p.suppressPrettyCount?"":p.newline},N.prototype.attribute=function(w,p,v){var g;return this.openAttribute(w,p,v),g=" "+w.name+'="'+w.value+'"',this.closeAttribute(w,p,v),g},N.prototype.cdata=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<![CDATA[",p.state=e.InsideTag,g+=w.value,p.state=e.CloseTag,g+="]]>"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.comment=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!-- ",p.state=e.InsideTag,g+=w.value,p.state=e.CloseTag,g+=" -->"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.declaration=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<?xml",p.state=e.InsideTag,g+=' version="'+w.version+'"',w.encoding!=null&&(g+=' encoding="'+w.encoding+'"'),w.standalone!=null&&(g+=' standalone="'+w.standalone+'"'),p.state=e.CloseTag,g+=p.spaceBeforeSlash+"?>",g+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.docType=function(w,p,v){var g,k,b,C,E;if(v||(v=0),this.openNode(w,p,v),p.state=e.OpenTag,C=this.indent(w,p,v),C+="<!DOCTYPE "+w.root().name,w.pubID&&w.sysID?C+=' PUBLIC "'+w.pubID+'" "'+w.sysID+'"':w.sysID&&(C+=' SYSTEM "'+w.sysID+'"'),w.children.length>0){for(C+=" [",C+=this.endline(w,p,v),p.state=e.InsideTag,E=w.children,k=0,b=E.length;k<b;k++)g=E[k],C+=this.writeChildNode(g,p,v+1);p.state=e.CloseTag,C+="]"}return p.state=e.CloseTag,C+=p.spaceBeforeSlash+">",C+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),C},N.prototype.element=function(w,p,v){var g,k,b,C,E,I,B,z,te,ue,Q,se,fe,_e;v||(v=0),ue=!1,Q="",this.openNode(w,p,v),p.state=e.OpenTag,Q+=this.indent(w,p,v)+"<"+w.name,se=w.attribs;for(te in se)R.call(se,te)&&(g=se[te],Q+=this.attribute(g,p,v));if(b=w.children.length,C=b===0?null:w.children[0],b===0||w.children.every(function(Ke){return(Ke.type===r.Text||Ke.type===r.Raw)&&Ke.value===""}))p.allowEmpty?(Q+=">",p.state=e.CloseTag,Q+="</"+w.name+">"+this.endline(w,p,v)):(p.state=e.CloseTag,Q+=p.spaceBeforeSlash+"/>"+this.endline(w,p,v));else if(p.pretty&&b===1&&(C.type===r.Text||C.type===r.Raw)&&C.value!=null)Q+=">",p.state=e.InsideTag,p.suppressPrettyCount++,ue=!0,Q+=this.writeChildNode(C,p,v+1),p.suppressPrettyCount--,ue=!1,p.state=e.CloseTag,Q+="</"+w.name+">"+this.endline(w,p,v);else{if(p.dontPrettyTextNodes){for(fe=w.children,E=0,B=fe.length;E<B;E++)if(k=fe[E],(k.type===r.Text||k.type===r.Raw)&&k.value!=null){p.suppressPrettyCount++,ue=!0;break}}for(Q+=">"+this.endline(w,p,v),p.state=e.InsideTag,_e=w.children,I=0,z=_e.length;I<z;I++)k=_e[I],Q+=this.writeChildNode(k,p,v+1);p.state=e.CloseTag,Q+=this.indent(w,p,v)+"</"+w.name+">",ue&&p.suppressPrettyCount--,Q+=this.endline(w,p,v),p.state=e.None}return this.closeNode(w,p,v),Q},N.prototype.writeChildNode=function(w,p,v){switch(w.type){case r.CData:return this.cdata(w,p,v);case r.Comment:return this.comment(w,p,v);case r.Element:return this.element(w,p,v);case r.Raw:return this.raw(w,p,v);case r.Text:return this.text(w,p,v);case r.ProcessingInstruction:return this.processingInstruction(w,p,v);case r.Dummy:return"";case r.Declaration:return this.declaration(w,p,v);case r.DocType:return this.docType(w,p,v);case r.AttributeDeclaration:return this.dtdAttList(w,p,v);case r.ElementDeclaration:return this.dtdElement(w,p,v);case r.EntityDeclaration:return this.dtdEntity(w,p,v);case r.NotationDeclaration:return this.dtdNotation(w,p,v);default:throw new Error("Unknown XML node type: "+w.constructor.name)}},N.prototype.processingInstruction=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<?",p.state=e.InsideTag,g+=w.target,w.value&&(g+=" "+w.value),p.state=e.CloseTag,g+=p.spaceBeforeSlash+"?>",g+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.raw=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v),p.state=e.InsideTag,g+=w.value,p.state=e.CloseTag,g+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.text=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v),p.state=e.InsideTag,g+=w.value,p.state=e.CloseTag,g+=this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.dtdAttList=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!ATTLIST",p.state=e.InsideTag,g+=" "+w.elementName+" "+w.attributeName+" "+w.attributeType,w.defaultValueType!=="#DEFAULT"&&(g+=" "+w.defaultValueType),w.defaultValue&&(g+=' "'+w.defaultValue+'"'),p.state=e.CloseTag,g+=p.spaceBeforeSlash+">"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.dtdElement=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!ELEMENT",p.state=e.InsideTag,g+=" "+w.name+" "+w.value,p.state=e.CloseTag,g+=p.spaceBeforeSlash+">"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.dtdEntity=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!ENTITY",p.state=e.InsideTag,w.pe&&(g+=" %"),g+=" "+w.name,w.value?g+=' "'+w.value+'"':(w.pubID&&w.sysID?g+=' PUBLIC "'+w.pubID+'" "'+w.sysID+'"':w.sysID&&(g+=' SYSTEM "'+w.sysID+'"'),w.nData&&(g+=" NDATA "+w.nData)),p.state=e.CloseTag,g+=p.spaceBeforeSlash+">"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.dtdNotation=function(w,p,v){var g;return this.openNode(w,p,v),p.state=e.OpenTag,g=this.indent(w,p,v)+"<!NOTATION",p.state=e.InsideTag,g+=" "+w.name,w.pubID&&w.sysID?g+=' PUBLIC "'+w.pubID+'" "'+w.sysID+'"':w.pubID?g+=' PUBLIC "'+w.pubID+'"':w.sysID&&(g+=' SYSTEM "'+w.sysID+'"'),p.state=e.CloseTag,g+=p.spaceBeforeSlash+">"+this.endline(w,p,v),p.state=e.None,this.closeNode(w,p,v),g},N.prototype.openNode=function(w,p,v){},N.prototype.closeNode=function(w,p,v){},N.prototype.openAttribute=function(w,p,v){},N.prototype.closeAttribute=function(w,p,v){},N}()}).call(KS)});var hl=L((zS,GS)=>{(function(){var r,e,t=function(i,s){for(var o in s)n.call(s,o)&&(i[o]=s[o]);function a(){this.constructor=i}return a.prototype=s.prototype,i.prototype=new a,i.__super__=s.prototype,i},n={}.hasOwnProperty;e=Lh(),GS.exports=r=function(i){t(s,i);function s(o){s.__super__.constructor.call(this,o)}return s.prototype.document=function(o,a){var u,c,l,f,d;for(a=this.filterOptions(a),f="",d=o.children,c=0,l=d.length;c<l;c++)u=d[c],f+=this.writeChildNode(u,a,0);return a.pretty&&f.slice(-a.newline.length)===a.newline&&(f=f.slice(0,-a.newline.length)),f},s}(e)}).call(zS)});var Mh=L((QS,YS)=>{(function(){var r,e,t,n,i,s,o,a,u=function(l,f){for(var d in f)c.call(f,d)&&(l[d]=f[d]);function h(){this.constructor=l}return h.prototype=f.prototype,l.prototype=new h,l.__super__=f.prototype,l},c={}.hasOwnProperty;a=Kn().isPlainObject,t=Oh(),e=ZT(),i=Jr(),r=jt(),o=Fh(),s=hl(),YS.exports=n=function(l){u(f,l);function f(d){f.__super__.constructor.call(this,null),this.name="#document",this.type=r.Document,this.documentURI=null,this.domConfig=new e,d||(d={}),d.writer||(d.writer=new s),this.options=d,this.stringify=new o(d)}return Object.defineProperty(f.prototype,"implementation",{value:new t}),Object.defineProperty(f.prototype,"doctype",{get:function(){var d,h,m,D;for(D=this.children,h=0,m=D.length;h<m;h++)if(d=D[h],d.type===r.DocType)return d;return null}}),Object.defineProperty(f.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(f.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(f.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(f.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].encoding:null}}),Object.defineProperty(f.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(f.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===r.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(f.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(f.prototype,"origin",{get:function(){return null}}),Object.defineProperty(f.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(f.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(f.prototype,"contentType",{get:function(){return null}}),f.prototype.end=function(d){var h;return h={},d?a(d)&&(h=d,d=this.options.writer):d=this.options.writer,d.document(this,d.filterOptions(h))},f.prototype.toString=function(d){return this.options.writer.document(this,this.options.writer.filterOptions(d))},f.prototype.createElement=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createTextNode=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createComment=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createCDATASection=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createProcessingInstruction=function(d,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createAttribute=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createEntityReference=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.getElementsByTagName=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.importNode=function(d,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createElementNS=function(d,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createAttributeNS=function(d,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.getElementsByTagNameNS=function(d,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.getElementById=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.adoptNode=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.renameNode=function(d,h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.getElementsByClassName=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createEvent=function(d){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createNodeIterator=function(d,h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},f.prototype.createTreeWalker=function(d,h,m){throw new Error("This DOM method is not implemented."+this.debugInfo())},f}(i)}).call(QS)});var eE=L((JS,ZS)=>{(function(){var r,e,t,n,i,s,o,a,u,c,l,f,d,h,m,D,_,R,N,w,p,v,g,k,b={}.hasOwnProperty;k=Kn(),v=k.isObject,p=k.isFunction,g=k.isPlainObject,w=k.getValue,r=jt(),f=Mh(),h=rl(),n=nl(),i=il(),D=dl(),N=fl(),m=pl(),c=sl(),l=ll(),s=ol(),a=al(),o=ul(),u=cl(),t=Ah(),R=Fh(),_=hl(),e=Qa(),ZS.exports=d=function(){function C(E,I,B){var z;this.name="?xml",this.type=r.Document,E||(E={}),z={},E.writer?g(E.writer)&&(z=E.writer,E.writer=new _):E.writer=new _,this.options=E,this.writer=E.writer,this.writerOptions=this.writer.filterOptions(z),this.stringify=new R(E),this.onDataCallback=I||function(){},this.onEndCallback=B||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return C.prototype.createChildNode=function(E){var I,B,z,te,ue,Q,se,fe;switch(E.type){case r.CData:this.cdata(E.value);break;case r.Comment:this.comment(E.value);break;case r.Element:z={},se=E.attribs;for(B in se)b.call(se,B)&&(I=se[B],z[B]=I.value);this.node(E.name,z);break;case r.Dummy:this.dummy();break;case r.Raw:this.raw(E.value);break;case r.Text:this.text(E.value);break;case r.ProcessingInstruction:this.instruction(E.target,E.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+E.constructor.name)}for(fe=E.children,ue=0,Q=fe.length;ue<Q;ue++)te=fe[ue],this.createChildNode(te),te.type===r.Element&&this.up();return this},C.prototype.dummy=function(){return this},C.prototype.node=function(E,I,B){var z;if(E==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(E));return this.openCurrent(),E=w(E),I==null&&(I={}),I=w(I),v(I)||(z=[I,B],B=z[0],I=z[1]),this.currentNode=new h(this,E,I),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,B!=null&&this.text(B),this},C.prototype.element=function(E,I,B){var z,te,ue,Q,se,fe;if(this.currentNode&&this.currentNode.type===r.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(E)||v(E)||p(E))for(Q=this.options.noValidation,this.options.noValidation=!0,fe=new f(this.options).element("TEMP_ROOT"),fe.element(E),this.options.noValidation=Q,se=fe.children,te=0,ue=se.length;te<ue;te++)z=se[te],this.createChildNode(z),z.type===r.Element&&this.up();else this.node(E,I,B);return this},C.prototype.attribute=function(E,I){var B,z;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(E));if(E!=null&&(E=w(E)),v(E))for(B in E)b.call(E,B)&&(z=E[B],this.attribute(B,z));else p(I)&&(I=I.apply()),this.options.keepNullAttributes&&I==null?this.currentNode.attribs[E]=new t(this,E,""):I!=null&&(this.currentNode.attribs[E]=new t(this,E,I));return this},C.prototype.text=function(E){var I;return this.openCurrent(),I=new N(this,E),this.onData(this.writer.text(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.cdata=function(E){var I;return this.openCurrent(),I=new n(this,E),this.onData(this.writer.cdata(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.comment=function(E){var I;return this.openCurrent(),I=new i(this,E),this.onData(this.writer.comment(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.raw=function(E){var I;return this.openCurrent(),I=new D(this,E),this.onData(this.writer.raw(I,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.instruction=function(E,I){var B,z,te,ue,Q;if(this.openCurrent(),E!=null&&(E=w(E)),I!=null&&(I=w(I)),Array.isArray(E))for(B=0,ue=E.length;B<ue;B++)z=E[B],this.instruction(z);else if(v(E))for(z in E)b.call(E,z)&&(te=E[z],this.instruction(z,te));else p(I)&&(I=I.apply()),Q=new m(this,E,I),this.onData(this.writer.processingInstruction(Q,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},C.prototype.declaration=function(E,I,B){var z;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return z=new c(this,E,I,B),this.onData(this.writer.declaration(z,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.doctype=function(E,I,B){if(this.openCurrent(),E==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new l(this,I,B),this.currentNode.rootNodeName=E,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},C.prototype.dtdElement=function(E,I){var B;return this.openCurrent(),B=new o(this,E,I),this.onData(this.writer.dtdElement(B,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.attList=function(E,I,B,z,te){var ue;return this.openCurrent(),ue=new s(this,E,I,B,z,te),this.onData(this.writer.dtdAttList(ue,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.entity=function(E,I){var B;return this.openCurrent(),B=new a(this,!1,E,I),this.onData(this.writer.dtdEntity(B,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.pEntity=function(E,I){var B;return this.openCurrent(),B=new a(this,!0,E,I),this.onData(this.writer.dtdEntity(B,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.notation=function(E,I){var B;return this.openCurrent(),B=new u(this,E,I),this.onData(this.writer.dtdNotation(B,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},C.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},C.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},C.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},C.prototype.openNode=function(E){var I,B,z,te;if(!E.isOpen){if(!this.root&&this.currentLevel===0&&E.type===r.Element&&(this.root=E),B="",E.type===r.Element){this.writerOptions.state=e.OpenTag,B=this.writer.indent(E,this.writerOptions,this.currentLevel)+"<"+E.name,te=E.attribs;for(z in te)b.call(te,z)&&(I=te[z],B+=this.writer.attribute(I,this.writerOptions,this.currentLevel));B+=(E.children?">":"/>")+this.writer.endline(E,this.writerOptions,this.currentLevel),this.writerOptions.state=e.InsideTag}else this.writerOptions.state=e.OpenTag,B=this.writer.indent(E,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+E.rootNodeName,E.pubID&&E.sysID?B+=' PUBLIC "'+E.pubID+'" "'+E.sysID+'"':E.sysID&&(B+=' SYSTEM "'+E.sysID+'"'),E.children?(B+=" [",this.writerOptions.state=e.InsideTag):(this.writerOptions.state=e.CloseTag,B+=">"),B+=this.writer.endline(E,this.writerOptions,this.currentLevel);return this.onData(B,this.currentLevel),E.isOpen=!0}},C.prototype.closeNode=function(E){var I;if(!E.isClosed)return I="",this.writerOptions.state=e.CloseTag,E.type===r.Element?I=this.writer.indent(E,this.writerOptions,this.currentLevel)+"</"+E.name+">"+this.writer.endline(E,this.writerOptions,this.currentLevel):I=this.writer.indent(E,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(E,this.writerOptions,this.currentLevel),this.writerOptions.state=e.None,this.onData(I,this.currentLevel),E.isClosed=!0},C.prototype.onData=function(E,I){return this.documentStarted=!0,this.onDataCallback(E,I+1)},C.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},C.prototype.debugInfo=function(E){return E==null?"":"node: <"+E+">"},C.prototype.ele=function(){return this.element.apply(this,arguments)},C.prototype.nod=function(E,I,B){return this.node(E,I,B)},C.prototype.txt=function(E){return this.text(E)},C.prototype.dat=function(E){return this.cdata(E)},C.prototype.com=function(E){return this.comment(E)},C.prototype.ins=function(E,I){return this.instruction(E,I)},C.prototype.dec=function(E,I,B){return this.declaration(E,I,B)},C.prototype.dtd=function(E,I,B){return this.doctype(E,I,B)},C.prototype.e=function(E,I,B){return this.element(E,I,B)},C.prototype.n=function(E,I,B){return this.node(E,I,B)},C.prototype.t=function(E){return this.text(E)},C.prototype.d=function(E){return this.cdata(E)},C.prototype.c=function(E){return this.comment(E)},C.prototype.r=function(E){return this.raw(E)},C.prototype.i=function(E,I){return this.instruction(E,I)},C.prototype.att=function(){return this.currentNode&&this.currentNode.type===r.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},C.prototype.a=function(){return this.currentNode&&this.currentNode.type===r.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},C.prototype.ent=function(E,I){return this.entity(E,I)},C.prototype.pent=function(E,I){return this.pEntity(E,I)},C.prototype.not=function(E,I){return this.notation(E,I)},C}()}).call(JS)});var nE=L((tE,rE)=>{(function(){var r,e,t,n,i=function(o,a){for(var u in a)s.call(a,u)&&(o[u]=a[u]);function c(){this.constructor=o}return c.prototype=a.prototype,o.prototype=new c,o.__super__=a.prototype,o},s={}.hasOwnProperty;r=jt(),n=Lh(),e=Qa(),rE.exports=t=function(o){i(a,o);function a(u,c){this.stream=u,a.__super__.constructor.call(this,c)}return a.prototype.endline=function(u,c,l){return u.isLastRootNode&&c.state===e.CloseTag?"":a.__super__.endline.call(this,u,c,l)},a.prototype.document=function(u,c){var l,f,d,h,m,D,_,R,N;for(_=u.children,f=d=0,m=_.length;d<m;f=++d)l=_[f],l.isLastRootNode=f===u.children.length-1;for(c=this.filterOptions(c),R=u.children,N=[],h=0,D=R.length;h<D;h++)l=R[h],N.push(this.writeChildNode(l,c,0));return N},a.prototype.attribute=function(u,c,l){return this.stream.write(a.__super__.attribute.call(this,u,c,l))},a.prototype.cdata=function(u,c,l){return this.stream.write(a.__super__.cdata.call(this,u,c,l))},a.prototype.comment=function(u,c,l){return this.stream.write(a.__super__.comment.call(this,u,c,l))},a.prototype.declaration=function(u,c,l){return this.stream.write(a.__super__.declaration.call(this,u,c,l))},a.prototype.docType=function(u,c,l){var f,d,h,m;if(l||(l=0),this.openNode(u,c,l),c.state=e.OpenTag,this.stream.write(this.indent(u,c,l)),this.stream.write("<!DOCTYPE "+u.root().name),u.pubID&&u.sysID?this.stream.write(' PUBLIC "'+u.pubID+'" "'+u.sysID+'"'):u.sysID&&this.stream.write(' SYSTEM "'+u.sysID+'"'),u.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(u,c,l)),c.state=e.InsideTag,m=u.children,d=0,h=m.length;d<h;d++)f=m[d],this.writeChildNode(f,c,l+1);c.state=e.CloseTag,this.stream.write("]")}return c.state=e.CloseTag,this.stream.write(c.spaceBeforeSlash+">"),this.stream.write(this.endline(u,c,l)),c.state=e.None,this.closeNode(u,c,l)},a.prototype.element=function(u,c,l){var f,d,h,m,D,_,R,N,w,p;l||(l=0),this.openNode(u,c,l),c.state=e.OpenTag,this.stream.write(this.indent(u,c,l)+"<"+u.name),w=u.attribs;for(R in w)s.call(w,R)&&(f=w[R],this.attribute(f,c,l));if(h=u.children.length,m=h===0?null:u.children[0],h===0||u.children.every(function(v){return(v.type===r.Text||v.type===r.Raw)&&v.value===""}))c.allowEmpty?(this.stream.write(">"),c.state=e.CloseTag,this.stream.write("</"+u.name+">")):(c.state=e.CloseTag,this.stream.write(c.spaceBeforeSlash+"/>"));else if(c.pretty&&h===1&&(m.type===r.Text||m.type===r.Raw)&&m.value!=null)this.stream.write(">"),c.state=e.InsideTag,c.suppressPrettyCount++,N=!0,this.writeChildNode(m,c,l+1),c.suppressPrettyCount--,N=!1,c.state=e.CloseTag,this.stream.write("</"+u.name+">");else{for(this.stream.write(">"+this.endline(u,c,l)),c.state=e.InsideTag,p=u.children,D=0,_=p.length;D<_;D++)d=p[D],this.writeChildNode(d,c,l+1);c.state=e.CloseTag,this.stream.write(this.indent(u,c,l)+"</"+u.name+">")}return this.stream.write(this.endline(u,c,l)),c.state=e.None,this.closeNode(u,c,l)},a.prototype.processingInstruction=function(u,c,l){return this.stream.write(a.__super__.processingInstruction.call(this,u,c,l))},a.prototype.raw=function(u,c,l){return this.stream.write(a.__super__.raw.call(this,u,c,l))},a.prototype.text=function(u,c,l){return this.stream.write(a.__super__.text.call(this,u,c,l))},a.prototype.dtdAttList=function(u,c,l){return this.stream.write(a.__super__.dtdAttList.call(this,u,c,l))},a.prototype.dtdElement=function(u,c,l){return this.stream.write(a.__super__.dtdElement.call(this,u,c,l))},a.prototype.dtdEntity=function(u,c,l){return this.stream.write(a.__super__.dtdEntity.call(this,u,c,l))},a.prototype.dtdNotation=function(u,c,l){return this.stream.write(a.__super__.dtdNotation.call(this,u,c,l))},a}(n)}).call(tE)});var sE=L((iE,Wi)=>{(function(){var r,e,t,n,i,s,o,a,u,c;c=Kn(),a=c.assign,u=c.isFunction,t=Oh(),n=Mh(),i=eE(),o=hl(),s=nE(),r=jt(),e=Qa(),Wi.exports.create=function(l,f,d,h){var m,D;if(l==null)throw new Error("Root element needs a name.");return h=a({},f,d,h),m=new n(h),D=m.element(l),h.headless||(m.declaration(h),(h.pubID!=null||h.sysID!=null)&&m.dtd(h)),D},Wi.exports.begin=function(l,f,d){var h;return u(l)&&(h=[l,f],f=h[0],d=h[1],l={}),f?new i(l,f,d):new n(l)},Wi.exports.stringWriter=function(l){return new o(l)},Wi.exports.streamWriter=function(l,f){return new s(l,f)},Wi.exports.implementation=new t,Wi.exports.nodeType=r,Wi.exports.writerState=e}).call(iE)});var oE=L(qh=>{(function(){"use strict";var r,e,t,n,i,s={}.hasOwnProperty;r=sE(),e=el().defaults,n=function(o){return typeof o=="string"&&(o.indexOf("&")>=0||o.indexOf(">")>=0||o.indexOf("<")>=0)},i=function(o){return"<![CDATA["+t(o)+"]]>"},t=function(o){return o.replace("]]>","]]]]><![CDATA[>")},qh.Builder=function(){function o(a){var u,c,l;this.options={},c=e["0.2"];for(u in c)s.call(c,u)&&(l=c[u],this.options[u]=l);for(u in a)s.call(a,u)&&(l=a[u],this.options[u]=l)}return o.prototype.buildObject=function(a){var u,c,l,f,d;return u=this.options.attrkey,c=this.options.charkey,Object.keys(a).length===1&&this.options.rootName===e["0.2"].rootName?(d=Object.keys(a)[0],a=a[d]):d=this.options.rootName,l=function(h){return function(m,D){var _,R,N,w,p,v;if(typeof D!="object")h.options.cdata&&n(D)?m.raw(i(D)):m.txt(D);else if(Array.isArray(D)){for(w in D)if(s.call(D,w)){R=D[w];for(p in R)N=R[p],m=l(m.ele(p),N).up()}}else for(p in D)if(s.call(D,p))if(R=D[p],p===u){if(typeof R=="object")for(_ in R)v=R[_],m=m.att(_,v)}else if(p===c)h.options.cdata&&n(R)?m=m.raw(i(R)):m=m.txt(R);else if(Array.isArray(R))for(w in R)s.call(R,w)&&(N=R[w],typeof N=="string"?h.options.cdata&&n(N)?m=m.ele(p).raw(i(N)).up():m=m.ele(p,N).up():m=l(m.ele(p),N).up());else typeof R=="object"?m=l(m.ele(p),R).up():typeof R=="string"&&h.options.cdata&&n(R)?m=m.ele(p).raw(i(R)).up():(R==null&&(R=""),m=m.ele(p,R.toString()).up());return m}}(this),f=r.create(d,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),l(f,a).end(this.options.renderOpts)},o}()}).call(qh)});var aE=L(gl=>{(function(r){r.parser=function(O,x){return new t(O,x)},r.SAXParser=t,r.SAXStream=c,r.createStream=u,r.MAX_BUFFER_LENGTH=64*1024;var e=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];r.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function t(O,x){if(!(this instanceof t))return new t(O,x);var J=this;i(J),J.q=J.c="",J.bufferCheckPosition=r.MAX_BUFFER_LENGTH,J.opt=x||{},J.opt.lowercase=J.opt.lowercase||J.opt.lowercasetags,J.looseCase=J.opt.lowercase?"toLowerCase":"toUpperCase",J.tags=[],J.closed=J.closedRoot=J.sawRoot=!1,J.tag=J.error=null,J.strict=!!O,J.noscript=!!(O||J.opt.noscript),J.state=b.BEGIN,J.strictEntities=J.opt.strictEntities,J.ENTITIES=J.strictEntities?Object.create(r.XML_ENTITIES):Object.create(r.ENTITIES),J.attribList=[],J.opt.xmlns&&(J.ns=Object.create(m)),J.trackPosition=J.opt.position!==!1,J.trackPosition&&(J.position=J.line=J.column=0),E(J,"onready")}Object.create||(Object.create=function(O){function x(){}x.prototype=O;var J=new x;return J}),Object.keys||(Object.keys=function(O){var x=[];for(var J in O)O.hasOwnProperty(J)&&x.push(J);return x});function n(O){for(var x=Math.max(r.MAX_BUFFER_LENGTH,10),J=0,W=0,Re=e.length;W<Re;W++){var Qe=O[e[W]].length;if(Qe>x)switch(e[W]){case"textNode":B(O);break;case"cdata":I(O,"oncdata",O.cdata),O.cdata="";break;case"script":I(O,"onscript",O.script),O.script="";break;default:te(O,"Max buffer length exceeded: "+e[W])}J=Math.max(J,Qe)}var Ie=r.MAX_BUFFER_LENGTH-J;O.bufferCheckPosition=Ie+O.position}function i(O){for(var x=0,J=e.length;x<J;x++)O[e[x]]=""}function s(O){B(O),O.cdata!==""&&(I(O,"oncdata",O.cdata),O.cdata=""),O.script!==""&&(I(O,"onscript",O.script),O.script="")}t.prototype={end:function(){ue(this)},write:nr,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){s(this)}};var o;try{o=require("stream").Stream}catch{o=function(){}}var a=r.EVENTS.filter(function(O){return O!=="error"&&O!=="end"});function u(O,x){return new c(O,x)}function c(O,x){if(!(this instanceof c))return new c(O,x);o.apply(this),this._parser=new t(O,x),this.writable=!0,this.readable=!0;var J=this;this._parser.onend=function(){J.emit("end")},this._parser.onerror=function(W){J.emit("error",W),J._parser.error=null},this._decoder=null,a.forEach(function(W){Object.defineProperty(J,"on"+W,{get:function(){return J._parser["on"+W]},set:function(Re){if(!Re)return J.removeAllListeners(W),J._parser["on"+W]=Re,Re;J.on(W,Re)},enumerable:!0,configurable:!1})})}c.prototype=Object.create(o.prototype,{constructor:{value:c}}),c.prototype.write=function(O){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(O)){if(!this._decoder){var x=require("string_decoder").StringDecoder;this._decoder=new x("utf8")}O=this._decoder.write(O)}return this._parser.write(O.toString()),this.emit("data",O),!0},c.prototype.end=function(O){return O&&O.length&&this.write(O),this._parser.end(),!0},c.prototype.on=function(O,x){var J=this;return!J._parser["on"+O]&&a.indexOf(O)!==-1&&(J._parser["on"+O]=function(){var W=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);W.splice(0,0,O),J.emit.apply(J,W)}),o.prototype.on.call(J,O,x)};var l="[CDATA[",f="DOCTYPE",d="http://www.w3.org/XML/1998/namespace",h="http://www.w3.org/2000/xmlns/",m={xml:d,xmlns:h},D=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,_=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,R=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,N=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function w(O){return O===" "||O===`
`||O==="\r"||O==="	"}function p(O){return O==='"'||O==="'"}function v(O){return O===">"||w(O)}function g(O,x){return O.test(x)}function k(O,x){return!g(O,x)}var b=0;r.STATE={BEGIN:b++,BEGIN_WHITESPACE:b++,TEXT:b++,TEXT_ENTITY:b++,OPEN_WAKA:b++,SGML_DECL:b++,SGML_DECL_QUOTED:b++,DOCTYPE:b++,DOCTYPE_QUOTED:b++,DOCTYPE_DTD:b++,DOCTYPE_DTD_QUOTED:b++,COMMENT_STARTING:b++,COMMENT:b++,COMMENT_ENDING:b++,COMMENT_ENDED:b++,CDATA:b++,CDATA_ENDING:b++,CDATA_ENDING_2:b++,PROC_INST:b++,PROC_INST_BODY:b++,PROC_INST_ENDING:b++,OPEN_TAG:b++,OPEN_TAG_SLASH:b++,ATTRIB:b++,ATTRIB_NAME:b++,ATTRIB_NAME_SAW_WHITE:b++,ATTRIB_VALUE:b++,ATTRIB_VALUE_QUOTED:b++,ATTRIB_VALUE_CLOSED:b++,ATTRIB_VALUE_UNQUOTED:b++,ATTRIB_VALUE_ENTITY_Q:b++,ATTRIB_VALUE_ENTITY_U:b++,CLOSE_TAG:b++,CLOSE_TAG_SAW_WHITE:b++,SCRIPT:b++,SCRIPT_ENDING:b++},r.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},r.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(r.ENTITIES).forEach(function(O){var x=r.ENTITIES[O],J=typeof x=="number"?String.fromCharCode(x):x;r.ENTITIES[O]=J});for(var C in r.STATE)r.STATE[r.STATE[C]]=C;b=r.STATE;function E(O,x,J){O[x]&&O[x](J)}function I(O,x,J){O.textNode&&B(O),E(O,x,J)}function B(O){O.textNode=z(O.opt,O.textNode),O.textNode&&E(O,"ontext",O.textNode),O.textNode=""}function z(O,x){return O.trim&&(x=x.trim()),O.normalize&&(x=x.replace(/\s+/g," ")),x}function te(O,x){return B(O),O.trackPosition&&(x+=`
Line: `+O.line+`
Column: `+O.column+`
Char: `+O.c),x=new Error(x),O.error=x,E(O,"onerror",x),O}function ue(O){return O.sawRoot&&!O.closedRoot&&Q(O,"Unclosed root tag"),O.state!==b.BEGIN&&O.state!==b.BEGIN_WHITESPACE&&O.state!==b.TEXT&&te(O,"Unexpected end"),B(O),O.c="",O.closed=!0,E(O,"onend"),t.call(O,O.strict,O.opt),O}function Q(O,x){if(typeof O!="object"||!(O instanceof t))throw new Error("bad call to strictFail");O.strict&&te(O,x)}function se(O){O.strict||(O.tagName=O.tagName[O.looseCase]());var x=O.tags[O.tags.length-1]||O,J=O.tag={name:O.tagName,attributes:{}};O.opt.xmlns&&(J.ns=x.ns),O.attribList.length=0,I(O,"onopentagstart",J)}function fe(O,x){var J=O.indexOf(":"),W=J<0?["",O]:O.split(":"),Re=W[0],Qe=W[1];return x&&O==="xmlns"&&(Re="xmlns",Qe=""),{prefix:Re,local:Qe}}function _e(O){if(O.strict||(O.attribName=O.attribName[O.looseCase]()),O.attribList.indexOf(O.attribName)!==-1||O.tag.attributes.hasOwnProperty(O.attribName)){O.attribName=O.attribValue="";return}if(O.opt.xmlns){var x=fe(O.attribName,!0),J=x.prefix,W=x.local;if(J==="xmlns")if(W==="xml"&&O.attribValue!==d)Q(O,"xml: prefix must be bound to "+d+`
Actual: `+O.attribValue);else if(W==="xmlns"&&O.attribValue!==h)Q(O,"xmlns: prefix must be bound to "+h+`
Actual: `+O.attribValue);else{var Re=O.tag,Qe=O.tags[O.tags.length-1]||O;Re.ns===Qe.ns&&(Re.ns=Object.create(Qe.ns)),Re.ns[W]=O.attribValue}O.attribList.push([O.attribName,O.attribValue])}else O.tag.attributes[O.attribName]=O.attribValue,I(O,"onattribute",{name:O.attribName,value:O.attribValue});O.attribName=O.attribValue=""}function Ke(O,x){if(O.opt.xmlns){var J=O.tag,W=fe(O.tagName);J.prefix=W.prefix,J.local=W.local,J.uri=J.ns[W.prefix]||"",J.prefix&&!J.uri&&(Q(O,"Unbound namespace prefix: "+JSON.stringify(O.tagName)),J.uri=W.prefix);var Re=O.tags[O.tags.length-1]||O;J.ns&&Re.ns!==J.ns&&Object.keys(J.ns).forEach(function(Wt){I(O,"onopennamespace",{prefix:Wt,uri:J.ns[Wt]})});for(var Qe=0,Ie=O.attribList.length;Qe<Ie;Qe++){var mt=O.attribList[Qe],Rt=mt[0],Xt=mt[1],lt=fe(Rt,!0),_t=lt.prefix,ln=lt.local,vt=_t===""?"":J.ns[_t]||"",Bt={name:Rt,value:Xt,prefix:_t,local:ln,uri:vt};_t&&_t!=="xmlns"&&!vt&&(Q(O,"Unbound namespace prefix: "+JSON.stringify(_t)),Bt.uri=_t),O.tag.attributes[Rt]=Bt,I(O,"onattribute",Bt)}O.attribList.length=0}O.tag.isSelfClosing=!!x,O.sawRoot=!0,O.tags.push(O.tag),I(O,"onopentag",O.tag),x||(!O.noscript&&O.tagName.toLowerCase()==="script"?O.state=b.SCRIPT:O.state=b.TEXT,O.tag=null,O.tagName=""),O.attribName=O.attribValue="",O.attribList.length=0}function gt(O){if(!O.tagName){Q(O,"Weird empty close tag."),O.textNode+="</>",O.state=b.TEXT;return}if(O.script){if(O.tagName!=="script"){O.script+="</"+O.tagName+">",O.tagName="",O.state=b.SCRIPT;return}I(O,"onscript",O.script),O.script=""}var x=O.tags.length,J=O.tagName;O.strict||(J=J[O.looseCase]());for(var W=J;x--;){var Re=O.tags[x];if(Re.name!==W)Q(O,"Unexpected close tag");else break}if(x<0){Q(O,"Unmatched closing tag: "+O.tagName),O.textNode+="</"+O.tagName+">",O.state=b.TEXT;return}O.tagName=J;for(var Qe=O.tags.length;Qe-- >x;){var Ie=O.tag=O.tags.pop();O.tagName=O.tag.name,I(O,"onclosetag",O.tagName);var mt={};for(var Rt in Ie.ns)mt[Rt]=Ie.ns[Rt];var Xt=O.tags[O.tags.length-1]||O;O.opt.xmlns&&Ie.ns!==Xt.ns&&Object.keys(Ie.ns).forEach(function(lt){var _t=Ie.ns[lt];I(O,"onclosenamespace",{prefix:lt,uri:_t})})}x===0&&(O.closedRoot=!0),O.tagName=O.attribValue=O.attribName="",O.attribList.length=0,O.state=b.TEXT}function Tt(O){var x=O.entity,J=x.toLowerCase(),W,Re="";return O.ENTITIES[x]?O.ENTITIES[x]:O.ENTITIES[J]?O.ENTITIES[J]:(x=J,x.charAt(0)==="#"&&(x.charAt(1)==="x"?(x=x.slice(2),W=parseInt(x,16),Re=W.toString(16)):(x=x.slice(1),W=parseInt(x,10),Re=W.toString(10))),x=x.replace(/^0+/,""),isNaN(W)||Re.toLowerCase()!==x?(Q(O,"Invalid character entity"),"&"+O.entity+";"):String.fromCodePoint(W))}function br(O,x){x==="<"?(O.state=b.OPEN_WAKA,O.startTagPosition=O.position):w(x)||(Q(O,"Non-whitespace before first tag."),O.textNode=x,O.state=b.TEXT)}function $t(O,x){var J="";return x<O.length&&(J=O.charAt(x)),J}function nr(O){var x=this;if(this.error)throw this.error;if(x.closed)return te(x,"Cannot write after close. Assign an onready handler.");if(O===null)return ue(x);typeof O=="object"&&(O=O.toString());for(var J=0,W="";W=$t(O,J++),x.c=W,!!W;)switch(x.trackPosition&&(x.position++,W===`
`?(x.line++,x.column=0):x.column++),x.state){case b.BEGIN:if(x.state=b.BEGIN_WHITESPACE,W==="\uFEFF")continue;br(x,W);continue;case b.BEGIN_WHITESPACE:br(x,W);continue;case b.TEXT:if(x.sawRoot&&!x.closedRoot){for(var Re=J-1;W&&W!=="<"&&W!=="&";)W=$t(O,J++),W&&x.trackPosition&&(x.position++,W===`
`?(x.line++,x.column=0):x.column++);x.textNode+=O.substring(Re,J-1)}W==="<"&&!(x.sawRoot&&x.closedRoot&&!x.strict)?(x.state=b.OPEN_WAKA,x.startTagPosition=x.position):(!w(W)&&(!x.sawRoot||x.closedRoot)&&Q(x,"Text data outside of root node."),W==="&"?x.state=b.TEXT_ENTITY:x.textNode+=W);continue;case b.SCRIPT:W==="<"?x.state=b.SCRIPT_ENDING:x.script+=W;continue;case b.SCRIPT_ENDING:W==="/"?x.state=b.CLOSE_TAG:(x.script+="<"+W,x.state=b.SCRIPT);continue;case b.OPEN_WAKA:if(W==="!")x.state=b.SGML_DECL,x.sgmlDecl="";else if(!w(W))if(g(D,W))x.state=b.OPEN_TAG,x.tagName=W;else if(W==="/")x.state=b.CLOSE_TAG,x.tagName="";else if(W==="?")x.state=b.PROC_INST,x.procInstName=x.procInstBody="";else{if(Q(x,"Unencoded <"),x.startTagPosition+1<x.position){var Qe=x.position-x.startTagPosition;W=new Array(Qe).join(" ")+W}x.textNode+="<"+W,x.state=b.TEXT}continue;case b.SGML_DECL:(x.sgmlDecl+W).toUpperCase()===l?(I(x,"onopencdata"),x.state=b.CDATA,x.sgmlDecl="",x.cdata=""):x.sgmlDecl+W==="--"?(x.state=b.COMMENT,x.comment="",x.sgmlDecl=""):(x.sgmlDecl+W).toUpperCase()===f?(x.state=b.DOCTYPE,(x.doctype||x.sawRoot)&&Q(x,"Inappropriately located doctype declaration"),x.doctype="",x.sgmlDecl=""):W===">"?(I(x,"onsgmldeclaration",x.sgmlDecl),x.sgmlDecl="",x.state=b.TEXT):(p(W)&&(x.state=b.SGML_DECL_QUOTED),x.sgmlDecl+=W);continue;case b.SGML_DECL_QUOTED:W===x.q&&(x.state=b.SGML_DECL,x.q=""),x.sgmlDecl+=W;continue;case b.DOCTYPE:W===">"?(x.state=b.TEXT,I(x,"ondoctype",x.doctype),x.doctype=!0):(x.doctype+=W,W==="["?x.state=b.DOCTYPE_DTD:p(W)&&(x.state=b.DOCTYPE_QUOTED,x.q=W));continue;case b.DOCTYPE_QUOTED:x.doctype+=W,W===x.q&&(x.q="",x.state=b.DOCTYPE);continue;case b.DOCTYPE_DTD:x.doctype+=W,W==="]"?x.state=b.DOCTYPE:p(W)&&(x.state=b.DOCTYPE_DTD_QUOTED,x.q=W);continue;case b.DOCTYPE_DTD_QUOTED:x.doctype+=W,W===x.q&&(x.state=b.DOCTYPE_DTD,x.q="");continue;case b.COMMENT:W==="-"?x.state=b.COMMENT_ENDING:x.comment+=W;continue;case b.COMMENT_ENDING:W==="-"?(x.state=b.COMMENT_ENDED,x.comment=z(x.opt,x.comment),x.comment&&I(x,"oncomment",x.comment),x.comment=""):(x.comment+="-"+W,x.state=b.COMMENT);continue;case b.COMMENT_ENDED:W!==">"?(Q(x,"Malformed comment"),x.comment+="--"+W,x.state=b.COMMENT):x.state=b.TEXT;continue;case b.CDATA:W==="]"?x.state=b.CDATA_ENDING:x.cdata+=W;continue;case b.CDATA_ENDING:W==="]"?x.state=b.CDATA_ENDING_2:(x.cdata+="]"+W,x.state=b.CDATA);continue;case b.CDATA_ENDING_2:W===">"?(x.cdata&&I(x,"oncdata",x.cdata),I(x,"onclosecdata"),x.cdata="",x.state=b.TEXT):W==="]"?x.cdata+="]":(x.cdata+="]]"+W,x.state=b.CDATA);continue;case b.PROC_INST:W==="?"?x.state=b.PROC_INST_ENDING:w(W)?x.state=b.PROC_INST_BODY:x.procInstName+=W;continue;case b.PROC_INST_BODY:if(!x.procInstBody&&w(W))continue;W==="?"?x.state=b.PROC_INST_ENDING:x.procInstBody+=W;continue;case b.PROC_INST_ENDING:W===">"?(I(x,"onprocessinginstruction",{name:x.procInstName,body:x.procInstBody}),x.procInstName=x.procInstBody="",x.state=b.TEXT):(x.procInstBody+="?"+W,x.state=b.PROC_INST_BODY);continue;case b.OPEN_TAG:g(_,W)?x.tagName+=W:(se(x),W===">"?Ke(x):W==="/"?x.state=b.OPEN_TAG_SLASH:(w(W)||Q(x,"Invalid character in tag name"),x.state=b.ATTRIB));continue;case b.OPEN_TAG_SLASH:W===">"?(Ke(x,!0),gt(x)):(Q(x,"Forward-slash in opening tag not followed by >"),x.state=b.ATTRIB);continue;case b.ATTRIB:if(w(W))continue;W===">"?Ke(x):W==="/"?x.state=b.OPEN_TAG_SLASH:g(D,W)?(x.attribName=W,x.attribValue="",x.state=b.ATTRIB_NAME):Q(x,"Invalid attribute name");continue;case b.ATTRIB_NAME:W==="="?x.state=b.ATTRIB_VALUE:W===">"?(Q(x,"Attribute without value"),x.attribValue=x.attribName,_e(x),Ke(x)):w(W)?x.state=b.ATTRIB_NAME_SAW_WHITE:g(_,W)?x.attribName+=W:Q(x,"Invalid attribute name");continue;case b.ATTRIB_NAME_SAW_WHITE:if(W==="=")x.state=b.ATTRIB_VALUE;else{if(w(W))continue;Q(x,"Attribute without value"),x.tag.attributes[x.attribName]="",x.attribValue="",I(x,"onattribute",{name:x.attribName,value:""}),x.attribName="",W===">"?Ke(x):g(D,W)?(x.attribName=W,x.state=b.ATTRIB_NAME):(Q(x,"Invalid attribute name"),x.state=b.ATTRIB)}continue;case b.ATTRIB_VALUE:if(w(W))continue;p(W)?(x.q=W,x.state=b.ATTRIB_VALUE_QUOTED):(Q(x,"Unquoted attribute value"),x.state=b.ATTRIB_VALUE_UNQUOTED,x.attribValue=W);continue;case b.ATTRIB_VALUE_QUOTED:if(W!==x.q){W==="&"?x.state=b.ATTRIB_VALUE_ENTITY_Q:x.attribValue+=W;continue}_e(x),x.q="",x.state=b.ATTRIB_VALUE_CLOSED;continue;case b.ATTRIB_VALUE_CLOSED:w(W)?x.state=b.ATTRIB:W===">"?Ke(x):W==="/"?x.state=b.OPEN_TAG_SLASH:g(D,W)?(Q(x,"No whitespace between attributes"),x.attribName=W,x.attribValue="",x.state=b.ATTRIB_NAME):Q(x,"Invalid attribute name");continue;case b.ATTRIB_VALUE_UNQUOTED:if(!v(W)){W==="&"?x.state=b.ATTRIB_VALUE_ENTITY_U:x.attribValue+=W;continue}_e(x),W===">"?Ke(x):x.state=b.ATTRIB;continue;case b.CLOSE_TAG:if(x.tagName)W===">"?gt(x):g(_,W)?x.tagName+=W:x.script?(x.script+="</"+x.tagName,x.tagName="",x.state=b.SCRIPT):(w(W)||Q(x,"Invalid tagname in closing tag"),x.state=b.CLOSE_TAG_SAW_WHITE);else{if(w(W))continue;k(D,W)?x.script?(x.script+="</"+W,x.state=b.SCRIPT):Q(x,"Invalid tagname in closing tag."):x.tagName=W}continue;case b.CLOSE_TAG_SAW_WHITE:if(w(W))continue;W===">"?gt(x):Q(x,"Invalid characters in closing tag");continue;case b.TEXT_ENTITY:case b.ATTRIB_VALUE_ENTITY_Q:case b.ATTRIB_VALUE_ENTITY_U:var Ie,mt;switch(x.state){case b.TEXT_ENTITY:Ie=b.TEXT,mt="textNode";break;case b.ATTRIB_VALUE_ENTITY_Q:Ie=b.ATTRIB_VALUE_QUOTED,mt="attribValue";break;case b.ATTRIB_VALUE_ENTITY_U:Ie=b.ATTRIB_VALUE_UNQUOTED,mt="attribValue";break}W===";"?(x[mt]+=Tt(x),x.entity="",x.state=Ie):g(x.entity.length?N:R,W)?x.entity+=W:(Q(x,"Invalid character in entity name"),x[mt]+="&"+x.entity+W,x.entity="",x.state=Ie);continue;default:throw new Error(x,"Unknown state: "+x.state)}return x.position>=x.bufferCheckPosition&&n(x),x}String.fromCodePoint||function(){var O=String.fromCharCode,x=Math.floor,J=function(){var W=16384,Re=[],Qe,Ie,mt=-1,Rt=arguments.length;if(!Rt)return"";for(var Xt="";++mt<Rt;){var lt=Number(arguments[mt]);if(!isFinite(lt)||lt<0||lt>1114111||x(lt)!==lt)throw RangeError("Invalid code point: "+lt);lt<=65535?Re.push(lt):(lt-=65536,Qe=(lt>>10)+55296,Ie=lt%1024+56320,Re.push(Qe,Ie)),(mt+1===Rt||Re.length>W)&&(Xt+=O.apply(null,Re),Re.length=0)}return Xt};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:J,configurable:!0,writable:!0}):String.fromCodePoint=J}()})(typeof gl>"u"?gl.sax={}:gl)});var uE=L(jh=>{(function(){"use strict";jh.stripBOM=function(r){return r[0]==="\uFEFF"?r.substring(1):r}}).call(jh)});var Uh=L(ks=>{(function(){"use strict";var r;r=new RegExp(/(?!xmlns)^.*:/),ks.normalize=function(e){return e.toLowerCase()},ks.firstCharLowerCase=function(e){return e.charAt(0).toLowerCase()+e.slice(1)},ks.stripPrefix=function(e){return e.replace(r,"")},ks.parseNumbers=function(e){return isNaN(e)||(e=e%1===0?parseInt(e,10):parseFloat(e)),e},ks.parseBooleans=function(e){return/^(?:true|false)$/i.test(e)&&(e=e.toLowerCase()==="true"),e}}).call(ks)});var cE=L(fi=>{(function(){"use strict";var r,e,t,n,i,s,o,a,u,c=function(d,h){return function(){return d.apply(h,arguments)}},l=function(d,h){for(var m in h)f.call(h,m)&&(d[m]=h[m]);function D(){this.constructor=d}return D.prototype=h.prototype,d.prototype=new D,d.__super__=h.prototype,d},f={}.hasOwnProperty;a=aE(),n=require("events"),r=uE(),o=Uh(),u=require("timers").setImmediate,e=el().defaults,i=function(d){return typeof d=="object"&&d!=null&&Object.keys(d).length===0},s=function(d,h,m){var D,_,R;for(D=0,_=d.length;D<_;D++)R=d[D],h=R(h,m);return h},t=function(d,h,m){var D;return D=Object.create(null),D.value=m,D.writable=!0,D.enumerable=!0,D.configurable=!0,Object.defineProperty(d,h,D)},fi.Parser=function(d){l(h,d);function h(m){this.parseStringPromise=c(this.parseStringPromise,this),this.parseString=c(this.parseString,this),this.reset=c(this.reset,this),this.assignOrPush=c(this.assignOrPush,this),this.processAsync=c(this.processAsync,this);var D,_,R;if(!(this instanceof fi.Parser))return new fi.Parser(m);this.options={},_=e["0.2"];for(D in _)f.call(_,D)&&(R=_[D],this.options[D]=R);for(D in m)f.call(m,D)&&(R=m[D],this.options[D]=R);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(o.normalize)),this.reset()}return h.prototype.processAsync=function(){var m,D;try{return this.remaining.length<=this.options.chunkSize?(m=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(m),this.saxParser.close()):(m=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(m),u(this.processAsync))}catch(_){if(D=_,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(D)}},h.prototype.assignOrPush=function(m,D,_){return D in m?(m[D]instanceof Array||t(m,D,[m[D]]),m[D].push(_)):this.options.explicitArray?t(m,D,[_]):t(m,D,_)},h.prototype.reset=function(){var m,D,_,R;return this.removeAllListeners(),this.saxParser=a.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(N){return function(w){if(N.saxParser.resume(),!N.saxParser.errThrown)return N.saxParser.errThrown=!0,N.emit("error",w)}}(this),this.saxParser.onend=function(N){return function(){if(!N.saxParser.ended)return N.saxParser.ended=!0,N.emit("end",N.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,R=[],m=this.options.attrkey,D=this.options.charkey,this.saxParser.onopentag=function(N){return function(w){var p,v,g,k,b;if(g={},g[D]="",!N.options.ignoreAttrs){b=w.attributes;for(p in b)f.call(b,p)&&(!(m in g)&&!N.options.mergeAttrs&&(g[m]={}),v=N.options.attrValueProcessors?s(N.options.attrValueProcessors,w.attributes[p],p):w.attributes[p],k=N.options.attrNameProcessors?s(N.options.attrNameProcessors,p):p,N.options.mergeAttrs?N.assignOrPush(g,k,v):t(g[m],k,v))}return g["#name"]=N.options.tagNameProcessors?s(N.options.tagNameProcessors,w.name):w.name,N.options.xmlns&&(g[N.options.xmlnskey]={uri:w.uri,local:w.local}),R.push(g)}}(this),this.saxParser.onclosetag=function(N){return function(){var w,p,v,g,k,b,C,E,I,B;if(b=R.pop(),k=b["#name"],(!N.options.explicitChildren||!N.options.preserveChildrenOrder)&&delete b["#name"],b.cdata===!0&&(w=b.cdata,delete b.cdata),I=R[R.length-1],b[D].match(/^\s*$/)&&!w?(p=b[D],delete b[D]):(N.options.trim&&(b[D]=b[D].trim()),N.options.normalize&&(b[D]=b[D].replace(/\s{2,}/g," ").trim()),b[D]=N.options.valueProcessors?s(N.options.valueProcessors,b[D],k):b[D],Object.keys(b).length===1&&D in b&&!N.EXPLICIT_CHARKEY&&(b=b[D])),i(b)&&(typeof N.options.emptyTag=="function"?b=N.options.emptyTag():b=N.options.emptyTag!==""?N.options.emptyTag:p),N.options.validator!=null&&(B="/"+function(){var z,te,ue;for(ue=[],z=0,te=R.length;z<te;z++)g=R[z],ue.push(g["#name"]);return ue}().concat(k).join("/"),function(){var z;try{return b=N.options.validator(B,I&&I[k],b)}catch(te){return z=te,N.emit("error",z)}}()),N.options.explicitChildren&&!N.options.mergeAttrs&&typeof b=="object"){if(!N.options.preserveChildrenOrder)g={},N.options.attrkey in b&&(g[N.options.attrkey]=b[N.options.attrkey],delete b[N.options.attrkey]),!N.options.charsAsChildren&&N.options.charkey in b&&(g[N.options.charkey]=b[N.options.charkey],delete b[N.options.charkey]),Object.getOwnPropertyNames(b).length>0&&(g[N.options.childkey]=b),b=g;else if(I){I[N.options.childkey]=I[N.options.childkey]||[],C={};for(v in b)f.call(b,v)&&t(C,v,b[v]);I[N.options.childkey].push(C),delete b["#name"],Object.keys(b).length===1&&D in b&&!N.EXPLICIT_CHARKEY&&(b=b[D])}}return R.length>0?N.assignOrPush(I,k,b):(N.options.explicitRoot&&(E=b,b={},t(b,k,E)),N.resultObject=b,N.saxParser.ended=!0,N.emit("end",N.resultObject))}}(this),_=function(N){return function(w){var p,v;if(v=R[R.length-1],v)return v[D]+=w,N.options.explicitChildren&&N.options.preserveChildrenOrder&&N.options.charsAsChildren&&(N.options.includeWhiteChars||w.replace(/\\n/g,"").trim()!=="")&&(v[N.options.childkey]=v[N.options.childkey]||[],p={"#name":"__text__"},p[D]=w,N.options.normalize&&(p[D]=p[D].replace(/\s{2,}/g," ").trim()),v[N.options.childkey].push(p)),v}}(this),this.saxParser.ontext=_,this.saxParser.oncdata=function(N){return function(w){var p;if(p=_(w),p)return p.cdata=!0}}(this)},h.prototype.parseString=function(m,D){var _;D!=null&&typeof D=="function"&&(this.on("end",function(R){return this.reset(),D(null,R)}),this.on("error",function(R){return this.reset(),D(R)}));try{return m=m.toString(),m.trim()===""?(this.emit("end",null),!0):(m=r.stripBOM(m),this.options.async?(this.remaining=m,u(this.processAsync),this.saxParser):this.saxParser.write(m).close())}catch(R){if(_=R,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw _}else return this.emit("error",_),this.saxParser.errThrown=!0}},h.prototype.parseStringPromise=function(m){return new Promise(function(D){return function(_,R){return D.parseString(m,function(N,w){return N?R(N):_(w)})}}(this))},h}(n),fi.parseString=function(d,h,m){var D,_,R;return m!=null?(typeof m=="function"&&(D=m),typeof h=="object"&&(_=h)):(typeof h=="function"&&(D=h),_={}),R=new fi.Parser(_),R.parseString(d,D)},fi.parseStringPromise=function(d,h){var m,D;return typeof h=="object"&&(m=h),D=new fi.Parser(m),D.parseStringPromise(d)}}).call(fi)});var lE=L(pi=>{(function(){"use strict";var r,e,t,n,i=function(o,a){for(var u in a)s.call(a,u)&&(o[u]=a[u]);function c(){this.constructor=o}return c.prototype=a.prototype,o.prototype=new c,o.__super__=a.prototype,o},s={}.hasOwnProperty;e=el(),r=oE(),t=cE(),n=Uh(),pi.defaults=e.defaults,pi.processors=n,pi.ValidationError=function(o){i(a,o);function a(u){this.message=u}return a}(Error),pi.Builder=r.Builder,pi.Parser=t.Parser,pi.parseString=t.parseString,pi.parseStringPromise=t.parseStringPromise}).call(pi)});var wE=L((u$,Vh)=>{var vE=require("fs"),JA=require("path"),ZA=vE.exists||JA.exists,Wh=function(r,e){var t=[],n;["end_of_record"].concat(r.split(`
`)).forEach(function(i){i=i.trim();var s=i.split(":"),o=[s.shift(),s.join(":")],a,u;switch(o[0].toUpperCase()){case"TN":n.title=o[1].trim();break;case"SF":n.file=o.slice(1).join(":").trim();break;case"FNF":n.functions.found=Number(o[1].trim());break;case"FNH":n.functions.hit=Number(o[1].trim());break;case"LF":n.lines.found=Number(o[1].trim());break;case"LH":n.lines.hit=Number(o[1].trim());break;case"DA":a=o[1].split(","),n.lines.details.push({line:Number(a[0]),hit:Number(a[1])});break;case"FN":u=o[1].split(","),n.functions.details.push({name:u[1],line:Number(u[0])});break;case"FNDA":u=o[1].split(","),n.functions.details.some(function(c,l){if(c.name===u[1]&&c.hit===void 0)return n.functions.details[l].hit=Number(u[0]),!0});break;case"BRDA":u=o[1].split(","),n.branches.details.push({line:Number(u[0]),block:Number(u[1]),branch:Number(u[2]),taken:u[3]==="-"?0:Number(u[3])});break;case"BRF":n.branches.found=Number(o[1]);break;case"BRH":n.branches.hit=Number(o[1]);break}i.indexOf("end_of_record")>-1&&(t.push(n),n={lines:{found:0,hit:0,details:[]},functions:{hit:0,found:0,details:[]},branches:{hit:0,found:0,details:[]}})}),t.shift(),t.length?e(null,t):e("Failed to parse string")},eN=function(r,e){ZA(r,function(t){if(!t)return Wh(r,e);vE.readFile(r,"utf8",function(n,i){Wh(i,e)})})};Vh.exports=eN;Vh.exports.source=Wh});var gn=L(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.asPromise=Nt.thenable=Nt.typedArray=Nt.stringArray=Nt.array=Nt.func=Nt.error=Nt.number=Nt.string=Nt.boolean=void 0;function rN(r){return r===!0||r===!1}Nt.boolean=rN;function EE(r){return typeof r=="string"||r instanceof String}Nt.string=EE;function nN(r){return typeof r=="number"||r instanceof Number}Nt.number=nN;function iN(r){return r instanceof Error}Nt.error=iN;function PE(r){return typeof r=="function"}Nt.func=PE;function xE(r){return Array.isArray(r)}Nt.array=xE;function sN(r){return xE(r)&&r.every(e=>EE(e))}Nt.stringArray=sN;function oN(r,e){return Array.isArray(r)&&r.every(e)}Nt.typedArray=oN;function kE(r){return r&&PE(r.then)}Nt.thenable=kE;function aN(r){return r instanceof Promise?r:kE(r)?new Promise((e,t)=>{r.then(n=>e(n),n=>t(n))}):Promise.resolve(r)}Nt.asPromise=aN});var Co=L(pr=>{"use strict";Object.defineProperty(pr,"__esModule",{value:!0});pr.stringArray=pr.array=pr.func=pr.error=pr.number=pr.string=pr.boolean=void 0;function uN(r){return r===!0||r===!1}pr.boolean=uN;function RE(r){return typeof r=="string"||r instanceof String}pr.string=RE;function cN(r){return typeof r=="number"||r instanceof Number}pr.number=cN;function lN(r){return r instanceof Error}pr.error=lN;function dN(r){return typeof r=="function"}pr.func=dN;function _E(r){return Array.isArray(r)}pr.array=_E;function fN(r){return _E(r)&&r.every(e=>RE(e))}pr.stringArray=fN});var vg=L(me=>{"use strict";Object.defineProperty(me,"__esModule",{value:!0});me.Message=me.NotificationType9=me.NotificationType8=me.NotificationType7=me.NotificationType6=me.NotificationType5=me.NotificationType4=me.NotificationType3=me.NotificationType2=me.NotificationType1=me.NotificationType0=me.NotificationType=me.RequestType9=me.RequestType8=me.RequestType7=me.RequestType6=me.RequestType5=me.RequestType4=me.RequestType3=me.RequestType2=me.RequestType1=me.RequestType=me.RequestType0=me.AbstractMessageSignature=me.ParameterStructures=me.ResponseError=me.ErrorCodes=void 0;var _s=Co(),Xh;(function(r){r.ParseError=-32700,r.InvalidRequest=-32600,r.MethodNotFound=-32601,r.InvalidParams=-32602,r.InternalError=-32603,r.jsonrpcReservedErrorRangeStart=-32099,r.serverErrorStart=-32099,r.MessageWriteError=-32099,r.MessageReadError=-32098,r.PendingResponseRejected=-32097,r.ConnectionInactive=-32096,r.ServerNotInitialized=-32002,r.UnknownErrorCode=-32001,r.jsonrpcReservedErrorRangeEnd=-32e3,r.serverErrorEnd=-32e3})(Xh||(me.ErrorCodes=Xh={}));var zh=class r extends Error{constructor(e,t,n){super(t),this.code=_s.number(e)?e:Xh.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,r.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};me.ResponseError=zh;var jr=class r{constructor(e){this.kind=e}static is(e){return e===r.auto||e===r.byName||e===r.byPosition}toString(){return this.kind}};me.ParameterStructures=jr;jr.auto=new jr("auto");jr.byPosition=new jr("byPosition");jr.byName=new jr("byName");var pt=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return jr.auto}};me.AbstractMessageSignature=pt;var Gh=class extends pt{constructor(e){super(e,0)}};me.RequestType0=Gh;var Qh=class extends pt{constructor(e,t=jr.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};me.RequestType=Qh;var Yh=class extends pt{constructor(e,t=jr.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};me.RequestType1=Yh;var Jh=class extends pt{constructor(e){super(e,2)}};me.RequestType2=Jh;var Zh=class extends pt{constructor(e){super(e,3)}};me.RequestType3=Zh;var eg=class extends pt{constructor(e){super(e,4)}};me.RequestType4=eg;var tg=class extends pt{constructor(e){super(e,5)}};me.RequestType5=tg;var rg=class extends pt{constructor(e){super(e,6)}};me.RequestType6=rg;var ng=class extends pt{constructor(e){super(e,7)}};me.RequestType7=ng;var ig=class extends pt{constructor(e){super(e,8)}};me.RequestType8=ig;var sg=class extends pt{constructor(e){super(e,9)}};me.RequestType9=sg;var og=class extends pt{constructor(e,t=jr.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};me.NotificationType=og;var ag=class extends pt{constructor(e){super(e,0)}};me.NotificationType0=ag;var ug=class extends pt{constructor(e,t=jr.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};me.NotificationType1=ug;var cg=class extends pt{constructor(e){super(e,2)}};me.NotificationType2=cg;var lg=class extends pt{constructor(e){super(e,3)}};me.NotificationType3=lg;var dg=class extends pt{constructor(e){super(e,4)}};me.NotificationType4=dg;var fg=class extends pt{constructor(e){super(e,5)}};me.NotificationType5=fg;var pg=class extends pt{constructor(e){super(e,6)}};me.NotificationType6=pg;var hg=class extends pt{constructor(e){super(e,7)}};me.NotificationType7=hg;var gg=class extends pt{constructor(e){super(e,8)}};me.NotificationType8=gg;var mg=class extends pt{constructor(e){super(e,9)}};me.NotificationType9=mg;var IE;(function(r){function e(i){let s=i;return s&&_s.string(s.method)&&(_s.string(s.id)||_s.number(s.id))}r.isRequest=e;function t(i){let s=i;return s&&_s.string(s.method)&&i.id===void 0}r.isNotification=t;function n(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(_s.string(s.id)||_s.number(s.id)||s.id===null)}r.isResponse=n})(IE||(me.Message=IE={}))});var yg=L(Xi=>{"use strict";var OE;Object.defineProperty(Xi,"__esModule",{value:!0});Xi.LRUCache=Xi.LinkedMap=Xi.Touch=void 0;var hr;(function(r){r.None=0,r.First=1,r.AsOld=r.First,r.Last=2,r.AsNew=r.Last})(hr||(Xi.Touch=hr={}));var El=class{constructor(){this[OE]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=hr.None){let n=this._map.get(e);if(n)return t!==hr.None&&this.touch(n,t),n.value}set(e,t,n=hr.None){let i=this._map.get(e);if(i)i.value=t,n!==hr.None&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case hr.None:this.addItemLast(i);break;case hr.First:this.addItemFirst(i);break;case hr.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return n}values(){let e=this._state,t=this._head,n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return n}entries(){let e=this._state,t=this._head,n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return n}[(OE=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==hr.First&&t!==hr.Last)){if(t===hr.First){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===hr.Last){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};Xi.LinkedMap=El;var wg=class extends El{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=hr.AsNew){return super.get(e,t)}peek(e){return super.get(e,hr.None)}set(e,t){return super.set(e,t,hr.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};Xi.LRUCache=wg});var NE=L(Pl=>{"use strict";Object.defineProperty(Pl,"__esModule",{value:!0});Pl.Disposable=void 0;var AE;(function(r){function e(t){return{dispose:t}}r.create=e})(AE||(Pl.Disposable=AE={}))});var zi=L(Dg=>{"use strict";Object.defineProperty(Dg,"__esModule",{value:!0});var bg;function Cg(){if(bg===void 0)throw new Error("No runtime abstraction layer installed");return bg}(function(r){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");bg=t}r.install=e})(Cg||(Cg={}));Dg.default=Cg});var To=L(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.Emitter=Do.Event=void 0;var pN=zi(),FE;(function(r){let e={dispose(){}};r.None=function(){return e}})(FE||(Do.Event=FE={}));var Tg=class{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else n=!0;if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],n=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,o=n.length;s<o;s++)try{t.push(n[s].apply(i[s],e))}catch(a){(0,pN.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},xl=class r{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new Tg),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Do.Emitter=xl;xl._noop=function(){}});var _l=L(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.CancellationTokenSource=So.CancellationToken=void 0;var hN=zi(),gN=Co(),Sg=To(),kl;(function(r){r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Sg.Event.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:Sg.Event.None});function e(t){let n=t;return n&&(n===r.None||n===r.Cancelled||gN.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}r.is=e})(kl||(So.CancellationToken=kl={}));var mN=Object.freeze(function(r,e){let t=(0,hN.default)().timer.setTimeout(r.bind(e),0);return{dispose(){t.dispose()}}}),Rl=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?mN:(this._emitter||(this._emitter=new Sg.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},Eg=class{get token(){return this._token||(this._token=new Rl),this._token}cancel(){this._token?this._token.cancel():this._token=kl.Cancelled}dispose(){this._token?this._token instanceof Rl&&this._token.dispose():this._token=kl.None}};So.CancellationTokenSource=Eg});var LE=L(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.SharedArrayReceiverStrategy=Eo.SharedArraySenderStrategy=void 0;var vN=_l(),Za;(function(r){r.Continue=0,r.Cancelled=1})(Za||(Za={}));var Pg=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),n=new Int32Array(t,0,1);n[0]=Za.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let n=this.buffers.get(t);if(n===void 0)return;let i=new Int32Array(n,0,1);Atomics.store(i,0,Za.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};Eo.SharedArraySenderStrategy=Pg;var xg=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Za.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},kg=class{constructor(e){this.token=new xg(e)}cancel(){}dispose(){}},Rg=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new vN.CancellationTokenSource:new kg(t)}};Eo.SharedArrayReceiverStrategy=Rg});var Ig=L(Il=>{"use strict";Object.defineProperty(Il,"__esModule",{value:!0});Il.Semaphore=void 0;var wN=zi(),_g=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,wN.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(n=>{this._active--,e.resolve(n),this.runNext()},n=>{this._active--,e.reject(n),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Il.Semaphore=_g});var qE=L(Gi=>{"use strict";Object.defineProperty(Gi,"__esModule",{value:!0});Gi.ReadableStreamMessageReader=Gi.AbstractMessageReader=Gi.MessageReader=void 0;var Ag=zi(),Po=Co(),Og=To(),yN=Ig(),ME;(function(r){function e(t){let n=t;return n&&Po.func(n.listen)&&Po.func(n.dispose)&&Po.func(n.onError)&&Po.func(n.onClose)&&Po.func(n.onPartialMessage)}r.is=e})(ME||(Gi.MessageReader=ME={}));var Ol=class{constructor(){this.errorEmitter=new Og.Emitter,this.closeEmitter=new Og.Emitter,this.partialMessageEmitter=new Og.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${Po.string(e.message)?e.message:"unknown"}`)}};Gi.AbstractMessageReader=Ol;var Ng;(function(r){function e(t){let n,i,s,o=new Map,a,u=new Map;if(t===void 0||typeof t=="string")n=t??"utf-8";else{if(n=t.charset??"utf-8",t.contentDecoder!==void 0&&(s=t.contentDecoder,o.set(s.name,s)),t.contentDecoders!==void 0)for(let c of t.contentDecoders)o.set(c.name,c);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,u.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let c of t.contentTypeDecoders)u.set(c.name,c)}return a===void 0&&(a=(0,Ag.default)().applicationJson.decoder,u.set(a.name,a)),{charset:n,contentDecoder:s,contentDecoders:o,contentTypeDecoder:a,contentTypeDecoders:u}}r.fromOptions=e})(Ng||(Ng={}));var Fg=class extends Ol{constructor(e,t){super(),this.readable=e,this.options=Ng.fromOptions(t),this.buffer=(0,Ag.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new yN.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(n=>{this.onData(n)});return this.readable.onError(n=>this.fireError(n)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let n=this.buffer.tryReadHeaders(!0);if(!n)return;let i=n.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(n))}`));return}let s=parseInt(i);if(isNaN(s)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let n=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(n,this.options);this.callback(i)}).catch(n=>{this.fireError(n)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Ag.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};Gi.ReadableStreamMessageReader=Fg});var WE=L(Qi=>{"use strict";Object.defineProperty(Qi,"__esModule",{value:!0});Qi.WriteableStreamMessageWriter=Qi.AbstractMessageWriter=Qi.MessageWriter=void 0;var jE=zi(),eu=Co(),bN=Ig(),UE=To(),CN="Content-Length: ",$E=`\r
`,BE;(function(r){function e(t){let n=t;return n&&eu.func(n.dispose)&&eu.func(n.onClose)&&eu.func(n.onError)&&eu.func(n.write)}r.is=e})(BE||(Qi.MessageWriter=BE={}));var Al=class{constructor(){this.errorEmitter=new UE.Emitter,this.closeEmitter=new UE.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${eu.string(e.message)?e.message:"unknown"}`)}};Qi.AbstractMessageWriter=Al;var Lg;(function(r){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,jE.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,jE.default)().applicationJson.encoder}}r.fromOptions=e})(Lg||(Lg={}));var Mg=class extends Al{constructor(e,t){super(),this.writable=e,this.options=Lg.fromOptions(t),this.errorCount=0,this.writeSemaphore=new bN.Semaphore(1),this.writable.onError(n=>this.fireError(n)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(n=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(n):n).then(n=>{let i=[];return i.push(CN,n.byteLength.toString(),$E),i.push($E),this.doWrite(e,i,n)},n=>{throw this.fireError(n),n}))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};Qi.WriteableStreamMessageWriter=Mg});var VE=L(Nl=>{"use strict";Object.defineProperty(Nl,"__esModule",{value:!0});Nl.AbstractMessageBuffer=void 0;var DN=13,TN=10,SN=`\r
`,qg=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,n=0,i=0,s=0;e:for(;n<this._chunks.length;){let c=this._chunks[n];for(i=0;i<c.length;){switch(c[i]){case DN:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case TN:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}s+=c.byteLength,n++}if(t!==4)return;let o=this._read(s+i),a=new Map,u=this.toString(o,"ascii").split(SN);if(u.length<2)return a;for(let c=0;c<u.length-2;c++){let l=u[c],f=l.indexOf(":");if(f===-1)throw new Error(`Message header must separate key and value using ':'
${l}`);let d=l.substr(0,f),h=l.substr(f+1).trim();a.set(e?d.toLowerCase():d,h)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(s)}if(this._chunks[0].byteLength>e){let s=this._chunks[0],o=this.asNative(s,e);return this._chunks[0]=s.slice(e),this._totalLength-=e,o}let t=this.allocNative(e),n=0,i=0;for(;e>0;){let s=this._chunks[i];if(s.byteLength>e){let o=s.slice(0,e);t.set(o,n),n+=e,this._chunks[i]=s.slice(e),this._totalLength-=e,e-=e}else t.set(s,n),n+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,e-=s.byteLength}return t}};Nl.AbstractMessageBuffer=qg});var GE=L(Se=>{"use strict";Object.defineProperty(Se,"__esModule",{value:!0});Se.createMessageConnection=Se.ConnectionOptions=Se.MessageStrategy=Se.CancellationStrategy=Se.CancellationSenderStrategy=Se.CancellationReceiverStrategy=Se.RequestCancellationReceiverStrategy=Se.IdCancellationReceiverStrategy=Se.ConnectionStrategy=Se.ConnectionError=Se.ConnectionErrors=Se.LogTraceNotification=Se.SetTraceNotification=Se.TraceFormat=Se.TraceValues=Se.Trace=Se.NullLogger=Se.ProgressType=Se.ProgressToken=void 0;var HE=zi(),St=Co(),we=vg(),KE=yg(),tu=To(),jg=_l(),iu;(function(r){r.type=new we.NotificationType("$/cancelRequest")})(iu||(iu={}));var Ug;(function(r){function e(t){return typeof t=="string"||typeof t=="number"}r.is=e})(Ug||(Se.ProgressToken=Ug={}));var ru;(function(r){r.type=new we.NotificationType("$/progress")})(ru||(ru={}));var $g=class{constructor(){}};Se.ProgressType=$g;var Bg;(function(r){function e(t){return St.func(t)}r.is=e})(Bg||(Bg={}));Se.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var Xe;(function(r){r[r.Off=0]="Off",r[r.Messages=1]="Messages",r[r.Compact=2]="Compact",r[r.Verbose=3]="Verbose"})(Xe||(Se.Trace=Xe={}));var XE;(function(r){r.Off="off",r.Messages="messages",r.Compact="compact",r.Verbose="verbose"})(XE||(Se.TraceValues=XE={}));(function(r){function e(n){if(!St.string(n))return r.Off;switch(n=n.toLowerCase(),n){case"off":return r.Off;case"messages":return r.Messages;case"compact":return r.Compact;case"verbose":return r.Verbose;default:return r.Off}}r.fromString=e;function t(n){switch(n){case r.Off:return"off";case r.Messages:return"messages";case r.Compact:return"compact";case r.Verbose:return"verbose";default:return"off"}}r.toString=t})(Xe||(Se.Trace=Xe={}));var Zr;(function(r){r.Text="text",r.JSON="json"})(Zr||(Se.TraceFormat=Zr={}));(function(r){function e(t){return St.string(t)?(t=t.toLowerCase(),t==="json"?r.JSON:r.Text):r.Text}r.fromString=e})(Zr||(Se.TraceFormat=Zr={}));var Wg;(function(r){r.type=new we.NotificationType("$/setTrace")})(Wg||(Se.SetTraceNotification=Wg={}));var Fl;(function(r){r.type=new we.NotificationType("$/logTrace")})(Fl||(Se.LogTraceNotification=Fl={}));var nu;(function(r){r[r.Closed=1]="Closed",r[r.Disposed=2]="Disposed",r[r.AlreadyListening=3]="AlreadyListening"})(nu||(Se.ConnectionErrors=nu={}));var xo=class r extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,r.prototype)}};Se.ConnectionError=xo;var Vg;(function(r){function e(t){let n=t;return n&&St.func(n.cancelUndispatched)}r.is=e})(Vg||(Se.ConnectionStrategy=Vg={}));var Ll;(function(r){function e(t){let n=t;return n&&(n.kind===void 0||n.kind==="id")&&St.func(n.createCancellationTokenSource)&&(n.dispose===void 0||St.func(n.dispose))}r.is=e})(Ll||(Se.IdCancellationReceiverStrategy=Ll={}));var Hg;(function(r){function e(t){let n=t;return n&&n.kind==="request"&&St.func(n.createCancellationTokenSource)&&(n.dispose===void 0||St.func(n.dispose))}r.is=e})(Hg||(Se.RequestCancellationReceiverStrategy=Hg={}));var Ml;(function(r){r.Message=Object.freeze({createCancellationTokenSource(t){return new jg.CancellationTokenSource}});function e(t){return Ll.is(t)||Hg.is(t)}r.is=e})(Ml||(Se.CancellationReceiverStrategy=Ml={}));var ql;(function(r){r.Message=Object.freeze({sendCancellation(t,n){return t.sendNotification(iu.type,{id:n})},cleanup(t){}});function e(t){let n=t;return n&&St.func(n.sendCancellation)&&St.func(n.cleanup)}r.is=e})(ql||(Se.CancellationSenderStrategy=ql={}));var jl;(function(r){r.Message=Object.freeze({receiver:Ml.Message,sender:ql.Message});function e(t){let n=t;return n&&Ml.is(n.receiver)&&ql.is(n.sender)}r.is=e})(jl||(Se.CancellationStrategy=jl={}));var Ul;(function(r){function e(t){let n=t;return n&&St.func(n.handleMessage)}r.is=e})(Ul||(Se.MessageStrategy=Ul={}));var zE;(function(r){function e(t){let n=t;return n&&(jl.is(n.cancellationStrategy)||Vg.is(n.connectionStrategy)||Ul.is(n.messageStrategy))}r.is=e})(zE||(Se.ConnectionOptions=zE={}));var kn;(function(r){r[r.New=1]="New",r[r.Listening=2]="Listening",r[r.Closed=3]="Closed",r[r.Disposed=4]="Disposed"})(kn||(kn={}));function EN(r,e,t,n){let i=t!==void 0?t:Se.NullLogger,s=0,o=0,a=0,u="2.0",c,l=new Map,f,d=new Map,h=new Map,m,D=new KE.LinkedMap,_=new Map,R=new Set,N=new Map,w=Xe.Off,p=Zr.Text,v,g=kn.New,k=new tu.Emitter,b=new tu.Emitter,C=new tu.Emitter,E=new tu.Emitter,I=new tu.Emitter,B=n&&n.cancellationStrategy?n.cancellationStrategy:jl.Message;function z(M){if(M===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+M.toString()}function te(M){return M===null?"res-unknown-"+(++a).toString():"res-"+M.toString()}function ue(){return"not-"+(++o).toString()}function Q(M,Y){we.Message.isRequest(Y)?M.set(z(Y.id),Y):we.Message.isResponse(Y)?M.set(te(Y.id),Y):M.set(ue(),Y)}function se(M){}function fe(){return g===kn.Listening}function _e(){return g===kn.Closed}function Ke(){return g===kn.Disposed}function gt(){(g===kn.New||g===kn.Listening)&&(g=kn.Closed,b.fire(void 0))}function Tt(M){k.fire([M,void 0,void 0])}function br(M){k.fire(M)}r.onClose(gt),r.onError(Tt),e.onClose(gt),e.onError(br);function $t(){m||D.size===0||(m=(0,HE.default)().timer.setImmediate(()=>{m=void 0,O()}))}function nr(M){we.Message.isRequest(M)?J(M):we.Message.isNotification(M)?Re(M):we.Message.isResponse(M)?W(M):Qe(M)}function O(){if(D.size===0)return;let M=D.shift();try{let Y=n?.messageStrategy;Ul.is(Y)?Y.handleMessage(M,nr):nr(M)}finally{$t()}}let x=M=>{try{if(we.Message.isNotification(M)&&M.method===iu.type.method){let Y=M.params.id,ie=z(Y),ae=D.get(ie);if(we.Message.isRequest(ae)){let Ue=n?.connectionStrategy,Ye=Ue&&Ue.cancelUndispatched?Ue.cancelUndispatched(ae,se):void 0;if(Ye&&(Ye.error!==void 0||Ye.result!==void 0)){D.delete(ie),N.delete(Y),Ye.id=ae.id,Xt(Ye,M.method,Date.now()),e.write(Ye).catch(()=>i.error("Sending response for canceled message failed."));return}}let Be=N.get(Y);if(Be!==void 0){Be.cancel(),_t(M);return}else R.add(Y)}Q(D,M)}finally{$t()}};function J(M){if(Ke())return;function Y(xe,Ve,Fe){let ot={jsonrpc:u,id:M.id};xe instanceof we.ResponseError?ot.error=xe.toJson():ot.result=xe===void 0?null:xe,Xt(ot,Ve,Fe),e.write(ot).catch(()=>i.error("Sending response failed."))}function ie(xe,Ve,Fe){let ot={jsonrpc:u,id:M.id,error:xe.toJson()};Xt(ot,Ve,Fe),e.write(ot).catch(()=>i.error("Sending response failed."))}function ae(xe,Ve,Fe){xe===void 0&&(xe=null);let ot={jsonrpc:u,id:M.id,result:xe};Xt(ot,Ve,Fe),e.write(ot).catch(()=>i.error("Sending response failed."))}lt(M);let Be=l.get(M.method),Ue,Ye;Be&&(Ue=Be.type,Ye=Be.handler);let st=Date.now();if(Ye||c){let xe=M.id??String(Date.now()),Ve=Ll.is(B.receiver)?B.receiver.createCancellationTokenSource(xe):B.receiver.createCancellationTokenSource(M);M.id!==null&&R.has(M.id)&&Ve.cancel(),M.id!==null&&N.set(xe,Ve);try{let Fe;if(Ye)if(M.params===void 0){if(Ue!==void 0&&Ue.numberOfParams!==0){ie(new we.ResponseError(we.ErrorCodes.InvalidParams,`Request ${M.method} defines ${Ue.numberOfParams} params but received none.`),M.method,st);return}Fe=Ye(Ve.token)}else if(Array.isArray(M.params)){if(Ue!==void 0&&Ue.parameterStructures===we.ParameterStructures.byName){ie(new we.ResponseError(we.ErrorCodes.InvalidParams,`Request ${M.method} defines parameters by name but received parameters by position`),M.method,st);return}Fe=Ye(...M.params,Ve.token)}else{if(Ue!==void 0&&Ue.parameterStructures===we.ParameterStructures.byPosition){ie(new we.ResponseError(we.ErrorCodes.InvalidParams,`Request ${M.method} defines parameters by position but received parameters by name`),M.method,st);return}Fe=Ye(M.params,Ve.token)}else c&&(Fe=c(M.method,M.params,Ve.token));let ot=Fe;Fe?ot.then?ot.then(It=>{N.delete(xe),Y(It,M.method,st)},It=>{N.delete(xe),It instanceof we.ResponseError?ie(It,M.method,st):It&&St.string(It.message)?ie(new we.ResponseError(we.ErrorCodes.InternalError,`Request ${M.method} failed with message: ${It.message}`),M.method,st):ie(new we.ResponseError(we.ErrorCodes.InternalError,`Request ${M.method} failed unexpectedly without providing any details.`),M.method,st)}):(N.delete(xe),Y(Fe,M.method,st)):(N.delete(xe),ae(Fe,M.method,st))}catch(Fe){N.delete(xe),Fe instanceof we.ResponseError?Y(Fe,M.method,st):Fe&&St.string(Fe.message)?ie(new we.ResponseError(we.ErrorCodes.InternalError,`Request ${M.method} failed with message: ${Fe.message}`),M.method,st):ie(new we.ResponseError(we.ErrorCodes.InternalError,`Request ${M.method} failed unexpectedly without providing any details.`),M.method,st)}}else ie(new we.ResponseError(we.ErrorCodes.MethodNotFound,`Unhandled method ${M.method}`),M.method,st)}function W(M){if(!Ke())if(M.id===null)M.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(M.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let Y=M.id,ie=_.get(Y);if(ln(M,ie),ie!==void 0){_.delete(Y);try{if(M.error){let ae=M.error;ie.reject(new we.ResponseError(ae.code,ae.message,ae.data))}else if(M.result!==void 0)ie.resolve(M.result);else throw new Error("Should never happen.")}catch(ae){ae.message?i.error(`Response handler '${ie.method}' failed with message: ${ae.message}`):i.error(`Response handler '${ie.method}' failed unexpectedly.`)}}}}function Re(M){if(Ke())return;let Y,ie;if(M.method===iu.type.method){let ae=M.params.id;R.delete(ae),_t(M);return}else{let ae=d.get(M.method);ae&&(ie=ae.handler,Y=ae.type)}if(ie||f)try{if(_t(M),ie)if(M.params===void 0)Y!==void 0&&Y.numberOfParams!==0&&Y.parameterStructures!==we.ParameterStructures.byName&&i.error(`Notification ${M.method} defines ${Y.numberOfParams} params but received none.`),ie();else if(Array.isArray(M.params)){let ae=M.params;M.method===ru.type.method&&ae.length===2&&Ug.is(ae[0])?ie({token:ae[0],value:ae[1]}):(Y!==void 0&&(Y.parameterStructures===we.ParameterStructures.byName&&i.error(`Notification ${M.method} defines parameters by name but received parameters by position`),Y.numberOfParams!==M.params.length&&i.error(`Notification ${M.method} defines ${Y.numberOfParams} params but received ${ae.length} arguments`)),ie(...ae))}else Y!==void 0&&Y.parameterStructures===we.ParameterStructures.byPosition&&i.error(`Notification ${M.method} defines parameters by position but received parameters by name`),ie(M.params);else f&&f(M.method,M.params)}catch(ae){ae.message?i.error(`Notification handler '${M.method}' failed with message: ${ae.message}`):i.error(`Notification handler '${M.method}' failed unexpectedly.`)}else C.fire(M)}function Qe(M){if(!M){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(M,null,4)}`);let Y=M;if(St.string(Y.id)||St.number(Y.id)){let ie=Y.id,ae=_.get(ie);ae&&ae.reject(new Error("The received response has neither a result nor an error property."))}}function Ie(M){if(M!=null)switch(w){case Xe.Verbose:return JSON.stringify(M,null,4);case Xe.Compact:return JSON.stringify(M);default:return}}function mt(M){if(!(w===Xe.Off||!v))if(p===Zr.Text){let Y;(w===Xe.Verbose||w===Xe.Compact)&&M.params&&(Y=`Params: ${Ie(M.params)}

`),v.log(`Sending request '${M.method} - (${M.id})'.`,Y)}else vt("send-request",M)}function Rt(M){if(!(w===Xe.Off||!v))if(p===Zr.Text){let Y;(w===Xe.Verbose||w===Xe.Compact)&&(M.params?Y=`Params: ${Ie(M.params)}

`:Y=`No parameters provided.

`),v.log(`Sending notification '${M.method}'.`,Y)}else vt("send-notification",M)}function Xt(M,Y,ie){if(!(w===Xe.Off||!v))if(p===Zr.Text){let ae;(w===Xe.Verbose||w===Xe.Compact)&&(M.error&&M.error.data?ae=`Error data: ${Ie(M.error.data)}

`:M.result?ae=`Result: ${Ie(M.result)}

`:M.error===void 0&&(ae=`No result returned.

`)),v.log(`Sending response '${Y} - (${M.id})'. Processing request took ${Date.now()-ie}ms`,ae)}else vt("send-response",M)}function lt(M){if(!(w===Xe.Off||!v))if(p===Zr.Text){let Y;(w===Xe.Verbose||w===Xe.Compact)&&M.params&&(Y=`Params: ${Ie(M.params)}

`),v.log(`Received request '${M.method} - (${M.id})'.`,Y)}else vt("receive-request",M)}function _t(M){if(!(w===Xe.Off||!v||M.method===Fl.type.method))if(p===Zr.Text){let Y;(w===Xe.Verbose||w===Xe.Compact)&&(M.params?Y=`Params: ${Ie(M.params)}

`:Y=`No parameters provided.

`),v.log(`Received notification '${M.method}'.`,Y)}else vt("receive-notification",M)}function ln(M,Y){if(!(w===Xe.Off||!v))if(p===Zr.Text){let ie;if((w===Xe.Verbose||w===Xe.Compact)&&(M.error&&M.error.data?ie=`Error data: ${Ie(M.error.data)}

`:M.result?ie=`Result: ${Ie(M.result)}

`:M.error===void 0&&(ie=`No result returned.

`)),Y){let ae=M.error?` Request failed: ${M.error.message} (${M.error.code}).`:"";v.log(`Received response '${Y.method} - (${M.id})' in ${Date.now()-Y.timerStart}ms.${ae}`,ie)}else v.log(`Received response ${M.id} without active response promise.`,ie)}else vt("receive-response",M)}function vt(M,Y){if(!v||w===Xe.Off)return;let ie={isLSPMessage:!0,type:M,message:Y,timestamp:Date.now()};v.log(ie)}function Bt(){if(_e())throw new xo(nu.Closed,"Connection is closed.");if(Ke())throw new xo(nu.Disposed,"Connection is disposed.")}function Wt(){if(fe())throw new xo(nu.AlreadyListening,"Connection is already listening")}function zr(){if(!fe())throw new Error("Call listen() first.")}function Ir(M){return M===void 0?null:M}function Nn(M){if(M!==null)return M}function ii(M){return M!=null&&!Array.isArray(M)&&typeof M=="object"}function Tn(M,Y){switch(M){case we.ParameterStructures.auto:return ii(Y)?Nn(Y):[Ir(Y)];case we.ParameterStructures.byName:if(!ii(Y))throw new Error("Received parameters by name but param is not an object literal.");return Nn(Y);case we.ParameterStructures.byPosition:return[Ir(Y)];default:throw new Error(`Unknown parameter structure ${M.toString()}`)}}function si(M,Y){let ie,ae=M.numberOfParams;switch(ae){case 0:ie=void 0;break;case 1:ie=Tn(M.parameterStructures,Y[0]);break;default:ie=[];for(let Be=0;Be<Y.length&&Be<ae;Be++)ie.push(Ir(Y[Be]));if(Y.length<ae)for(let Be=Y.length;Be<ae;Be++)ie.push(null);break}return ie}let Cr={sendNotification:(M,...Y)=>{Bt();let ie,ae;if(St.string(M)){ie=M;let Ue=Y[0],Ye=0,st=we.ParameterStructures.auto;we.ParameterStructures.is(Ue)&&(Ye=1,st=Ue);let xe=Y.length,Ve=xe-Ye;switch(Ve){case 0:ae=void 0;break;case 1:ae=Tn(st,Y[Ye]);break;default:if(st===we.ParameterStructures.byName)throw new Error(`Received ${Ve} parameters for 'by Name' notification parameter structure.`);ae=Y.slice(Ye,xe).map(Fe=>Ir(Fe));break}}else{let Ue=Y;ie=M.method,ae=si(M,Ue)}let Be={jsonrpc:u,method:ie,params:ae};return Rt(Be),e.write(Be).catch(Ue=>{throw i.error("Sending notification failed."),Ue})},onNotification:(M,Y)=>{Bt();let ie;return St.func(M)?f=M:Y&&(St.string(M)?(ie=M,d.set(M,{type:void 0,handler:Y})):(ie=M.method,d.set(M.method,{type:M,handler:Y}))),{dispose:()=>{ie!==void 0?d.delete(ie):f=void 0}}},onProgress:(M,Y,ie)=>{if(h.has(Y))throw new Error(`Progress handler for token ${Y} already registered`);return h.set(Y,ie),{dispose:()=>{h.delete(Y)}}},sendProgress:(M,Y,ie)=>Cr.sendNotification(ru.type,{token:Y,value:ie}),onUnhandledProgress:E.event,sendRequest:(M,...Y)=>{Bt(),zr();let ie,ae,Be;if(St.string(M)){ie=M;let xe=Y[0],Ve=Y[Y.length-1],Fe=0,ot=we.ParameterStructures.auto;we.ParameterStructures.is(xe)&&(Fe=1,ot=xe);let It=Y.length;jg.CancellationToken.is(Ve)&&(It=It-1,Be=Ve);let Yt=It-Fe;switch(Yt){case 0:ae=void 0;break;case 1:ae=Tn(ot,Y[Fe]);break;default:if(ot===we.ParameterStructures.byName)throw new Error(`Received ${Yt} parameters for 'by Name' request parameter structure.`);ae=Y.slice(Fe,It).map(ki=>Ir(ki));break}}else{let xe=Y;ie=M.method,ae=si(M,xe);let Ve=M.numberOfParams;Be=jg.CancellationToken.is(xe[Ve])?xe[Ve]:void 0}let Ue=s++,Ye;Be&&(Ye=Be.onCancellationRequested(()=>{let xe=B.sender.sendCancellation(Cr,Ue);return xe===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${Ue}`),Promise.resolve()):xe.catch(()=>{i.log(`Sending cancellation messages for id ${Ue} failed`)})}));let st={jsonrpc:u,id:Ue,method:ie,params:ae};return mt(st),typeof B.sender.enableCancellation=="function"&&B.sender.enableCancellation(st),new Promise(async(xe,Ve)=>{let Fe=Yt=>{xe(Yt),B.sender.cleanup(Ue),Ye?.dispose()},ot=Yt=>{Ve(Yt),B.sender.cleanup(Ue),Ye?.dispose()},It={method:ie,timerStart:Date.now(),resolve:Fe,reject:ot};try{await e.write(st),_.set(Ue,It)}catch(Yt){throw i.error("Sending request failed."),It.reject(new we.ResponseError(we.ErrorCodes.MessageWriteError,Yt.message?Yt.message:"Unknown reason")),Yt}})},onRequest:(M,Y)=>{Bt();let ie=null;return Bg.is(M)?(ie=void 0,c=M):St.string(M)?(ie=null,Y!==void 0&&(ie=M,l.set(M,{handler:Y,type:void 0}))):Y!==void 0&&(ie=M.method,l.set(M.method,{type:M,handler:Y})),{dispose:()=>{ie!==null&&(ie!==void 0?l.delete(ie):c=void 0)}}},hasPendingResponse:()=>_.size>0,trace:async(M,Y,ie)=>{let ae=!1,Be=Zr.Text;ie!==void 0&&(St.boolean(ie)?ae=ie:(ae=ie.sendNotification||!1,Be=ie.traceFormat||Zr.Text)),w=M,p=Be,w===Xe.Off?v=void 0:v=Y,ae&&!_e()&&!Ke()&&await Cr.sendNotification(Wg.type,{value:Xe.toString(M)})},onError:k.event,onClose:b.event,onUnhandledNotification:C.event,onDispose:I.event,end:()=>{e.end()},dispose:()=>{if(Ke())return;g=kn.Disposed,I.fire(void 0);let M=new we.ResponseError(we.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let Y of _.values())Y.reject(M);_=new Map,N=new Map,R=new Set,D=new KE.LinkedMap,St.func(e.dispose)&&e.dispose(),St.func(r.dispose)&&r.dispose()},listen:()=>{Bt(),Wt(),g=kn.Listening,r.listen(x)},inspect:()=>{(0,HE.default)().console.log("inspect")}};return Cr.onNotification(Fl.type,M=>{if(w===Xe.Off||!v)return;let Y=w===Xe.Verbose||w===Xe.Compact;v.log(M.message,Y?M.verbose:void 0)}),Cr.onNotification(ru.type,M=>{let Y=h.get(M.token);Y?Y(M.value):E.fire(M)}),Cr}Se.createMessageConnection=EN});var $l=L(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});G.ProgressType=G.ProgressToken=G.createMessageConnection=G.NullLogger=G.ConnectionOptions=G.ConnectionStrategy=G.AbstractMessageBuffer=G.WriteableStreamMessageWriter=G.AbstractMessageWriter=G.MessageWriter=G.ReadableStreamMessageReader=G.AbstractMessageReader=G.MessageReader=G.SharedArrayReceiverStrategy=G.SharedArraySenderStrategy=G.CancellationToken=G.CancellationTokenSource=G.Emitter=G.Event=G.Disposable=G.LRUCache=G.Touch=G.LinkedMap=G.ParameterStructures=G.NotificationType9=G.NotificationType8=G.NotificationType7=G.NotificationType6=G.NotificationType5=G.NotificationType4=G.NotificationType3=G.NotificationType2=G.NotificationType1=G.NotificationType0=G.NotificationType=G.ErrorCodes=G.ResponseError=G.RequestType9=G.RequestType8=G.RequestType7=G.RequestType6=G.RequestType5=G.RequestType4=G.RequestType3=G.RequestType2=G.RequestType1=G.RequestType0=G.RequestType=G.Message=G.RAL=void 0;G.MessageStrategy=G.CancellationStrategy=G.CancellationSenderStrategy=G.CancellationReceiverStrategy=G.ConnectionError=G.ConnectionErrors=G.LogTraceNotification=G.SetTraceNotification=G.TraceFormat=G.TraceValues=G.Trace=void 0;var dt=vg();Object.defineProperty(G,"Message",{enumerable:!0,get:function(){return dt.Message}});Object.defineProperty(G,"RequestType",{enumerable:!0,get:function(){return dt.RequestType}});Object.defineProperty(G,"RequestType0",{enumerable:!0,get:function(){return dt.RequestType0}});Object.defineProperty(G,"RequestType1",{enumerable:!0,get:function(){return dt.RequestType1}});Object.defineProperty(G,"RequestType2",{enumerable:!0,get:function(){return dt.RequestType2}});Object.defineProperty(G,"RequestType3",{enumerable:!0,get:function(){return dt.RequestType3}});Object.defineProperty(G,"RequestType4",{enumerable:!0,get:function(){return dt.RequestType4}});Object.defineProperty(G,"RequestType5",{enumerable:!0,get:function(){return dt.RequestType5}});Object.defineProperty(G,"RequestType6",{enumerable:!0,get:function(){return dt.RequestType6}});Object.defineProperty(G,"RequestType7",{enumerable:!0,get:function(){return dt.RequestType7}});Object.defineProperty(G,"RequestType8",{enumerable:!0,get:function(){return dt.RequestType8}});Object.defineProperty(G,"RequestType9",{enumerable:!0,get:function(){return dt.RequestType9}});Object.defineProperty(G,"ResponseError",{enumerable:!0,get:function(){return dt.ResponseError}});Object.defineProperty(G,"ErrorCodes",{enumerable:!0,get:function(){return dt.ErrorCodes}});Object.defineProperty(G,"NotificationType",{enumerable:!0,get:function(){return dt.NotificationType}});Object.defineProperty(G,"NotificationType0",{enumerable:!0,get:function(){return dt.NotificationType0}});Object.defineProperty(G,"NotificationType1",{enumerable:!0,get:function(){return dt.NotificationType1}});Object.defineProperty(G,"NotificationType2",{enumerable:!0,get:function(){return dt.NotificationType2}});Object.defineProperty(G,"NotificationType3",{enumerable:!0,get:function(){return dt.NotificationType3}});Object.defineProperty(G,"NotificationType4",{enumerable:!0,get:function(){return dt.NotificationType4}});Object.defineProperty(G,"NotificationType5",{enumerable:!0,get:function(){return dt.NotificationType5}});Object.defineProperty(G,"NotificationType6",{enumerable:!0,get:function(){return dt.NotificationType6}});Object.defineProperty(G,"NotificationType7",{enumerable:!0,get:function(){return dt.NotificationType7}});Object.defineProperty(G,"NotificationType8",{enumerable:!0,get:function(){return dt.NotificationType8}});Object.defineProperty(G,"NotificationType9",{enumerable:!0,get:function(){return dt.NotificationType9}});Object.defineProperty(G,"ParameterStructures",{enumerable:!0,get:function(){return dt.ParameterStructures}});var Kg=yg();Object.defineProperty(G,"LinkedMap",{enumerable:!0,get:function(){return Kg.LinkedMap}});Object.defineProperty(G,"LRUCache",{enumerable:!0,get:function(){return Kg.LRUCache}});Object.defineProperty(G,"Touch",{enumerable:!0,get:function(){return Kg.Touch}});var PN=NE();Object.defineProperty(G,"Disposable",{enumerable:!0,get:function(){return PN.Disposable}});var QE=To();Object.defineProperty(G,"Event",{enumerable:!0,get:function(){return QE.Event}});Object.defineProperty(G,"Emitter",{enumerable:!0,get:function(){return QE.Emitter}});var YE=_l();Object.defineProperty(G,"CancellationTokenSource",{enumerable:!0,get:function(){return YE.CancellationTokenSource}});Object.defineProperty(G,"CancellationToken",{enumerable:!0,get:function(){return YE.CancellationToken}});var JE=LE();Object.defineProperty(G,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return JE.SharedArraySenderStrategy}});Object.defineProperty(G,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return JE.SharedArrayReceiverStrategy}});var Xg=qE();Object.defineProperty(G,"MessageReader",{enumerable:!0,get:function(){return Xg.MessageReader}});Object.defineProperty(G,"AbstractMessageReader",{enumerable:!0,get:function(){return Xg.AbstractMessageReader}});Object.defineProperty(G,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Xg.ReadableStreamMessageReader}});var zg=WE();Object.defineProperty(G,"MessageWriter",{enumerable:!0,get:function(){return zg.MessageWriter}});Object.defineProperty(G,"AbstractMessageWriter",{enumerable:!0,get:function(){return zg.AbstractMessageWriter}});Object.defineProperty(G,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return zg.WriteableStreamMessageWriter}});var xN=VE();Object.defineProperty(G,"AbstractMessageBuffer",{enumerable:!0,get:function(){return xN.AbstractMessageBuffer}});var or=GE();Object.defineProperty(G,"ConnectionStrategy",{enumerable:!0,get:function(){return or.ConnectionStrategy}});Object.defineProperty(G,"ConnectionOptions",{enumerable:!0,get:function(){return or.ConnectionOptions}});Object.defineProperty(G,"NullLogger",{enumerable:!0,get:function(){return or.NullLogger}});Object.defineProperty(G,"createMessageConnection",{enumerable:!0,get:function(){return or.createMessageConnection}});Object.defineProperty(G,"ProgressToken",{enumerable:!0,get:function(){return or.ProgressToken}});Object.defineProperty(G,"ProgressType",{enumerable:!0,get:function(){return or.ProgressType}});Object.defineProperty(G,"Trace",{enumerable:!0,get:function(){return or.Trace}});Object.defineProperty(G,"TraceValues",{enumerable:!0,get:function(){return or.TraceValues}});Object.defineProperty(G,"TraceFormat",{enumerable:!0,get:function(){return or.TraceFormat}});Object.defineProperty(G,"SetTraceNotification",{enumerable:!0,get:function(){return or.SetTraceNotification}});Object.defineProperty(G,"LogTraceNotification",{enumerable:!0,get:function(){return or.LogTraceNotification}});Object.defineProperty(G,"ConnectionErrors",{enumerable:!0,get:function(){return or.ConnectionErrors}});Object.defineProperty(G,"ConnectionError",{enumerable:!0,get:function(){return or.ConnectionError}});Object.defineProperty(G,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return or.CancellationReceiverStrategy}});Object.defineProperty(G,"CancellationSenderStrategy",{enumerable:!0,get:function(){return or.CancellationSenderStrategy}});Object.defineProperty(G,"CancellationStrategy",{enumerable:!0,get:function(){return or.CancellationStrategy}});Object.defineProperty(G,"MessageStrategy",{enumerable:!0,get:function(){return or.MessageStrategy}});var kN=zi();G.RAL=kN.default});var tP=L(Jg=>{"use strict";Object.defineProperty(Jg,"__esModule",{value:!0});var ZE=require("util"),gi=$l(),Bl=class r extends gi.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return r.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new ZE.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};Bl.emptyBuffer=Buffer.allocUnsafe(0);var Gg=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),gi.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),gi.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),gi.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),gi.Disposable.create(()=>this.stream.off("data",e))}},Qg=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),gi.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),gi.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),gi.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((n,i)=>{let s=o=>{o==null?n():i(o)};typeof e=="string"?this.stream.write(e,t,s):this.stream.write(e,s)})}end(){this.stream.end()}},eP=Object.freeze({messageBuffer:Object.freeze({create:r=>new Bl(r)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(r,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(r,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(r,e)=>{try{return r instanceof Buffer?Promise.resolve(JSON.parse(r.toString(e.charset))):Promise.resolve(JSON.parse(new ZE.TextDecoder(e.charset).decode(r)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:r=>new Gg(r),asWritableStream:r=>new Qg(r)}),console,timer:Object.freeze({setTimeout(r,e,...t){let n=setTimeout(r,e,...t);return{dispose:()=>clearTimeout(n)}},setImmediate(r,...e){let t=setImmediate(r,...e);return{dispose:()=>clearImmediate(t)}},setInterval(r,e,...t){let n=setInterval(r,e,...t);return{dispose:()=>clearInterval(n)}}})});function Yg(){return eP}(function(r){function e(){gi.RAL.install(eP)}r.install=e})(Yg||(Yg={}));Jg.default=Yg});var As=L(qe=>{"use strict";var RN=qe&&qe.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),_N=qe&&qe.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&RN(e,r,t)};Object.defineProperty(qe,"__esModule",{value:!0});qe.createMessageConnection=qe.createServerSocketTransport=qe.createClientSocketTransport=qe.createServerPipeTransport=qe.createClientPipeTransport=qe.generateRandomPipeName=qe.StreamMessageWriter=qe.StreamMessageReader=qe.SocketMessageWriter=qe.SocketMessageReader=qe.PortMessageWriter=qe.PortMessageReader=qe.IPCMessageWriter=qe.IPCMessageReader=void 0;var ko=tP();ko.default.install();var rP=require("path"),IN=require("os"),ON=require("crypto"),Hl=require("net"),en=$l();_N($l(),qe);var Zg=class extends en.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",n=>this.fireError(n)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),en.Disposable.create(()=>this.process.off("message",e))}};qe.IPCMessageReader=Zg;var em=class extends en.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",n=>this.fireError(n)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};qe.IPCMessageWriter=em;var tm=class extends en.AbstractMessageReader{constructor(e){super(),this.onData=new en.Emitter,e.on("close",()=>this.fireClose),e.on("error",t=>this.fireError(t)),e.on("message",t=>{this.onData.fire(t)})}listen(e){return this.onData.event(e)}};qe.PortMessageReader=tm;var rm=class extends en.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};qe.PortMessageWriter=rm;var Is=class extends en.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,ko.default)().stream.asReadableStream(e),t)}};qe.SocketMessageReader=Is;var Os=class extends en.WriteableStreamMessageWriter{constructor(e,t){super((0,ko.default)().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};qe.SocketMessageWriter=Os;var Wl=class extends en.ReadableStreamMessageReader{constructor(e,t){super((0,ko.default)().stream.asReadableStream(e),t)}};qe.StreamMessageReader=Wl;var Vl=class extends en.WriteableStreamMessageWriter{constructor(e,t){super((0,ko.default)().stream.asWritableStream(e),t)}};qe.StreamMessageWriter=Vl;var nP=process.env.XDG_RUNTIME_DIR,AN=new Map([["linux",107],["darwin",103]]);function NN(){let r=(0,ON.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${r}-sock`;let e;nP?e=rP.join(nP,`vscode-ipc-${r}.sock`):e=rP.join(IN.tmpdir(),`vscode-${r}.sock`);let t=AN.get(process.platform);return t!==void 0&&e.length>t&&(0,ko.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}qe.generateRandomPipeName=NN;function FN(r,e="utf-8"){let t,n=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Hl.createServer)(a=>{o.close(),t([new Is(a,e),new Os(a,e)])});o.on("error",s),o.listen(r,()=>{o.removeListener("error",s),i({onConnected:()=>n})})})}qe.createClientPipeTransport=FN;function LN(r,e="utf-8"){let t=(0,Hl.createConnection)(r);return[new Is(t,e),new Os(t,e)]}qe.createServerPipeTransport=LN;function MN(r,e="utf-8"){let t,n=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Hl.createServer)(a=>{o.close(),t([new Is(a,e),new Os(a,e)])});o.on("error",s),o.listen(r,"127.0.0.1",()=>{o.removeListener("error",s),i({onConnected:()=>n})})})}qe.createClientSocketTransport=MN;function qN(r,e="utf-8"){let t=(0,Hl.createConnection)(r,"127.0.0.1");return[new Is(t,e),new Os(t,e)]}qe.createServerSocketTransport=qN;function jN(r){let e=r;return e.read!==void 0&&e.addListener!==void 0}function UN(r){let e=r;return e.write!==void 0&&e.addListener!==void 0}function $N(r,e,t,n){t||(t=en.NullLogger);let i=jN(r)?new Wl(r):r,s=UN(e)?new Vl(e):e;return en.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,en.createMessageConnection)(i,s,t,n)}qe.createMessageConnection=$N});var nm=L((tB,iP)=>{"use strict";iP.exports=As()});var Xl=L((sP,Kl)=>{(function(r){if(typeof Kl=="object"&&typeof Kl.exports=="object"){var e=r(require,sP);e!==void 0&&(Kl.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],r)})(function(r,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(P){function q(j){return typeof j=="string"}P.is=q})(t||(e.DocumentUri=t={}));var n;(function(P){function q(j){return typeof j=="string"}P.is=q})(n||(e.URI=n={}));var i;(function(P){P.MIN_VALUE=-2147483648,P.MAX_VALUE=2147483647;function q(j){return typeof j=="number"&&P.MIN_VALUE<=j&&j<=P.MAX_VALUE}P.is=q})(i||(e.integer=i={}));var s;(function(P){P.MIN_VALUE=0,P.MAX_VALUE=2147483647;function q(j){return typeof j=="number"&&P.MIN_VALUE<=j&&j<=P.MAX_VALUE}P.is=q})(s||(e.uinteger=s={}));var o;(function(P){function q(A,T){return A===Number.MAX_VALUE&&(A=s.MAX_VALUE),T===Number.MAX_VALUE&&(T=s.MAX_VALUE),{line:A,character:T}}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&$.uinteger(T.line)&&$.uinteger(T.character)}P.is=j})(o||(e.Position=o={}));var a;(function(P){function q(A,T,H,Z){if($.uinteger(A)&&$.uinteger(T)&&$.uinteger(H)&&$.uinteger(Z))return{start:o.create(A,T),end:o.create(H,Z)};if(o.is(A)&&o.is(T))return{start:A,end:T};throw new Error("Range#create called with invalid arguments[".concat(A,", ").concat(T,", ").concat(H,", ").concat(Z,"]"))}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&o.is(T.start)&&o.is(T.end)}P.is=j})(a||(e.Range=a={}));var u;(function(P){function q(A,T){return{uri:A,range:T}}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&a.is(T.range)&&($.string(T.uri)||$.undefined(T.uri))}P.is=j})(u||(e.Location=u={}));var c;(function(P){function q(A,T,H,Z){return{targetUri:A,targetRange:T,targetSelectionRange:H,originSelectionRange:Z}}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&a.is(T.targetRange)&&$.string(T.targetUri)&&a.is(T.targetSelectionRange)&&(a.is(T.originSelectionRange)||$.undefined(T.originSelectionRange))}P.is=j})(c||(e.LocationLink=c={}));var l;(function(P){function q(A,T,H,Z){return{red:A,green:T,blue:H,alpha:Z}}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&$.numberRange(T.red,0,1)&&$.numberRange(T.green,0,1)&&$.numberRange(T.blue,0,1)&&$.numberRange(T.alpha,0,1)}P.is=j})(l||(e.Color=l={}));var f;(function(P){function q(A,T){return{range:A,color:T}}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&a.is(T.range)&&l.is(T.color)}P.is=j})(f||(e.ColorInformation=f={}));var d;(function(P){function q(A,T,H){return{label:A,textEdit:T,additionalTextEdits:H}}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&$.string(T.label)&&($.undefined(T.textEdit)||v.is(T))&&($.undefined(T.additionalTextEdits)||$.typedArray(T.additionalTextEdits,v.is))}P.is=j})(d||(e.ColorPresentation=d={}));var h;(function(P){P.Comment="comment",P.Imports="imports",P.Region="region"})(h||(e.FoldingRangeKind=h={}));var m;(function(P){function q(A,T,H,Z,be,wt){var at={startLine:A,endLine:T};return $.defined(H)&&(at.startCharacter=H),$.defined(Z)&&(at.endCharacter=Z),$.defined(be)&&(at.kind=be),$.defined(wt)&&(at.collapsedText=wt),at}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&$.uinteger(T.startLine)&&$.uinteger(T.startLine)&&($.undefined(T.startCharacter)||$.uinteger(T.startCharacter))&&($.undefined(T.endCharacter)||$.uinteger(T.endCharacter))&&($.undefined(T.kind)||$.string(T.kind))}P.is=j})(m||(e.FoldingRange=m={}));var D;(function(P){function q(A,T){return{location:A,message:T}}P.create=q;function j(A){var T=A;return $.defined(T)&&u.is(T.location)&&$.string(T.message)}P.is=j})(D||(e.DiagnosticRelatedInformation=D={}));var _;(function(P){P.Error=1,P.Warning=2,P.Information=3,P.Hint=4})(_||(e.DiagnosticSeverity=_={}));var R;(function(P){P.Unnecessary=1,P.Deprecated=2})(R||(e.DiagnosticTag=R={}));var N;(function(P){function q(j){var A=j;return $.objectLiteral(A)&&$.string(A.href)}P.is=q})(N||(e.CodeDescription=N={}));var w;(function(P){function q(A,T,H,Z,be,wt){var at={range:A,message:T};return $.defined(H)&&(at.severity=H),$.defined(Z)&&(at.code=Z),$.defined(be)&&(at.source=be),$.defined(wt)&&(at.relatedInformation=wt),at}P.create=q;function j(A){var T,H=A;return $.defined(H)&&a.is(H.range)&&$.string(H.message)&&($.number(H.severity)||$.undefined(H.severity))&&($.integer(H.code)||$.string(H.code)||$.undefined(H.code))&&($.undefined(H.codeDescription)||$.string((T=H.codeDescription)===null||T===void 0?void 0:T.href))&&($.string(H.source)||$.undefined(H.source))&&($.undefined(H.relatedInformation)||$.typedArray(H.relatedInformation,D.is))}P.is=j})(w||(e.Diagnostic=w={}));var p;(function(P){function q(A,T){for(var H=[],Z=2;Z<arguments.length;Z++)H[Z-2]=arguments[Z];var be={title:A,command:T};return $.defined(H)&&H.length>0&&(be.arguments=H),be}P.create=q;function j(A){var T=A;return $.defined(T)&&$.string(T.title)&&$.string(T.command)}P.is=j})(p||(e.Command=p={}));var v;(function(P){function q(H,Z){return{range:H,newText:Z}}P.replace=q;function j(H,Z){return{range:{start:H,end:H},newText:Z}}P.insert=j;function A(H){return{range:H,newText:""}}P.del=A;function T(H){var Z=H;return $.objectLiteral(Z)&&$.string(Z.newText)&&a.is(Z.range)}P.is=T})(v||(e.TextEdit=v={}));var g;(function(P){function q(A,T,H){var Z={label:A};return T!==void 0&&(Z.needsConfirmation=T),H!==void 0&&(Z.description=H),Z}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&$.string(T.label)&&($.boolean(T.needsConfirmation)||T.needsConfirmation===void 0)&&($.string(T.description)||T.description===void 0)}P.is=j})(g||(e.ChangeAnnotation=g={}));var k;(function(P){function q(j){var A=j;return $.string(A)}P.is=q})(k||(e.ChangeAnnotationIdentifier=k={}));var b;(function(P){function q(H,Z,be){return{range:H,newText:Z,annotationId:be}}P.replace=q;function j(H,Z,be){return{range:{start:H,end:H},newText:Z,annotationId:be}}P.insert=j;function A(H,Z){return{range:H,newText:"",annotationId:Z}}P.del=A;function T(H){var Z=H;return v.is(Z)&&(g.is(Z.annotationId)||k.is(Z.annotationId))}P.is=T})(b||(e.AnnotatedTextEdit=b={}));var C;(function(P){function q(A,T){return{textDocument:A,edits:T}}P.create=q;function j(A){var T=A;return $.defined(T)&&_e.is(T.textDocument)&&Array.isArray(T.edits)}P.is=j})(C||(e.TextDocumentEdit=C={}));var E;(function(P){function q(A,T,H){var Z={kind:"create",uri:A};return T!==void 0&&(T.overwrite!==void 0||T.ignoreIfExists!==void 0)&&(Z.options=T),H!==void 0&&(Z.annotationId=H),Z}P.create=q;function j(A){var T=A;return T&&T.kind==="create"&&$.string(T.uri)&&(T.options===void 0||(T.options.overwrite===void 0||$.boolean(T.options.overwrite))&&(T.options.ignoreIfExists===void 0||$.boolean(T.options.ignoreIfExists)))&&(T.annotationId===void 0||k.is(T.annotationId))}P.is=j})(E||(e.CreateFile=E={}));var I;(function(P){function q(A,T,H,Z){var be={kind:"rename",oldUri:A,newUri:T};return H!==void 0&&(H.overwrite!==void 0||H.ignoreIfExists!==void 0)&&(be.options=H),Z!==void 0&&(be.annotationId=Z),be}P.create=q;function j(A){var T=A;return T&&T.kind==="rename"&&$.string(T.oldUri)&&$.string(T.newUri)&&(T.options===void 0||(T.options.overwrite===void 0||$.boolean(T.options.overwrite))&&(T.options.ignoreIfExists===void 0||$.boolean(T.options.ignoreIfExists)))&&(T.annotationId===void 0||k.is(T.annotationId))}P.is=j})(I||(e.RenameFile=I={}));var B;(function(P){function q(A,T,H){var Z={kind:"delete",uri:A};return T!==void 0&&(T.recursive!==void 0||T.ignoreIfNotExists!==void 0)&&(Z.options=T),H!==void 0&&(Z.annotationId=H),Z}P.create=q;function j(A){var T=A;return T&&T.kind==="delete"&&$.string(T.uri)&&(T.options===void 0||(T.options.recursive===void 0||$.boolean(T.options.recursive))&&(T.options.ignoreIfNotExists===void 0||$.boolean(T.options.ignoreIfNotExists)))&&(T.annotationId===void 0||k.is(T.annotationId))}P.is=j})(B||(e.DeleteFile=B={}));var z;(function(P){function q(j){var A=j;return A&&(A.changes!==void 0||A.documentChanges!==void 0)&&(A.documentChanges===void 0||A.documentChanges.every(function(T){return $.string(T.kind)?E.is(T)||I.is(T)||B.is(T):C.is(T)}))}P.is=q})(z||(e.WorkspaceEdit=z={}));var te=function(){function P(q,j){this.edits=q,this.changeAnnotations=j}return P.prototype.insert=function(q,j,A){var T,H;if(A===void 0?T=v.insert(q,j):k.is(A)?(H=A,T=b.insert(q,j,A)):(this.assertChangeAnnotations(this.changeAnnotations),H=this.changeAnnotations.manage(A),T=b.insert(q,j,H)),this.edits.push(T),H!==void 0)return H},P.prototype.replace=function(q,j,A){var T,H;if(A===void 0?T=v.replace(q,j):k.is(A)?(H=A,T=b.replace(q,j,A)):(this.assertChangeAnnotations(this.changeAnnotations),H=this.changeAnnotations.manage(A),T=b.replace(q,j,H)),this.edits.push(T),H!==void 0)return H},P.prototype.delete=function(q,j){var A,T;if(j===void 0?A=v.del(q):k.is(j)?(T=j,A=b.del(q,j)):(this.assertChangeAnnotations(this.changeAnnotations),T=this.changeAnnotations.manage(j),A=b.del(q,T)),this.edits.push(A),T!==void 0)return T},P.prototype.add=function(q){this.edits.push(q)},P.prototype.all=function(){return this.edits},P.prototype.clear=function(){this.edits.splice(0,this.edits.length)},P.prototype.assertChangeAnnotations=function(q){if(q===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},P}(),ue=function(){function P(q){this._annotations=q===void 0?Object.create(null):q,this._counter=0,this._size=0}return P.prototype.all=function(){return this._annotations},Object.defineProperty(P.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),P.prototype.manage=function(q,j){var A;if(k.is(q)?A=q:(A=this.nextId(),j=q),this._annotations[A]!==void 0)throw new Error("Id ".concat(A," is already in use."));if(j===void 0)throw new Error("No annotation provided for id ".concat(A));return this._annotations[A]=j,this._size++,A},P.prototype.nextId=function(){return this._counter++,this._counter.toString()},P}(),Q=function(){function P(q){var j=this;this._textEditChanges=Object.create(null),q!==void 0?(this._workspaceEdit=q,q.documentChanges?(this._changeAnnotations=new ue(q.changeAnnotations),q.changeAnnotations=this._changeAnnotations.all(),q.documentChanges.forEach(function(A){if(C.is(A)){var T=new te(A.edits,j._changeAnnotations);j._textEditChanges[A.textDocument.uri]=T}})):q.changes&&Object.keys(q.changes).forEach(function(A){var T=new te(q.changes[A]);j._textEditChanges[A]=T})):this._workspaceEdit={}}return Object.defineProperty(P.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),P.prototype.getTextEditChange=function(q){if(_e.is(q)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var j={uri:q.uri,version:q.version},A=this._textEditChanges[j.uri];if(!A){var T=[],H={textDocument:j,edits:T};this._workspaceEdit.documentChanges.push(H),A=new te(T,this._changeAnnotations),this._textEditChanges[j.uri]=A}return A}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var A=this._textEditChanges[q];if(!A){var T=[];this._workspaceEdit.changes[q]=T,A=new te(T),this._textEditChanges[q]=A}return A}},P.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new ue,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},P.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},P.prototype.createFile=function(q,j,A){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T;g.is(j)||k.is(j)?T=j:A=j;var H,Z;if(T===void 0?H=E.create(q,A):(Z=k.is(T)?T:this._changeAnnotations.manage(T),H=E.create(q,A,Z)),this._workspaceEdit.documentChanges.push(H),Z!==void 0)return Z},P.prototype.renameFile=function(q,j,A,T){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var H;g.is(A)||k.is(A)?H=A:T=A;var Z,be;if(H===void 0?Z=I.create(q,j,T):(be=k.is(H)?H:this._changeAnnotations.manage(H),Z=I.create(q,j,T,be)),this._workspaceEdit.documentChanges.push(Z),be!==void 0)return be},P.prototype.deleteFile=function(q,j,A){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T;g.is(j)||k.is(j)?T=j:A=j;var H,Z;if(T===void 0?H=B.create(q,A):(Z=k.is(T)?T:this._changeAnnotations.manage(T),H=B.create(q,A,Z)),this._workspaceEdit.documentChanges.push(H),Z!==void 0)return Z},P}();e.WorkspaceChange=Q;var se;(function(P){function q(A){return{uri:A}}P.create=q;function j(A){var T=A;return $.defined(T)&&$.string(T.uri)}P.is=j})(se||(e.TextDocumentIdentifier=se={}));var fe;(function(P){function q(A,T){return{uri:A,version:T}}P.create=q;function j(A){var T=A;return $.defined(T)&&$.string(T.uri)&&$.integer(T.version)}P.is=j})(fe||(e.VersionedTextDocumentIdentifier=fe={}));var _e;(function(P){function q(A,T){return{uri:A,version:T}}P.create=q;function j(A){var T=A;return $.defined(T)&&$.string(T.uri)&&(T.version===null||$.integer(T.version))}P.is=j})(_e||(e.OptionalVersionedTextDocumentIdentifier=_e={}));var Ke;(function(P){function q(A,T,H,Z){return{uri:A,languageId:T,version:H,text:Z}}P.create=q;function j(A){var T=A;return $.defined(T)&&$.string(T.uri)&&$.string(T.languageId)&&$.integer(T.version)&&$.string(T.text)}P.is=j})(Ke||(e.TextDocumentItem=Ke={}));var gt;(function(P){P.PlainText="plaintext",P.Markdown="markdown";function q(j){var A=j;return A===P.PlainText||A===P.Markdown}P.is=q})(gt||(e.MarkupKind=gt={}));var Tt;(function(P){function q(j){var A=j;return $.objectLiteral(j)&&gt.is(A.kind)&&$.string(A.value)}P.is=q})(Tt||(e.MarkupContent=Tt={}));var br;(function(P){P.Text=1,P.Method=2,P.Function=3,P.Constructor=4,P.Field=5,P.Variable=6,P.Class=7,P.Interface=8,P.Module=9,P.Property=10,P.Unit=11,P.Value=12,P.Enum=13,P.Keyword=14,P.Snippet=15,P.Color=16,P.File=17,P.Reference=18,P.Folder=19,P.EnumMember=20,P.Constant=21,P.Struct=22,P.Event=23,P.Operator=24,P.TypeParameter=25})(br||(e.CompletionItemKind=br={}));var $t;(function(P){P.PlainText=1,P.Snippet=2})($t||(e.InsertTextFormat=$t={}));var nr;(function(P){P.Deprecated=1})(nr||(e.CompletionItemTag=nr={}));var O;(function(P){function q(A,T,H){return{newText:A,insert:T,replace:H}}P.create=q;function j(A){var T=A;return T&&$.string(T.newText)&&a.is(T.insert)&&a.is(T.replace)}P.is=j})(O||(e.InsertReplaceEdit=O={}));var x;(function(P){P.asIs=1,P.adjustIndentation=2})(x||(e.InsertTextMode=x={}));var J;(function(P){function q(j){var A=j;return A&&($.string(A.detail)||A.detail===void 0)&&($.string(A.description)||A.description===void 0)}P.is=q})(J||(e.CompletionItemLabelDetails=J={}));var W;(function(P){function q(j){return{label:j}}P.create=q})(W||(e.CompletionItem=W={}));var Re;(function(P){function q(j,A){return{items:j||[],isIncomplete:!!A}}P.create=q})(Re||(e.CompletionList=Re={}));var Qe;(function(P){function q(A){return A.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}P.fromPlainText=q;function j(A){var T=A;return $.string(T)||$.objectLiteral(T)&&$.string(T.language)&&$.string(T.value)}P.is=j})(Qe||(e.MarkedString=Qe={}));var Ie;(function(P){function q(j){var A=j;return!!A&&$.objectLiteral(A)&&(Tt.is(A.contents)||Qe.is(A.contents)||$.typedArray(A.contents,Qe.is))&&(j.range===void 0||a.is(j.range))}P.is=q})(Ie||(e.Hover=Ie={}));var mt;(function(P){function q(j,A){return A?{label:j,documentation:A}:{label:j}}P.create=q})(mt||(e.ParameterInformation=mt={}));var Rt;(function(P){function q(j,A){for(var T=[],H=2;H<arguments.length;H++)T[H-2]=arguments[H];var Z={label:j};return $.defined(A)&&(Z.documentation=A),$.defined(T)?Z.parameters=T:Z.parameters=[],Z}P.create=q})(Rt||(e.SignatureInformation=Rt={}));var Xt;(function(P){P.Text=1,P.Read=2,P.Write=3})(Xt||(e.DocumentHighlightKind=Xt={}));var lt;(function(P){function q(j,A){var T={range:j};return $.number(A)&&(T.kind=A),T}P.create=q})(lt||(e.DocumentHighlight=lt={}));var _t;(function(P){P.File=1,P.Module=2,P.Namespace=3,P.Package=4,P.Class=5,P.Method=6,P.Property=7,P.Field=8,P.Constructor=9,P.Enum=10,P.Interface=11,P.Function=12,P.Variable=13,P.Constant=14,P.String=15,P.Number=16,P.Boolean=17,P.Array=18,P.Object=19,P.Key=20,P.Null=21,P.EnumMember=22,P.Struct=23,P.Event=24,P.Operator=25,P.TypeParameter=26})(_t||(e.SymbolKind=_t={}));var ln;(function(P){P.Deprecated=1})(ln||(e.SymbolTag=ln={}));var vt;(function(P){function q(j,A,T,H,Z){var be={name:j,kind:A,location:{uri:H,range:T}};return Z&&(be.containerName=Z),be}P.create=q})(vt||(e.SymbolInformation=vt={}));var Bt;(function(P){function q(j,A,T,H){return H!==void 0?{name:j,kind:A,location:{uri:T,range:H}}:{name:j,kind:A,location:{uri:T}}}P.create=q})(Bt||(e.WorkspaceSymbol=Bt={}));var Wt;(function(P){function q(A,T,H,Z,be,wt){var at={name:A,detail:T,kind:H,range:Z,selectionRange:be};return wt!==void 0&&(at.children=wt),at}P.create=q;function j(A){var T=A;return T&&$.string(T.name)&&$.number(T.kind)&&a.is(T.range)&&a.is(T.selectionRange)&&(T.detail===void 0||$.string(T.detail))&&(T.deprecated===void 0||$.boolean(T.deprecated))&&(T.children===void 0||Array.isArray(T.children))&&(T.tags===void 0||Array.isArray(T.tags))}P.is=j})(Wt||(e.DocumentSymbol=Wt={}));var zr;(function(P){P.Empty="",P.QuickFix="quickfix",P.Refactor="refactor",P.RefactorExtract="refactor.extract",P.RefactorInline="refactor.inline",P.RefactorRewrite="refactor.rewrite",P.Source="source",P.SourceOrganizeImports="source.organizeImports",P.SourceFixAll="source.fixAll"})(zr||(e.CodeActionKind=zr={}));var Ir;(function(P){P.Invoked=1,P.Automatic=2})(Ir||(e.CodeActionTriggerKind=Ir={}));var Nn;(function(P){function q(A,T,H){var Z={diagnostics:A};return T!=null&&(Z.only=T),H!=null&&(Z.triggerKind=H),Z}P.create=q;function j(A){var T=A;return $.defined(T)&&$.typedArray(T.diagnostics,w.is)&&(T.only===void 0||$.typedArray(T.only,$.string))&&(T.triggerKind===void 0||T.triggerKind===Ir.Invoked||T.triggerKind===Ir.Automatic)}P.is=j})(Nn||(e.CodeActionContext=Nn={}));var ii;(function(P){function q(A,T,H){var Z={title:A},be=!0;return typeof T=="string"?(be=!1,Z.kind=T):p.is(T)?Z.command=T:Z.edit=T,be&&H!==void 0&&(Z.kind=H),Z}P.create=q;function j(A){var T=A;return T&&$.string(T.title)&&(T.diagnostics===void 0||$.typedArray(T.diagnostics,w.is))&&(T.kind===void 0||$.string(T.kind))&&(T.edit!==void 0||T.command!==void 0)&&(T.command===void 0||p.is(T.command))&&(T.isPreferred===void 0||$.boolean(T.isPreferred))&&(T.edit===void 0||z.is(T.edit))}P.is=j})(ii||(e.CodeAction=ii={}));var Tn;(function(P){function q(A,T){var H={range:A};return $.defined(T)&&(H.data=T),H}P.create=q;function j(A){var T=A;return $.defined(T)&&a.is(T.range)&&($.undefined(T.command)||p.is(T.command))}P.is=j})(Tn||(e.CodeLens=Tn={}));var si;(function(P){function q(A,T){return{tabSize:A,insertSpaces:T}}P.create=q;function j(A){var T=A;return $.defined(T)&&$.uinteger(T.tabSize)&&$.boolean(T.insertSpaces)}P.is=j})(si||(e.FormattingOptions=si={}));var Cr;(function(P){function q(A,T,H){return{range:A,target:T,data:H}}P.create=q;function j(A){var T=A;return $.defined(T)&&a.is(T.range)&&($.undefined(T.target)||$.string(T.target))}P.is=j})(Cr||(e.DocumentLink=Cr={}));var M;(function(P){function q(A,T){return{range:A,parent:T}}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&a.is(T.range)&&(T.parent===void 0||P.is(T.parent))}P.is=j})(M||(e.SelectionRange=M={}));var Y;(function(P){P.namespace="namespace",P.type="type",P.class="class",P.enum="enum",P.interface="interface",P.struct="struct",P.typeParameter="typeParameter",P.parameter="parameter",P.variable="variable",P.property="property",P.enumMember="enumMember",P.event="event",P.function="function",P.method="method",P.macro="macro",P.keyword="keyword",P.modifier="modifier",P.comment="comment",P.string="string",P.number="number",P.regexp="regexp",P.operator="operator",P.decorator="decorator"})(Y||(e.SemanticTokenTypes=Y={}));var ie;(function(P){P.declaration="declaration",P.definition="definition",P.readonly="readonly",P.static="static",P.deprecated="deprecated",P.abstract="abstract",P.async="async",P.modification="modification",P.documentation="documentation",P.defaultLibrary="defaultLibrary"})(ie||(e.SemanticTokenModifiers=ie={}));var ae;(function(P){function q(j){var A=j;return $.objectLiteral(A)&&(A.resultId===void 0||typeof A.resultId=="string")&&Array.isArray(A.data)&&(A.data.length===0||typeof A.data[0]=="number")}P.is=q})(ae||(e.SemanticTokens=ae={}));var Be;(function(P){function q(A,T){return{range:A,text:T}}P.create=q;function j(A){var T=A;return T!=null&&a.is(T.range)&&$.string(T.text)}P.is=j})(Be||(e.InlineValueText=Be={}));var Ue;(function(P){function q(A,T,H){return{range:A,variableName:T,caseSensitiveLookup:H}}P.create=q;function j(A){var T=A;return T!=null&&a.is(T.range)&&$.boolean(T.caseSensitiveLookup)&&($.string(T.variableName)||T.variableName===void 0)}P.is=j})(Ue||(e.InlineValueVariableLookup=Ue={}));var Ye;(function(P){function q(A,T){return{range:A,expression:T}}P.create=q;function j(A){var T=A;return T!=null&&a.is(T.range)&&($.string(T.expression)||T.expression===void 0)}P.is=j})(Ye||(e.InlineValueEvaluatableExpression=Ye={}));var st;(function(P){function q(A,T){return{frameId:A,stoppedLocation:T}}P.create=q;function j(A){var T=A;return $.defined(T)&&a.is(A.stoppedLocation)}P.is=j})(st||(e.InlineValueContext=st={}));var xe;(function(P){P.Type=1,P.Parameter=2;function q(j){return j===1||j===2}P.is=q})(xe||(e.InlayHintKind=xe={}));var Ve;(function(P){function q(A){return{value:A}}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&(T.tooltip===void 0||$.string(T.tooltip)||Tt.is(T.tooltip))&&(T.location===void 0||u.is(T.location))&&(T.command===void 0||p.is(T.command))}P.is=j})(Ve||(e.InlayHintLabelPart=Ve={}));var Fe;(function(P){function q(A,T,H){var Z={position:A,label:T};return H!==void 0&&(Z.kind=H),Z}P.create=q;function j(A){var T=A;return $.objectLiteral(T)&&o.is(T.position)&&($.string(T.label)||$.typedArray(T.label,Ve.is))&&(T.kind===void 0||xe.is(T.kind))&&T.textEdits===void 0||$.typedArray(T.textEdits,v.is)&&(T.tooltip===void 0||$.string(T.tooltip)||Tt.is(T.tooltip))&&(T.paddingLeft===void 0||$.boolean(T.paddingLeft))&&(T.paddingRight===void 0||$.boolean(T.paddingRight))}P.is=j})(Fe||(e.InlayHint=Fe={}));var ot;(function(P){function q(j){return{kind:"snippet",value:j}}P.createSnippet=q})(ot||(e.StringValue=ot={}));var It;(function(P){function q(j,A,T,H){return{insertText:j,filterText:A,range:T,command:H}}P.create=q})(It||(e.InlineCompletionItem=It={}));var Yt;(function(P){function q(j){return{items:j}}P.create=q})(Yt||(e.InlineCompletionList=Yt={}));var ki;(function(P){P.Invoked=0,P.Automatic=1})(ki||(e.InlineCompletionTriggerKind=ki={}));var Ri;(function(P){function q(j,A){return{range:j,text:A}}P.create=q})(Ri||(e.SelectedCompletionInfo=Ri={}));var S;(function(P){function q(j,A){return{triggerKind:j,selectedCompletionInfo:A}}P.create=q})(S||(e.InlineCompletionContext=S={}));var X;(function(P){function q(j){var A=j;return $.objectLiteral(A)&&n.is(A.uri)&&$.string(A.name)}P.is=q})(X||(e.WorkspaceFolder=X={})),e.EOL=[`
`,`\r
`,"\r"];var de;(function(P){function q(H,Z,be,wt){return new He(H,Z,be,wt)}P.create=q;function j(H){var Z=H;return!!($.defined(Z)&&$.string(Z.uri)&&($.undefined(Z.languageId)||$.string(Z.languageId))&&$.uinteger(Z.lineCount)&&$.func(Z.getText)&&$.func(Z.positionAt)&&$.func(Z.offsetAt))}P.is=j;function A(H,Z){for(var be=H.getText(),wt=T(Z,function(Fn,y){var U=Fn.range.start.line-y.range.start.line;return U===0?Fn.range.start.character-y.range.start.character:U}),at=be.length,Or=wt.length-1;Or>=0;Or--){var Gr=wt[Or],Sn=H.offsetAt(Gr.range.start),Ne=H.offsetAt(Gr.range.end);if(Ne<=at)be=be.substring(0,Sn)+Gr.newText+be.substring(Ne,be.length);else throw new Error("Overlapping edit");at=Sn}return be}P.applyEdits=A;function T(H,Z){if(H.length<=1)return H;var be=H.length/2|0,wt=H.slice(0,be),at=H.slice(be);T(wt,Z),T(at,Z);for(var Or=0,Gr=0,Sn=0;Or<wt.length&&Gr<at.length;){var Ne=Z(wt[Or],at[Gr]);Ne<=0?H[Sn++]=wt[Or++]:H[Sn++]=at[Gr++]}for(;Or<wt.length;)H[Sn++]=wt[Or++];for(;Gr<at.length;)H[Sn++]=at[Gr++];return H}})(de||(e.TextDocument=de={}));var He=function(){function P(q,j,A,T){this._uri=q,this._languageId=j,this._version=A,this._content=T,this._lineOffsets=void 0}return Object.defineProperty(P.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(P.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),P.prototype.getText=function(q){if(q){var j=this.offsetAt(q.start),A=this.offsetAt(q.end);return this._content.substring(j,A)}return this._content},P.prototype.update=function(q,j){this._content=q.text,this._version=j,this._lineOffsets=void 0},P.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var q=[],j=this._content,A=!0,T=0;T<j.length;T++){A&&(q.push(T),A=!1);var H=j.charAt(T);A=H==="\r"||H===`
`,H==="\r"&&T+1<j.length&&j.charAt(T+1)===`
`&&T++}A&&j.length>0&&q.push(j.length),this._lineOffsets=q}return this._lineOffsets},P.prototype.positionAt=function(q){q=Math.max(Math.min(q,this._content.length),0);var j=this.getLineOffsets(),A=0,T=j.length;if(T===0)return o.create(0,q);for(;A<T;){var H=Math.floor((A+T)/2);j[H]>q?T=H:A=H+1}var Z=A-1;return o.create(Z,q-j[Z])},P.prototype.offsetAt=function(q){var j=this.getLineOffsets();if(q.line>=j.length)return this._content.length;if(q.line<0)return 0;var A=j[q.line],T=q.line+1<j.length?j[q.line+1]:this._content.length;return Math.max(Math.min(A+q.character,T),A)},Object.defineProperty(P.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),P}(),$;(function(P){var q=Object.prototype.toString;function j(Ne){return typeof Ne<"u"}P.defined=j;function A(Ne){return typeof Ne>"u"}P.undefined=A;function T(Ne){return Ne===!0||Ne===!1}P.boolean=T;function H(Ne){return q.call(Ne)==="[object String]"}P.string=H;function Z(Ne){return q.call(Ne)==="[object Number]"}P.number=Z;function be(Ne,Fn,y){return q.call(Ne)==="[object Number]"&&Fn<=Ne&&Ne<=y}P.numberRange=be;function wt(Ne){return q.call(Ne)==="[object Number]"&&-2147483648<=Ne&&Ne<=2147483647}P.integer=wt;function at(Ne){return q.call(Ne)==="[object Number]"&&0<=Ne&&Ne<=2147483647}P.uinteger=at;function Or(Ne){return q.call(Ne)==="[object Function]"}P.func=Or;function Gr(Ne){return Ne!==null&&typeof Ne=="object"}P.objectLiteral=Gr;function Sn(Ne,Fn){return Array.isArray(Ne)&&Ne.every(Fn)}P.typedArray=Sn})($||($={}))})});var yt=L(Ur=>{"use strict";Object.defineProperty(Ur,"__esModule",{value:!0});Ur.ProtocolNotificationType=Ur.ProtocolNotificationType0=Ur.ProtocolRequestType=Ur.ProtocolRequestType0=Ur.RegistrationType=Ur.MessageDirection=void 0;var Ro=As(),oP;(function(r){r.clientToServer="clientToServer",r.serverToClient="serverToClient",r.both="both"})(oP||(Ur.MessageDirection=oP={}));var im=class{constructor(e){this.method=e}};Ur.RegistrationType=im;var sm=class extends Ro.RequestType0{constructor(e){super(e)}};Ur.ProtocolRequestType0=sm;var om=class extends Ro.RequestType{constructor(e){super(e,Ro.ParameterStructures.byName)}};Ur.ProtocolRequestType=om;var am=class extends Ro.NotificationType0{constructor(e){super(e)}};Ur.ProtocolNotificationType0=am;var um=class extends Ro.NotificationType{constructor(e){super(e,Ro.ParameterStructures.byName)}};Ur.ProtocolNotificationType=um});var zl=L(Ht=>{"use strict";Object.defineProperty(Ht,"__esModule",{value:!0});Ht.objectLiteral=Ht.typedArray=Ht.stringArray=Ht.array=Ht.func=Ht.error=Ht.number=Ht.string=Ht.boolean=void 0;function BN(r){return r===!0||r===!1}Ht.boolean=BN;function aP(r){return typeof r=="string"||r instanceof String}Ht.string=aP;function WN(r){return typeof r=="number"||r instanceof Number}Ht.number=WN;function VN(r){return r instanceof Error}Ht.error=VN;function HN(r){return typeof r=="function"}Ht.func=HN;function uP(r){return Array.isArray(r)}Ht.array=uP;function KN(r){return uP(r)&&r.every(e=>aP(e))}Ht.stringArray=KN;function XN(r,e){return Array.isArray(r)&&r.every(e)}Ht.typedArray=XN;function zN(r){return r!==null&&typeof r=="object"}Ht.objectLiteral=zN});var dP=L(Gl=>{"use strict";Object.defineProperty(Gl,"__esModule",{value:!0});Gl.ImplementationRequest=void 0;var cP=yt(),lP;(function(r){r.method="textDocument/implementation",r.messageDirection=cP.MessageDirection.clientToServer,r.type=new cP.ProtocolRequestType(r.method)})(lP||(Gl.ImplementationRequest=lP={}))});var hP=L(Ql=>{"use strict";Object.defineProperty(Ql,"__esModule",{value:!0});Ql.TypeDefinitionRequest=void 0;var fP=yt(),pP;(function(r){r.method="textDocument/typeDefinition",r.messageDirection=fP.MessageDirection.clientToServer,r.type=new fP.ProtocolRequestType(r.method)})(pP||(Ql.TypeDefinitionRequest=pP={}))});var vP=L(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.DidChangeWorkspaceFoldersNotification=_o.WorkspaceFoldersRequest=void 0;var Yl=yt(),gP;(function(r){r.method="workspace/workspaceFolders",r.messageDirection=Yl.MessageDirection.serverToClient,r.type=new Yl.ProtocolRequestType0(r.method)})(gP||(_o.WorkspaceFoldersRequest=gP={}));var mP;(function(r){r.method="workspace/didChangeWorkspaceFolders",r.messageDirection=Yl.MessageDirection.clientToServer,r.type=new Yl.ProtocolNotificationType(r.method)})(mP||(_o.DidChangeWorkspaceFoldersNotification=mP={}))});var bP=L(Jl=>{"use strict";Object.defineProperty(Jl,"__esModule",{value:!0});Jl.ConfigurationRequest=void 0;var wP=yt(),yP;(function(r){r.method="workspace/configuration",r.messageDirection=wP.MessageDirection.serverToClient,r.type=new wP.ProtocolRequestType(r.method)})(yP||(Jl.ConfigurationRequest=yP={}))});var TP=L(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.ColorPresentationRequest=Io.DocumentColorRequest=void 0;var Zl=yt(),CP;(function(r){r.method="textDocument/documentColor",r.messageDirection=Zl.MessageDirection.clientToServer,r.type=new Zl.ProtocolRequestType(r.method)})(CP||(Io.DocumentColorRequest=CP={}));var DP;(function(r){r.method="textDocument/colorPresentation",r.messageDirection=Zl.MessageDirection.clientToServer,r.type=new Zl.ProtocolRequestType(r.method)})(DP||(Io.ColorPresentationRequest=DP={}))});var PP=L(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.FoldingRangeRefreshRequest=Oo.FoldingRangeRequest=void 0;var ed=yt(),SP;(function(r){r.method="textDocument/foldingRange",r.messageDirection=ed.MessageDirection.clientToServer,r.type=new ed.ProtocolRequestType(r.method)})(SP||(Oo.FoldingRangeRequest=SP={}));var EP;(function(r){r.method="workspace/foldingRange/refresh",r.messageDirection=ed.MessageDirection.serverToClient,r.type=new ed.ProtocolRequestType0(r.method)})(EP||(Oo.FoldingRangeRefreshRequest=EP={}))});var RP=L(td=>{"use strict";Object.defineProperty(td,"__esModule",{value:!0});td.DeclarationRequest=void 0;var xP=yt(),kP;(function(r){r.method="textDocument/declaration",r.messageDirection=xP.MessageDirection.clientToServer,r.type=new xP.ProtocolRequestType(r.method)})(kP||(td.DeclarationRequest=kP={}))});var OP=L(rd=>{"use strict";Object.defineProperty(rd,"__esModule",{value:!0});rd.SelectionRangeRequest=void 0;var _P=yt(),IP;(function(r){r.method="textDocument/selectionRange",r.messageDirection=_P.MessageDirection.clientToServer,r.type=new _P.ProtocolRequestType(r.method)})(IP||(rd.SelectionRangeRequest=IP={}))});var LP=L(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.WorkDoneProgressCancelNotification=Yi.WorkDoneProgressCreateRequest=Yi.WorkDoneProgress=void 0;var GN=As(),nd=yt(),AP;(function(r){r.type=new GN.ProgressType;function e(t){return t===r.type}r.is=e})(AP||(Yi.WorkDoneProgress=AP={}));var NP;(function(r){r.method="window/workDoneProgress/create",r.messageDirection=nd.MessageDirection.serverToClient,r.type=new nd.ProtocolRequestType(r.method)})(NP||(Yi.WorkDoneProgressCreateRequest=NP={}));var FP;(function(r){r.method="window/workDoneProgress/cancel",r.messageDirection=nd.MessageDirection.clientToServer,r.type=new nd.ProtocolNotificationType(r.method)})(FP||(Yi.WorkDoneProgressCancelNotification=FP={}))});var UP=L(Ji=>{"use strict";Object.defineProperty(Ji,"__esModule",{value:!0});Ji.CallHierarchyOutgoingCallsRequest=Ji.CallHierarchyIncomingCallsRequest=Ji.CallHierarchyPrepareRequest=void 0;var Ao=yt(),MP;(function(r){r.method="textDocument/prepareCallHierarchy",r.messageDirection=Ao.MessageDirection.clientToServer,r.type=new Ao.ProtocolRequestType(r.method)})(MP||(Ji.CallHierarchyPrepareRequest=MP={}));var qP;(function(r){r.method="callHierarchy/incomingCalls",r.messageDirection=Ao.MessageDirection.clientToServer,r.type=new Ao.ProtocolRequestType(r.method)})(qP||(Ji.CallHierarchyIncomingCallsRequest=qP={}));var jP;(function(r){r.method="callHierarchy/outgoingCalls",r.messageDirection=Ao.MessageDirection.clientToServer,r.type=new Ao.ProtocolRequestType(r.method)})(jP||(Ji.CallHierarchyOutgoingCallsRequest=jP={}))});var KP=L($r=>{"use strict";Object.defineProperty($r,"__esModule",{value:!0});$r.SemanticTokensRefreshRequest=$r.SemanticTokensRangeRequest=$r.SemanticTokensDeltaRequest=$r.SemanticTokensRequest=$r.SemanticTokensRegistrationType=$r.TokenFormat=void 0;var mi=yt(),$P;(function(r){r.Relative="relative"})($P||($r.TokenFormat=$P={}));var su;(function(r){r.method="textDocument/semanticTokens",r.type=new mi.RegistrationType(r.method)})(su||($r.SemanticTokensRegistrationType=su={}));var BP;(function(r){r.method="textDocument/semanticTokens/full",r.messageDirection=mi.MessageDirection.clientToServer,r.type=new mi.ProtocolRequestType(r.method),r.registrationMethod=su.method})(BP||($r.SemanticTokensRequest=BP={}));var WP;(function(r){r.method="textDocument/semanticTokens/full/delta",r.messageDirection=mi.MessageDirection.clientToServer,r.type=new mi.ProtocolRequestType(r.method),r.registrationMethod=su.method})(WP||($r.SemanticTokensDeltaRequest=WP={}));var VP;(function(r){r.method="textDocument/semanticTokens/range",r.messageDirection=mi.MessageDirection.clientToServer,r.type=new mi.ProtocolRequestType(r.method),r.registrationMethod=su.method})(VP||($r.SemanticTokensRangeRequest=VP={}));var HP;(function(r){r.method="workspace/semanticTokens/refresh",r.messageDirection=mi.MessageDirection.serverToClient,r.type=new mi.ProtocolRequestType0(r.method)})(HP||($r.SemanticTokensRefreshRequest=HP={}))});var GP=L(id=>{"use strict";Object.defineProperty(id,"__esModule",{value:!0});id.ShowDocumentRequest=void 0;var XP=yt(),zP;(function(r){r.method="window/showDocument",r.messageDirection=XP.MessageDirection.serverToClient,r.type=new XP.ProtocolRequestType(r.method)})(zP||(id.ShowDocumentRequest=zP={}))});var JP=L(sd=>{"use strict";Object.defineProperty(sd,"__esModule",{value:!0});sd.LinkedEditingRangeRequest=void 0;var QP=yt(),YP;(function(r){r.method="textDocument/linkedEditingRange",r.messageDirection=QP.MessageDirection.clientToServer,r.type=new QP.ProtocolRequestType(r.method)})(YP||(sd.LinkedEditingRangeRequest=YP={}))});var o0=L(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.WillDeleteFilesRequest=gr.DidDeleteFilesNotification=gr.DidRenameFilesNotification=gr.WillRenameFilesRequest=gr.DidCreateFilesNotification=gr.WillCreateFilesRequest=gr.FileOperationPatternKind=void 0;var mn=yt(),ZP;(function(r){r.file="file",r.folder="folder"})(ZP||(gr.FileOperationPatternKind=ZP={}));var e0;(function(r){r.method="workspace/willCreateFiles",r.messageDirection=mn.MessageDirection.clientToServer,r.type=new mn.ProtocolRequestType(r.method)})(e0||(gr.WillCreateFilesRequest=e0={}));var t0;(function(r){r.method="workspace/didCreateFiles",r.messageDirection=mn.MessageDirection.clientToServer,r.type=new mn.ProtocolNotificationType(r.method)})(t0||(gr.DidCreateFilesNotification=t0={}));var r0;(function(r){r.method="workspace/willRenameFiles",r.messageDirection=mn.MessageDirection.clientToServer,r.type=new mn.ProtocolRequestType(r.method)})(r0||(gr.WillRenameFilesRequest=r0={}));var n0;(function(r){r.method="workspace/didRenameFiles",r.messageDirection=mn.MessageDirection.clientToServer,r.type=new mn.ProtocolNotificationType(r.method)})(n0||(gr.DidRenameFilesNotification=n0={}));var i0;(function(r){r.method="workspace/didDeleteFiles",r.messageDirection=mn.MessageDirection.clientToServer,r.type=new mn.ProtocolNotificationType(r.method)})(i0||(gr.DidDeleteFilesNotification=i0={}));var s0;(function(r){r.method="workspace/willDeleteFiles",r.messageDirection=mn.MessageDirection.clientToServer,r.type=new mn.ProtocolRequestType(r.method)})(s0||(gr.WillDeleteFilesRequest=s0={}))});var d0=L(Zi=>{"use strict";Object.defineProperty(Zi,"__esModule",{value:!0});Zi.MonikerRequest=Zi.MonikerKind=Zi.UniquenessLevel=void 0;var a0=yt(),u0;(function(r){r.document="document",r.project="project",r.group="group",r.scheme="scheme",r.global="global"})(u0||(Zi.UniquenessLevel=u0={}));var c0;(function(r){r.$import="import",r.$export="export",r.local="local"})(c0||(Zi.MonikerKind=c0={}));var l0;(function(r){r.method="textDocument/moniker",r.messageDirection=a0.MessageDirection.clientToServer,r.type=new a0.ProtocolRequestType(r.method)})(l0||(Zi.MonikerRequest=l0={}))});var g0=L(es=>{"use strict";Object.defineProperty(es,"__esModule",{value:!0});es.TypeHierarchySubtypesRequest=es.TypeHierarchySupertypesRequest=es.TypeHierarchyPrepareRequest=void 0;var No=yt(),f0;(function(r){r.method="textDocument/prepareTypeHierarchy",r.messageDirection=No.MessageDirection.clientToServer,r.type=new No.ProtocolRequestType(r.method)})(f0||(es.TypeHierarchyPrepareRequest=f0={}));var p0;(function(r){r.method="typeHierarchy/supertypes",r.messageDirection=No.MessageDirection.clientToServer,r.type=new No.ProtocolRequestType(r.method)})(p0||(es.TypeHierarchySupertypesRequest=p0={}));var h0;(function(r){r.method="typeHierarchy/subtypes",r.messageDirection=No.MessageDirection.clientToServer,r.type=new No.ProtocolRequestType(r.method)})(h0||(es.TypeHierarchySubtypesRequest=h0={}))});var w0=L(Fo=>{"use strict";Object.defineProperty(Fo,"__esModule",{value:!0});Fo.InlineValueRefreshRequest=Fo.InlineValueRequest=void 0;var od=yt(),m0;(function(r){r.method="textDocument/inlineValue",r.messageDirection=od.MessageDirection.clientToServer,r.type=new od.ProtocolRequestType(r.method)})(m0||(Fo.InlineValueRequest=m0={}));var v0;(function(r){r.method="workspace/inlineValue/refresh",r.messageDirection=od.MessageDirection.serverToClient,r.type=new od.ProtocolRequestType0(r.method)})(v0||(Fo.InlineValueRefreshRequest=v0={}))});var D0=L(ts=>{"use strict";Object.defineProperty(ts,"__esModule",{value:!0});ts.InlayHintRefreshRequest=ts.InlayHintResolveRequest=ts.InlayHintRequest=void 0;var Lo=yt(),y0;(function(r){r.method="textDocument/inlayHint",r.messageDirection=Lo.MessageDirection.clientToServer,r.type=new Lo.ProtocolRequestType(r.method)})(y0||(ts.InlayHintRequest=y0={}));var b0;(function(r){r.method="inlayHint/resolve",r.messageDirection=Lo.MessageDirection.clientToServer,r.type=new Lo.ProtocolRequestType(r.method)})(b0||(ts.InlayHintResolveRequest=b0={}));var C0;(function(r){r.method="workspace/inlayHint/refresh",r.messageDirection=Lo.MessageDirection.serverToClient,r.type=new Lo.ProtocolRequestType0(r.method)})(C0||(ts.InlayHintRefreshRequest=C0={}))});var R0=L(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.DiagnosticRefreshRequest=vn.WorkspaceDiagnosticRequest=vn.DocumentDiagnosticRequest=vn.DocumentDiagnosticReportKind=vn.DiagnosticServerCancellationData=void 0;var k0=As(),QN=zl(),Mo=yt(),T0;(function(r){function e(t){let n=t;return n&&QN.boolean(n.retriggerRequest)}r.is=e})(T0||(vn.DiagnosticServerCancellationData=T0={}));var S0;(function(r){r.Full="full",r.Unchanged="unchanged"})(S0||(vn.DocumentDiagnosticReportKind=S0={}));var E0;(function(r){r.method="textDocument/diagnostic",r.messageDirection=Mo.MessageDirection.clientToServer,r.type=new Mo.ProtocolRequestType(r.method),r.partialResult=new k0.ProgressType})(E0||(vn.DocumentDiagnosticRequest=E0={}));var P0;(function(r){r.method="workspace/diagnostic",r.messageDirection=Mo.MessageDirection.clientToServer,r.type=new Mo.ProtocolRequestType(r.method),r.partialResult=new k0.ProgressType})(P0||(vn.WorkspaceDiagnosticRequest=P0={}));var x0;(function(r){r.method="workspace/diagnostic/refresh",r.messageDirection=Mo.MessageDirection.serverToClient,r.type=new Mo.ProtocolRequestType0(r.method)})(x0||(vn.DiagnosticRefreshRequest=x0={}))});var L0=L(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.DidCloseNotebookDocumentNotification=Ft.DidSaveNotebookDocumentNotification=Ft.DidChangeNotebookDocumentNotification=Ft.NotebookCellArrayChange=Ft.DidOpenNotebookDocumentNotification=Ft.NotebookDocumentSyncRegistrationType=Ft.NotebookDocument=Ft.NotebookCell=Ft.ExecutionSummary=Ft.NotebookCellKind=void 0;var ou=Xl(),Rn=zl(),zn=yt(),cm;(function(r){r.Markup=1,r.Code=2;function e(t){return t===1||t===2}r.is=e})(cm||(Ft.NotebookCellKind=cm={}));var lm;(function(r){function e(i,s){let o={executionOrder:i};return(s===!0||s===!1)&&(o.success=s),o}r.create=e;function t(i){let s=i;return Rn.objectLiteral(s)&&ou.uinteger.is(s.executionOrder)&&(s.success===void 0||Rn.boolean(s.success))}r.is=t;function n(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}r.equals=n})(lm||(Ft.ExecutionSummary=lm={}));var ad;(function(r){function e(s,o){return{kind:s,document:o}}r.create=e;function t(s){let o=s;return Rn.objectLiteral(o)&&cm.is(o.kind)&&ou.DocumentUri.is(o.document)&&(o.metadata===void 0||Rn.objectLiteral(o.metadata))}r.is=t;function n(s,o){let a=new Set;return s.document!==o.document&&a.add("document"),s.kind!==o.kind&&a.add("kind"),s.executionSummary!==o.executionSummary&&a.add("executionSummary"),(s.metadata!==void 0||o.metadata!==void 0)&&!i(s.metadata,o.metadata)&&a.add("metadata"),(s.executionSummary!==void 0||o.executionSummary!==void 0)&&!lm.equals(s.executionSummary,o.executionSummary)&&a.add("executionSummary"),a}r.diff=n;function i(s,o){if(s===o)return!0;if(s==null||o===null||o===void 0||typeof s!=typeof o||typeof s!="object")return!1;let a=Array.isArray(s),u=Array.isArray(o);if(a!==u)return!1;if(a&&u){if(s.length!==o.length)return!1;for(let c=0;c<s.length;c++)if(!i(s[c],o[c]))return!1}if(Rn.objectLiteral(s)&&Rn.objectLiteral(o)){let c=Object.keys(s),l=Object.keys(o);if(c.length!==l.length||(c.sort(),l.sort(),!i(c,l)))return!1;for(let f=0;f<c.length;f++){let d=c[f];if(!i(s[d],o[d]))return!1}}return!0}})(ad||(Ft.NotebookCell=ad={}));var _0;(function(r){function e(n,i,s,o){return{uri:n,notebookType:i,version:s,cells:o}}r.create=e;function t(n){let i=n;return Rn.objectLiteral(i)&&Rn.string(i.uri)&&ou.integer.is(i.version)&&Rn.typedArray(i.cells,ad.is)}r.is=t})(_0||(Ft.NotebookDocument=_0={}));var qo;(function(r){r.method="notebookDocument/sync",r.messageDirection=zn.MessageDirection.clientToServer,r.type=new zn.RegistrationType(r.method)})(qo||(Ft.NotebookDocumentSyncRegistrationType=qo={}));var I0;(function(r){r.method="notebookDocument/didOpen",r.messageDirection=zn.MessageDirection.clientToServer,r.type=new zn.ProtocolNotificationType(r.method),r.registrationMethod=qo.method})(I0||(Ft.DidOpenNotebookDocumentNotification=I0={}));var O0;(function(r){function e(n){let i=n;return Rn.objectLiteral(i)&&ou.uinteger.is(i.start)&&ou.uinteger.is(i.deleteCount)&&(i.cells===void 0||Rn.typedArray(i.cells,ad.is))}r.is=e;function t(n,i,s){let o={start:n,deleteCount:i};return s!==void 0&&(o.cells=s),o}r.create=t})(O0||(Ft.NotebookCellArrayChange=O0={}));var A0;(function(r){r.method="notebookDocument/didChange",r.messageDirection=zn.MessageDirection.clientToServer,r.type=new zn.ProtocolNotificationType(r.method),r.registrationMethod=qo.method})(A0||(Ft.DidChangeNotebookDocumentNotification=A0={}));var N0;(function(r){r.method="notebookDocument/didSave",r.messageDirection=zn.MessageDirection.clientToServer,r.type=new zn.ProtocolNotificationType(r.method),r.registrationMethod=qo.method})(N0||(Ft.DidSaveNotebookDocumentNotification=N0={}));var F0;(function(r){r.method="notebookDocument/didClose",r.messageDirection=zn.MessageDirection.clientToServer,r.type=new zn.ProtocolNotificationType(r.method),r.registrationMethod=qo.method})(F0||(Ft.DidCloseNotebookDocumentNotification=F0={}))});var j0=L(ud=>{"use strict";Object.defineProperty(ud,"__esModule",{value:!0});ud.InlineCompletionRequest=void 0;var M0=yt(),q0;(function(r){r.method="textDocument/inlineCompletion",r.messageDirection=M0.MessageDirection.clientToServer,r.type=new M0.ProtocolRequestType(r.method)})(q0||(ud.InlineCompletionRequest=q0={}))});var J2=L(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.WorkspaceSymbolRequest=F.CodeActionResolveRequest=F.CodeActionRequest=F.DocumentSymbolRequest=F.DocumentHighlightRequest=F.ReferencesRequest=F.DefinitionRequest=F.SignatureHelpRequest=F.SignatureHelpTriggerKind=F.HoverRequest=F.CompletionResolveRequest=F.CompletionRequest=F.CompletionTriggerKind=F.PublishDiagnosticsNotification=F.WatchKind=F.RelativePattern=F.FileChangeType=F.DidChangeWatchedFilesNotification=F.WillSaveTextDocumentWaitUntilRequest=F.WillSaveTextDocumentNotification=F.TextDocumentSaveReason=F.DidSaveTextDocumentNotification=F.DidCloseTextDocumentNotification=F.DidChangeTextDocumentNotification=F.TextDocumentContentChangeEvent=F.DidOpenTextDocumentNotification=F.TextDocumentSyncKind=F.TelemetryEventNotification=F.LogMessageNotification=F.ShowMessageRequest=F.ShowMessageNotification=F.MessageType=F.DidChangeConfigurationNotification=F.ExitNotification=F.ShutdownRequest=F.InitializedNotification=F.InitializeErrorCodes=F.InitializeRequest=F.WorkDoneProgressOptions=F.TextDocumentRegistrationOptions=F.StaticRegistrationOptions=F.PositionEncodingKind=F.FailureHandlingKind=F.ResourceOperationKind=F.UnregistrationRequest=F.RegistrationRequest=F.DocumentSelector=F.NotebookCellTextDocumentFilter=F.NotebookDocumentFilter=F.TextDocumentFilter=void 0;F.MonikerRequest=F.MonikerKind=F.UniquenessLevel=F.WillDeleteFilesRequest=F.DidDeleteFilesNotification=F.WillRenameFilesRequest=F.DidRenameFilesNotification=F.WillCreateFilesRequest=F.DidCreateFilesNotification=F.FileOperationPatternKind=F.LinkedEditingRangeRequest=F.ShowDocumentRequest=F.SemanticTokensRegistrationType=F.SemanticTokensRefreshRequest=F.SemanticTokensRangeRequest=F.SemanticTokensDeltaRequest=F.SemanticTokensRequest=F.TokenFormat=F.CallHierarchyPrepareRequest=F.CallHierarchyOutgoingCallsRequest=F.CallHierarchyIncomingCallsRequest=F.WorkDoneProgressCancelNotification=F.WorkDoneProgressCreateRequest=F.WorkDoneProgress=F.SelectionRangeRequest=F.DeclarationRequest=F.FoldingRangeRefreshRequest=F.FoldingRangeRequest=F.ColorPresentationRequest=F.DocumentColorRequest=F.ConfigurationRequest=F.DidChangeWorkspaceFoldersNotification=F.WorkspaceFoldersRequest=F.TypeDefinitionRequest=F.ImplementationRequest=F.ApplyWorkspaceEditRequest=F.ExecuteCommandRequest=F.PrepareRenameRequest=F.RenameRequest=F.PrepareSupportDefaultBehavior=F.DocumentOnTypeFormattingRequest=F.DocumentRangesFormattingRequest=F.DocumentRangeFormattingRequest=F.DocumentFormattingRequest=F.DocumentLinkResolveRequest=F.DocumentLinkRequest=F.CodeLensRefreshRequest=F.CodeLensResolveRequest=F.CodeLensRequest=F.WorkspaceSymbolResolveRequest=void 0;F.InlineCompletionRequest=F.DidCloseNotebookDocumentNotification=F.DidSaveNotebookDocumentNotification=F.DidChangeNotebookDocumentNotification=F.NotebookCellArrayChange=F.DidOpenNotebookDocumentNotification=F.NotebookDocumentSyncRegistrationType=F.NotebookDocument=F.NotebookCell=F.ExecutionSummary=F.NotebookCellKind=F.DiagnosticRefreshRequest=F.WorkspaceDiagnosticRequest=F.DocumentDiagnosticRequest=F.DocumentDiagnosticReportKind=F.DiagnosticServerCancellationData=F.InlayHintRefreshRequest=F.InlayHintResolveRequest=F.InlayHintRequest=F.InlineValueRefreshRequest=F.InlineValueRequest=F.TypeHierarchySupertypesRequest=F.TypeHierarchySubtypesRequest=F.TypeHierarchyPrepareRequest=void 0;var ne=yt(),U0=Xl(),er=zl(),YN=dP();Object.defineProperty(F,"ImplementationRequest",{enumerable:!0,get:function(){return YN.ImplementationRequest}});var JN=hP();Object.defineProperty(F,"TypeDefinitionRequest",{enumerable:!0,get:function(){return JN.TypeDefinitionRequest}});var z2=vP();Object.defineProperty(F,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return z2.WorkspaceFoldersRequest}});Object.defineProperty(F,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return z2.DidChangeWorkspaceFoldersNotification}});var ZN=bP();Object.defineProperty(F,"ConfigurationRequest",{enumerable:!0,get:function(){return ZN.ConfigurationRequest}});var G2=TP();Object.defineProperty(F,"DocumentColorRequest",{enumerable:!0,get:function(){return G2.DocumentColorRequest}});Object.defineProperty(F,"ColorPresentationRequest",{enumerable:!0,get:function(){return G2.ColorPresentationRequest}});var Q2=PP();Object.defineProperty(F,"FoldingRangeRequest",{enumerable:!0,get:function(){return Q2.FoldingRangeRequest}});Object.defineProperty(F,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return Q2.FoldingRangeRefreshRequest}});var eF=RP();Object.defineProperty(F,"DeclarationRequest",{enumerable:!0,get:function(){return eF.DeclarationRequest}});var tF=OP();Object.defineProperty(F,"SelectionRangeRequest",{enumerable:!0,get:function(){return tF.SelectionRangeRequest}});var gm=LP();Object.defineProperty(F,"WorkDoneProgress",{enumerable:!0,get:function(){return gm.WorkDoneProgress}});Object.defineProperty(F,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return gm.WorkDoneProgressCreateRequest}});Object.defineProperty(F,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return gm.WorkDoneProgressCancelNotification}});var mm=UP();Object.defineProperty(F,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return mm.CallHierarchyIncomingCallsRequest}});Object.defineProperty(F,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return mm.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(F,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return mm.CallHierarchyPrepareRequest}});var jo=KP();Object.defineProperty(F,"TokenFormat",{enumerable:!0,get:function(){return jo.TokenFormat}});Object.defineProperty(F,"SemanticTokensRequest",{enumerable:!0,get:function(){return jo.SemanticTokensRequest}});Object.defineProperty(F,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return jo.SemanticTokensDeltaRequest}});Object.defineProperty(F,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return jo.SemanticTokensRangeRequest}});Object.defineProperty(F,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return jo.SemanticTokensRefreshRequest}});Object.defineProperty(F,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return jo.SemanticTokensRegistrationType}});var rF=GP();Object.defineProperty(F,"ShowDocumentRequest",{enumerable:!0,get:function(){return rF.ShowDocumentRequest}});var nF=JP();Object.defineProperty(F,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return nF.LinkedEditingRangeRequest}});var Ns=o0();Object.defineProperty(F,"FileOperationPatternKind",{enumerable:!0,get:function(){return Ns.FileOperationPatternKind}});Object.defineProperty(F,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Ns.DidCreateFilesNotification}});Object.defineProperty(F,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Ns.WillCreateFilesRequest}});Object.defineProperty(F,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Ns.DidRenameFilesNotification}});Object.defineProperty(F,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Ns.WillRenameFilesRequest}});Object.defineProperty(F,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Ns.DidDeleteFilesNotification}});Object.defineProperty(F,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Ns.WillDeleteFilesRequest}});var vm=d0();Object.defineProperty(F,"UniquenessLevel",{enumerable:!0,get:function(){return vm.UniquenessLevel}});Object.defineProperty(F,"MonikerKind",{enumerable:!0,get:function(){return vm.MonikerKind}});Object.defineProperty(F,"MonikerRequest",{enumerable:!0,get:function(){return vm.MonikerRequest}});var wm=g0();Object.defineProperty(F,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return wm.TypeHierarchyPrepareRequest}});Object.defineProperty(F,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return wm.TypeHierarchySubtypesRequest}});Object.defineProperty(F,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return wm.TypeHierarchySupertypesRequest}});var Y2=w0();Object.defineProperty(F,"InlineValueRequest",{enumerable:!0,get:function(){return Y2.InlineValueRequest}});Object.defineProperty(F,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return Y2.InlineValueRefreshRequest}});var ym=D0();Object.defineProperty(F,"InlayHintRequest",{enumerable:!0,get:function(){return ym.InlayHintRequest}});Object.defineProperty(F,"InlayHintResolveRequest",{enumerable:!0,get:function(){return ym.InlayHintResolveRequest}});Object.defineProperty(F,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return ym.InlayHintRefreshRequest}});var au=R0();Object.defineProperty(F,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return au.DiagnosticServerCancellationData}});Object.defineProperty(F,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return au.DocumentDiagnosticReportKind}});Object.defineProperty(F,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return au.DocumentDiagnosticRequest}});Object.defineProperty(F,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return au.WorkspaceDiagnosticRequest}});Object.defineProperty(F,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return au.DiagnosticRefreshRequest}});var Gn=L0();Object.defineProperty(F,"NotebookCellKind",{enumerable:!0,get:function(){return Gn.NotebookCellKind}});Object.defineProperty(F,"ExecutionSummary",{enumerable:!0,get:function(){return Gn.ExecutionSummary}});Object.defineProperty(F,"NotebookCell",{enumerable:!0,get:function(){return Gn.NotebookCell}});Object.defineProperty(F,"NotebookDocument",{enumerable:!0,get:function(){return Gn.NotebookDocument}});Object.defineProperty(F,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Gn.NotebookDocumentSyncRegistrationType}});Object.defineProperty(F,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Gn.DidOpenNotebookDocumentNotification}});Object.defineProperty(F,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Gn.NotebookCellArrayChange}});Object.defineProperty(F,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Gn.DidChangeNotebookDocumentNotification}});Object.defineProperty(F,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Gn.DidSaveNotebookDocumentNotification}});Object.defineProperty(F,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Gn.DidCloseNotebookDocumentNotification}});var iF=j0();Object.defineProperty(F,"InlineCompletionRequest",{enumerable:!0,get:function(){return iF.InlineCompletionRequest}});var dm;(function(r){function e(t){let n=t;return er.string(n)||er.string(n.language)||er.string(n.scheme)||er.string(n.pattern)}r.is=e})(dm||(F.TextDocumentFilter=dm={}));var fm;(function(r){function e(t){let n=t;return er.objectLiteral(n)&&(er.string(n.notebookType)||er.string(n.scheme)||er.string(n.pattern))}r.is=e})(fm||(F.NotebookDocumentFilter=fm={}));var pm;(function(r){function e(t){let n=t;return er.objectLiteral(n)&&(er.string(n.notebook)||fm.is(n.notebook))&&(n.language===void 0||er.string(n.language))}r.is=e})(pm||(F.NotebookCellTextDocumentFilter=pm={}));var hm;(function(r){function e(t){if(!Array.isArray(t))return!1;for(let n of t)if(!er.string(n)&&!dm.is(n)&&!pm.is(n))return!1;return!0}r.is=e})(hm||(F.DocumentSelector=hm={}));var $0;(function(r){r.method="client/registerCapability",r.messageDirection=ne.MessageDirection.serverToClient,r.type=new ne.ProtocolRequestType(r.method)})($0||(F.RegistrationRequest=$0={}));var B0;(function(r){r.method="client/unregisterCapability",r.messageDirection=ne.MessageDirection.serverToClient,r.type=new ne.ProtocolRequestType(r.method)})(B0||(F.UnregistrationRequest=B0={}));var W0;(function(r){r.Create="create",r.Rename="rename",r.Delete="delete"})(W0||(F.ResourceOperationKind=W0={}));var V0;(function(r){r.Abort="abort",r.Transactional="transactional",r.TextOnlyTransactional="textOnlyTransactional",r.Undo="undo"})(V0||(F.FailureHandlingKind=V0={}));var H0;(function(r){r.UTF8="utf-8",r.UTF16="utf-16",r.UTF32="utf-32"})(H0||(F.PositionEncodingKind=H0={}));var K0;(function(r){function e(t){let n=t;return n&&er.string(n.id)&&n.id.length>0}r.hasId=e})(K0||(F.StaticRegistrationOptions=K0={}));var X0;(function(r){function e(t){let n=t;return n&&(n.documentSelector===null||hm.is(n.documentSelector))}r.is=e})(X0||(F.TextDocumentRegistrationOptions=X0={}));var z0;(function(r){function e(n){let i=n;return er.objectLiteral(i)&&(i.workDoneProgress===void 0||er.boolean(i.workDoneProgress))}r.is=e;function t(n){let i=n;return i&&er.boolean(i.workDoneProgress)}r.hasWorkDoneProgress=t})(z0||(F.WorkDoneProgressOptions=z0={}));var G0;(function(r){r.method="initialize",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(G0||(F.InitializeRequest=G0={}));var Q0;(function(r){r.unknownProtocolVersion=1})(Q0||(F.InitializeErrorCodes=Q0={}));var Y0;(function(r){r.method="initialized",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolNotificationType(r.method)})(Y0||(F.InitializedNotification=Y0={}));var J0;(function(r){r.method="shutdown",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType0(r.method)})(J0||(F.ShutdownRequest=J0={}));var Z0;(function(r){r.method="exit",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolNotificationType0(r.method)})(Z0||(F.ExitNotification=Z0={}));var e2;(function(r){r.method="workspace/didChangeConfiguration",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolNotificationType(r.method)})(e2||(F.DidChangeConfigurationNotification=e2={}));var t2;(function(r){r.Error=1,r.Warning=2,r.Info=3,r.Log=4,r.Debug=5})(t2||(F.MessageType=t2={}));var r2;(function(r){r.method="window/showMessage",r.messageDirection=ne.MessageDirection.serverToClient,r.type=new ne.ProtocolNotificationType(r.method)})(r2||(F.ShowMessageNotification=r2={}));var n2;(function(r){r.method="window/showMessageRequest",r.messageDirection=ne.MessageDirection.serverToClient,r.type=new ne.ProtocolRequestType(r.method)})(n2||(F.ShowMessageRequest=n2={}));var i2;(function(r){r.method="window/logMessage",r.messageDirection=ne.MessageDirection.serverToClient,r.type=new ne.ProtocolNotificationType(r.method)})(i2||(F.LogMessageNotification=i2={}));var s2;(function(r){r.method="telemetry/event",r.messageDirection=ne.MessageDirection.serverToClient,r.type=new ne.ProtocolNotificationType(r.method)})(s2||(F.TelemetryEventNotification=s2={}));var o2;(function(r){r.None=0,r.Full=1,r.Incremental=2})(o2||(F.TextDocumentSyncKind=o2={}));var a2;(function(r){r.method="textDocument/didOpen",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolNotificationType(r.method)})(a2||(F.DidOpenTextDocumentNotification=a2={}));var u2;(function(r){function e(n){let i=n;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}r.isIncremental=e;function t(n){let i=n;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}r.isFull=t})(u2||(F.TextDocumentContentChangeEvent=u2={}));var c2;(function(r){r.method="textDocument/didChange",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolNotificationType(r.method)})(c2||(F.DidChangeTextDocumentNotification=c2={}));var l2;(function(r){r.method="textDocument/didClose",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolNotificationType(r.method)})(l2||(F.DidCloseTextDocumentNotification=l2={}));var d2;(function(r){r.method="textDocument/didSave",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolNotificationType(r.method)})(d2||(F.DidSaveTextDocumentNotification=d2={}));var f2;(function(r){r.Manual=1,r.AfterDelay=2,r.FocusOut=3})(f2||(F.TextDocumentSaveReason=f2={}));var p2;(function(r){r.method="textDocument/willSave",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolNotificationType(r.method)})(p2||(F.WillSaveTextDocumentNotification=p2={}));var h2;(function(r){r.method="textDocument/willSaveWaitUntil",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(h2||(F.WillSaveTextDocumentWaitUntilRequest=h2={}));var g2;(function(r){r.method="workspace/didChangeWatchedFiles",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolNotificationType(r.method)})(g2||(F.DidChangeWatchedFilesNotification=g2={}));var m2;(function(r){r.Created=1,r.Changed=2,r.Deleted=3})(m2||(F.FileChangeType=m2={}));var v2;(function(r){function e(t){let n=t;return er.objectLiteral(n)&&(U0.URI.is(n.baseUri)||U0.WorkspaceFolder.is(n.baseUri))&&er.string(n.pattern)}r.is=e})(v2||(F.RelativePattern=v2={}));var w2;(function(r){r.Create=1,r.Change=2,r.Delete=4})(w2||(F.WatchKind=w2={}));var y2;(function(r){r.method="textDocument/publishDiagnostics",r.messageDirection=ne.MessageDirection.serverToClient,r.type=new ne.ProtocolNotificationType(r.method)})(y2||(F.PublishDiagnosticsNotification=y2={}));var b2;(function(r){r.Invoked=1,r.TriggerCharacter=2,r.TriggerForIncompleteCompletions=3})(b2||(F.CompletionTriggerKind=b2={}));var C2;(function(r){r.method="textDocument/completion",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(C2||(F.CompletionRequest=C2={}));var D2;(function(r){r.method="completionItem/resolve",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(D2||(F.CompletionResolveRequest=D2={}));var T2;(function(r){r.method="textDocument/hover",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(T2||(F.HoverRequest=T2={}));var S2;(function(r){r.Invoked=1,r.TriggerCharacter=2,r.ContentChange=3})(S2||(F.SignatureHelpTriggerKind=S2={}));var E2;(function(r){r.method="textDocument/signatureHelp",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(E2||(F.SignatureHelpRequest=E2={}));var P2;(function(r){r.method="textDocument/definition",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(P2||(F.DefinitionRequest=P2={}));var x2;(function(r){r.method="textDocument/references",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(x2||(F.ReferencesRequest=x2={}));var k2;(function(r){r.method="textDocument/documentHighlight",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(k2||(F.DocumentHighlightRequest=k2={}));var R2;(function(r){r.method="textDocument/documentSymbol",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(R2||(F.DocumentSymbolRequest=R2={}));var _2;(function(r){r.method="textDocument/codeAction",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(_2||(F.CodeActionRequest=_2={}));var I2;(function(r){r.method="codeAction/resolve",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(I2||(F.CodeActionResolveRequest=I2={}));var O2;(function(r){r.method="workspace/symbol",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(O2||(F.WorkspaceSymbolRequest=O2={}));var A2;(function(r){r.method="workspaceSymbol/resolve",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(A2||(F.WorkspaceSymbolResolveRequest=A2={}));var N2;(function(r){r.method="textDocument/codeLens",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(N2||(F.CodeLensRequest=N2={}));var F2;(function(r){r.method="codeLens/resolve",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(F2||(F.CodeLensResolveRequest=F2={}));var L2;(function(r){r.method="workspace/codeLens/refresh",r.messageDirection=ne.MessageDirection.serverToClient,r.type=new ne.ProtocolRequestType0(r.method)})(L2||(F.CodeLensRefreshRequest=L2={}));var M2;(function(r){r.method="textDocument/documentLink",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(M2||(F.DocumentLinkRequest=M2={}));var q2;(function(r){r.method="documentLink/resolve",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(q2||(F.DocumentLinkResolveRequest=q2={}));var j2;(function(r){r.method="textDocument/formatting",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(j2||(F.DocumentFormattingRequest=j2={}));var U2;(function(r){r.method="textDocument/rangeFormatting",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(U2||(F.DocumentRangeFormattingRequest=U2={}));var $2;(function(r){r.method="textDocument/rangesFormatting",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})($2||(F.DocumentRangesFormattingRequest=$2={}));var B2;(function(r){r.method="textDocument/onTypeFormatting",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(B2||(F.DocumentOnTypeFormattingRequest=B2={}));var W2;(function(r){r.Identifier=1})(W2||(F.PrepareSupportDefaultBehavior=W2={}));var V2;(function(r){r.method="textDocument/rename",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(V2||(F.RenameRequest=V2={}));var H2;(function(r){r.method="textDocument/prepareRename",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(H2||(F.PrepareRenameRequest=H2={}));var K2;(function(r){r.method="workspace/executeCommand",r.messageDirection=ne.MessageDirection.clientToServer,r.type=new ne.ProtocolRequestType(r.method)})(K2||(F.ExecuteCommandRequest=K2={}));var X2;(function(r){r.method="workspace/applyEdit",r.messageDirection=ne.MessageDirection.serverToClient,r.type=new ne.ProtocolRequestType("workspace/applyEdit")})(X2||(F.ApplyWorkspaceEditRequest=X2={}))});var ex=L(cd=>{"use strict";Object.defineProperty(cd,"__esModule",{value:!0});cd.createProtocolConnection=void 0;var Z2=As();function sF(r,e,t,n){return Z2.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,Z2.createMessageConnection)(r,e,t,n)}cd.createProtocolConnection=sF});var rx=L(Br=>{"use strict";var oF=Br&&Br.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),ld=Br&&Br.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&oF(e,r,t)};Object.defineProperty(Br,"__esModule",{value:!0});Br.LSPErrorCodes=Br.createProtocolConnection=void 0;ld(As(),Br);ld(Xl(),Br);ld(yt(),Br);ld(J2(),Br);var aF=ex();Object.defineProperty(Br,"createProtocolConnection",{enumerable:!0,get:function(){return aF.createProtocolConnection}});var tx;(function(r){r.lspReservedErrorRangeStart=-32899,r.RequestFailed=-32803,r.ServerCancelled=-32802,r.ContentModified=-32801,r.RequestCancelled=-32800,r.lspReservedErrorRangeEnd=-32800})(tx||(Br.LSPErrorCodes=tx={}))});var Ce=L(Qn=>{"use strict";var uF=Qn&&Qn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),nx=Qn&&Qn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&uF(e,r,t)};Object.defineProperty(Qn,"__esModule",{value:!0});Qn.createProtocolConnection=void 0;var cF=nm();nx(nm(),Qn);nx(rx(),Qn);function lF(r,e,t,n){return(0,cF.createMessageConnection)(r,e,t,n)}Qn.createProtocolConnection=lF});var dd=L(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.forEach=mr.mapAsync=mr.map=mr.clearTestMode=mr.setTestMode=mr.Semaphore=mr.Delayer=void 0;var cu=Ce(),bm=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(n=>{this.onSuccess=n}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var n=this.task();return this.task=void 0,n})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,cu.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};mr.Delayer=bm;var Cm=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,cu.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(n=>{this._active--,e.resolve(n),this.runNext()},n=>{this._active--,e.reject(n),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};mr.Semaphore=Cm;var Dm=!1;function dF(){Dm=!0}mr.setTestMode=dF;function fF(){Dm=!1}mr.clearTestMode=fF;var ix=15,uu=class{constructor(e=ix){this.yieldAfter=Dm===!0?Math.max(e,2):Math.max(e,ix),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function pF(r,e,t,n){if(r.length===0)return[];let i=new Array(r.length),s=new uu(n?.yieldAfter);function o(u){s.start();for(let c=u;c<r.length;c++)if(i[c]=e(r[c]),s.shouldYield())return n?.yieldCallback&&n.yieldCallback(),c+1;return-1}let a=o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,cu.RAL)().timer.setImmediate(()=>{u(o(a))})});return i}mr.map=pF;async function hF(r,e,t,n){if(r.length===0)return[];let i=new Array(r.length),s=new uu(n?.yieldAfter);async function o(u){s.start();for(let c=u;c<r.length;c++)if(i[c]=await e(r[c],t),s.shouldYield())return n?.yieldCallback&&n.yieldCallback(),c+1;return-1}let a=await o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,cu.RAL)().timer.setImmediate(()=>{u(o(a))})});return i}mr.mapAsync=hF;async function gF(r,e,t,n){if(r.length===0)return;let i=new uu(n?.yieldAfter);function s(a){i.start();for(let u=a;u<r.length;u++)if(e(r[u]),i.shouldYield())return n?.yieldCallback&&n.yieldCallback(),u+1;return-1}let o=s(0);for(;o!==-1&&!(t!==void 0&&t.isCancellationRequested);)o=await new Promise(a=>{(0,cu.RAL)().timer.setImmediate(()=>{a(s(o))})})}mr.forEach=gF});var Em=L(Sm=>{"use strict";Object.defineProperty(Sm,"__esModule",{value:!0});var mF=require("vscode"),Tm=class extends mF.CompletionItem{constructor(e){super(e)}};Sm.default=Tm});var km=L(xm=>{"use strict";Object.defineProperty(xm,"__esModule",{value:!0});var vF=require("vscode"),Pm=class extends vF.CodeLens{constructor(e){super(e)}};xm.default=Pm});var Im=L(_m=>{"use strict";Object.defineProperty(_m,"__esModule",{value:!0});var wF=require("vscode"),Rm=class extends wF.DocumentLink{constructor(e,t){super(e,t)}};_m.default=Rm});var Nm=L(Am=>{"use strict";Object.defineProperty(Am,"__esModule",{value:!0});var yF=require("vscode"),Om=class extends yF.CodeAction{constructor(e,t){super(e),this.data=t}};Am.default=Om});var Mm=L(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.ProtocolDiagnostic=Uo.DiagnosticCode=void 0;var bF=require("vscode"),Fm=gn(),sx;(function(r){function e(t){let n=t;return n!=null&&(Fm.number(n.value)||Fm.string(n.value))&&Fm.string(n.target)}r.is=e})(sx||(Uo.DiagnosticCode=sx={}));var Lm=class extends bF.Diagnostic{constructor(e,t,n,i){super(e,t,n),this.data=i,this.hasDiagnosticCode=!1}};Uo.ProtocolDiagnostic=Lm});var Um=L(jm=>{"use strict";Object.defineProperty(jm,"__esModule",{value:!0});var CF=require("vscode"),qm=class extends CF.CallHierarchyItem{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s,o),a!==void 0&&(this.data=a)}};jm.default=qm});var Wm=L(Bm=>{"use strict";Object.defineProperty(Bm,"__esModule",{value:!0});var DF=require("vscode"),$m=class extends DF.TypeHierarchyItem{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s,o),a!==void 0&&(this.data=a)}};Bm.default=$m});var Km=L(Hm=>{"use strict";Object.defineProperty(Hm,"__esModule",{value:!0});var fd=require("vscode"),Vm=class extends fd.SymbolInformation{constructor(e,t,n,i,s){let o=!(i instanceof fd.Uri);super(e,t,n,o?i:new fd.Location(i,new fd.Range(0,0,0,0))),this.hasRange=o,s!==void 0&&(this.data=s)}};Hm.default=Vm});var Gm=L(zm=>{"use strict";Object.defineProperty(zm,"__esModule",{value:!0});var TF=require("vscode"),Xm=class extends TF.InlayHint{constructor(e,t,n){super(e,t,n)}};zm.default=Xm});var cx=L(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});pd.createConverter=void 0;var Kt=require("vscode"),Te=Ce(),Fs=gn(),ox=dd(),SF=Em(),EF=km(),PF=Im(),ax=Nm(),ux=Mm(),xF=Um(),kF=Wm(),RF=Km(),_F=Gm(),Qm;(function(r){function e(t){let n=t;return n&&!!n.inserting&&!!n.replacing}r.is=e})(Qm||(Qm={}));function IF(r){let t=r||(S=>S.toString());function n(S){return t(S)}function i(S){return{uri:t(S.uri)}}function s(S){return{uri:t(S.uri),languageId:S.languageId,version:S.version,text:S.getText()}}function o(S){return{uri:t(S.uri),version:S.version}}function a(S){return{textDocument:s(S)}}function u(S){let X=S;return!!X.document&&!!X.contentChanges}function c(S){let X=S;return!!X.uri&&!!X.version}function l(S,X,de){if(c(S))return{textDocument:{uri:t(S.uri),version:S.version},contentChanges:[{text:S.getText()}]};if(u(S)){let He=X,$=de;return{textDocument:{uri:t(He),version:$},contentChanges:S.contentChanges.map(q=>{let j=q.range;return{range:{start:{line:j.start.line,character:j.start.character},end:{line:j.end.line,character:j.end.character}},rangeLength:q.rangeLength,text:q.text}})}}else throw Error("Unsupported text document change parameter")}function f(S){return{textDocument:i(S)}}function d(S,X=!1){let de={textDocument:i(S)};return X&&(de.text=S.getText()),de}function h(S){switch(S){case Kt.TextDocumentSaveReason.Manual:return Te.TextDocumentSaveReason.Manual;case Kt.TextDocumentSaveReason.AfterDelay:return Te.TextDocumentSaveReason.AfterDelay;case Kt.TextDocumentSaveReason.FocusOut:return Te.TextDocumentSaveReason.FocusOut}return Te.TextDocumentSaveReason.Manual}function m(S){return{textDocument:i(S.document),reason:h(S.reason)}}function D(S){return{files:S.files.map(X=>({uri:t(X)}))}}function _(S){return{files:S.files.map(X=>({oldUri:t(X.oldUri),newUri:t(X.newUri)}))}}function R(S){return{files:S.files.map(X=>({uri:t(X)}))}}function N(S){return{files:S.files.map(X=>({uri:t(X)}))}}function w(S){return{files:S.files.map(X=>({oldUri:t(X.oldUri),newUri:t(X.newUri)}))}}function p(S){return{files:S.files.map(X=>({uri:t(X)}))}}function v(S,X){return{textDocument:i(S),position:ue(X)}}function g(S){switch(S){case Kt.CompletionTriggerKind.TriggerCharacter:return Te.CompletionTriggerKind.TriggerCharacter;case Kt.CompletionTriggerKind.TriggerForIncompleteCompletions:return Te.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return Te.CompletionTriggerKind.Invoked}}function k(S,X,de){return{textDocument:i(S),position:ue(X),context:{triggerKind:g(de.triggerKind),triggerCharacter:de.triggerCharacter}}}function b(S){switch(S){case Kt.SignatureHelpTriggerKind.Invoke:return Te.SignatureHelpTriggerKind.Invoked;case Kt.SignatureHelpTriggerKind.TriggerCharacter:return Te.SignatureHelpTriggerKind.TriggerCharacter;case Kt.SignatureHelpTriggerKind.ContentChange:return Te.SignatureHelpTriggerKind.ContentChange}}function C(S){return{label:S.label}}function E(S){return S.map(C)}function I(S){return{label:S.label,parameters:E(S.parameters)}}function B(S){return S.map(I)}function z(S){return S===void 0?S:{signatures:B(S.signatures),activeSignature:S.activeSignature,activeParameter:S.activeParameter}}function te(S,X,de){return{textDocument:i(S),position:ue(X),context:{isRetrigger:de.isRetrigger,triggerCharacter:de.triggerCharacter,triggerKind:b(de.triggerKind),activeSignatureHelp:z(de.activeSignatureHelp)}}}function ue(S){return{line:S.line,character:S.character}}function Q(S){return S==null?S:{line:S.line>Te.uinteger.MAX_VALUE?Te.uinteger.MAX_VALUE:S.line,character:S.character>Te.uinteger.MAX_VALUE?Te.uinteger.MAX_VALUE:S.character}}function se(S,X){return ox.map(S,Q,X)}function fe(S){return S.map(Q)}function _e(S){return S==null?S:{start:Q(S.start),end:Q(S.end)}}function Ke(S){return S.map(_e)}function gt(S){return S==null?S:Te.Location.create(n(S.uri),_e(S.range))}function Tt(S){switch(S){case Kt.DiagnosticSeverity.Error:return Te.DiagnosticSeverity.Error;case Kt.DiagnosticSeverity.Warning:return Te.DiagnosticSeverity.Warning;case Kt.DiagnosticSeverity.Information:return Te.DiagnosticSeverity.Information;case Kt.DiagnosticSeverity.Hint:return Te.DiagnosticSeverity.Hint}}function br(S){if(!S)return;let X=[];for(let de of S){let He=$t(de);He!==void 0&&X.push(He)}return X.length>0?X:void 0}function $t(S){switch(S){case Kt.DiagnosticTag.Unnecessary:return Te.DiagnosticTag.Unnecessary;case Kt.DiagnosticTag.Deprecated:return Te.DiagnosticTag.Deprecated;default:return}}function nr(S){return{message:S.message,location:gt(S.location)}}function O(S){return S.map(nr)}function x(S){if(S!=null)return Fs.number(S)||Fs.string(S)?S:{value:S.value,target:n(S.target)}}function J(S){let X=Te.Diagnostic.create(_e(S.range),S.message),de=S instanceof ux.ProtocolDiagnostic?S:void 0;de!==void 0&&de.data!==void 0&&(X.data=de.data);let He=x(S.code);return ux.DiagnosticCode.is(He)?de!==void 0&&de.hasDiagnosticCode?X.code=He:(X.code=He.value,X.codeDescription={href:He.target}):X.code=He,Fs.number(S.severity)&&(X.severity=Tt(S.severity)),Array.isArray(S.tags)&&(X.tags=br(S.tags)),S.relatedInformation&&(X.relatedInformation=O(S.relatedInformation)),S.source&&(X.source=S.source),X}function W(S,X){return S==null?S:ox.map(S,J,X)}function Re(S){return S==null?S:S.map(J)}function Qe(S,X){switch(S){case"$string":return X;case Te.MarkupKind.PlainText:return{kind:S,value:X};case Te.MarkupKind.Markdown:return{kind:S,value:X.value};default:return`Unsupported Markup content received. Kind is: ${S}`}}function Ie(S){switch(S){case Kt.CompletionItemTag.Deprecated:return Te.CompletionItemTag.Deprecated}}function mt(S){if(S===void 0)return S;let X=[];for(let de of S){let He=Ie(de);He!==void 0&&X.push(He)}return X}function Rt(S,X){return X!==void 0?X:S+1}function Xt(S,X=!1){let de,He;Fs.string(S.label)?de=S.label:(de=S.label.label,X&&(S.label.detail!==void 0||S.label.description!==void 0)&&(He={detail:S.label.detail,description:S.label.description}));let $={label:de};He!==void 0&&($.labelDetails=He);let P=S instanceof SF.default?S:void 0;S.detail&&($.detail=S.detail),S.documentation&&(!P||P.documentationFormat==="$string"?$.documentation=S.documentation:$.documentation=Qe(P.documentationFormat,S.documentation)),S.filterText&&($.filterText=S.filterText),lt($,S),Fs.number(S.kind)&&($.kind=Rt(S.kind,P&&P.originalItemKind)),S.sortText&&($.sortText=S.sortText),S.additionalTextEdits&&($.additionalTextEdits=vt(S.additionalTextEdits)),S.commitCharacters&&($.commitCharacters=S.commitCharacters.slice()),S.command&&($.command=ae(S.command)),(S.preselect===!0||S.preselect===!1)&&($.preselect=S.preselect);let q=mt(S.tags);if(P){if(P.data!==void 0&&($.data=P.data),P.deprecated===!0||P.deprecated===!1){if(P.deprecated===!0&&q!==void 0&&q.length>0){let j=q.indexOf(Kt.CompletionItemTag.Deprecated);j!==-1&&q.splice(j,1)}$.deprecated=P.deprecated}P.insertTextMode!==void 0&&($.insertTextMode=P.insertTextMode)}return q!==void 0&&q.length>0&&($.tags=q),$.insertTextMode===void 0&&S.keepWhitespace===!0&&($.insertTextMode=Te.InsertTextMode.adjustIndentation),$}function lt(S,X){let de=Te.InsertTextFormat.PlainText,He,$;X.textEdit?(He=X.textEdit.newText,$=X.textEdit.range):X.insertText instanceof Kt.SnippetString?(de=Te.InsertTextFormat.Snippet,He=X.insertText.value):He=X.insertText,X.range&&($=X.range),S.insertTextFormat=de,X.fromEdit&&He!==void 0&&$!==void 0?S.textEdit=_t(He,$):S.insertText=He}function _t(S,X){return Qm.is(X)?Te.InsertReplaceEdit.create(S,_e(X.inserting),_e(X.replacing)):{newText:S,range:_e(X)}}function ln(S){return{range:_e(S.range),newText:S.newText}}function vt(S){return S==null?S:S.map(ln)}function Bt(S){return S<=Kt.SymbolKind.TypeParameter?S+1:Te.SymbolKind.Property}function Wt(S){return S}function zr(S){return S.map(Wt)}function Ir(S,X,de){return{textDocument:i(S),position:ue(X),context:{includeDeclaration:de.includeDeclaration}}}async function Nn(S,X){let de=Te.CodeAction.create(S.title);if(S instanceof ax.default&&S.data!==void 0&&(de.data=S.data),S.kind!==void 0&&(de.kind=M(S.kind)),S.diagnostics!==void 0&&(de.diagnostics=await W(S.diagnostics,X)),S.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return S.command!==void 0&&(de.command=ae(S.command)),S.isPreferred!==void 0&&(de.isPreferred=S.isPreferred),S.disabled!==void 0&&(de.disabled={reason:S.disabled.reason}),de}function ii(S){let X=Te.CodeAction.create(S.title);if(S instanceof ax.default&&S.data!==void 0&&(X.data=S.data),S.kind!==void 0&&(X.kind=M(S.kind)),S.diagnostics!==void 0&&(X.diagnostics=Re(S.diagnostics)),S.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return S.command!==void 0&&(X.command=ae(S.command)),S.isPreferred!==void 0&&(X.isPreferred=S.isPreferred),S.disabled!==void 0&&(X.disabled={reason:S.disabled.reason}),X}async function Tn(S,X){if(S==null)return S;let de;return S.only&&Fs.string(S.only.value)&&(de=[S.only.value]),Te.CodeActionContext.create(await W(S.diagnostics,X),de,Cr(S.triggerKind))}function si(S){if(S==null)return S;let X;return S.only&&Fs.string(S.only.value)&&(X=[S.only.value]),Te.CodeActionContext.create(Re(S.diagnostics),X,Cr(S.triggerKind))}function Cr(S){switch(S){case Kt.CodeActionTriggerKind.Invoke:return Te.CodeActionTriggerKind.Invoked;case Kt.CodeActionTriggerKind.Automatic:return Te.CodeActionTriggerKind.Automatic;default:return}}function M(S){if(S!=null)return S.value}function Y(S){return S==null?S:Te.InlineValueContext.create(S.frameId,_e(S.stoppedLocation))}function ie(S,X,de){return{context:Te.InlineCompletionContext.create(de.triggerKind,de.selectedCompletionInfo),textDocument:i(S),position:Q(X)}}function ae(S){let X=Te.Command.create(S.title,S.command);return S.arguments&&(X.arguments=S.arguments),X}function Be(S){let X=Te.CodeLens.create(_e(S.range));return S.command&&(X.command=ae(S.command)),S instanceof EF.default&&S.data&&(X.data=S.data),X}function Ue(S,X){let de={tabSize:S.tabSize,insertSpaces:S.insertSpaces};return X.trimTrailingWhitespace&&(de.trimTrailingWhitespace=!0),X.trimFinalNewlines&&(de.trimFinalNewlines=!0),X.insertFinalNewline&&(de.insertFinalNewline=!0),de}function Ye(S){return{textDocument:i(S)}}function st(S){return{textDocument:i(S)}}function xe(S){let X=Te.DocumentLink.create(_e(S.range));S.target&&(X.target=n(S.target)),S.tooltip!==void 0&&(X.tooltip=S.tooltip);let de=S instanceof PF.default?S:void 0;return de&&de.data&&(X.data=de.data),X}function Ve(S){return{textDocument:i(S)}}function Fe(S){let X={name:S.name,kind:Bt(S.kind),uri:n(S.uri),range:_e(S.range),selectionRange:_e(S.selectionRange)};return S.detail!==void 0&&S.detail.length>0&&(X.detail=S.detail),S.tags!==void 0&&(X.tags=zr(S.tags)),S instanceof xF.default&&S.data!==void 0&&(X.data=S.data),X}function ot(S){let X={name:S.name,kind:Bt(S.kind),uri:n(S.uri),range:_e(S.range),selectionRange:_e(S.selectionRange)};return S.detail!==void 0&&S.detail.length>0&&(X.detail=S.detail),S.tags!==void 0&&(X.tags=zr(S.tags)),S instanceof kF.default&&S.data!==void 0&&(X.data=S.data),X}function It(S){let X=S instanceof RF.default?{name:S.name,kind:Bt(S.kind),location:S.hasRange?gt(S.location):{uri:t(S.location.uri)},data:S.data}:{name:S.name,kind:Bt(S.kind),location:gt(S.location)};return S.tags!==void 0&&(X.tags=zr(S.tags)),S.containerName!==""&&(X.containerName=S.containerName),X}function Yt(S){let X=typeof S.label=="string"?S.label:S.label.map(ki),de=Te.InlayHint.create(Q(S.position),X);return S.kind!==void 0&&(de.kind=S.kind),S.textEdits!==void 0&&(de.textEdits=vt(S.textEdits)),S.tooltip!==void 0&&(de.tooltip=Ri(S.tooltip)),S.paddingLeft!==void 0&&(de.paddingLeft=S.paddingLeft),S.paddingRight!==void 0&&(de.paddingRight=S.paddingRight),S instanceof _F.default&&S.data!==void 0&&(de.data=S.data),de}function ki(S){let X=Te.InlayHintLabelPart.create(S.value);return S.location!==void 0&&(X.location=gt(S.location)),S.command!==void 0&&(X.command=ae(S.command)),S.tooltip!==void 0&&(X.tooltip=Ri(S.tooltip)),X}function Ri(S){return typeof S=="string"?S:{kind:Te.MarkupKind.Markdown,value:S.value}}return{asUri:n,asTextDocumentIdentifier:i,asTextDocumentItem:s,asVersionedTextDocumentIdentifier:o,asOpenTextDocumentParams:a,asChangeTextDocumentParams:l,asCloseTextDocumentParams:f,asSaveTextDocumentParams:d,asWillSaveTextDocumentParams:m,asDidCreateFilesParams:D,asDidRenameFilesParams:_,asDidDeleteFilesParams:R,asWillCreateFilesParams:N,asWillRenameFilesParams:w,asWillDeleteFilesParams:p,asTextDocumentPositionParams:v,asCompletionParams:k,asSignatureHelpParams:te,asWorkerPosition:ue,asRange:_e,asRanges:Ke,asPosition:Q,asPositions:se,asPositionsSync:fe,asLocation:gt,asDiagnosticSeverity:Tt,asDiagnosticTag:$t,asDiagnostic:J,asDiagnostics:W,asDiagnosticsSync:Re,asCompletionItem:Xt,asTextEdit:ln,asSymbolKind:Bt,asSymbolTag:Wt,asSymbolTags:zr,asReferenceParams:Ir,asCodeAction:Nn,asCodeActionSync:ii,asCodeActionContext:Tn,asCodeActionContextSync:si,asInlineValueContext:Y,asCommand:ae,asCodeLens:Be,asFormattingOptions:Ue,asDocumentSymbolParams:Ye,asCodeLensParams:st,asDocumentLink:xe,asDocumentLinkParams:Ve,asCallHierarchyItem:Fe,asTypeHierarchyItem:ot,asInlayHint:Yt,asWorkspaceSymbol:It,asInlineCompletionParams:ie}}pd.createConverter=IF});var fx=L(gd=>{"use strict";Object.defineProperty(gd,"__esModule",{value:!0});gd.createConverter=void 0;var oe=require("vscode"),ye=Ce(),wn=gn(),We=dd(),OF=Em(),AF=km(),NF=Im(),FF=Nm(),lx=Mm(),LF=Um(),MF=Wm(),qF=Km(),jF=Gm(),dx=Ce(),hd;(function(r){function e(t){let n=t;return n&&wn.string(n.language)&&wn.string(n.value)}r.is=e})(hd||(hd={}));function UF(r,e,t){let i=r||(y=>oe.Uri.parse(y));function s(y){return i(y)}function o(y){let U=[];for(let ee of y)if(typeof ee=="string")U.push(ee);else if(dx.NotebookCellTextDocumentFilter.is(ee))if(typeof ee.notebook=="string")U.push({notebookType:ee.notebook,language:ee.language});else{let he=ee.notebook.notebookType??"*";U.push({notebookType:he,scheme:ee.notebook.scheme,pattern:ee.notebook.pattern,language:ee.language})}else dx.TextDocumentFilter.is(ee)&&U.push({language:ee.language,scheme:ee.scheme,pattern:ee.pattern});return U}async function a(y,U){return We.map(y,c,U)}function u(y){let U=new Array(y.length);for(let ee=0;ee<y.length;ee++)U[ee]=c(y[ee]);return U}function c(y){let U=new lx.ProtocolDiagnostic(m(y.range),y.message,_(y.severity),y.data);if(y.code!==void 0){if(typeof y.code=="string"||typeof y.code=="number")ye.CodeDescription.is(y.codeDescription)?U.code={value:y.code,target:s(y.codeDescription.href)}:U.code=y.code;else if(lx.DiagnosticCode.is(y.code)){U.hasDiagnosticCode=!0;let ee=y.code;U.code={value:ee.value,target:s(ee.target)}}}return y.source&&(U.source=y.source),y.relatedInformation&&(U.relatedInformation=l(y.relatedInformation)),Array.isArray(y.tags)&&(U.tags=f(y.tags)),U}function l(y){let U=new Array(y.length);for(let ee=0;ee<y.length;ee++){let he=y[ee];U[ee]=new oe.DiagnosticRelatedInformation(Tt(he.location),he.message)}return U}function f(y){if(!y)return;let U=[];for(let ee of y){let he=d(ee);he!==void 0&&U.push(he)}return U.length>0?U:void 0}function d(y){switch(y){case ye.DiagnosticTag.Unnecessary:return oe.DiagnosticTag.Unnecessary;case ye.DiagnosticTag.Deprecated:return oe.DiagnosticTag.Deprecated;default:return}}function h(y){return y?new oe.Position(y.line,y.character):void 0}function m(y){return y?new oe.Range(y.start.line,y.start.character,y.end.line,y.end.character):void 0}async function D(y,U){return We.map(y,ee=>new oe.Range(ee.start.line,ee.start.character,ee.end.line,ee.end.character),U)}function _(y){if(y==null)return oe.DiagnosticSeverity.Error;switch(y){case ye.DiagnosticSeverity.Error:return oe.DiagnosticSeverity.Error;case ye.DiagnosticSeverity.Warning:return oe.DiagnosticSeverity.Warning;case ye.DiagnosticSeverity.Information:return oe.DiagnosticSeverity.Information;case ye.DiagnosticSeverity.Hint:return oe.DiagnosticSeverity.Hint}return oe.DiagnosticSeverity.Error}function R(y){if(wn.string(y))return w(y);if(hd.is(y))return w().appendCodeblock(y.value,y.language);if(Array.isArray(y)){let U=[];for(let ee of y){let he=w();hd.is(ee)?he.appendCodeblock(ee.value,ee.language):he.appendMarkdown(ee),U.push(he)}return U}else return w(y)}function N(y){if(wn.string(y))return y;switch(y.kind){case ye.MarkupKind.Markdown:return w(y.value);case ye.MarkupKind.PlainText:return y.value;default:return`Unsupported Markup content received. Kind is: ${y.kind}`}}function w(y){let U;if(y===void 0||typeof y=="string")U=new oe.MarkdownString(y);else switch(y.kind){case ye.MarkupKind.Markdown:U=new oe.MarkdownString(y.value);break;case ye.MarkupKind.PlainText:U=new oe.MarkdownString,U.appendText(y.value);break;default:U=new oe.MarkdownString,U.appendText(`Unsupported Markup content received. Kind is: ${y.kind}`);break}return U.isTrusted=e,U.supportHtml=t,U}function p(y){if(y)return new oe.Hover(R(y.contents),m(y.range))}async function v(y,U,ee){if(!y)return;if(Array.isArray(y))return We.map(y,Ln=>E(Ln,U),ee);let he=y,{defaultRange:Jt,commitCharacters:ir}=g(he,U),tt=await We.map(he.items,Ln=>E(Ln,ir,Jt,he.itemDefaults?.insertTextMode,he.itemDefaults?.insertTextFormat,he.itemDefaults?.data),ee);return new oe.CompletionList(tt,he.isIncomplete)}function g(y,U){let ee=y.itemDefaults?.editRange,he=y.itemDefaults?.commitCharacters??U;return ye.Range.is(ee)?{defaultRange:m(ee),commitCharacters:he}:ee!==void 0?{defaultRange:{inserting:m(ee.insert),replacing:m(ee.replace)},commitCharacters:he}:{defaultRange:void 0,commitCharacters:he}}function k(y){return ye.CompletionItemKind.Text<=y&&y<=ye.CompletionItemKind.TypeParameter?[y-1,void 0]:[oe.CompletionItemKind.Text,y]}function b(y){switch(y){case ye.CompletionItemTag.Deprecated:return oe.CompletionItemTag.Deprecated}}function C(y){if(y==null)return[];let U=[];for(let ee of y){let he=b(ee);he!==void 0&&U.push(he)}return U}function E(y,U,ee,he,Jt,ir){let tt=C(y.tags),Ln=I(y),ut=new OF.default(Ln);y.detail&&(ut.detail=y.detail),y.documentation&&(ut.documentation=N(y.documentation),ut.documentationFormat=wn.string(y.documentation)?"$string":y.documentation.kind),y.filterText&&(ut.filterText=y.filterText);let Gu=B(y,ee,Jt);if(Gu&&(ut.insertText=Gu.text,ut.range=Gu.range,ut.fromEdit=Gu.fromEdit),wn.number(y.kind)){let[SI,tb]=k(y.kind);ut.kind=SI,tb&&(ut.originalItemKind=tb)}y.sortText&&(ut.sortText=y.sortText),y.additionalTextEdits&&(ut.additionalTextEdits=Q(y.additionalTextEdits));let Zy=y.commitCharacters!==void 0?wn.stringArray(y.commitCharacters)?y.commitCharacters:void 0:U;Zy&&(ut.commitCharacters=Zy.slice()),y.command&&(ut.command=vt(y.command)),(y.deprecated===!0||y.deprecated===!1)&&(ut.deprecated=y.deprecated,y.deprecated===!0&&tt.push(oe.CompletionItemTag.Deprecated)),(y.preselect===!0||y.preselect===!1)&&(ut.preselect=y.preselect);let eb=y.data??ir;eb!==void 0&&(ut.data=eb),tt.length>0&&(ut.tags=tt);let yp=y.insertTextMode??he;return yp!==void 0&&(ut.insertTextMode=yp,yp===ye.InsertTextMode.asIs&&(ut.keepWhitespace=!0)),ut}function I(y){return ye.CompletionItemLabelDetails.is(y.labelDetails)?{label:y.label,detail:y.labelDetails.detail,description:y.labelDetails.description}:y.label}function B(y,U,ee){let he=y.insertTextFormat??ee;if(y.textEdit!==void 0||U!==void 0){let[Jt,ir]=y.textEdit!==void 0?z(y.textEdit):[U,y.textEditText??y.label];return he===ye.InsertTextFormat.Snippet?{text:new oe.SnippetString(ir),range:Jt,fromEdit:!0}:{text:ir,range:Jt,fromEdit:!0}}else return y.insertText?he===ye.InsertTextFormat.Snippet?{text:new oe.SnippetString(y.insertText),fromEdit:!1}:{text:y.insertText,fromEdit:!1}:void 0}function z(y){return ye.InsertReplaceEdit.is(y)?[{inserting:m(y.insert),replacing:m(y.replace)},y.newText]:[m(y.range),y.newText]}function te(y){if(y)return new oe.TextEdit(m(y.range),y.newText)}async function ue(y,U){if(y)return We.map(y,te,U)}function Q(y){if(!y)return;let U=new Array(y.length);for(let ee=0;ee<y.length;ee++)U[ee]=te(y[ee]);return U}async function se(y,U){if(!y)return;let ee=new oe.SignatureHelp;return wn.number(y.activeSignature)?ee.activeSignature=y.activeSignature:ee.activeSignature=0,wn.number(y.activeParameter)?ee.activeParameter=y.activeParameter:ee.activeParameter=0,y.signatures&&(ee.signatures=await fe(y.signatures,U)),ee}async function fe(y,U){return We.mapAsync(y,_e,U)}async function _e(y,U){let ee=new oe.SignatureInformation(y.label);return y.documentation!==void 0&&(ee.documentation=N(y.documentation)),y.parameters!==void 0&&(ee.parameters=await Ke(y.parameters,U)),y.activeParameter!==void 0&&(ee.activeParameter=y.activeParameter),ee}function Ke(y,U){return We.map(y,gt,U)}function gt(y){let U=new oe.ParameterInformation(y.label);return y.documentation&&(U.documentation=N(y.documentation)),U}function Tt(y){return y?new oe.Location(i(y.uri),m(y.range)):void 0}async function br(y,U){if(y)return O(y,U)}async function $t(y,U){if(y)return O(y,U)}function nr(y){if(!y)return;let U={targetUri:i(y.targetUri),targetRange:m(y.targetRange),originSelectionRange:m(y.originSelectionRange),targetSelectionRange:m(y.targetSelectionRange)};if(!U.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return U}async function O(y,U){if(y)if(wn.array(y)){if(y.length===0)return[];if(ye.LocationLink.is(y[0])){let ee=y;return We.map(ee,nr,U)}else{let ee=y;return We.map(ee,Tt,U)}}else return ye.LocationLink.is(y)?[nr(y)]:Tt(y)}async function x(y,U){if(y)return We.map(y,Tt,U)}async function J(y,U){if(y)return We.map(y,W,U)}function W(y){let U=new oe.DocumentHighlight(m(y.range));return wn.number(y.kind)&&(U.kind=Re(y.kind)),U}function Re(y){switch(y){case ye.DocumentHighlightKind.Text:return oe.DocumentHighlightKind.Text;case ye.DocumentHighlightKind.Read:return oe.DocumentHighlightKind.Read;case ye.DocumentHighlightKind.Write:return oe.DocumentHighlightKind.Write}return oe.DocumentHighlightKind.Text}async function Qe(y,U){if(y)return We.map(y,Xt,U)}function Ie(y){return y<=ye.SymbolKind.TypeParameter?y-1:oe.SymbolKind.Property}function mt(y){switch(y){case ye.SymbolTag.Deprecated:return oe.SymbolTag.Deprecated;default:return}}function Rt(y){if(y==null)return;let U=[];for(let ee of y){let he=mt(ee);he!==void 0&&U.push(he)}return U.length===0?void 0:U}function Xt(y){let U=y.data,ee=y.location,he=ee.range===void 0||U!==void 0?new qF.default(y.name,Ie(y.kind),y.containerName??"",ee.range===void 0?i(ee.uri):new oe.Location(i(y.location.uri),m(ee.range)),U):new oe.SymbolInformation(y.name,Ie(y.kind),y.containerName??"",new oe.Location(i(y.location.uri),m(ee.range)));return ln(he,y),he}async function lt(y,U){if(y!=null)return We.map(y,_t,U)}function _t(y){let U=new oe.DocumentSymbol(y.name,y.detail||"",Ie(y.kind),m(y.range),m(y.selectionRange));if(ln(U,y),y.children!==void 0&&y.children.length>0){let ee=[];for(let he of y.children)ee.push(_t(he));U.children=ee}return U}function ln(y,U){y.tags=Rt(U.tags),U.deprecated&&(y.tags?y.tags.includes(oe.SymbolTag.Deprecated)||(y.tags=y.tags.concat(oe.SymbolTag.Deprecated)):y.tags=[oe.SymbolTag.Deprecated])}function vt(y){let U={title:y.title,command:y.command};return y.arguments&&(U.arguments=y.arguments),U}async function Bt(y,U){if(y)return We.map(y,vt,U)}let Wt=new Map;Wt.set(ye.CodeActionKind.Empty,oe.CodeActionKind.Empty),Wt.set(ye.CodeActionKind.QuickFix,oe.CodeActionKind.QuickFix),Wt.set(ye.CodeActionKind.Refactor,oe.CodeActionKind.Refactor),Wt.set(ye.CodeActionKind.RefactorExtract,oe.CodeActionKind.RefactorExtract),Wt.set(ye.CodeActionKind.RefactorInline,oe.CodeActionKind.RefactorInline),Wt.set(ye.CodeActionKind.RefactorRewrite,oe.CodeActionKind.RefactorRewrite),Wt.set(ye.CodeActionKind.Source,oe.CodeActionKind.Source),Wt.set(ye.CodeActionKind.SourceOrganizeImports,oe.CodeActionKind.SourceOrganizeImports);function zr(y){if(y==null)return;let U=Wt.get(y);if(U)return U;let ee=y.split(".");U=oe.CodeActionKind.Empty;for(let he of ee)U=U.append(he);return U}function Ir(y){if(y!=null)return y.map(U=>zr(U))}async function Nn(y,U){if(y==null)return;let ee=new FF.default(y.title,y.data);return y.kind!==void 0&&(ee.kind=zr(y.kind)),y.diagnostics!==void 0&&(ee.diagnostics=u(y.diagnostics)),y.edit!==void 0&&(ee.edit=await Cr(y.edit,U)),y.command!==void 0&&(ee.command=vt(y.command)),y.isPreferred!==void 0&&(ee.isPreferred=y.isPreferred),y.disabled!==void 0&&(ee.disabled={reason:y.disabled.reason}),ee}function ii(y,U){return We.mapAsync(y,async ee=>ye.Command.is(ee)?vt(ee):Nn(ee,U),U)}function Tn(y){if(!y)return;let U=new AF.default(m(y.range));return y.command&&(U.command=vt(y.command)),y.data!==void 0&&y.data!==null&&(U.data=y.data),U}async function si(y,U){if(y)return We.map(y,Tn,U)}async function Cr(y,U){if(!y)return;let ee=new Map;if(y.changeAnnotations!==void 0){let ir=y.changeAnnotations;await We.forEach(Object.keys(ir),tt=>{let Ln=M(ir[tt]);ee.set(tt,Ln)},U)}let he=ir=>{if(ir!==void 0)return ee.get(ir)},Jt=new oe.WorkspaceEdit;if(y.documentChanges){let ir=y.documentChanges;await We.forEach(ir,tt=>{if(ye.CreateFile.is(tt))Jt.createFile(i(tt.uri),tt.options,he(tt.annotationId));else if(ye.RenameFile.is(tt))Jt.renameFile(i(tt.oldUri),i(tt.newUri),tt.options,he(tt.annotationId));else if(ye.DeleteFile.is(tt))Jt.deleteFile(i(tt.uri),tt.options,he(tt.annotationId));else if(ye.TextDocumentEdit.is(tt)){let Ln=i(tt.textDocument.uri);for(let ut of tt.edits)ye.AnnotatedTextEdit.is(ut)?Jt.replace(Ln,m(ut.range),ut.newText,he(ut.annotationId)):Jt.replace(Ln,m(ut.range),ut.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(tt,void 0,4)}`)},U)}else if(y.changes){let ir=y.changes;await We.forEach(Object.keys(ir),tt=>{Jt.set(i(tt),Q(ir[tt]))},U)}return Jt}function M(y){if(y!==void 0)return{label:y.label,needsConfirmation:!!y.needsConfirmation,description:y.description}}function Y(y){let U=m(y.range),ee=y.target?s(y.target):void 0,he=new NF.default(U,ee);return y.tooltip!==void 0&&(he.tooltip=y.tooltip),y.data!==void 0&&y.data!==null&&(he.data=y.data),he}async function ie(y,U){if(y)return We.map(y,Y,U)}function ae(y){return new oe.Color(y.red,y.green,y.blue,y.alpha)}function Be(y){return new oe.ColorInformation(m(y.range),ae(y.color))}async function Ue(y,U){if(y)return We.map(y,Be,U)}function Ye(y){let U=new oe.ColorPresentation(y.label);return U.additionalTextEdits=Q(y.additionalTextEdits),y.textEdit&&(U.textEdit=te(y.textEdit)),U}async function st(y,U){if(y)return We.map(y,Ye,U)}function xe(y){if(y)switch(y){case ye.FoldingRangeKind.Comment:return oe.FoldingRangeKind.Comment;case ye.FoldingRangeKind.Imports:return oe.FoldingRangeKind.Imports;case ye.FoldingRangeKind.Region:return oe.FoldingRangeKind.Region}}function Ve(y){return new oe.FoldingRange(y.startLine,y.endLine,xe(y.kind))}async function Fe(y,U){if(y)return We.map(y,Ve,U)}function ot(y){return new oe.SelectionRange(m(y.range),y.parent?ot(y.parent):void 0)}async function It(y,U){return Array.isArray(y)?We.map(y,ot,U):[]}function Yt(y){return ye.InlineValueText.is(y)?new oe.InlineValueText(m(y.range),y.text):ye.InlineValueVariableLookup.is(y)?new oe.InlineValueVariableLookup(m(y.range),y.variableName,y.caseSensitiveLookup):new oe.InlineValueEvaluatableExpression(m(y.range),y.expression)}async function ki(y,U){return Array.isArray(y)?We.map(y,Yt,U):[]}async function Ri(y,U){let ee=typeof y.label=="string"?y.label:await We.map(y.label,S,U),he=new jF.default(h(y.position),ee);return y.kind!==void 0&&(he.kind=y.kind),y.textEdits!==void 0&&(he.textEdits=await ue(y.textEdits,U)),y.tooltip!==void 0&&(he.tooltip=X(y.tooltip)),y.paddingLeft!==void 0&&(he.paddingLeft=y.paddingLeft),y.paddingRight!==void 0&&(he.paddingRight=y.paddingRight),y.data!==void 0&&(he.data=y.data),he}function S(y){let U=new oe.InlayHintLabelPart(y.value);return y.location!==void 0&&(U.location=Tt(y.location)),y.tooltip!==void 0&&(U.tooltip=X(y.tooltip)),y.command!==void 0&&(U.command=vt(y.command)),U}function X(y){return typeof y=="string"?y:w(y)}async function de(y,U){if(Array.isArray(y))return We.mapAsync(y,Ri,U)}function He(y){if(y===null)return;let U=new LF.default(Ie(y.kind),y.name,y.detail||"",s(y.uri),m(y.range),m(y.selectionRange),y.data);return y.tags!==void 0&&(U.tags=Rt(y.tags)),U}async function $(y,U){if(y!==null)return We.map(y,He,U)}async function P(y,U){return new oe.CallHierarchyIncomingCall(He(y.from),await D(y.fromRanges,U))}async function q(y,U){if(y!==null)return We.mapAsync(y,P,U)}async function j(y,U){return new oe.CallHierarchyOutgoingCall(He(y.to),await D(y.fromRanges,U))}async function A(y,U){if(y!==null)return We.mapAsync(y,j,U)}async function T(y,U){if(y!=null)return new oe.SemanticTokens(new Uint32Array(y.data),y.resultId)}function H(y){return new oe.SemanticTokensEdit(y.start,y.deleteCount,y.data!==void 0?new Uint32Array(y.data):void 0)}async function Z(y,U){if(y!=null)return new oe.SemanticTokensEdits(y.edits.map(H),y.resultId)}function be(y){return y}async function wt(y,U){if(y!=null)return new oe.LinkedEditingRanges(await D(y.ranges,U),at(y.wordPattern))}function at(y){if(y!=null)return new RegExp(y)}function Or(y){if(y===null)return;let U=new MF.default(Ie(y.kind),y.name,y.detail||"",s(y.uri),m(y.range),m(y.selectionRange),y.data);return y.tags!==void 0&&(U.tags=Rt(y.tags)),U}async function Gr(y,U){if(y!==null)return We.map(y,Or,U)}function Sn(y){if(wn.string(y))return y;if(ye.RelativePattern.is(y)){if(ye.URI.is(y.baseUri))return new oe.RelativePattern(s(y.baseUri),y.pattern);if(ye.WorkspaceFolder.is(y.baseUri)){let U=oe.workspace.getWorkspaceFolder(s(y.baseUri.uri));return U!==void 0?new oe.RelativePattern(U,y.pattern):void 0}}}async function Ne(y,U){if(!y)return;if(Array.isArray(y))return We.map(y,Jt=>Fn(Jt),U);let ee=y,he=await We.map(ee.items,Jt=>Fn(Jt),U);return new oe.InlineCompletionList(he)}function Fn(y){let U;typeof y.insertText=="string"?U=y.insertText:U=new oe.SnippetString(y.insertText.value);let ee;y.command&&(ee=vt(y.command));let he=new oe.InlineCompletionItem(U,m(y.range),ee);return y.filterText&&(he.filterText=y.filterText),he}return{asUri:s,asDocumentSelector:o,asDiagnostics:a,asDiagnostic:c,asRange:m,asRanges:D,asPosition:h,asDiagnosticSeverity:_,asDiagnosticTag:d,asHover:p,asCompletionResult:v,asCompletionItem:E,asTextEdit:te,asTextEdits:ue,asSignatureHelp:se,asSignatureInformations:fe,asSignatureInformation:_e,asParameterInformations:Ke,asParameterInformation:gt,asDeclarationResult:br,asDefinitionResult:$t,asLocation:Tt,asReferences:x,asDocumentHighlights:J,asDocumentHighlight:W,asDocumentHighlightKind:Re,asSymbolKind:Ie,asSymbolTag:mt,asSymbolTags:Rt,asSymbolInformations:Qe,asSymbolInformation:Xt,asDocumentSymbols:lt,asDocumentSymbol:_t,asCommand:vt,asCommands:Bt,asCodeAction:Nn,asCodeActionKind:zr,asCodeActionKinds:Ir,asCodeActionResult:ii,asCodeLens:Tn,asCodeLenses:si,asWorkspaceEdit:Cr,asDocumentLink:Y,asDocumentLinks:ie,asFoldingRangeKind:xe,asFoldingRange:Ve,asFoldingRanges:Fe,asColor:ae,asColorInformation:Be,asColorInformations:Ue,asColorPresentation:Ye,asColorPresentations:st,asSelectionRange:ot,asSelectionRanges:It,asInlineValue:Yt,asInlineValues:ki,asInlayHint:Ri,asInlayHints:de,asSemanticTokensLegend:be,asSemanticTokens:T,asSemanticTokensEdit:H,asSemanticTokensEdits:Z,asCallHierarchyItem:He,asCallHierarchyItems:$,asCallHierarchyIncomingCall:P,asCallHierarchyIncomingCalls:q,asCallHierarchyOutgoingCall:j,asCallHierarchyOutgoingCalls:A,asLinkedEditingRanges:wt,asTypeHierarchyItem:Or,asTypeHierarchyItems:Gr,asGlobPattern:Sn,asInlineCompletionResult:Ne,asInlineCompletionItem:Fn}}gd.createConverter=UF});var bt=L(yn=>{"use strict";Object.defineProperty(yn,"__esModule",{value:!0});yn.generateUuid=yn.parse=yn.isUUID=yn.v4=yn.empty=void 0;var lu=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},du=class r extends lu{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return r._oneOf(r._chars)}constructor(){super([r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-","4",r._randomHex(),r._randomHex(),r._randomHex(),"-",r._oneOf(r._timeHighBits),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex()].join(""))}};du._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];du._timeHighBits=["8","9","a","b"];yn.empty=new lu("00000000-0000-0000-0000-000000000000");function px(){return new du}yn.v4=px;var $F=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function hx(r){return $F.test(r)}yn.isUUID=hx;function BF(r){if(!hx(r))throw new Error("invalid uuid");return new lu(r)}yn.parse=BF;function WF(){return px().asHex()}yn.generateUuid=WF});var Jm=L(md=>{"use strict";Object.defineProperty(md,"__esModule",{value:!0});md.ProgressPart=void 0;var gx=require("vscode"),mx=Ce(),vx=gn(),Ym=class{constructor(e,t,n){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(mx.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),n&&n(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&gx.window.withProgress({location:gx.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,n)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=n,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(mx.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,s)=>{this._resolve=i,this._reject=s})})}report(e){if(this._infinite&&vx.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(vx.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),n=Math.max(0,t-this._reported);this._reported+=n,this._progress!==void 0&&this._progress.report({message:e.message,increment:n})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};md.ProgressPart=Ym});var $e=L(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});tr.WorkspaceFeature=tr.TextDocumentLanguageFeature=tr.TextDocumentEventFeature=tr.DynamicDocumentFeature=tr.DynamicFeature=tr.StaticFeature=tr.ensure=tr.LSPCancellationError=void 0;var Ls=require("vscode"),Zm=Ce(),Pr=gn(),wx=bt(),ev=class extends Ls.CancellationError{constructor(e){super(),this.data=e}};tr.LSPCancellationError=ev;function VF(r,e){return r[e]===void 0&&(r[e]={}),r[e]}tr.ensure=VF;var yx;(function(r){function e(t){let n=t;return n!=null&&Pr.func(n.fillClientCapabilities)&&Pr.func(n.initialize)&&Pr.func(n.getState)&&Pr.func(n.clear)&&(n.fillInitializeParams===void 0||Pr.func(n.fillInitializeParams))}r.is=e})(yx||(tr.StaticFeature=yx={}));var bx;(function(r){function e(t){let n=t;return n!=null&&Pr.func(n.fillClientCapabilities)&&Pr.func(n.initialize)&&Pr.func(n.getState)&&Pr.func(n.clear)&&(n.fillInitializeParams===void 0||Pr.func(n.fillInitializeParams))&&Pr.func(n.register)&&Pr.func(n.unregister)&&n.registrationType!==void 0}r.is=e})(bx||(tr.DynamicFeature=bx={}));var fu=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let s of Ls.workspace.textDocuments)if(Ls.languages.match(i,s)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let n=t>0;return{kind:"document",id:this.registrationType.method,registrations:n,matches:!1}}};tr.DynamicDocumentFeature=fu;var tv=class extends fu{static textDocumentFilter(e,t){for(let n of e)if(Ls.languages.match(n,t)>0)return!0;return!1}constructor(e,t,n,i,s,o,a){super(e),this._event=t,this._type=n,this._middleware=i,this._createParams=s,this._textDocument=o,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new Ls.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(n=>{this._client.error(`Sending document notification ${this._type.method} failed.`,n)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async n=>{let i=this._createParams(n);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(n),this._type,i)};if(this.matches(e)){let n=this._middleware();return n?n(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,n){this._onNotificationSent.fire({textDocument:e,type:t,params:n})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(Ls.languages.match(t,e)>0)return{send:n=>this.callback(n)}}};tr.TextDocumentEventFeature=tv;var rv=class extends fu{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(Zm.TextDocumentRegistrationOptions.is(t)){let n=Zm.StaticRegistrationOptions.hasId(t)?t.id:wx.generateUuid(),i=t.documentSelector??e;if(i)return[n,Object.assign({},t,{documentSelector:i})]}else if(Pr.boolean(t)&&t===!0||Zm.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let n=Pr.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[wx.generateUuid(),n]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return Pr.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let n=t.data.registerOptions.documentSelector;if(n!==null&&Ls.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(n),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};tr.TextDocumentLanguageFeature=rv;var nv=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};tr.WorkspaceFeature=nv});var Dx=L((VB,Cx)=>{var HF=typeof process=="object"&&process&&process.platform==="win32";Cx.exports=HF?{sep:"\\"}:{sep:"/"}});var xx=L((HB,Px)=>{"use strict";Px.exports=Sx;function Sx(r,e,t){r instanceof RegExp&&(r=Tx(r,t)),e instanceof RegExp&&(e=Tx(e,t));var n=Ex(r,e,t);return n&&{start:n[0],end:n[1],pre:t.slice(0,n[0]),body:t.slice(n[0]+r.length,n[1]),post:t.slice(n[1]+e.length)}}function Tx(r,e){var t=e.match(r);return t?t[0]:null}Sx.range=Ex;function Ex(r,e,t){var n,i,s,o,a,u=t.indexOf(r),c=t.indexOf(e,u+1),l=u;if(u>=0&&c>0){if(r===e)return[u,c];for(n=[],s=t.length;l>=0&&!a;)l==u?(n.push(l),u=t.indexOf(r,l+1)):n.length==1?a=[n.pop(),c]:(i=n.pop(),i<s&&(s=i,o=c),c=t.indexOf(e,l+1)),l=u<c&&u>=0?u:c;n.length&&(a=[s,o])}return a}});var Fx=L((KB,Nx)=>{var kx=xx();Nx.exports=zF;var Rx="\0SLASH"+Math.random()+"\0",_x="\0OPEN"+Math.random()+"\0",sv="\0CLOSE"+Math.random()+"\0",Ix="\0COMMA"+Math.random()+"\0",Ox="\0PERIOD"+Math.random()+"\0";function iv(r){return parseInt(r,10)==r?parseInt(r,10):r.charCodeAt(0)}function KF(r){return r.split("\\\\").join(Rx).split("\\{").join(_x).split("\\}").join(sv).split("\\,").join(Ix).split("\\.").join(Ox)}function XF(r){return r.split(Rx).join("\\").split(_x).join("{").split(sv).join("}").split(Ix).join(",").split(Ox).join(".")}function Ax(r){if(!r)return[""];var e=[],t=kx("{","}",r);if(!t)return r.split(",");var n=t.pre,i=t.body,s=t.post,o=n.split(",");o[o.length-1]+="{"+i+"}";var a=Ax(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function zF(r){return r?(r.substr(0,2)==="{}"&&(r="\\{\\}"+r.substr(2)),pu(KF(r),!0).map(XF)):[]}function GF(r){return"{"+r+"}"}function QF(r){return/^-?0\d/.test(r)}function YF(r,e){return r<=e}function JF(r,e){return r>=e}function pu(r,e){var t=[],n=kx("{","}",r);if(!n)return[r];var i=n.pre,s=n.post.length?pu(n.post,!1):[""];if(/\$$/.test(n.pre))for(var o=0;o<s.length;o++){var a=i+"{"+n.body+"}"+s[o];t.push(a)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),c=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),l=u||c,f=n.body.indexOf(",")>=0;if(!l&&!f)return n.post.match(/,.*\}/)?(r=n.pre+"{"+n.body+sv+n.post,pu(r)):[r];var d;if(l)d=n.body.split(/\.\./);else if(d=Ax(n.body),d.length===1&&(d=pu(d[0],!1).map(GF),d.length===1))return s.map(function(E){return n.pre+d[0]+E});var h;if(l){var m=iv(d[0]),D=iv(d[1]),_=Math.max(d[0].length,d[1].length),R=d.length==3?Math.abs(iv(d[2])):1,N=YF,w=D<m;w&&(R*=-1,N=JF);var p=d.some(QF);h=[];for(var v=m;N(v,D);v+=R){var g;if(c)g=String.fromCharCode(v),g==="\\"&&(g="");else if(g=String(v),p){var k=_-g.length;if(k>0){var b=new Array(k+1).join("0");v<0?g="-"+b+g.slice(1):g=b+g}}h.push(g)}}else{h=[];for(var C=0;C<d.length;C++)h.push.apply(h,pu(d[C],!1))}for(var C=0;C<h.length;C++)for(var o=0;o<s.length;o++){var a=i+h[C]+s[o];(!e||l||a)&&t.push(a)}}return t}});var wd=L((zB,lv)=>{var tn=lv.exports=(r,e,t={})=>(vd(e),!t.nocomment&&e.charAt(0)==="#"?!1:new $o(e,t).match(r));lv.exports=tn;var uv=Dx();tn.sep=uv.sep;var _n=Symbol("globstar **");tn.GLOBSTAR=_n;var ZF=Fx(),Lx={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},cv="[^/]",ov=cv+"*?",eL="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",tL="(?:(?!(?:\\/|^)\\.).)*?",jx=r=>r.split("").reduce((e,t)=>(e[t]=!0,e),{}),Mx=jx("().*{}+?[]^$\\!"),rL=jx("[.("),qx=/\/+/;tn.filter=(r,e={})=>(t,n,i)=>tn(t,r,e);var rs=(r,e={})=>{let t={};return Object.keys(r).forEach(n=>t[n]=r[n]),Object.keys(e).forEach(n=>t[n]=e[n]),t};tn.defaults=r=>{if(!r||typeof r!="object"||!Object.keys(r).length)return tn;let e=tn,t=(n,i,s)=>e(n,i,rs(r,s));return t.Minimatch=class extends e.Minimatch{constructor(i,s){super(i,rs(r,s))}},t.Minimatch.defaults=n=>e.defaults(rs(r,n)).Minimatch,t.filter=(n,i)=>e.filter(n,rs(r,i)),t.defaults=n=>e.defaults(rs(r,n)),t.makeRe=(n,i)=>e.makeRe(n,rs(r,i)),t.braceExpand=(n,i)=>e.braceExpand(n,rs(r,i)),t.match=(n,i,s)=>e.match(n,i,rs(r,s)),t};tn.braceExpand=(r,e)=>Ux(r,e);var Ux=(r,e={})=>(vd(r),e.nobrace||!/\{(?:(?!\{).)*\}/.test(r)?[r]:ZF(r)),nL=1024*64,vd=r=>{if(typeof r!="string")throw new TypeError("invalid pattern");if(r.length>nL)throw new TypeError("pattern is too long")},av=Symbol("subparse");tn.makeRe=(r,e)=>new $o(r,e||{}).makeRe();tn.match=(r,e,t={})=>{let n=new $o(e,t);return r=r.filter(i=>n.match(i)),n.options.nonull&&!r.length&&r.push(e),r};var iL=r=>r.replace(/\\(.)/g,"$1"),sL=r=>r.replace(/\\([^-\]])/g,"$1"),oL=r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),aL=r=>r.replace(/[[\]\\]/g,"\\$&"),$o=class{constructor(e,t){vd(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let n=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,n),n=this.globParts=n.map(i=>i.split(qx)),this.debug(this.pattern,n),n=n.map((i,s,o)=>i.map(this.parse,this)),this.debug(this.pattern,n),n=n.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,n),this.set=n}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,n=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,n++;n&&(this.pattern=e.slice(n)),this.negate=t}matchOne(e,t,n){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,o=0,a=e.length,u=t.length;s<a&&o<u;s++,o++){this.debug("matchOne loop");var c=t[o],l=e[s];if(this.debug(t,c,l),c===!1)return!1;if(c===_n){this.debug("GLOBSTAR",[t,c,l]);var f=s,d=o+1;if(d===u){for(this.debug("** at the end");s<a;s++)if(e[s]==="."||e[s]===".."||!i.dot&&e[s].charAt(0)===".")return!1;return!0}for(;f<a;){var h=e[f];if(this.debug(`
globstar while`,e,f,t,d,h),this.matchOne(e.slice(f),t.slice(d),n))return this.debug("globstar found match!",f,a,h),!0;if(h==="."||h===".."||!i.dot&&h.charAt(0)==="."){this.debug("dot detected!",e,f,t,d);break}this.debug("globstar swallow a segment, and continue"),f++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,f,t,d),f===a))}var m;if(typeof c=="string"?(m=l===c,this.debug("string match",c,l,m)):(m=l.match(c),this.debug("pattern match",c,l,m)),!m)return!1}if(s===a&&o===u)return!0;if(s===a)return n;if(o===u)return s===a-1&&e[s]==="";throw new Error("wtf?")}braceExpand(){return Ux(this.pattern,this.options)}parse(e,t){vd(e);let n=this.options;if(e==="**")if(n.noglobstar)e="*";else return _n;if(e==="")return"";let i="",s=!!n.nocase,o=!1,a=[],u=[],c,l=!1,f=-1,d=-1,h,m,D,_=e.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",R=()=>{if(c){switch(c){case"*":i+=ov,s=!0;break;case"?":i+=cv,s=!0;break;default:i+="\\"+c;break}this.debug("clearStateChar %j %j",c,i),c=!1}};for(let p=0,v;p<e.length&&(v=e.charAt(p));p++){if(this.debug("%s	%s %s %j",e,p,i,v),o){if(v==="/")return!1;Mx[v]&&(i+="\\"),i+=v,o=!1;continue}switch(v){case"/":return!1;case"\\":if(l&&e.charAt(p+1)==="-"){i+=v;continue}R(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,p,i,v),l){this.debug("  in class"),v==="!"&&p===d+1&&(v="^"),i+=v;continue}this.debug("call clearStateChar %j",c),R(),c=v,n.noext&&R();continue;case"(":if(l){i+="(";continue}if(!c){i+="\\(";continue}a.push({type:c,start:p-1,reStart:i.length,open:Lx[c].open,close:Lx[c].close}),i+=c==="!"?"(?:(?!(?:":"(?:",this.debug("plType %j %j",c,i),c=!1;continue;case")":if(l||!a.length){i+="\\)";continue}R(),s=!0,m=a.pop(),i+=m.close,m.type==="!"&&u.push(m),m.reEnd=i.length;continue;case"|":if(l||!a.length){i+="\\|";continue}R(),i+="|";continue;case"[":if(R(),l){i+="\\"+v;continue}l=!0,d=p,f=i.length,i+=v;continue;case"]":if(p===d+1||!l){i+="\\"+v;continue}h=e.substring(d+1,p);try{RegExp("["+aL(sL(h))+"]"),i+=v}catch{i=i.substring(0,f)+"(?:$.)"}s=!0,l=!1;continue;default:R(),Mx[v]&&!(v==="^"&&l)&&(i+="\\"),i+=v;break}}for(l&&(h=e.slice(d+1),D=this.parse(h,av),i=i.substring(0,f)+"\\["+D[0],s=s||D[1]),m=a.pop();m;m=a.pop()){let p;p=i.slice(m.reStart+m.open.length),this.debug("setting tail",i,m),p=p.replace(/((?:\\{2}){0,64})(\\?)\|/g,(g,k,b)=>(b||(b="\\"),k+k+b+"|")),this.debug(`tail=%j
   %s`,p,p,m,i);let v=m.type==="*"?ov:m.type==="?"?cv:"\\"+m.type;s=!0,i=i.slice(0,m.reStart)+v+"\\("+p}R(),o&&(i+="\\\\");let N=rL[i.charAt(0)];for(let p=u.length-1;p>-1;p--){let v=u[p],g=i.slice(0,v.reStart),k=i.slice(v.reStart,v.reEnd-8),b=i.slice(v.reEnd),C=i.slice(v.reEnd-8,v.reEnd)+b,E=g.split("(").length-1,I=b;for(let z=0;z<E;z++)I=I.replace(/\)[+*?]?/,"");b=I;let B=b===""&&t!==av?"$":"";i=g+k+b+B+C}if(i!==""&&s&&(i="(?=.)"+i),N&&(i=_+i),t===av)return[i,s];if(!s)return iL(e);let w=n.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",w),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,n=t.noglobstar?ov:t.dot?eL:tL,i=t.nocase?"i":"",s=e.map(o=>(o=o.map(a=>typeof a=="string"?oL(a):a===_n?_n:a._src).reduce((a,u)=>(a[a.length-1]===_n&&u===_n||a.push(u),a),[]),o.forEach((a,u)=>{a!==_n||o[u-1]===_n||(u===0?o.length>1?o[u+1]="(?:\\/|"+n+"\\/)?"+o[u+1]:o[u]=n:u===o.length-1?o[u-1]+="(?:\\/|"+n+")?":(o[u-1]+="(?:\\/|\\/"+n+"\\/)"+o[u+1],o[u+1]=_n))}),o.filter(a=>a!==_n).join("/"))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let n=this.options;uv.sep!=="/"&&(e=e.split(uv.sep).join("/")),e=e.split(qx),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let s;for(let o=e.length-1;o>=0&&(s=e[o],!s);o--);for(let o=0;o<i.length;o++){let a=i[o],u=e;if(n.matchBase&&a.length===1&&(u=[s]),this.matchOne(u,a,t))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return tn.defaults(e).Minimatch}};tn.Minimatch=$o});var wv=L(ns=>{"use strict";Object.defineProperty(ns,"__esModule",{value:!0});ns.DiagnosticFeature=ns.DiagnosticPullMode=ns.vsdiag=void 0;var uL=wd(),Le=require("vscode"),Lt=Ce(),cL=bt(),dv=$e();function yd(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var bn;(function(r){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=r.DocumentDiagnosticReportKind||(r.DocumentDiagnosticReportKind={}))})(bn||(ns.vsdiag=bn={}));var bd;(function(r){r.onType="onType",r.onSave="onSave"})(bd||(ns.DiagnosticPullMode=bd={}));var vr;(function(r){r.active="open",r.reschedule="reschedule",r.outDated="drop"})(vr||(vr={}));var fv=class r{constructor(){this.open=new Set,this._onOpen=new Le.EventEmitter,this._onClose=new Le.EventEmitter,r.fillTabResources(this.open);let e=t=>{if(t.closed.length===0&&t.opened.length===0)return;let n=this.open,i=new Set;r.fillTabResources(i);let s=new Set,o=new Set(i);for(let a of n.values())i.has(a)?o.delete(a):s.add(a);if(this.open=i,s.size>0){let a=new Set;for(let u of s)a.add(Le.Uri.parse(u));this._onClose.fire(a)}if(o.size>0){let a=new Set;for(let u of o)a.add(Le.Uri.parse(u));this._onOpen.fire(a)}};Le.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=Le.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof Le.Uri?Le.window.activeTextEditor?.document.uri===e:Le.window.activeTextEditor?.document===e}isVisible(e){let t=e instanceof Le.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=new Set;return r.fillTabResources(new Set,e),e}static fillTabResources(e,t){let n=e??new Set;for(let i of Le.window.tabGroups.all)for(let s of i.tabs){let o=s.input,a;o instanceof Le.TabInputText?a=o.uri:o instanceof Le.TabInputTextDiff?a=o.modified:o instanceof Le.TabInputCustom&&(a=o.uri),a!==void 0&&!n.has(a.toString())&&(n.add(a.toString()),t!==void 0&&t.add(a))}}},Qt;(function(r){r[r.document=1]="document",r[r.workspace=2]="workspace"})(Qt||(Qt={}));var vi;(function(r){function e(t){return t instanceof Le.Uri?t.toString():t.uri.toString()}r.asKey=e})(vi||(vi={}));var pv=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,n){let i=e===Qt.document?this.documentPullStates:this.workspacePullStates,[s,o,a]=t instanceof Le.Uri?[t.toString(),t,n]:[t.uri.toString(),t.uri,t.version],u=i.get(s);return u===void 0&&(u={document:o,pulledVersion:a,resultId:void 0},i.set(s,u)),u}update(e,t,n,i){let s=e===Qt.document?this.documentPullStates:this.workspacePullStates,[o,a,u,c]=t instanceof Le.Uri?[t.toString(),t,n,i]:[t.uri.toString(),t.uri,t.version,n],l=s.get(o);l===void 0?(l={document:a,pulledVersion:u,resultId:c},s.set(o,l)):(l.pulledVersion=u,l.resultId=c)}unTrack(e,t){let n=vi.asKey(t);(e===Qt.document?this.documentPullStates:this.workspacePullStates).delete(n)}tracks(e,t){let n=vi.asKey(t);return(e===Qt.document?this.documentPullStates:this.workspacePullStates).has(n)}getResultId(e,t){let n=vi.asKey(t);return(e===Qt.document?this.documentPullStates:this.workspacePullStates).get(n)?.resultId}getAllResultIds(){let e=[];for(let[t,n]of this.workspacePullStates)this.documentPullStates.has(t)&&(n=this.documentPullStates.get(t)),n.resultId!==void 0&&e.push({uri:t,value:n.resultId});return e}},hv=class{constructor(e,t,n){this.client=e,this.tabs=t,this.options=n,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new Le.EventEmitter,this.provider=this.createProvider(),this.diagnostics=Le.languages.createDiagnosticCollection(n.identifier),this.openRequests=new Map,this.documentStates=new pv,this.workspaceErrorCounter=0}knows(e,t){let n=t instanceof Le.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(n.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let n=e instanceof Le.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${n.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let n=e instanceof Le.Uri,i=n?e:e.uri,s=i.toString();t=n?t:e.version;let o=this.openRequests.get(s),a=n?this.documentStates.track(Qt.document,e,t):this.documentStates.track(Qt.document,e);if(o===void 0){let u=new Le.CancellationTokenSource;this.openRequests.set(s,{state:vr.active,document:e,version:t,tokenSource:u});let c,l;try{c=await this.provider.provideDiagnostics(e,a.resultId,u.token)??{kind:bn.DocumentDiagnosticReportKind.full,items:[]}}catch(f){if(f instanceof dv.LSPCancellationError&&Lt.DiagnosticServerCancellationData.is(f.data)&&f.data.retriggerRequest===!1&&(l={state:vr.outDated,document:e}),l===void 0&&f instanceof Le.CancellationError)l={state:vr.reschedule,document:e};else throw f}if(l=l??this.openRequests.get(s),l===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(s),!this.tabs.isVisible(e)){this.documentStates.unTrack(Qt.document,e);return}if(l.state===vr.outDated)return;c!==void 0&&(c.kind===bn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,c.items),a.pulledVersion=t,a.resultId=c.resultId),l.state===vr.reschedule&&this.pull(e)}else o.state===vr.active?(o.tokenSource.cancel(),this.openRequests.set(s,{state:vr.reschedule,document:o.document})):o.state===vr.outDated&&this.openRequests.set(s,{state:vr.reschedule,document:o.document})}forgetDocument(e){let t=e instanceof Le.Uri?e:e.uri,n=t.toString(),i=this.openRequests.get(n);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(n,{state:vr.reschedule,document:e}):this.pull(e,()=>{this.forget(Qt.document,e)}):(i!==void 0&&(i.state===vr.active&&i.tokenSource.cancel(),this.openRequests.set(n,{state:vr.outDated,document:e})),this.diagnostics.delete(t),this.forget(Qt.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,Lt.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof dv.LSPCancellationError)&&!Lt.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,Lt.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new Le.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let n of t.items)n.kind===bn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(Qt.document,n.uri)||this.diagnostics.set(n.uri,n.items)),this.documentStates.update(Qt.workspace,n.uri,n.version??void 0,n.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,n,i)=>{let s=(a,u,c)=>{let l={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof Le.Uri?a:a.uri)},previousResultId:u};return this.isDisposed===!0||!this.client.isRunning()?{kind:bn.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(Lt.DocumentDiagnosticRequest.type,l,c).then(async f=>f==null||this.isDisposed||c.isCancellationRequested?{kind:bn.DocumentDiagnosticReportKind.full,items:[]}:f.kind===Lt.DocumentDiagnosticReportKind.Full?{kind:bn.DocumentDiagnosticReportKind.full,resultId:f.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(f.items,c)}:{kind:bn.DocumentDiagnosticReportKind.unChanged,resultId:f.resultId},f=>this.client.handleFailedRequest(Lt.DocumentDiagnosticRequest.type,c,f,{kind:bn.DocumentDiagnosticReportKind.full,items:[]}))},o=this.client.middleware;return o.provideDiagnostics?o.provideDiagnostics(t,n,i,s):s(t,n,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,n,i)=>{let s=async c=>c.kind===Lt.DocumentDiagnosticReportKind.Full?{kind:bn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(c.uri),resultId:c.resultId,version:c.version,items:await this.client.protocol2CodeConverter.asDiagnostics(c.items,n)}:{kind:bn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(c.uri),resultId:c.resultId,version:c.version},o=c=>{let l=[];for(let f of c)l.push({uri:this.client.code2ProtocolConverter.asUri(f.uri),value:f.value});return l},a=(c,l)=>{let f=(0,cL.generateUuid)(),d=this.client.onProgress(Lt.WorkspaceDiagnosticRequest.partialResult,f,async m=>{if(m==null){i(null);return}let D={items:[]};for(let _ of m.items)try{D.items.push(await s(_))}catch(R){this.client.error("Converting workspace diagnostics failed.",R)}i(D)}),h={identifier:this.options.identifier,previousResultIds:o(c),partialResultToken:f};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(Lt.WorkspaceDiagnosticRequest.type,h,l).then(async m=>{if(l.isCancellationRequested)return{items:[]};let D={items:[]};for(let _ of m.items)D.items.push(await s(_));return d.dispose(),i(D),{items:[]}},m=>(d.dispose(),this.client.handleFailedRequest(Lt.DocumentDiagnosticRequest.type,l,m,{items:[]})))},u=this.client.middleware;return u.provideWorkspaceDiagnostics?u.provideWorkspaceDiagnostics(t,n,i,a):a(t,n,i)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(let[e,t]of this.openRequests)t.state===vr.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:vr.outDated,document:t.document});this.diagnostics.dispose()}},gv=class{constructor(e){this.diagnosticRequestor=e,this.documents=new Lt.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=vi.asKey(e);this.documents.has(t)||(this.documents.set(t,e,Lt.Touch.Last),this.trigger())}remove(e){let t=vi.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,Lt.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=vi.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,Lt.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?vi.asKey(this.endDocument):void 0}},mv=class{constructor(e,t,n){let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},s=e.protocol2CodeConverter.asDocumentSelector(n.documentSelector),o=[],a=m=>{let D=n.documentSelector;if(i.match!==void 0)return i.match(D,m);for(let _ of D)if(Lt.TextDocumentFilter.is(_)){if(typeof _=="string"||_.language!==void 0&&_.language!=="*"||_.scheme!==void 0&&_.scheme!=="*"&&_.scheme!==m.scheme)return!1;if(_.pattern!==void 0){let R=new uL.Minimatch(_.pattern,{noext:!0});if(!R.makeRe()||!R.match(m.fsPath))return!1}}return!0},u=m=>m instanceof Le.Uri?a(m):Le.languages.match(s,m)>0&&t.isVisible(m),c=m=>m instanceof Le.Uri?this.activeTextDocument?.uri.toString()===m.toString():this.activeTextDocument===m;this.diagnosticRequestor=new hv(e,t,n),this.backgroundScheduler=new gv(this.diagnosticRequestor);let l=m=>{!u(m)||!n.interFileDependencies||c(m)||this.backgroundScheduler.add(m)};this.activeTextDocument=Le.window.activeTextEditor?.document,Le.window.onDidChangeActiveTextEditor(m=>{let D=this.activeTextDocument;this.activeTextDocument=m?.document,D!==void 0&&l(D),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let f=e.getFeature(Lt.DidOpenTextDocumentNotification.method);o.push(f.onNotificationSent(m=>{let D=m.textDocument;this.diagnosticRequestor.knows(Qt.document,D)||u(D)&&this.diagnosticRequestor.pull(D,()=>{l(D)})})),o.push(t.onOpen(m=>{for(let D of m){if(this.diagnosticRequestor.knows(Qt.document,D))continue;let _=D.toString(),R;for(let N of Le.workspace.textDocuments)if(_===N.uri.toString()){R=N;break}R!==void 0&&u(R)&&this.diagnosticRequestor.pull(R,()=>{l(R)})}}));let d=new Set;for(let m of Le.workspace.textDocuments)u(m)&&(this.diagnosticRequestor.pull(m,()=>{l(m)}),d.add(m.uri.toString()));if(i.onTabs===!0)for(let m of t.getTabResources())!d.has(m.toString())&&u(m)&&this.diagnosticRequestor.pull(m,()=>{l(m)});if(i.onChange===!0){let m=e.getFeature(Lt.DidChangeTextDocumentNotification.method);o.push(m.onNotificationSent(async D=>{let _=D.textDocument;(i.filter===void 0||!i.filter(_,bd.onType))&&this.diagnosticRequestor.knows(Qt.document,_)&&this.diagnosticRequestor.pull(_,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let m=e.getFeature(Lt.DidSaveTextDocumentNotification.method);o.push(m.onNotificationSent(D=>{let _=D.textDocument;(i.filter===void 0||!i.filter(_,bd.onSave))&&this.diagnosticRequestor.knows(Qt.document,_)&&this.diagnosticRequestor.pull(D.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let h=e.getFeature(Lt.DidCloseTextDocumentNotification.method);o.push(h.onNotificationSent(m=>{this.cleanUpDocument(m.textDocument)})),t.onClose(m=>{for(let D of m)this.cleanUpDocument(D)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let m of Le.workspace.textDocuments)u(m)&&this.diagnosticRequestor.pull(m)}),n.workspaceDiagnostics===!0&&n.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=Le.Disposable.from(...o,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(Qt.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},vv=class extends dv.TextDocumentLanguageFeature{constructor(e){super(e,Lt.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=yd(yd(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,yd(yd(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(Lt.DiagnosticRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeDiagnosticsEmitter.fire()});let[i,s]=this.getRegistration(t,e.diagnosticProvider);!i||!s||this.register({id:i,registerOptions:s})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new fv);let t=new mv(this._client,this.tabs,e);return[t.disposable,t]}};ns.DiagnosticFeature=vv});var Wx=L(Sd=>{"use strict";Object.defineProperty(Sd,"__esModule",{value:!0});Sd.NotebookDocumentSyncFeature=void 0;var wr=require("vscode"),lL=wd(),wi=Ce(),dL=bt(),$x=gn();function Bx(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var Bo;(function(r){let e;(function(t){function n(d,h){return{version:d.version,uri:h.asUri(d.uri)}}t.asVersionedNotebookDocumentIdentifier=n;function i(d,h,m){let D=wi.NotebookDocument.create(m.asUri(d.uri),d.notebookType,d.version,s(h,m));return Object.keys(d.metadata).length>0&&(D.metadata=o(d.metadata)),D}t.asNotebookDocument=i;function s(d,h){return d.map(m=>a(m,h))}t.asNotebookCells=s;function o(d){return c(new Set,d)}t.asMetadata=o;function a(d,h){let m=wi.NotebookCell.create(u(d.kind),h.asUri(d.document.uri));return Object.keys(d.metadata).length>0&&(m.metadata=o(d.metadata)),d.executionSummary!==void 0&&$x.number(d.executionSummary.executionOrder)&&$x.boolean(d.executionSummary.success)&&(m.executionSummary={executionOrder:d.executionSummary.executionOrder,success:d.executionSummary.success}),m}t.asNotebookCell=a;function u(d){switch(d){case wr.NotebookCellKind.Markup:return wi.NotebookCellKind.Markup;case wr.NotebookCellKind.Code:return wi.NotebookCellKind.Code}}function c(d,h){if(d.has(h))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(h)){let m=[];for(let D of h)if(D!==null&&typeof D=="object"||Array.isArray(D))m.push(c(d,D));else{if(D instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");m.push(D)}return m}else{let m=Object.keys(h),D=Object.create(null);for(let _ of m){let R=h[_];if(R!==null&&typeof R=="object"||Array.isArray(R))D[_]=c(d,R);else{if(R instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");D[_]=R}}return D}}function l(d,h){let m=h.asChangeTextDocumentParams(d,d.document.uri,d.document.version);return{document:m.textDocument,changes:m.contentChanges}}t.asTextContentChange=l;function f(d,h){let m=Object.create(null);if(d.metadata&&(m.metadata=r.c2p.asMetadata(d.metadata)),d.cells!==void 0){let D=Object.create(null),_=d.cells;_.structure&&(D.structure={array:{start:_.structure.array.start,deleteCount:_.structure.array.deleteCount,cells:_.structure.array.cells!==void 0?_.structure.array.cells.map(R=>r.c2p.asNotebookCell(R,h)):void 0},didOpen:_.structure.didOpen!==void 0?_.structure.didOpen.map(R=>h.asOpenTextDocumentParams(R.document).textDocument):void 0,didClose:_.structure.didClose!==void 0?_.structure.didClose.map(R=>h.asCloseTextDocumentParams(R.document).textDocument):void 0}),_.data!==void 0&&(D.data=_.data.map(R=>r.c2p.asNotebookCell(R,h))),_.textContent!==void 0&&(D.textContent=_.textContent.map(R=>r.c2p.asTextContentChange(R,h))),Object.keys(D).length>0&&(m.cells=D)}return m}t.asNotebookDocumentChangeEvent=f})(e=r.c2p||(r.c2p={}))})(Bo||(Bo={}));var yv;(function(r){function e(a,u,c){let l=a.length,f=u.length,d=0;for(;d<f&&d<l&&t(a[d],u[d],c);)d++;if(d<f&&d<l){let h=l-1,m=f-1;for(;h>=0&&m>=0&&t(a[h],u[m],c);)h--,m--;let D=h+1-d,_=d===m+1?void 0:u.slice(d,m+1);return _!==void 0?{start:d,deleteCount:D,cells:_}:{start:d,deleteCount:D}}else return d<f?{start:d,deleteCount:0,cells:u.slice(d)}:d<l?{start:d,deleteCount:l-d}:void 0}r.computeDiff=e;function t(a,u,c=!0){return a.kind!==u.kind||a.document.uri.toString()!==u.document.uri.toString()||a.document.languageId!==u.document.languageId||!n(a.executionSummary,u.executionSummary)?!1:!c||c&&s(a.metadata,u.metadata)}function n(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.executionOrder===u.executionOrder&&a.success===u.success&&i(a.timing,u.timing)}function i(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.startTime===u.startTime&&a.endTime===u.endTime}function s(a,u){if(a===u)return!0;if(a==null||u===null||u===void 0||typeof a!=typeof u||typeof a!="object")return!1;let c=Array.isArray(a),l=Array.isArray(u);if(c!==l)return!1;if(c&&l){if(a.length!==u.length)return!1;for(let f=0;f<a.length;f++)if(!s(a[f],u[f]))return!1}if(o(a)&&o(u)){let f=Object.keys(a),d=Object.keys(u);if(f.length!==d.length||(f.sort(),d.sort(),!s(f,d)))return!1;for(let h=0;h<f.length;h++){let m=f[h];if(!s(a[m],u[m]))return!1}return!0}return!1}function o(a){return a!==null&&typeof a=="object"}r.isObjectLiteral=o})(yv||(yv={}));var bv;(function(r){function e(t,n){if(typeof t=="string")return t==="*"||n.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&n.notebookType!==t.notebookType)return!1;let i=n.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let s=new lL.Minimatch(t.pattern,{noext:!0});if(!s.makeRe()||!s.match(i.fsPath))return!1}return!0}r.matchNotebook=e})(bv||(bv={}));var Cd;(function(r){function e(n){let i=n.notebookSelector,s=[];for(let o of i){let a=(typeof o.notebook=="string"?o.notebook:o.notebook?.notebookType)??"*",u=typeof o.notebook=="string"?void 0:o.notebook?.scheme,c=typeof o.notebook=="string"?void 0:o.notebook?.pattern;if(o.cells!==void 0)for(let l of o.cells)s.push(t(a,u,c,l.language));else s.push(t(a,u,c,void 0))}return s}r.asDocumentSelector=e;function t(n,i,s,o){return i===void 0&&s===void 0?{notebook:n,language:o}:{notebook:{notebookType:n,scheme:i,pattern:s},language:o}}})(Cd||(Cd={}));var Dd;(function(r){function e(t){return{cells:t,uris:new Set(t.map(n=>n.document.uri.toString()))}}r.create=e})(Dd||(Dd={}));var Wo=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(Cd.asDocumentSelector(t)),wr.workspace.onDidOpenNotebookDocument(n=>{this.notebookDidOpen.add(n.uri.toString()),this.didOpen(n)},void 0,this.disposables);for(let n of wr.workspace.notebookDocuments)this.notebookDidOpen.add(n.uri.toString()),this.didOpen(n);wr.workspace.onDidChangeNotebookDocument(n=>this.didChangeNotebookDocument(n),void 0,this.disposables),this.options.save===!0&&wr.workspace.onDidSaveNotebookDocument(n=>this.didSave(n),void 0,this.disposables),wr.workspace.onDidCloseNotebookDocument(n=>{this.didClose(n),this.notebookDidOpen.delete(n.uri.toString())},void 0,this.disposables)}getState(){for(let e of wr.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return wr.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(wr.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let n=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(n!==void 0){let s=n.uris.has(t.document.uri.toString());if(i&&s||!i&&!s)return;if(i){let o=this.getMatchingCells(e);if(o!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,n,o);a!==void 0&&this.doSendChange(a,o).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){wr.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let n=this.notebookSyncInfo.get(e.uri.toString());if(n===void 0)return;let i=t.document.uri,s=n.cells.findIndex(o=>o.document.uri.toString()===i.toString());if(s!==-1)if(s===0&&n.cells.length===1)this.doSendClose(e,n.cells).catch(()=>{});else{let o=n.cells.slice(),a=o.splice(s,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:s,deleteCount:1},didClose:a}}},o).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),n=this.notebookSyncInfo.get(e.uri.toString())){if(n!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,n,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,n=this.notebookSyncInfo.get(t.uri.toString());if(n===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,n)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,n);return}let s=this.asNotebookDocumentChangeEvent(e.notebook,e,n,i);s!==void 0&&this.doSendChange(s,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let n=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,n).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){let n=async(s,o)=>{let a=Bo.c2p.asNotebookDocument(s,o,this.client.code2ProtocolConverter),u=o.map(c=>this.client.code2ProtocolConverter.asTextDocumentItem(c.document));try{await this.client.sendNotification(wi.DidOpenNotebookDocumentNotification.type,{notebookDocument:a,cellTextDocuments:u})}catch(c){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",c),c}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),Dd.create(t)),i?.didOpen!==void 0?i.didOpen(e,t,n):n(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){let n=async s=>{try{await this.client.sendNotification(wi.DidChangeNotebookDocumentNotification.type,{notebookDocument:Bo.c2p.asVersionedNotebookDocumentIdentifier(s.notebook,this.client.code2ProtocolConverter),change:Bo.c2p.asNotebookDocumentChangeEvent(s,this.client.code2ProtocolConverter)})}catch(o){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",o),o}},i=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),Dd.create(t??[])),i?.didChange!==void 0?i?.didChange(e,n):n(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){let t=async i=>{try{await this.client.sendNotification(wi.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(i.uri)}})}catch(s){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",s),s}},n=this.client.middleware?.notebooks;return n?.didSave!==void 0?n.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){let n=async(s,o)=>{try{await this.client.sendNotification(wi.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)},cellTextDocuments:o.map(a=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(a.document))})}catch(a){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",a),a}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),i?.didClose!==void 0?i.didClose(e,t,n):n(e,t)}asNotebookDocumentChangeEvent(e,t,n,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let s={notebook:e};t?.metadata!==void 0&&(s.metadata=Bo.c2p.asMetadata(t.metadata));let o;if(t?.cellChanges!==void 0&&t.cellChanges.length>0){let a=[];o=new Set(i.map(u=>u.document.uri.toString()));for(let u of t.cellChanges)o.has(u.cell.document.uri.toString())&&(u.executionSummary!==void 0||u.metadata!==void 0)&&a.push(u.cell);a.length>0&&(s.cells=s.cells??{},s.cells.data=a)}if((t?.contentChanges!==void 0&&t.contentChanges.length>0||t===void 0)&&n!==void 0&&i!==void 0){let a=n.cells,u=i,c=yv.computeDiff(a,u,!1),l,f;if(c!==void 0){l=c.cells===void 0?new Map:new Map(c.cells.map(m=>[m.document.uri.toString(),m])),f=c.deleteCount===0?new Map:new Map(a.slice(c.start,c.start+c.deleteCount).map(m=>[m.document.uri.toString(),m]));for(let m of Array.from(f.keys()))l.has(m)&&(f.delete(m),l.delete(m));s.cells=s.cells??{};let d=[],h=[];if(l.size>0||f.size>0){for(let m of l.values())d.push(m);for(let m of f.values())h.push(m)}s.cells.structure={array:c,didOpen:d,didClose:h}}}return Object.keys(s).length>1?s:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let n of this.options.notebookSelector)if(n.notebook===void 0||bv.matchNotebook(n.notebook,e)){let i=this.filterCells(e,t,n.cells);return i.length===0?void 0:i}}}cellMatches(e,t){let n=this.getMatchingCells(e,[t]);return n!==void 0&&n[0]===t}filterCells(e,t,n){let i=n!==void 0?t.filter(s=>{let o=s.document.languageId;return n.some(a=>a.language==="*"||o===a.language)}):t;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}},Td=class r{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=wi.NotebookDocumentSyncRegistrationType.type,wr.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==r.CellScheme)return;let[n,i]=this.findNotebookDocumentAndCell(t);if(!(n===void 0||i===void 0))for(let s of this.registrations.values())s instanceof Wo&&s.didOpenNotebookCellTextDocument(n,i)}),wr.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let n=t.document;if(n.uri.scheme!==r.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(n);if(i!==void 0)for(let s of this.registrations.values())s instanceof Wo&&s.didChangeNotebookCellTextDocument(i,t)}),wr.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==r.CellScheme)return;let[n,i]=this.findNotebookDocumentAndCell(t);if(!(n===void 0||i===void 0))for(let s of this.registrations.values())s instanceof Wo&&s.didCloseNotebookCellTextDocument(n,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=Bx(Bx(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(Cd.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let n=t.id??dL.generateUuid();this.register({id:n,registerOptions:t})}register(e){let t=new Wo(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}clear(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==r.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&wr.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let n of wr.workspace.notebookDocuments)for(let i of n.getCells())if(i.document.uri.toString()===t)return[n,i];return[void 0,void 0]}};Sd.NotebookDocumentSyncFeature=Td;Td.CellScheme="vscode-notebook-cell"});var Hx=L(is=>{"use strict";Object.defineProperty(is,"__esModule",{value:!0});is.SyncConfigurationFeature=is.toJSONObject=is.ConfigurationFeature=void 0;var Vo=require("vscode"),hu=Ce(),fL=gn(),pL=bt(),Vx=$e(),Cv=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(hu.ConfigurationRequest.type,(t,n)=>{let i=o=>{let a=[];for(let u of o.items){let c=u.scopeUri!==void 0&&u.scopeUri!==null?this._client.protocol2CodeConverter.asUri(u.scopeUri):void 0;a.push(this.getConfiguration(c,u.section!==null?u.section:void 0))}return a},s=e.middleware.workspace;return s&&s.configuration?s.configuration(t,n,i):i(t,n)})}getConfiguration(e,t){let n=null;if(t){let i=t.lastIndexOf(".");if(i===-1)n=Ms(Vo.workspace.getConfiguration(void 0,e).get(t));else{let s=Vo.workspace.getConfiguration(t.substr(0,i),e);s&&(n=Ms(s.get(t.substr(i+1))))}}else{let i=Vo.workspace.getConfiguration(void 0,e);n={};for(let s of Object.keys(i))i.has(s)&&(n[s]=Ms(i.get(s)))}return n===void 0&&(n=null),n}clear(){}};is.ConfigurationFeature=Cv;function Ms(r){if(r){if(Array.isArray(r))return r.map(Ms);if(typeof r=="object"){let e=Object.create(null);for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=Ms(r[t]));return e}}return r}is.toJSONObject=Ms;var Dv=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return hu.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,Vx.ensure)((0,Vx.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:pL.generateUuid(),registerOptions:{section:e}})}register(e){let t=Vo.workspace.onDidChangeConfiguration(n=>{this.onDidChangeConfiguration(e.registerOptions.section,n)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let n;if(fL.string(e)?n=[e]:n=e,n!==void 0&&t!==void 0&&!n.some(a=>t.affectsConfiguration(a)))return;let i=async o=>o===void 0?this._client.sendNotification(hu.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(hu.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(o)}),s=this._client.middleware.workspace?.didChangeConfiguration;(s?s(n,i):i(n)).catch(o=>{this._client.error(`Sending notification ${hu.DidChangeConfigurationNotification.type.method} failed`,o)})}extractSettingsInformation(e){function t(s,o){let a=s;for(let u=0;u<o.length-1;u++){let c=a[o[u]];c||(c=Object.create(null),a[o[u]]=c),a=c}return a}let n=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),u=null;if(a>=0?u=Vo.workspace.getConfiguration(o.substr(0,a),n).get(o.substr(a+1)):u=Vo.workspace.getConfiguration(void 0,n).get(o),u){let c=e[s].split(".");t(i,c)[c[c.length-1]]=Ms(u)}}return i}};is.SyncConfigurationFeature=Dv});var Kx=L(Wr=>{"use strict";Object.defineProperty(Wr,"__esModule",{value:!0});Wr.DidSaveTextDocumentFeature=Wr.WillSaveWaitUntilFeature=Wr.WillSaveFeature=Wr.DidChangeTextDocumentFeature=Wr.DidCloseTextDocumentFeature=Wr.DidOpenTextDocumentFeature=void 0;var rn=require("vscode"),ct=Ce(),Et=$e(),Ho=bt(),Tv=class extends Et.TextDocumentEventFeature{constructor(e,t){super(e,rn.workspace.onDidOpenTextDocument,ct.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,n=>e.code2ProtocolConverter.asOpenTextDocumentParams(n),n=>n,Et.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Et.ensure)((0,Et.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:Ho.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return ct.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);rn.workspace.textDocuments.forEach(n=>{let i=n.uri.toString();if(!this._syncedDocuments.has(i)&&rn.languages.match(t,n)>0&&!this._client.hasDedicatedTextSynchronizationFeature(n)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));(s.didOpen?s.didOpen(n,o):o(n)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,n)}})}getTextDocument(e){return e}notificationSent(e,t,n){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,n)}};Wr.DidOpenTextDocumentFeature=Tv;var Sv=class extends Et.TextDocumentEventFeature{constructor(e,t,n){super(e,rn.workspace.onDidCloseTextDocument,ct.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,Et.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=n}get registrationType(){return ct.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Et.ensure)((0,Et.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:Ho.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,n){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,n)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let n=this._selectors.values();this._syncedDocuments.forEach(i=>{if(rn.languages.match(t,i)>0&&!this._selectorFilter(n,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(s.didClose?s.didClose(i,o):o(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};Wr.DidCloseTextDocumentFeature=Sv;var Ev=class extends Et.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new rn.EventEmitter,this._onPendingChangeAdded=new rn.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=ct.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return ct.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Et.ensure)((0,Et.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.change!==void 0&&n.change!==ct.TextDocumentSyncKind.None&&this.register({id:Ho.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:n.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=rn.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,n=e.document.version,i=[];for(let s of this._changeData.values())if(rn.languages.match(s.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let o=this._client.middleware;if(s.syncKind===ct.TextDocumentSyncKind.Incremental){let a=async u=>{let c=this._client.code2ProtocolConverter.asChangeTextDocumentParams(u,t,n);await this._client.sendNotification(ct.DidChangeTextDocumentNotification.type,c),this.notificationSent(u.document,ct.DidChangeTextDocumentNotification.type,c)};i.push(o.didChange?o.didChange(e,u=>a(u)):a(e))}else if(s.syncKind===ct.TextDocumentSyncKind.Full){let a=async u=>{let c=u.document.uri.toString();this._pendingTextDocumentChanges.set(c,u.document),this._onPendingChangeAdded.fire()};i.push(o.didChange?o.didChange(e,u=>a(u)):a(e))}}return Promise.all(i).then(void 0,s=>{throw this._client.error(`Sending document notification ${ct.DidChangeTextDocumentNotification.type.method} failed`,s),s})}notificationSent(e,t,n){this._onNotificationSent.fire({textDocument:e,type:t,params:n})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=ct.TextDocumentSyncKind.None;else{this._syncKind=ct.TextDocumentSyncKind.None;for(let t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===ct.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=ct.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let n of this._pendingTextDocumentChanges)e.has(n[0])||(t.push(n[1]),this._pendingTextDocumentChanges.delete(n[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(rn.languages.match(t.documentSelector,e)>0)return{send:n=>this.callback(n)}}updateSyncKind(e){if(this._syncKind!==ct.TextDocumentSyncKind.Full)switch(e){case ct.TextDocumentSyncKind.Full:this._syncKind=e;break;case ct.TextDocumentSyncKind.Incremental:this._syncKind===ct.TextDocumentSyncKind.None&&(this._syncKind=ct.TextDocumentSyncKind.Incremental);break}}};Wr.DidChangeTextDocumentFeature=Ev;var Pv=class extends Et.TextDocumentEventFeature{constructor(e){super(e,rn.workspace.onWillSaveTextDocument,ct.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,n)=>Et.TextDocumentEventFeature.textDocumentFilter(t,n.document))}get registrationType(){return ct.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,Et.ensure)((0,Et.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSave&&this.register({id:Ho.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};Wr.WillSaveFeature=Pv;var xv=class extends Et.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return ct.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,Et.ensure)((0,Et.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSaveWaitUntil&&this.register({id:Ho.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=rn.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Et.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,n=i=>this._client.sendRequest(ct.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async s=>{let o=await this._client.protocol2CodeConverter.asTextEdits(s);return o===void 0?[]:o});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,n):n(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};Wr.WillSaveWaitUntilFeature=xv;var kv=class extends Et.TextDocumentEventFeature{constructor(e){super(e,rn.workspace.onDidSaveTextDocument,ct.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,Et.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return ct.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Et.ensure)((0,Et.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;if(t&&n&&n.save){let i=typeof n.save=="boolean"?{includeText:!1}:{includeText:!!n.save.includeText};this.register({id:Ho.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};Wr.DidSaveTextDocumentFeature=kv});var Xx=L(Ed=>{"use strict";Object.defineProperty(Ed,"__esModule",{value:!0});Ed.CompletionItemFeature=void 0;var hL=require("vscode"),Me=Ce(),Rv=$e(),gL=bt(),mL=[Me.CompletionItemKind.Text,Me.CompletionItemKind.Method,Me.CompletionItemKind.Function,Me.CompletionItemKind.Constructor,Me.CompletionItemKind.Field,Me.CompletionItemKind.Variable,Me.CompletionItemKind.Class,Me.CompletionItemKind.Interface,Me.CompletionItemKind.Module,Me.CompletionItemKind.Property,Me.CompletionItemKind.Unit,Me.CompletionItemKind.Value,Me.CompletionItemKind.Enum,Me.CompletionItemKind.Keyword,Me.CompletionItemKind.Snippet,Me.CompletionItemKind.Color,Me.CompletionItemKind.File,Me.CompletionItemKind.Reference,Me.CompletionItemKind.Folder,Me.CompletionItemKind.EnumMember,Me.CompletionItemKind.Constant,Me.CompletionItemKind.Struct,Me.CompletionItemKind.Event,Me.CompletionItemKind.Operator,Me.CompletionItemKind.TypeParameter],_v=class extends Rv.TextDocumentLanguageFeature{constructor(e){super(e,Me.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,Rv.ensure)((0,Rv.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[Me.MarkupKind.Markdown,Me.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[Me.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[Me.InsertTextMode.asIs,Me.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=Me.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:mL},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){let n=this.getRegistrationOptions(t,e.completionProvider);n&&this.register({id:gL.generateUuid(),registerOptions:n})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);let n=e.triggerCharacters??[],i=e.allCommitCharacters,s=e.documentSelector,o={provideCompletionItems:(a,u,c,l)=>{let f=this._client,d=this._client.middleware,h=(m,D,_,R)=>f.sendRequest(Me.CompletionRequest.type,f.code2ProtocolConverter.asCompletionParams(m,D,_),R).then(N=>R.isCancellationRequested?null:f.protocol2CodeConverter.asCompletionResult(N,i,R),N=>f.handleFailedRequest(Me.CompletionRequest.type,R,N,null));return d.provideCompletionItem?d.provideCompletionItem(a,u,l,c,h):h(a,u,l,c)},resolveCompletionItem:e.resolveProvider?(a,u)=>{let c=this._client,l=this._client.middleware,f=(d,h)=>c.sendRequest(Me.CompletionResolveRequest.type,c.code2ProtocolConverter.asCompletionItem(d,!!this.labelDetailsSupport.get(t)),h).then(m=>h.isCancellationRequested?null:c.protocol2CodeConverter.asCompletionItem(m),m=>c.handleFailedRequest(Me.CompletionResolveRequest.type,h,m,d));return l.resolveCompletionItem?l.resolveCompletionItem(a,u,f):f(a,u)}:void 0};return[hL.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),o,...n),o]}};Ed.CompletionItemFeature=_v});var zx=L(Pd=>{"use strict";Object.defineProperty(Pd,"__esModule",{value:!0});Pd.HoverFeature=void 0;var vL=require("vscode"),gu=Ce(),Iv=$e(),wL=bt(),Ov=class extends Iv.TextDocumentLanguageFeature{constructor(e){super(e,gu.HoverRequest.type)}fillClientCapabilities(e){let t=(0,Iv.ensure)((0,Iv.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[gu.MarkupKind.Markdown,gu.MarkupKind.PlainText]}initialize(e,t){let n=this.getRegistrationOptions(t,e.hoverProvider);n&&this.register({id:wL.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideHover:(i,s,o)=>{let a=this._client,u=(l,f,d)=>a.sendRequest(gu.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,f),d).then(h=>d.isCancellationRequested?null:a.protocol2CodeConverter.asHover(h),h=>a.handleFailedRequest(gu.HoverRequest.type,d,h,null)),c=a.middleware;return c.provideHover?c.provideHover(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return vL.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Pd.HoverFeature=Ov});var Gx=L(xd=>{"use strict";Object.defineProperty(xd,"__esModule",{value:!0});xd.DefinitionFeature=void 0;var yL=require("vscode"),Av=Ce(),Nv=$e(),bL=bt(),Fv=class extends Nv.TextDocumentLanguageFeature{constructor(e){super(e,Av.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,Nv.ensure)((0,Nv.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.definitionProvider);n&&this.register({id:bL.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDefinition:(i,s,o)=>{let a=this._client,u=(l,f,d)=>a.sendRequest(Av.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,f),d).then(h=>d.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(h,d),h=>a.handleFailedRequest(Av.DefinitionRequest.type,d,h,null)),c=a.middleware;return c.provideDefinition?c.provideDefinition(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return yL.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};xd.DefinitionFeature=Fv});var Yx=L(kd=>{"use strict";Object.defineProperty(kd,"__esModule",{value:!0});kd.SignatureHelpFeature=void 0;var Qx=require("vscode"),mu=Ce(),Lv=$e(),CL=bt(),Mv=class extends Lv.TextDocumentLanguageFeature{constructor(e){super(e,mu.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,Lv.ensure)((0,Lv.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[mu.MarkupKind.Markdown,mu.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.signatureHelpProvider);n&&this.register({id:CL.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideSignatureHelp:(n,i,s,o)=>{let a=this._client,u=(l,f,d,h)=>a.sendRequest(mu.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(l,f,d),h).then(m=>h.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(m,h),m=>a.handleFailedRequest(mu.SignatureHelpRequest.type,h,m,null)),c=a.middleware;return c.provideSignatureHelp?c.provideSignatureHelp(n,i,o,s,u):u(n,i,o,s)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let n=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return Qx.languages.registerSignatureHelpProvider(n,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return Qx.languages.registerSignatureHelpProvider(n,t,i)}}};kd.SignatureHelpFeature=Mv});var Jx=L(Rd=>{"use strict";Object.defineProperty(Rd,"__esModule",{value:!0});Rd.DocumentHighlightFeature=void 0;var DL=require("vscode"),qv=Ce(),jv=$e(),TL=bt(),Uv=class extends jv.TextDocumentLanguageFeature{constructor(e){super(e,qv.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,jv.ensure)((0,jv.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentHighlightProvider);n&&this.register({id:TL.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentHighlights:(i,s,o)=>{let a=this._client,u=(l,f,d)=>a.sendRequest(qv.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,f),d).then(h=>d.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(h,d),h=>a.handleFailedRequest(qv.DocumentHighlightRequest.type,d,h,null)),c=a.middleware;return c.provideDocumentHighlights?c.provideDocumentHighlights(i,s,o,u):u(i,s,o)}};return[DL.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};Rd.DocumentHighlightFeature=Uv});var Wv=L(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.DocumentSymbolFeature=Yn.SupportedSymbolTags=Yn.SupportedSymbolKinds=void 0;var SL=require("vscode"),ze=Ce(),$v=$e(),EL=bt();Yn.SupportedSymbolKinds=[ze.SymbolKind.File,ze.SymbolKind.Module,ze.SymbolKind.Namespace,ze.SymbolKind.Package,ze.SymbolKind.Class,ze.SymbolKind.Method,ze.SymbolKind.Property,ze.SymbolKind.Field,ze.SymbolKind.Constructor,ze.SymbolKind.Enum,ze.SymbolKind.Interface,ze.SymbolKind.Function,ze.SymbolKind.Variable,ze.SymbolKind.Constant,ze.SymbolKind.String,ze.SymbolKind.Number,ze.SymbolKind.Boolean,ze.SymbolKind.Array,ze.SymbolKind.Object,ze.SymbolKind.Key,ze.SymbolKind.Null,ze.SymbolKind.EnumMember,ze.SymbolKind.Struct,ze.SymbolKind.Event,ze.SymbolKind.Operator,ze.SymbolKind.TypeParameter];Yn.SupportedSymbolTags=[ze.SymbolTag.Deprecated];var Bv=class extends $v.TextDocumentLanguageFeature{constructor(e){super(e,ze.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,$v.ensure)((0,$v.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Yn.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:Yn.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentSymbolProvider);n&&this.register({id:EL.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentSymbols:(s,o)=>{let a=this._client,u=async(l,f)=>{try{let d=await a.sendRequest(ze.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(l),f);if(f.isCancellationRequested||d===void 0||d===null)return null;if(d.length===0)return[];{let h=d[0];return ze.DocumentSymbol.is(h)?await a.protocol2CodeConverter.asDocumentSymbols(d,f):await a.protocol2CodeConverter.asSymbolInformations(d,f)}}catch(d){return a.handleFailedRequest(ze.DocumentSymbolRequest.type,f,d,null)}},c=a.middleware;return c.provideDocumentSymbols?c.provideDocumentSymbols(s,o,u):u(s,o)}},i=e.label!==void 0?{label:e.label}:void 0;return[SL.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n,i),n]}};Yn.DocumentSymbolFeature=Bv});var ek=L(_d=>{"use strict";Object.defineProperty(_d,"__esModule",{value:!0});_d.WorkspaceSymbolFeature=void 0;var PL=require("vscode"),vu=Ce(),Vv=$e(),Zx=Wv(),xL=bt(),Hv=class extends Vv.WorkspaceFeature{constructor(e){super(e,vu.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Vv.ensure)((0,Vv.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Zx.SupportedSymbolKinds},t.tagSupport={valueSet:Zx.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:xL.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(n,i)=>{let s=this._client,o=(u,c)=>s.sendRequest(vu.WorkspaceSymbolRequest.type,{query:u},c).then(l=>c.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformations(l,c),l=>s.handleFailedRequest(vu.WorkspaceSymbolRequest.type,c,l,null)),a=s.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(n,i,o):o(n,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(n,i)=>{let s=this._client,o=(u,c)=>s.sendRequest(vu.WorkspaceSymbolResolveRequest.type,s.code2ProtocolConverter.asWorkspaceSymbol(u),c).then(l=>c.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformation(l),l=>s.handleFailedRequest(vu.WorkspaceSymbolResolveRequest.type,c,l,null)),a=s.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(n,i,o):o(n,i)}:void 0};return[PL.languages.registerWorkspaceSymbolProvider(t),t]}};_d.WorkspaceSymbolFeature=Hv});var tk=L(Id=>{"use strict";Object.defineProperty(Id,"__esModule",{value:!0});Id.ReferencesFeature=void 0;var kL=require("vscode"),Kv=Ce(),Xv=$e(),RL=bt(),zv=class extends Xv.TextDocumentLanguageFeature{constructor(e){super(e,Kv.ReferencesRequest.type)}fillClientCapabilities(e){(0,Xv.ensure)((0,Xv.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.referencesProvider);n&&this.register({id:RL.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideReferences:(i,s,o,a)=>{let u=this._client,c=(f,d,h,m)=>u.sendRequest(Kv.ReferencesRequest.type,u.code2ProtocolConverter.asReferenceParams(f,d,h),m).then(D=>m.isCancellationRequested?null:u.protocol2CodeConverter.asReferences(D,m),D=>u.handleFailedRequest(Kv.ReferencesRequest.type,m,D,null)),l=u.middleware;return l.provideReferences?l.provideReferences(i,s,o,a,c):c(i,s,o,a)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return kL.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Id.ReferencesFeature=zv});var rk=L(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});Od.CodeActionFeature=void 0;var _L=require("vscode"),nn=Ce(),IL=bt(),Gv=$e(),Qv=class extends Gv.TextDocumentLanguageFeature{constructor(e){super(e,nn.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,Gv.ensure)((0,Gv.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[nn.CodeActionKind.Empty,nn.CodeActionKind.QuickFix,nn.CodeActionKind.Refactor,nn.CodeActionKind.RefactorExtract,nn.CodeActionKind.RefactorInline,nn.CodeActionKind.RefactorRewrite,nn.CodeActionKind.Source,nn.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.codeActionProvider);n&&this.register({id:IL.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideCodeActions:(i,s,o,a)=>{let u=this._client,c=async(f,d,h,m)=>{let D={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(f),range:u.code2ProtocolConverter.asRange(d),context:u.code2ProtocolConverter.asCodeActionContextSync(h)};return u.sendRequest(nn.CodeActionRequest.type,D,m).then(_=>m.isCancellationRequested||_===null||_===void 0?null:u.protocol2CodeConverter.asCodeActionResult(_,m),_=>u.handleFailedRequest(nn.CodeActionRequest.type,m,_,null))},l=u.middleware;return l.provideCodeActions?l.provideCodeActions(i,s,o,a,c):c(i,s,o,a)},resolveCodeAction:e.resolveProvider?(i,s)=>{let o=this._client,a=this._client.middleware,u=async(c,l)=>o.sendRequest(nn.CodeActionResolveRequest.type,o.code2ProtocolConverter.asCodeActionSync(c),l).then(f=>l.isCancellationRequested?c:o.protocol2CodeConverter.asCodeAction(f,l),f=>o.handleFailedRequest(nn.CodeActionResolveRequest.type,l,f,c));return a.resolveCodeAction?a.resolveCodeAction(i,s,u):u(i,s)}:void 0};return[_L.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),n]}};Od.CodeActionFeature=Qv});var ik=L(Ad=>{"use strict";Object.defineProperty(Ad,"__esModule",{value:!0});Ad.CodeLensFeature=void 0;var nk=require("vscode"),Ko=Ce(),OL=bt(),wu=$e(),Yv=class extends wu.TextDocumentLanguageFeature{constructor(e){super(e,Ko.CodeLensRequest.type)}fillClientCapabilities(e){(0,wu.ensure)((0,wu.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,wu.ensure)((0,wu.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ko.CodeLensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:OL.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n=new nk.EventEmitter,i={onDidChangeCodeLenses:n.event,provideCodeLenses:(s,o)=>{let a=this._client,u=(l,f)=>a.sendRequest(Ko.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(l),f).then(d=>f.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(d,f),d=>a.handleFailedRequest(Ko.CodeLensRequest.type,f,d,null)),c=a.middleware;return c.provideCodeLenses?c.provideCodeLenses(s,o,u):u(s,o)},resolveCodeLens:e.resolveProvider?(s,o)=>{let a=this._client,u=(l,f)=>a.sendRequest(Ko.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(l),f).then(d=>f.isCancellationRequested?l:a.protocol2CodeConverter.asCodeLens(d),d=>a.handleFailedRequest(Ko.CodeLensResolveRequest.type,f,d,l)),c=a.middleware;return c.resolveCodeLens?c.resolveCodeLens(s,o,u):u(s,o)}:void 0};return[nk.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:n}]}};Ad.CodeLensFeature=Yv});var sk=L(ss=>{"use strict";Object.defineProperty(ss,"__esModule",{value:!0});ss.DocumentOnTypeFormattingFeature=ss.DocumentRangeFormattingFeature=ss.DocumentFormattingFeature=void 0;var Nd=require("vscode"),In=Ce(),tw=bt(),yi=$e(),Xo;(function(r){function e(t){let n=Nd.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:n.get("trimTrailingWhitespace"),trimFinalNewlines:n.get("trimFinalNewlines"),insertFinalNewline:n.get("insertFinalNewline")}}r.fromConfiguration=e})(Xo||(Xo={}));var Jv=class extends yi.TextDocumentLanguageFeature{constructor(e){super(e,In.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,yi.ensure)((0,yi.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentFormattingProvider);n&&this.register({id:tw.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentFormattingEdits:(i,s,o)=>{let a=this._client,u=(l,f,d)=>{let h={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),options:a.code2ProtocolConverter.asFormattingOptions(f,Xo.fromConfiguration(l))};return a.sendRequest(In.DocumentFormattingRequest.type,h,d).then(m=>d.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(m,d),m=>a.handleFailedRequest(In.DocumentFormattingRequest.type,d,m,null))},c=a.middleware;return c.provideDocumentFormattingEdits?c.provideDocumentFormattingEdits(i,s,o,u):u(i,s,o)}};return[Nd.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};ss.DocumentFormattingFeature=Jv;var Zv=class extends yi.TextDocumentLanguageFeature{constructor(e){super(e,In.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){let t=(0,yi.ensure)((0,yi.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);n&&this.register({id:tw.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentRangeFormattingEdits:(i,s,o,a)=>{let u=this._client,c=(f,d,h,m)=>{let D={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(f),range:u.code2ProtocolConverter.asRange(d),options:u.code2ProtocolConverter.asFormattingOptions(h,Xo.fromConfiguration(f))};return u.sendRequest(In.DocumentRangeFormattingRequest.type,D,m).then(_=>m.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(_,m),_=>u.handleFailedRequest(In.DocumentRangeFormattingRequest.type,m,_,null))},l=u.middleware;return l.provideDocumentRangeFormattingEdits?l.provideDocumentRangeFormattingEdits(i,s,o,a,c):c(i,s,o,a)}};return e.rangesSupport&&(n.provideDocumentRangesFormattingEdits=(i,s,o,a)=>{let u=this._client,c=(f,d,h,m)=>{let D={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(f),ranges:u.code2ProtocolConverter.asRanges(d),options:u.code2ProtocolConverter.asFormattingOptions(h,Xo.fromConfiguration(f))};return u.sendRequest(In.DocumentRangesFormattingRequest.type,D,m).then(_=>m.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(_,m),_=>u.handleFailedRequest(In.DocumentRangesFormattingRequest.type,m,_,null))},l=u.middleware;return l.provideDocumentRangesFormattingEdits?l.provideDocumentRangesFormattingEdits(i,s,o,a,c):c(i,s,o,a)}),[Nd.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};ss.DocumentRangeFormattingFeature=Zv;var ew=class extends yi.TextDocumentLanguageFeature{constructor(e){super(e,In.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,yi.ensure)((0,yi.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);n&&this.register({id:tw.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideOnTypeFormattingEdits:(s,o,a,u,c)=>{let l=this._client,f=(h,m,D,_,R)=>{let N={textDocument:l.code2ProtocolConverter.asTextDocumentIdentifier(h),position:l.code2ProtocolConverter.asPosition(m),ch:D,options:l.code2ProtocolConverter.asFormattingOptions(_,Xo.fromConfiguration(h))};return l.sendRequest(In.DocumentOnTypeFormattingRequest.type,N,R).then(w=>R.isCancellationRequested?null:l.protocol2CodeConverter.asTextEdits(w,R),w=>l.handleFailedRequest(In.DocumentOnTypeFormattingRequest.type,R,w,null))},d=l.middleware;return d.provideOnTypeFormattingEdits?d.provideOnTypeFormattingEdits(s,o,a,u,c,f):f(s,o,a,u,c)}},i=e.moreTriggerCharacter||[];return[Nd.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n,e.firstTriggerCharacter,...i),n]}};ss.DocumentOnTypeFormattingFeature=ew});var ak=L(Fd=>{"use strict";Object.defineProperty(Fd,"__esModule",{value:!0});Fd.RenameFeature=void 0;var AL=require("vscode"),qs=Ce(),NL=bt(),ok=gn(),rw=$e(),nw=class extends rw.TextDocumentLanguageFeature{constructor(e){super(e,qs.RenameRequest.type)}fillClientCapabilities(e){let t=(0,rw.ensure)((0,rw.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=qs.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.renameProvider);n&&(ok.boolean(e.renameProvider)&&(n.prepareProvider=!1),this.register({id:NL.generateUuid(),registerOptions:n}))}registerLanguageProvider(e){let t=e.documentSelector,n={provideRenameEdits:(i,s,o,a)=>{let u=this._client,c=(f,d,h,m)=>{let D={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(f),position:u.code2ProtocolConverter.asPosition(d),newName:h};return u.sendRequest(qs.RenameRequest.type,D,m).then(_=>m.isCancellationRequested?null:u.protocol2CodeConverter.asWorkspaceEdit(_,m),_=>u.handleFailedRequest(qs.RenameRequest.type,m,_,null,!1))},l=u.middleware;return l.provideRenameEdits?l.provideRenameEdits(i,s,o,a,c):c(i,s,o,a)},prepareRename:e.prepareProvider?(i,s,o)=>{let a=this._client,u=(l,f,d)=>{let h={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),position:a.code2ProtocolConverter.asPosition(f)};return a.sendRequest(qs.PrepareRenameRequest.type,h,d).then(m=>d.isCancellationRequested?null:qs.Range.is(m)?a.protocol2CodeConverter.asRange(m):this.isDefaultBehavior(m)?m.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):m&&qs.Range.is(m.range)?{range:a.protocol2CodeConverter.asRange(m.range),placeholder:m.placeholder}:Promise.reject(new Error("The element can't be renamed.")),m=>{throw typeof m.message=="string"?new Error(m.message):new Error("The element can't be renamed.")})},c=a.middleware;return c.prepareRename?c.prepareRename(i,s,o,u):u(i,s,o)}:void 0};return[this.registerProvider(t,n),n]}registerProvider(e,t){return AL.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&ok.boolean(t.defaultBehavior)}};Fd.RenameFeature=nw});var uk=L(Ld=>{"use strict";Object.defineProperty(Ld,"__esModule",{value:!0});Ld.DocumentLinkFeature=void 0;var FL=require("vscode"),yu=Ce(),iw=$e(),LL=bt(),sw=class extends iw.TextDocumentLanguageFeature{constructor(e){super(e,yu.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,iw.ensure)((0,iw.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentLinkProvider);n&&this.register({id:LL.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentLinks:(i,s)=>{let o=this._client,a=(c,l)=>o.sendRequest(yu.DocumentLinkRequest.type,o.code2ProtocolConverter.asDocumentLinkParams(c),l).then(f=>l.isCancellationRequested?null:o.protocol2CodeConverter.asDocumentLinks(f,l),f=>o.handleFailedRequest(yu.DocumentLinkRequest.type,l,f,null)),u=o.middleware;return u.provideDocumentLinks?u.provideDocumentLinks(i,s,a):a(i,s)},resolveDocumentLink:e.resolveProvider?(i,s)=>{let o=this._client,a=(c,l)=>o.sendRequest(yu.DocumentLinkResolveRequest.type,o.code2ProtocolConverter.asDocumentLink(c),l).then(f=>l.isCancellationRequested?c:o.protocol2CodeConverter.asDocumentLink(f),f=>o.handleFailedRequest(yu.DocumentLinkResolveRequest.type,l,f,c)),u=o.middleware;return u.resolveDocumentLink?u.resolveDocumentLink(i,s,a):a(i,s)}:void 0};return[FL.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};Ld.DocumentLinkFeature=sw});var lk=L(Md=>{"use strict";Object.defineProperty(Md,"__esModule",{value:!0});Md.ExecuteCommandFeature=void 0;var ML=require("vscode"),ow=Ce(),qL=bt(),ck=$e(),aw=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return ow.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,ck.ensure)((0,ck.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:qL.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,n=t.middleware,i=(s,o)=>{let a={command:s,arguments:o};return t.sendRequest(ow.ExecuteCommandRequest.type,a).then(void 0,u=>t.handleFailedRequest(ow.ExecuteCommandRequest.type,void 0,u,void 0))};if(e.registerOptions.commands){let s=[];for(let o of e.registerOptions.commands)s.push(ML.commands.registerCommand(o,(...a)=>n.executeCommand?n.executeCommand(o,a,i):i(o,a)));this._commands.set(e.id,s)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(n=>n.dispose())}clear(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};Md.ExecuteCommandFeature=aw});var dk=L(jd=>{"use strict";Object.defineProperty(jd,"__esModule",{value:!0});jd.FileSystemWatcherFeature=void 0;var jL=require("vscode"),js=Ce(),qd=$e(),uw=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return js.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,qd.ensure)((0,qd.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,qd.ensure)((0,qd.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let n of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(n.globPattern);if(i===void 0)continue;let s=!0,o=!0,a=!0;n.kind!==void 0&&n.kind!==null&&(s=(n.kind&js.WatchKind.Create)!==0,o=(n.kind&js.WatchKind.Change)!==0,a=(n.kind&js.WatchKind.Delete)!==0);let u=jL.workspace.createFileSystemWatcher(i,!s,!o,!a);this.hookListeners(u,s,o,a,t),t.push(u)}this._watchers.set(e.id,t)}registerRaw(e,t){let n=[];for(let i of t)this.hookListeners(i,!0,!0,!0,n);this._watchers.set(e,n)}hookListeners(e,t,n,i,s){t&&e.onDidCreate(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:js.FileChangeType.Created}),null,s),n&&e.onDidChange(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:js.FileChangeType.Changed}),null,s),i&&e.onDidDelete(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:js.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let n of t)n.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};jd.FileSystemWatcherFeature=uw});var fk=L(Ud=>{"use strict";Object.defineProperty(Ud,"__esModule",{value:!0});Ud.ColorProviderFeature=void 0;var UL=require("vscode"),bu=Ce(),cw=$e(),lw=class extends cw.TextDocumentLanguageFeature{constructor(e){super(e,bu.DocumentColorRequest.type)}fillClientCapabilities(e){(0,cw.ensure)((0,cw.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.colorProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideColorPresentations:(i,s,o)=>{let a=this._client,u=(l,f,d)=>{let h={color:l,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(f.document),range:a.code2ProtocolConverter.asRange(f.range)};return a.sendRequest(bu.ColorPresentationRequest.type,h,d).then(m=>d.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(m,d),m=>a.handleFailedRequest(bu.ColorPresentationRequest.type,d,m,null))},c=a.middleware;return c.provideColorPresentations?c.provideColorPresentations(i,s,o,u):u(i,s,o)},provideDocumentColors:(i,s)=>{let o=this._client,a=(c,l)=>{let f={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(c)};return o.sendRequest(bu.DocumentColorRequest.type,f,l).then(d=>l.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(d,l),d=>o.handleFailedRequest(bu.DocumentColorRequest.type,l,d,null))},u=o.middleware;return u.provideDocumentColors?u.provideDocumentColors(i,s,a):a(i,s)}};return[UL.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};Ud.ColorProviderFeature=lw});var pk=L($d=>{"use strict";Object.defineProperty($d,"__esModule",{value:!0});$d.ImplementationFeature=void 0;var $L=require("vscode"),dw=Ce(),fw=$e(),pw=class extends fw.TextDocumentLanguageFeature{constructor(e){super(e,dw.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,fw.ensure)((0,fw.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.implementationProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideImplementation:(i,s,o)=>{let a=this._client,u=(l,f,d)=>a.sendRequest(dw.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,f),d).then(h=>d.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(h,d),h=>a.handleFailedRequest(dw.ImplementationRequest.type,d,h,null)),c=a.middleware;return c.provideImplementation?c.provideImplementation(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return $L.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};$d.ImplementationFeature=pw});var hk=L(Bd=>{"use strict";Object.defineProperty(Bd,"__esModule",{value:!0});Bd.TypeDefinitionFeature=void 0;var BL=require("vscode"),hw=Ce(),Cu=$e(),gw=class extends Cu.TextDocumentLanguageFeature{constructor(e){super(e,hw.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,Cu.ensure)((0,Cu.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,Cu.ensure)((0,Cu.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.typeDefinitionProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideTypeDefinition:(i,s,o)=>{let a=this._client,u=(l,f,d)=>a.sendRequest(hw.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,f),d).then(h=>d.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(h,d),h=>a.handleFailedRequest(hw.TypeDefinitionRequest.type,d,h,null)),c=a.middleware;return c.provideTypeDefinition?c.provideTypeDefinition(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return BL.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Bd.TypeDefinitionFeature=gw});var gk=L(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.WorkspaceFoldersFeature=zo.arrayDiff=void 0;var WL=bt(),Wd=require("vscode"),Du=Ce();function mw(r,e){if(r!=null)return r[e]}function vw(r,e){return r.filter(t=>e.indexOf(t)<0)}zo.arrayDiff=vw;var ww=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Du.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=Wd.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(n=>this.asProtocol(n))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(Du.WorkspaceFoldersRequest.type,s=>{let o=()=>{let u=Wd.workspace.workspaceFolders;return u===void 0?null:u.map(l=>this.asProtocol(l))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(s,o):o(s)});let n=mw(mw(mw(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof n=="string"?i=n:n===!0&&(i=WL.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let n=vw(this._initialFolders,e),i=vw(e,this._initialFolders);(i.length>0||n.length>0)&&(t=this.doSendEvent(i,n))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(n=>{this._client.error(`Sending notification ${Du.DidChangeWorkspaceFoldersNotification.type.method} failed`,n)})}doSendEvent(e,t){let n={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(Du.DidChangeWorkspaceFoldersNotification.type,n)}register(e){let t=e.id,n=this._client,i=Wd.workspace.onDidChangeWorkspaceFolders(s=>{let o=c=>this.doSendEvent(c.added,c.removed),a=n.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(s,o):o(s)).catch(c=>{this._client.error(`Sending notification ${Du.DidChangeWorkspaceFoldersNotification.type.method} failed`,c)})});this._listeners.set(t,i),this.sendInitialEvent(Wd.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};zo.WorkspaceFoldersFeature=ww});var vk=L(Vd=>{"use strict";Object.defineProperty(Vd,"__esModule",{value:!0});Vd.FoldingRangeFeature=void 0;var mk=require("vscode"),Us=Ce(),Tu=$e(),yw=class extends Tu.TextDocumentLanguageFeature{constructor(e){super(e,Us.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,Tu.ensure)((0,Tu.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[Us.FoldingRangeKind.Comment,Us.FoldingRangeKind.Imports,Us.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,Tu.ensure)((0,Tu.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(Us.FoldingRangeRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeFoldingRange.fire()});let[n,i]=this.getRegistration(t,e.foldingRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n=new mk.EventEmitter,i={onDidChangeFoldingRanges:n.event,provideFoldingRanges:(s,o,a)=>{let u=this._client,c=(f,d,h)=>{let m={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(f)};return u.sendRequest(Us.FoldingRangeRequest.type,m,h).then(D=>h.isCancellationRequested?null:u.protocol2CodeConverter.asFoldingRanges(D,h),D=>u.handleFailedRequest(Us.FoldingRangeRequest.type,h,D,null))},l=u.middleware;return l.provideFoldingRanges?l.provideFoldingRanges(s,o,a,c):c(s,o,a)}};return[mk.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeFoldingRange:n}]}};Vd.FoldingRangeFeature=yw});var wk=L(Hd=>{"use strict";Object.defineProperty(Hd,"__esModule",{value:!0});Hd.DeclarationFeature=void 0;var VL=require("vscode"),bw=Ce(),Cw=$e(),Dw=class extends Cw.TextDocumentLanguageFeature{constructor(e){super(e,bw.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,Cw.ensure)((0,Cw.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.declarationProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDeclaration:(i,s,o)=>{let a=this._client,u=(l,f,d)=>a.sendRequest(bw.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,f),d).then(h=>d.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(h,d),h=>a.handleFailedRequest(bw.DeclarationRequest.type,d,h,null)),c=a.middleware;return c.provideDeclaration?c.provideDeclaration(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return VL.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Hd.DeclarationFeature=Dw});var yk=L(Kd=>{"use strict";Object.defineProperty(Kd,"__esModule",{value:!0});Kd.SelectionRangeFeature=void 0;var HL=require("vscode"),Tw=Ce(),Sw=$e(),Ew=class extends Sw.TextDocumentLanguageFeature{constructor(e){super(e,Tw.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,Sw.ensure)((0,Sw.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.selectionRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideSelectionRanges:(i,s,o)=>{let a=this._client,u=async(l,f,d)=>{let h={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(l),positions:a.code2ProtocolConverter.asPositionsSync(f,d)};return a.sendRequest(Tw.SelectionRangeRequest.type,h,d).then(m=>d.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(m,d),m=>a.handleFailedRequest(Tw.SelectionRangeRequest.type,d,m,null))},c=a.middleware;return c.provideSelectionRanges?c.provideSelectionRanges(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return HL.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Kd.SelectionRangeFeature=Ew});var Ck=L(Xd=>{"use strict";Object.defineProperty(Xd,"__esModule",{value:!0});Xd.ProgressFeature=void 0;var bk=Ce(),KL=Jm();function XL(r,e){return r[e]===void 0&&(r[e]=Object.create(null)),r[e]}var Pw=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:bk.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){XL(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},n=i=>{this.activeParts.add(new KL.ProgressPart(this._client,i.token,t))};e.onRequest(bk.WorkDoneProgressCreateRequest.type,n)}clear(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};Xd.ProgressFeature=Pw});var Dk=L(zd=>{"use strict";Object.defineProperty(zd,"__esModule",{value:!0});zd.CallHierarchyFeature=void 0;var zL=require("vscode"),$s=Ce(),xw=$e(),kw=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,n){let i=this.client,s=this.middleware,o=(a,u,c)=>{let l=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest($s.CallHierarchyPrepareRequest.type,l,c).then(f=>c.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(f,c),f=>i.handleFailedRequest($s.CallHierarchyPrepareRequest.type,c,f,null))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,n,o):o(e,t,n)}provideCallHierarchyIncomingCalls(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let u={item:n.code2ProtocolConverter.asCallHierarchyItem(o)};return n.sendRequest($s.CallHierarchyIncomingCallsRequest.type,u,a).then(c=>a.isCancellationRequested?null:n.protocol2CodeConverter.asCallHierarchyIncomingCalls(c,a),c=>n.handleFailedRequest($s.CallHierarchyIncomingCallsRequest.type,a,c,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let u={item:n.code2ProtocolConverter.asCallHierarchyItem(o)};return n.sendRequest($s.CallHierarchyOutgoingCallsRequest.type,u,a).then(c=>a.isCancellationRequested?null:n.protocol2CodeConverter.asCallHierarchyOutgoingCalls(c,a),c=>n.handleFailedRequest($s.CallHierarchyOutgoingCallsRequest.type,a,c,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,s):s(e,t)}},Rw=class extends xw.TextDocumentLanguageFeature{constructor(e){super(e,$s.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,n=(0,xw.ensure)((0,xw.ensure)(t,"textDocument"),"callHierarchy");n.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.callHierarchyProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=this._client,n=new kw(t);return[zL.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),n),n]}};zd.CallHierarchyFeature=Rw});var Tk=L(Qd=>{"use strict";Object.defineProperty(Qd,"__esModule",{value:!0});Qd.SemanticTokensFeature=void 0;var Gd=require("vscode"),Ee=Ce(),Su=$e(),GL=gn(),_w=class extends Su.TextDocumentLanguageFeature{constructor(e){super(e,Ee.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,Su.ensure)((0,Su.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[Ee.SemanticTokenTypes.namespace,Ee.SemanticTokenTypes.type,Ee.SemanticTokenTypes.class,Ee.SemanticTokenTypes.enum,Ee.SemanticTokenTypes.interface,Ee.SemanticTokenTypes.struct,Ee.SemanticTokenTypes.typeParameter,Ee.SemanticTokenTypes.parameter,Ee.SemanticTokenTypes.variable,Ee.SemanticTokenTypes.property,Ee.SemanticTokenTypes.enumMember,Ee.SemanticTokenTypes.event,Ee.SemanticTokenTypes.function,Ee.SemanticTokenTypes.method,Ee.SemanticTokenTypes.macro,Ee.SemanticTokenTypes.keyword,Ee.SemanticTokenTypes.modifier,Ee.SemanticTokenTypes.comment,Ee.SemanticTokenTypes.string,Ee.SemanticTokenTypes.number,Ee.SemanticTokenTypes.regexp,Ee.SemanticTokenTypes.operator,Ee.SemanticTokenTypes.decorator],t.tokenModifiers=[Ee.SemanticTokenModifiers.declaration,Ee.SemanticTokenModifiers.definition,Ee.SemanticTokenModifiers.readonly,Ee.SemanticTokenModifiers.static,Ee.SemanticTokenModifiers.deprecated,Ee.SemanticTokenModifiers.abstract,Ee.SemanticTokenModifiers.async,Ee.SemanticTokenModifiers.modification,Ee.SemanticTokenModifiers.documentation,Ee.SemanticTokenModifiers.defaultLibrary],t.formats=[Ee.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,Su.ensure)((0,Su.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ee.SemanticTokensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeSemanticTokensEmitter.fire()});let[i,s]=this.getRegistration(t,e.semanticTokensProvider);!i||!s||this.register({id:i,registerOptions:s})}registerLanguageProvider(e){let t=e.documentSelector,n=GL.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,s=new Gd.EventEmitter,o=n?{onDidChangeSemanticTokens:s.event,provideDocumentSemanticTokens:(h,m)=>{let D=this._client,_=D.middleware,R=(N,w)=>{let p={textDocument:D.code2ProtocolConverter.asTextDocumentIdentifier(N)};return D.sendRequest(Ee.SemanticTokensRequest.type,p,w).then(v=>w.isCancellationRequested?null:D.protocol2CodeConverter.asSemanticTokens(v,w),v=>D.handleFailedRequest(Ee.SemanticTokensRequest.type,w,v,null))};return _.provideDocumentSemanticTokens?_.provideDocumentSemanticTokens(h,m,R):R(h,m)},provideDocumentSemanticTokensEdits:i?(h,m,D)=>{let _=this._client,R=_.middleware,N=(w,p,v)=>{let g={textDocument:_.code2ProtocolConverter.asTextDocumentIdentifier(w),previousResultId:p};return _.sendRequest(Ee.SemanticTokensDeltaRequest.type,g,v).then(async k=>v.isCancellationRequested?null:Ee.SemanticTokens.is(k)?await _.protocol2CodeConverter.asSemanticTokens(k,v):await _.protocol2CodeConverter.asSemanticTokensEdits(k,v),k=>_.handleFailedRequest(Ee.SemanticTokensDeltaRequest.type,v,k,null))};return R.provideDocumentSemanticTokensEdits?R.provideDocumentSemanticTokensEdits(h,m,D,N):N(h,m,D)}:void 0}:void 0,u=e.range===!0?{provideDocumentRangeSemanticTokens:(h,m,D)=>{let _=this._client,R=_.middleware,N=(w,p,v)=>{let g={textDocument:_.code2ProtocolConverter.asTextDocumentIdentifier(w),range:_.code2ProtocolConverter.asRange(p)};return _.sendRequest(Ee.SemanticTokensRangeRequest.type,g,v).then(k=>v.isCancellationRequested?null:_.protocol2CodeConverter.asSemanticTokens(k,v),k=>_.handleFailedRequest(Ee.SemanticTokensRangeRequest.type,v,k,null))};return R.provideDocumentRangeSemanticTokens?R.provideDocumentRangeSemanticTokens(h,m,D,N):N(h,m,D)}}:void 0,c=[],l=this._client,f=l.protocol2CodeConverter.asSemanticTokensLegend(e.legend),d=l.protocol2CodeConverter.asDocumentSelector(t);return o!==void 0&&c.push(Gd.languages.registerDocumentSemanticTokensProvider(d,o,f)),u!==void 0&&c.push(Gd.languages.registerDocumentRangeSemanticTokensProvider(d,u,f)),[new Gd.Disposable(()=>c.forEach(h=>h.dispose())),{range:u,full:o,onDidChangeSemanticTokensEmitter:s}]}};Qd.SemanticTokensFeature=_w});var Pk=L(Vr=>{"use strict";Object.defineProperty(Vr,"__esModule",{value:!0});Vr.WillDeleteFilesFeature=Vr.WillRenameFilesFeature=Vr.WillCreateFilesFeature=Vr.DidDeleteFilesFeature=Vr.DidRenameFilesFeature=Vr.DidCreateFilesFeature=void 0;var Cn=require("vscode"),QL=wd(),bi=Ce(),YL=bt();function Sk(r,e){return r[e]===void 0&&(r[e]={}),r[e]}function JL(r,e){return r[e]}function Ek(r,e,t){r[e]=t}var Eu=class r{constructor(e,t,n,i,s){this._client=e,this._event=t,this._registrationType=n,this._clientCapability=i,this._serverCapability=s,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=Sk(Sk(e,"workspace"),"fileOperations");Ek(t,"dynamicRegistration",!0),Ek(t,this._clientCapability,!0)}initialize(e){let t=e.workspace?.fileOperations,n=t!==void 0?JL(t,this._serverCapability):void 0;if(n?.filters!==void 0)try{this.register({id:YL.generateUuid(),registerOptions:{filters:n.filters}})}catch(i){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${i}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(n=>{let i=new QL.Minimatch(n.pattern.glob,r.asMinimatchOptions(n.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${n.pattern.glob}!`);return{scheme:n.scheme,matcher:i,kind:n.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return r.getFileType(e)}async filter(e,t){let n=await Promise.all(e.files.map(async s=>{let o=t(s),a=o.fsPath.replace(/\\/g,"/");for(let u of this._filters.values())for(let c of u)if(!(c.scheme!==void 0&&c.scheme!==o.scheme)){if(c.matcher.match(a)){if(c.kind===void 0)return!0;let l=await this.getFileType(o);if(l===void 0)return this._client.error(`Failed to determine file type for ${o.toString()}.`),!0;if(l===Cn.FileType.File&&c.kind===bi.FileOperationPatternKind.file||l===Cn.FileType.Directory&&c.kind===bi.FileOperationPatternKind.folder)return!0}else if(c.kind===bi.FileOperationPatternKind.folder&&await r.getFileType(o)===Cn.FileType.Directory&&c.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((s,o)=>n[o]);return{...e,files:i}}static async getFileType(e){try{return(await Cn.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){let t={dot:!0};return e?.ignoreCase===!0&&(t.nocase=!0),t}},Yd=class extends Eu{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s),this._notificationType=n,this._accessUri=o,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let n=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,n)}}},Jd=class extends Yd{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let n=await Eu.getFileType(e);return n&&this._fsPathFileTypes.set(t,n),n}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},Iw=class extends Yd{constructor(e){super(e,Cn.workspace.onDidCreateFiles,bi.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.didCreateFiles?n.didCreateFiles(e,t):t(e)}};Vr.DidCreateFilesFeature=Iw;var Ow=class extends Jd{constructor(e){super(e,Cn.workspace.onDidRenameFiles,bi.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=Cn.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let n=this._client.middleware.workspace;return n?.didRenameFiles?n.didRenameFiles(e,t):t(e)}};Vr.DidRenameFilesFeature=Ow;var Aw=class extends Jd{constructor(e){super(e,Cn.workspace.onDidDeleteFiles,bi.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=Cn.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let n=this._client.middleware.workspace;return n?.didDeleteFiles?n.didDeleteFiles(e,t):t(e)}};Vr.DidDeleteFilesFeature=Aw;var Pu=class extends Eu{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s),this._requestType=n,this._accessUri=o,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let n=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,n)}else return}},Nw=class extends Pu{constructor(e){super(e,Cn.workspace.onWillCreateFiles,bi.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.willCreateFiles?n.willCreateFiles(e,t):t(e)}};Vr.WillCreateFilesFeature=Nw;var Fw=class extends Pu{constructor(e){super(e,Cn.workspace.onWillRenameFiles,bi.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.willRenameFiles?n.willRenameFiles(e,t):t(e)}};Vr.WillRenameFilesFeature=Fw;var Lw=class extends Pu{constructor(e){super(e,Cn.workspace.onWillDeleteFiles,bi.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.willDeleteFiles?n.willDeleteFiles(e,t):t(e)}};Vr.WillDeleteFilesFeature=Lw});var xk=L(Zd=>{"use strict";Object.defineProperty(Zd,"__esModule",{value:!0});Zd.LinkedEditingFeature=void 0;var ZL=require("vscode"),Mw=Ce(),qw=$e(),jw=class extends qw.TextDocumentLanguageFeature{constructor(e){super(e,Mw.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,qw.ensure)((0,qw.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideLinkedEditingRanges:(i,s,o)=>{let a=this._client,u=(l,f,d)=>a.sendRequest(Mw.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(l,f),d).then(h=>d.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(h,d),h=>a.handleFailedRequest(Mw.LinkedEditingRangeRequest.type,d,h,null)),c=a.middleware;return c.provideLinkedEditingRange?c.provideLinkedEditingRange(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return ZL.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Zd.LinkedEditingFeature=jw});var kk=L(ef=>{"use strict";Object.defineProperty(ef,"__esModule",{value:!0});ef.TypeHierarchyFeature=void 0;var e1=require("vscode"),Bs=Ce(),Uw=$e(),$w=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,n){let i=this.client,s=this.middleware,o=(a,u,c)=>{let l=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest(Bs.TypeHierarchyPrepareRequest.type,l,c).then(f=>c.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(f,c),f=>i.handleFailedRequest(Bs.TypeHierarchyPrepareRequest.type,c,f,null))};return s.prepareTypeHierarchy?s.prepareTypeHierarchy(e,t,n,o):o(e,t,n)}provideTypeHierarchySupertypes(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let u={item:n.code2ProtocolConverter.asTypeHierarchyItem(o)};return n.sendRequest(Bs.TypeHierarchySupertypesRequest.type,u,a).then(c=>a.isCancellationRequested?null:n.protocol2CodeConverter.asTypeHierarchyItems(c,a),c=>n.handleFailedRequest(Bs.TypeHierarchySupertypesRequest.type,a,c,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,s):s(e,t)}provideTypeHierarchySubtypes(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let u={item:n.code2ProtocolConverter.asTypeHierarchyItem(o)};return n.sendRequest(Bs.TypeHierarchySubtypesRequest.type,u,a).then(c=>a.isCancellationRequested?null:n.protocol2CodeConverter.asTypeHierarchyItems(c,a),c=>n.handleFailedRequest(Bs.TypeHierarchySubtypesRequest.type,a,c,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,s):s(e,t)}},Bw=class extends Uw.TextDocumentLanguageFeature{constructor(e){super(e,Bs.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,Uw.ensure)((0,Uw.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.typeHierarchyProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=this._client,n=new $w(t);return[e1.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),n),n]}};ef.TypeHierarchyFeature=Bw});var _k=L(rf=>{"use strict";Object.defineProperty(rf,"__esModule",{value:!0});rf.InlineValueFeature=void 0;var Rk=require("vscode"),tf=Ce(),xu=$e(),Ww=class extends xu.TextDocumentLanguageFeature{constructor(e){super(e,tf.InlineValueRequest.type)}fillClientCapabilities(e){(0,xu.ensure)((0,xu.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,xu.ensure)((0,xu.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(tf.InlineValueRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlineValues.fire()});let[n,i]=this.getRegistration(t,e.inlineValueProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n=new Rk.EventEmitter,i={onDidChangeInlineValues:n.event,provideInlineValues:(s,o,a,u)=>{let c=this._client,l=(d,h,m,D)=>{let _={textDocument:c.code2ProtocolConverter.asTextDocumentIdentifier(d),range:c.code2ProtocolConverter.asRange(h),context:c.code2ProtocolConverter.asInlineValueContext(m)};return c.sendRequest(tf.InlineValueRequest.type,_,D).then(R=>D.isCancellationRequested?null:c.protocol2CodeConverter.asInlineValues(R,D),R=>c.handleFailedRequest(tf.InlineValueRequest.type,D,R,null))},f=c.middleware;return f.provideInlineValues?f.provideInlineValues(s,o,a,u,l):l(s,o,a,u)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:n}]}registerProvider(e,t){return Rk.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};rf.InlineValueFeature=Ww});var Ok=L(nf=>{"use strict";Object.defineProperty(nf,"__esModule",{value:!0});nf.InlayHintsFeature=void 0;var Ik=require("vscode"),Go=Ce(),ku=$e(),Vw=class extends ku.TextDocumentLanguageFeature{constructor(e){super(e,Go.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,ku.ensure)((0,ku.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,ku.ensure)((0,ku.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(Go.InlayHintRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlayHints.fire()});let[n,i]=this.getRegistration(t,e.inlayHintProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n=new Ik.EventEmitter,i={onDidChangeInlayHints:n.event,provideInlayHints:(s,o,a)=>{let u=this._client,c=async(f,d,h)=>{let m={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(f),range:u.code2ProtocolConverter.asRange(d)};try{let D=await u.sendRequest(Go.InlayHintRequest.type,m,h);return h.isCancellationRequested?null:u.protocol2CodeConverter.asInlayHints(D,h)}catch(D){return u.handleFailedRequest(Go.InlayHintRequest.type,h,D,null)}},l=u.middleware;return l.provideInlayHints?l.provideInlayHints(s,o,a,c):c(s,o,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(s,o)=>{let a=this._client,u=async(l,f)=>{try{let d=await a.sendRequest(Go.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(l),f);if(f.isCancellationRequested)return null;let h=a.protocol2CodeConverter.asInlayHint(d,f);return f.isCancellationRequested?null:h}catch(d){return a.handleFailedRequest(Go.InlayHintResolveRequest.type,f,d,null)}},c=a.middleware;return c.resolveInlayHint?c.resolveInlayHint(s,o,u):u(s,o)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:n}]}registerProvider(e,t){return Ik.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};nf.InlayHintsFeature=Vw});var Ak=L(sf=>{"use strict";Object.defineProperty(sf,"__esModule",{value:!0});sf.InlineCompletionItemFeature=void 0;var t1=require("vscode"),Hw=Ce(),Kw=$e(),r1=bt(),Xw=class extends Kw.TextDocumentLanguageFeature{constructor(e){super(e,Hw.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,Kw.ensure)((0,Kw.ensure)(e,"textDocument"),"inlineCompletion");t.dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.inlineCompletionProvider);n&&this.register({id:r1.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideInlineCompletionItems:(i,s,o,a)=>{let u=this._client,c=this._client.middleware,l=(f,d,h,m)=>u.sendRequest(Hw.InlineCompletionRequest.type,u.code2ProtocolConverter.asInlineCompletionParams(f,d,h),m).then(D=>m.isCancellationRequested?null:u.protocol2CodeConverter.asInlineCompletionResult(D,m),D=>u.handleFailedRequest(Hw.InlineCompletionRequest.type,m,D,null));return c.provideInlineCompletionItems?c.provideInlineCompletionItems(i,s,o,a,l):l(i,s,o,a)}};return[t1.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};sf.InlineCompletionItemFeature=Xw});var Zw=L(rr=>{"use strict";Object.defineProperty(rr,"__esModule",{value:!0});rr.ProposedFeatures=rr.BaseLanguageClient=rr.MessageTransports=rr.SuspendMode=rr.State=rr.CloseAction=rr.ErrorAction=rr.RevealOutputChannelOn=void 0;var Ze=require("vscode"),re=Ce(),n1=cx(),i1=fx(),An=gn(),of=dd(),Nk=bt(),s1=Jm(),On=$e(),o1=wv(),Fk=Wx(),Lk=Hx(),Qo=Kx(),a1=Xx(),u1=zx(),c1=Gx(),l1=Yx(),d1=Jx(),f1=Wv(),p1=ek(),h1=tk(),g1=rk(),m1=ik(),zw=sk(),v1=ak(),w1=uk(),y1=lk(),b1=dk(),C1=fk(),D1=pk(),T1=hk(),S1=gk(),E1=vk(),P1=wk(),x1=yk(),k1=Ck(),R1=Dk(),_1=Tk(),Yo=Pk(),I1=xk(),O1=kk(),A1=_k(),N1=Ok(),F1=Ak(),Ws;(function(r){r[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Warn=2]="Warn",r[r.Error=3]="Error",r[r.Never=4]="Never"})(Ws||(rr.RevealOutputChannelOn=Ws={}));var _u;(function(r){r[r.Continue=1]="Continue",r[r.Shutdown=2]="Shutdown"})(_u||(rr.ErrorAction=_u={}));var os;(function(r){r[r.DoNotRestart=1]="DoNotRestart",r[r.Restart=2]="Restart"})(os||(rr.CloseAction=os={}));var Ru;(function(r){r[r.Stopped=1]="Stopped",r[r.Starting=3]="Starting",r[r.Running=2]="Running"})(Ru||(rr.State=Ru={}));var Mk;(function(r){r.off="off",r.on="on"})(Mk||(rr.SuspendMode=Mk={}));var Gw;(function(r){function e(t){return t==null?!1:typeof t=="boolean"||typeof t=="object"&&t!==null&&An.stringArray(t.enabledCommands)?t:!1}r.sanitizeIsTrusted=e})(Gw||(Gw={}));var Qw=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,n){return n&&n<=3?{action:_u.Continue}:{action:_u.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:os.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:os.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:os.Restart})}},Oe;(function(r){r.Initial="initial",r.Starting="starting",r.StartFailed="startFailed",r.Running="running",r.Stopping="stopping",r.Stopped="stopped"})(Oe||(Oe={}));var qk;(function(r){function e(t){return t&&re.MessageReader.is(t.reader)&&re.MessageWriter.is(t.writer)}r.is=e})(qk||(rr.MessageTransports=qk={}));var Iu=class r{constructor(e,t,n){this._traceFormat=re.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new of.Semaphore(1),this._id=e,this._name=t,n=n||{};let i={isTrusted:!1,supportHtml:!1};n.markdown!==void 0&&(i.isTrusted=Gw.sanitizeIsTrusted(n.markdown.isTrusted),i.supportHtml=n.markdown.supportHtml===!0),this._clientOptions={documentSelector:n.documentSelector??[],synchronize:n.synchronize??{},diagnosticCollectionName:n.diagnosticCollectionName,outputChannelName:n.outputChannelName??this._name,revealOutputChannelOn:n.revealOutputChannelOn??Ws.Error,stdioEncoding:n.stdioEncoding??"utf8",initializationOptions:n.initializationOptions,initializationFailedHandler:n.initializationFailedHandler,progressOnInitialization:!!n.progressOnInitialization,errorHandler:n.errorHandler??this.createDefaultErrorHandler(n.connectionOptions?.maxRestartCount),middleware:n.middleware??{},uriConverters:n.uriConverters,workspaceFolder:n.workspaceFolder,connectionOptions:n.connectionOptions,markdown:i,diagnosticPullOptions:n.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:n.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=Oe.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,n.outputChannel?(this._outputChannel=n.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=n.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new of.Semaphore(1),this._pendingChangeDelayer=new of.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new of.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new re.Emitter,this._stateChangeEmitter=new re.Emitter,this._trace=re.Trace.Off,this._tracer={log:(s,o)=>{An.string(s)?this.logTrace(s,o):this.logObjectTrace(s)}},this._c2p=n1.createConverter(n.uriConverters?n.uriConverters.code2Protocol:void 0),this._p2c=i1.createConverter(n.uriConverters?n.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=Ze.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let n=this.getPublicState();n!==t&&this._stateChangeEmitter.fire({oldState:t,newState:n})}getPublicState(){switch(this.$state){case Oe.Starting:return Ru.Starting;case Oe.Running:return Ru.Running;default:return Ru.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===Oe.StartFailed||this.$state===Oe.Stopping||this.$state===Oe.Stopped)return Promise.reject(new re.ResponseError(re.ErrorCodes.ConnectionInactive,"Client is not running"));let n=await this.$start();this._didChangeTextDocumentFeature.syncKind===re.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(n);let i=this._clientOptions.middleware?.sendRequest;if(i!==void 0){let s,o;return t.length===1?re.CancellationToken.is(t[0])?o=t[0]:s=t[0]:t.length===2&&(s=t[0],o=t[1]),i(e,s,o,(a,u,c)=>{let l=[];return u!==void 0&&l.push(u),c!==void 0&&l.push(c),n.sendRequest(a,...l)})}else return n.sendRequest(e,...t)}onRequest(e,t){let n=typeof e=="string"?e:e.method;this._requestHandlers.set(n,t);let i=this.activeConnection(),s;return i!==void 0?(this._requestDisposables.set(n,i.onRequest(e,t)),s={dispose:()=>{let o=this._requestDisposables.get(n);o!==void 0&&(o.dispose(),this._requestDisposables.delete(n))}}):(this._pendingRequestHandlers.set(n,t),s={dispose:()=>{this._pendingRequestHandlers.delete(n);let o=this._requestDisposables.get(n);o!==void 0&&(o.dispose(),this._requestDisposables.delete(n))}}),{dispose:()=>{this._requestHandlers.delete(n),s.dispose()}}}async sendNotification(e,t){if(this.$state===Oe.StartFailed||this.$state===Oe.Stopping||this.$state===Oe.Stopped)return Promise.reject(new re.ResponseError(re.ErrorCodes.ConnectionInactive,"Client is not running"));let n=this._didChangeTextDocumentFeature.syncKind===re.TextDocumentSyncKind.Full,i;n&&typeof e!="string"&&e.method===re.DidOpenTextDocumentNotification.method&&(i=t?.textDocument.uri,this._pendingOpenNotifications.add(i));let s=await this.$start();n&&await this.sendPendingFullTextDocumentChanges(s),i!==void 0&&this._pendingOpenNotifications.delete(i);let o=this._clientOptions.middleware?.sendNotification;return o?o(e,s.sendNotification.bind(s),t):s.sendNotification(e,t)}onNotification(e,t){let n=typeof e=="string"?e:e.method;this._notificationHandlers.set(n,t);let i=this.activeConnection(),s;return i!==void 0?(this._notificationDisposables.set(n,i.onNotification(e,t)),s={dispose:()=>{let o=this._notificationDisposables.get(n);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(n))}}):(this._pendingNotificationHandlers.set(n,t),s={dispose:()=>{this._pendingNotificationHandlers.delete(n);let o=this._notificationDisposables.get(n);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(n))}}),{dispose:()=>{this._notificationHandlers.delete(n),s.dispose()}}}async sendProgress(e,t,n){if(this.$state===Oe.StartFailed||this.$state===Oe.Stopping||this.$state===Oe.Stopped)return Promise.reject(new re.ResponseError(re.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,n)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,n){this._progressHandlers.set(t,{type:e,handler:n});let i=this.activeConnection(),s,o=this._clientOptions.middleware?.handleWorkDoneProgress,a=re.WorkDoneProgress.is(e)&&o!==void 0?u=>{o(t,u,()=>n(u))}:n;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),s={dispose:()=>{let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:n}),s={dispose:()=>{this._pendingProgressHandlers.delete(t);let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),s.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new Qw(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof re.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?An.string(e.stack)?e.stack:e.message:An.string(e)?e:e.toString()}debug(e,t,n=!0){this.logOutputMessage(re.MessageType.Debug,Ws.Debug,"Debug",e,t,n)}info(e,t,n=!0){this.logOutputMessage(re.MessageType.Info,Ws.Info,"Info",e,t,n)}warn(e,t,n=!0){this.logOutputMessage(re.MessageType.Warning,Ws.Warn,"Warn",e,t,n)}error(e,t,n=!0){this.logOutputMessage(re.MessageType.Error,Ws.Error,"Error",e,t,n)}logOutputMessage(e,t,n,i,s,o){this.outputChannel.appendLine(`[${n.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${i}`),s!=null&&this.outputChannel.appendLine(this.data2String(s)),(o==="force"||o&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,i)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===re.MessageType.Error?Ze.window.showErrorMessage:e===re.MessageType.Warning?Ze.window.showWarningMessage:Ze.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===Oe.Initial||this.$state===Oe.Stopping||this.$state===Oe.Stopped}needsStop(){return this.$state===Oe.Starting||this.$state===Oe.Running}activeConnection(){return this.$state===Oe.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===Oe.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===Oe.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,t,n]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?Ze.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):Ze.languages.createDiagnosticCollection());for(let[i,s]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,s);for(let[i,s]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,s);for(let[i,s]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,s);this.$state=Oe.Starting;try{let i=await this.createConnection();i.onNotification(re.LogMessageNotification.type,s=>{switch(s.type){case re.MessageType.Error:this.error(s.message,void 0,!1);break;case re.MessageType.Warning:this.warn(s.message,void 0,!1);break;case re.MessageType.Info:this.info(s.message,void 0,!1);break;case re.MessageType.Debug:this.debug(s.message,void 0,!1);break;default:this.outputChannel.appendLine(s.message)}}),i.onNotification(re.ShowMessageNotification.type,s=>{switch(s.type){case re.MessageType.Error:Ze.window.showErrorMessage(s.message);break;case re.MessageType.Warning:Ze.window.showWarningMessage(s.message);break;case re.MessageType.Info:Ze.window.showInformationMessage(s.message);break;default:Ze.window.showInformationMessage(s.message)}}),i.onRequest(re.ShowMessageRequest.type,s=>{let o;switch(s.type){case re.MessageType.Error:o=Ze.window.showErrorMessage;break;case re.MessageType.Warning:o=Ze.window.showWarningMessage;break;case re.MessageType.Info:o=Ze.window.showInformationMessage;break;default:o=Ze.window.showInformationMessage}let a=s.actions||[];return o(s.message,...a)}),i.onNotification(re.TelemetryEventNotification.type,s=>{this._telemetryEmitter.fire(s)}),i.onRequest(re.ShowDocumentRequest.type,async s=>{let o=async u=>{let c=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await Ze.env.openExternal(c)};{let l={};return u.selection!==void 0&&(l.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?l.preserveFocus=!0:u.takeFocus===!0&&(l.preserveFocus=!1),await Ze.window.showTextDocument(c,l),{success:!0}}}catch{return{success:!1}}},a=this._clientOptions.middleware.window?.showDocument;return a!==void 0?a(s,o):o(s)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=Oe.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),n(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,s)=>{e=i,t=s}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[n,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],s={processId:null,clientInfo:{name:Ze.env.appName,version:Ze.version},locale:this.getLocale(),rootPath:n||null,rootUri:n?this._c2p.asUri(Ze.Uri.file(n)):null,capabilities:this.computeClientCapabilities(),initializationOptions:An.func(t)?t():t,trace:re.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(s),this._clientOptions.progressOnInitialization){let o=Nk.generateUuid(),a=new s1.ProgressPart(e,o);s.workDoneToken=o;try{let u=await this.doInitialize(e,s);return a.done(),u}catch(u){throw a.cancel(),u}}else return this.doInitialize(e,s)}async doInitialize(e,t){try{let n=await e.initialize(t);if(n.capabilities.positionEncoding!==void 0&&n.capabilities.positionEncoding!==re.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${n.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=n,this.$state=Oe.Running;let i;An.number(n.capabilities.textDocumentSync)?n.capabilities.textDocumentSync===re.TextDocumentSyncKind.None?i={openClose:!1,change:re.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:n.capabilities.textDocumentSync,save:{includeText:!1}}:n.capabilities.textDocumentSync!==void 0&&n.capabilities.textDocumentSync!==null&&(i=n.capabilities.textDocumentSync),this._capabilities=Object.assign({},n.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(re.PublishDiagnosticsNotification.type,s=>this.handleDiagnostics(s)),e.onRequest(re.RegistrationRequest.type,s=>this.handleRegistrationRequest(s)),e.onRequest("client/registerFeature",s=>this.handleRegistrationRequest(s)),e.onRequest(re.UnregistrationRequest.type,s=>this.handleUnregistrationRequest(s)),e.onRequest("client/unregisterFeature",s=>this.handleUnregistrationRequest(s)),e.onRequest(re.ApplyWorkspaceEditRequest.type,s=>this.handleApplyWorkspaceEdit(s));for(let[s,o]of this._pendingNotificationHandlers)this._notificationDisposables.set(s,e.onNotification(s,o));this._pendingNotificationHandlers.clear();for(let[s,o]of this._pendingRequestHandlers)this._requestDisposables.set(s,e.onRequest(s,o));this._pendingRequestHandlers.clear();for(let[s,o]of this._pendingProgressHandlers)this._progressDisposables.set(s,e.onProgress(o.type,s,o.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(re.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),n}catch(n){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(n)?this.initialize(e):this.stop():n instanceof re.ResponseError&&n.data&&n.data.retry?Ze.window.showErrorMessage(n.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(n&&n.message&&Ze.window.showErrorMessage(n.message),this.error("Server initialization failed.",n),this.stop()),n}}_clientGetRootPath(){let e=Ze.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===Oe.Stopped||this.$state===Oe.Initial)return;if(this.$state===Oe.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let n=this.activeConnection();if(n===void 0||this.$state!==Oe.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=Oe.Stopping,this.cleanUp(e);let i=new Promise(o=>{(0,re.RAL)().timer.setTimeout(o,t)}),s=(async o=>(await o.shutdown(),await o.exit(),o))(n);return this._onStop=Promise.race([i,s]).then(o=>{if(o!==void 0)o.end(),o.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},o=>{throw this.error("Stopping server failed",o,!1),o}).finally(()=>{this.$state=Oe.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let n of t)n.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let n of Array.from(this._features.entries()).map(i=>i[1]).reverse())n.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){let t=this;async function n(s){return t._fileEvents.push(s),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(re.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=this.clientOptions.middleware?.workspace;(i?.didChangeWatchedFile?i.didChangeWatchedFile(e,n):n(e)).catch(s=>{t.error("Notify file events failed.",s)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let n of t){let i=this.code2ProtocolConverter.asChangeTextDocumentParams(n);await e.sendNotification(re.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(n,re.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,re.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,n]=e.value;this._diagnosticQueue.delete(t);let i=new Ze.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(n,i.token).then(s=>{if(!i.token.isCancellationRequested){let o=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(o,s,(u,c)=>this.setDiagnostics(u,c)):this.setDiagnostics(o,s)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return Ze.env.language}async $start(){if(this.$state===Oe.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,s,o)=>{this.handleConnectionError(i,s,o).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))},n=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=L1(n.reader,n.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===Oe.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:os.DoNotRestart};if(this.$state!==Oe.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===os.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===Oe.Starting?this.$state=Oe.StartFailed:this.$state=Oe.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===os.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=Oe.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,n){let i=await this._clientOptions.errorHandler.error(e,t,n);i.action===_u.Shutdown?(this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(s=>{this.error("Stopping server failed",s,!1)})):this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,i.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(Ze.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let n=Ze.workspace.getConfiguration(this._id),i=re.Trace.Off,s=re.TraceFormat.Text;if(n){let o=n.get("trace.server","off");typeof o=="string"?i=re.Trace.fromString(o):(i=re.Trace.fromString(n.get("trace.server.verbosity","off")),s=re.TraceFormat.fromString(n.get("trace.server.format","text")))}this._trace=i,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(o=>{this.error("Updating trace failed with error",o,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let n;An.array(t)?n=t:n=[t],n&&this._dynamicFeatures.get(re.DidChangeWatchedFilesNotification.type.method).registerRaw(Nk.generateUuid(),n)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),On.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(re.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof Fk.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new Lk.ConfigurationFeature(this)),this.registerFeature(new Qo.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new Qo.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new Qo.WillSaveFeature(this)),this.registerFeature(new Qo.WillSaveWaitUntilFeature(this)),this.registerFeature(new Qo.DidSaveTextDocumentFeature(this)),this.registerFeature(new Qo.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new b1.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new a1.CompletionItemFeature(this)),this.registerFeature(new u1.HoverFeature(this)),this.registerFeature(new l1.SignatureHelpFeature(this)),this.registerFeature(new c1.DefinitionFeature(this)),this.registerFeature(new h1.ReferencesFeature(this)),this.registerFeature(new d1.DocumentHighlightFeature(this)),this.registerFeature(new f1.DocumentSymbolFeature(this)),this.registerFeature(new p1.WorkspaceSymbolFeature(this)),this.registerFeature(new g1.CodeActionFeature(this)),this.registerFeature(new m1.CodeLensFeature(this)),this.registerFeature(new zw.DocumentFormattingFeature(this)),this.registerFeature(new zw.DocumentRangeFormattingFeature(this)),this.registerFeature(new zw.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new v1.RenameFeature(this)),this.registerFeature(new w1.DocumentLinkFeature(this)),this.registerFeature(new y1.ExecuteCommandFeature(this)),this.registerFeature(new Lk.SyncConfigurationFeature(this)),this.registerFeature(new T1.TypeDefinitionFeature(this)),this.registerFeature(new D1.ImplementationFeature(this)),this.registerFeature(new C1.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new S1.WorkspaceFoldersFeature(this)),this.registerFeature(new E1.FoldingRangeFeature(this)),this.registerFeature(new P1.DeclarationFeature(this)),this.registerFeature(new x1.SelectionRangeFeature(this)),this.registerFeature(new k1.ProgressFeature(this)),this.registerFeature(new R1.CallHierarchyFeature(this)),this.registerFeature(new _1.SemanticTokensFeature(this)),this.registerFeature(new I1.LinkedEditingFeature(this)),this.registerFeature(new Yo.DidCreateFilesFeature(this)),this.registerFeature(new Yo.DidRenameFilesFeature(this)),this.registerFeature(new Yo.DidDeleteFilesFeature(this)),this.registerFeature(new Yo.WillCreateFilesFeature(this)),this.registerFeature(new Yo.WillRenameFilesFeature(this)),this.registerFeature(new Yo.WillDeleteFilesFeature(this)),this.registerFeature(new O1.TypeHierarchyFeature(this)),this.registerFeature(new A1.InlineValueFeature(this)),this.registerFeature(new N1.InlayHintsFeature(this)),this.registerFeature(new o1.DiagnosticFeature(this)),this.registerFeature(new Fk.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Jw.createAll(this))}fillInitializeParams(e){for(let t of this._features)An.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,On.ensure)(e,"workspace").applyEdit=!0;let t=(0,On.ensure)((0,On.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[re.ResourceOperationKind.Create,re.ResourceOperationKind.Rename,re.ResourceOperationKind.Delete],t.failureHandling=re.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let n=(0,On.ensure)((0,On.ensure)(e,"textDocument"),"publishDiagnostics");n.relatedInformation=!0,n.versionSupport=!1,n.tagSupport={valueSet:[re.DiagnosticTag.Unnecessary,re.DiagnosticTag.Deprecated]},n.codeDescriptionSupport=!0,n.dataSupport=!0;let i=(0,On.ensure)(e,"window"),s=(0,On.ensure)(i,"showMessage");s.messageActionItem={additionalPropertiesSupport:!0};let o=(0,On.ensure)(i,"showDocument");o.support=!0;let a=(0,On.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(r.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let u of this._features)u.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let n of this._features)An.func(n.preInitialize)&&n.preInitialize(this._capabilities,t);for(let n of this._features)n.initialize(this._capabilities,t)}async handleRegistrationRequest(e){let t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,n=>this.doRegisterCapability(n)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let n=this._dynamicFeatures.get(t.method);if(n===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let s={id:t.id,registerOptions:i};try{n.register(s)}catch(o){return Promise.reject(o)}}}async handleUnregistrationRequest(e){let t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,n=>this.doUnregisterCapability(n)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let n=this._dynamicFeatures.get(t.method);if(!n)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));n.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,n=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;Ze.workspace.textDocuments.forEach(o=>i.set(o.uri.toString(),o));let s=!1;if(t.documentChanges){for(let o of t.documentChanges)if(re.TextDocumentEdit.is(o)&&o.textDocument.version&&o.textDocument.version>=0){let a=this._p2c.asUri(o.textDocument.uri).toString(),u=i.get(a);if(u&&u.version!==o.textDocument.version){s=!0;break}}}return s?Promise.resolve({applied:!1}):An.asPromise(Ze.workspace.applyEdit(n).then(o=>({applied:o})))}handleFailedRequest(e,t,n,i,s=!0){if(n instanceof re.ResponseError){if(n.code===re.ErrorCodes.PendingResponseRejected||n.code===re.ErrorCodes.ConnectionInactive)return i;if(n.code===re.LSPErrorCodes.RequestCancelled||n.code===re.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw n.data!==void 0?new On.LSPCancellationError(n.data):new Ze.CancellationError}else if(n.code===re.LSPErrorCodes.ContentModified){if(r.RequestsToCancelOnContentModified.has(e.method)||r.CancellableResolveCalls.has(e.method))throw new Ze.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,n,s),n}};rr.BaseLanguageClient=Iu;Iu.RequestsToCancelOnContentModified=new Set([re.SemanticTokensRequest.method,re.SemanticTokensRangeRequest.method,re.SemanticTokensDeltaRequest.method]);Iu.CancellableResolveCalls=new Set([re.CompletionResolveRequest.method,re.CodeLensResolveRequest.method,re.CodeActionResolveRequest.method,re.InlayHintResolveRequest.method,re.DocumentLinkResolveRequest.method,re.WorkspaceSymbolResolveRequest.method]);var Yw=class{error(e){(0,re.RAL)().console.error(e)}warn(e){(0,re.RAL)().console.warn(e)}info(e){(0,re.RAL)().console.info(e)}log(e){(0,re.RAL)().console.log(e)}};function L1(r,e,t,n,i){let s=new Yw,o=(0,re.createProtocolConnection)(r,e,s,i);return o.onError(u=>{t(u[0],u[1],u[2])}),o.onClose(n),{listen:()=>o.listen(),sendRequest:o.sendRequest,onRequest:o.onRequest,hasPendingResponse:o.hasPendingResponse,sendNotification:o.sendNotification,onNotification:o.onNotification,onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(u,c,l)=>{let f={sendNotification:!1,traceFormat:re.TraceFormat.Text};return l===void 0?o.trace(u,c,f):(An.boolean(l),o.trace(u,c,l))},initialize:u=>o.sendRequest(re.InitializeRequest.type,u),shutdown:()=>o.sendRequest(re.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(re.ExitNotification.type),end:()=>o.end(),dispose:()=>o.dispose()}}var Jw;(function(r){function e(t){return[new F1.InlineCompletionItemFeature(t)]}r.createAll=e})(Jw||(rr.ProposedFeatures=Jw={}))});var Uk=L(af=>{"use strict";Object.defineProperty(af,"__esModule",{value:!0});af.terminate=void 0;var jk=require("child_process"),M1=require("path"),q1=process.platform==="win32",j1=process.platform==="darwin",U1=process.platform==="linux";function $1(r,e){if(q1)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),jk.execFileSync("taskkill",["/T","/F","/PID",r.pid.toString()],i),!0}catch{return!1}else if(U1||j1)try{var t=(0,M1.join)(__dirname,"terminateProcess.sh"),n=jk.spawnSync(t,[r.pid.toString()]);return!n.error}catch{return!1}else return r.kill("SIGKILL"),!0}af.terminate=$1});var ey=L((OW,$k)=>{"use strict";$k.exports=Ce()});var Ou=L((AW,Bk)=>{"use strict";var B1=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};Bk.exports=B1});var uf=L((NW,Wk)=>{"use strict";var W1="2.0.0",V1=Number.MAX_SAFE_INTEGER||9007199254740991,H1=16,K1=250,X1=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Wk.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:H1,MAX_SAFE_BUILD_LENGTH:K1,MAX_SAFE_INTEGER:V1,RELEASE_TYPES:X1,SEMVER_SPEC_VERSION:W1,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var cf=L((Jn,Vk)=>{"use strict";var{MAX_SAFE_COMPONENT_LENGTH:ty,MAX_SAFE_BUILD_LENGTH:z1,MAX_LENGTH:G1}=uf(),Q1=Ou();Jn=Vk.exports={};var Y1=Jn.re=[],J1=Jn.safeRe=[],ce=Jn.src=[],Z1=Jn.safeSrc=[],le=Jn.t={},eM=0,ry="[a-zA-Z0-9-]",tM=[["\\s",1],["\\d",G1],[ry,z1]],rM=r=>{for(let[e,t]of tM)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},Pe=(r,e,t)=>{let n=rM(e),i=eM++;Q1(r,i,e),le[r]=i,ce[i]=e,Z1[i]=n,Y1[i]=new RegExp(e,t?"g":void 0),J1[i]=new RegExp(n,t?"g":void 0)};Pe("NUMERICIDENTIFIER","0|[1-9]\\d*");Pe("NUMERICIDENTIFIERLOOSE","\\d+");Pe("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${ry}*`);Pe("MAINVERSION",`(${ce[le.NUMERICIDENTIFIER]})\\.(${ce[le.NUMERICIDENTIFIER]})\\.(${ce[le.NUMERICIDENTIFIER]})`);Pe("MAINVERSIONLOOSE",`(${ce[le.NUMERICIDENTIFIERLOOSE]})\\.(${ce[le.NUMERICIDENTIFIERLOOSE]})\\.(${ce[le.NUMERICIDENTIFIERLOOSE]})`);Pe("PRERELEASEIDENTIFIER",`(?:${ce[le.NONNUMERICIDENTIFIER]}|${ce[le.NUMERICIDENTIFIER]})`);Pe("PRERELEASEIDENTIFIERLOOSE",`(?:${ce[le.NONNUMERICIDENTIFIER]}|${ce[le.NUMERICIDENTIFIERLOOSE]})`);Pe("PRERELEASE",`(?:-(${ce[le.PRERELEASEIDENTIFIER]}(?:\\.${ce[le.PRERELEASEIDENTIFIER]})*))`);Pe("PRERELEASELOOSE",`(?:-?(${ce[le.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${ce[le.PRERELEASEIDENTIFIERLOOSE]})*))`);Pe("BUILDIDENTIFIER",`${ry}+`);Pe("BUILD",`(?:\\+(${ce[le.BUILDIDENTIFIER]}(?:\\.${ce[le.BUILDIDENTIFIER]})*))`);Pe("FULLPLAIN",`v?${ce[le.MAINVERSION]}${ce[le.PRERELEASE]}?${ce[le.BUILD]}?`);Pe("FULL",`^${ce[le.FULLPLAIN]}$`);Pe("LOOSEPLAIN",`[v=\\s]*${ce[le.MAINVERSIONLOOSE]}${ce[le.PRERELEASELOOSE]}?${ce[le.BUILD]}?`);Pe("LOOSE",`^${ce[le.LOOSEPLAIN]}$`);Pe("GTLT","((?:<|>)?=?)");Pe("XRANGEIDENTIFIERLOOSE",`${ce[le.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);Pe("XRANGEIDENTIFIER",`${ce[le.NUMERICIDENTIFIER]}|x|X|\\*`);Pe("XRANGEPLAIN",`[v=\\s]*(${ce[le.XRANGEIDENTIFIER]})(?:\\.(${ce[le.XRANGEIDENTIFIER]})(?:\\.(${ce[le.XRANGEIDENTIFIER]})(?:${ce[le.PRERELEASE]})?${ce[le.BUILD]}?)?)?`);Pe("XRANGEPLAINLOOSE",`[v=\\s]*(${ce[le.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[le.XRANGEIDENTIFIERLOOSE]})(?:\\.(${ce[le.XRANGEIDENTIFIERLOOSE]})(?:${ce[le.PRERELEASELOOSE]})?${ce[le.BUILD]}?)?)?`);Pe("XRANGE",`^${ce[le.GTLT]}\\s*${ce[le.XRANGEPLAIN]}$`);Pe("XRANGELOOSE",`^${ce[le.GTLT]}\\s*${ce[le.XRANGEPLAINLOOSE]}$`);Pe("COERCEPLAIN",`(^|[^\\d])(\\d{1,${ty}})(?:\\.(\\d{1,${ty}}))?(?:\\.(\\d{1,${ty}}))?`);Pe("COERCE",`${ce[le.COERCEPLAIN]}(?:$|[^\\d])`);Pe("COERCEFULL",ce[le.COERCEPLAIN]+`(?:${ce[le.PRERELEASE]})?(?:${ce[le.BUILD]})?(?:$|[^\\d])`);Pe("COERCERTL",ce[le.COERCE],!0);Pe("COERCERTLFULL",ce[le.COERCEFULL],!0);Pe("LONETILDE","(?:~>?)");Pe("TILDETRIM",`(\\s*)${ce[le.LONETILDE]}\\s+`,!0);Jn.tildeTrimReplace="$1~";Pe("TILDE",`^${ce[le.LONETILDE]}${ce[le.XRANGEPLAIN]}$`);Pe("TILDELOOSE",`^${ce[le.LONETILDE]}${ce[le.XRANGEPLAINLOOSE]}$`);Pe("LONECARET","(?:\\^)");Pe("CARETTRIM",`(\\s*)${ce[le.LONECARET]}\\s+`,!0);Jn.caretTrimReplace="$1^";Pe("CARET",`^${ce[le.LONECARET]}${ce[le.XRANGEPLAIN]}$`);Pe("CARETLOOSE",`^${ce[le.LONECARET]}${ce[le.XRANGEPLAINLOOSE]}$`);Pe("COMPARATORLOOSE",`^${ce[le.GTLT]}\\s*(${ce[le.LOOSEPLAIN]})$|^$`);Pe("COMPARATOR",`^${ce[le.GTLT]}\\s*(${ce[le.FULLPLAIN]})$|^$`);Pe("COMPARATORTRIM",`(\\s*)${ce[le.GTLT]}\\s*(${ce[le.LOOSEPLAIN]}|${ce[le.XRANGEPLAIN]})`,!0);Jn.comparatorTrimReplace="$1$2$3";Pe("HYPHENRANGE",`^\\s*(${ce[le.XRANGEPLAIN]})\\s+-\\s+(${ce[le.XRANGEPLAIN]})\\s*$`);Pe("HYPHENRANGELOOSE",`^\\s*(${ce[le.XRANGEPLAINLOOSE]})\\s+-\\s+(${ce[le.XRANGEPLAINLOOSE]})\\s*$`);Pe("STAR","(<|>)?=?\\s*\\*");Pe("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");Pe("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var lf=L((FW,Hk)=>{"use strict";var nM=Object.freeze({loose:!0}),iM=Object.freeze({}),sM=r=>r?typeof r!="object"?nM:r:iM;Hk.exports=sM});var Gk=L((LW,zk)=>{"use strict";var Kk=/^[0-9]+$/,Xk=(r,e)=>{let t=Kk.test(r),n=Kk.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},oM=(r,e)=>Xk(e,r);zk.exports={compareIdentifiers:Xk,rcompareIdentifiers:oM}});var Au=L((MW,Yk)=>{"use strict";var df=Ou(),{MAX_LENGTH:Qk,MAX_SAFE_INTEGER:ff}=uf(),{safeRe:pf,t:hf}=cf(),aM=lf(),{compareIdentifiers:Jo}=Gk(),ny=class r{constructor(e,t){if(t=aM(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>Qk)throw new TypeError(`version is longer than ${Qk} characters`);df("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?pf[hf.LOOSE]:pf[hf.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>ff||this.major<0)throw new TypeError("Invalid major version");if(this.minor>ff||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>ff||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<ff)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(df("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),Jo(this.major,e.major)||Jo(this.minor,e.minor)||Jo(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=e.prerelease[t];if(df("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Jo(n,i)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],i=e.build[t];if(df("build compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Jo(n,i)}while(++t)}inc(e,t,n){if(e.startsWith("pre")){if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(t){let i=`-${t}`.match(this.options.loose?pf[hf.PRERELEASELOOSE]:pf[hf.PRERELEASE]);if(!i||i[1]!==t)throw new Error(`invalid identifier: ${t}`)}}switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];n===!1&&(s=[t]),Jo(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};Yk.exports=ny});var eR=L((qW,Zk)=>{"use strict";var Jk=Au(),uM=(r,e,t=!1)=>{if(r instanceof Jk)return r;try{return new Jk(r,e)}catch(n){if(!t)return null;throw n}};Zk.exports=uM});var rR=L((jW,tR)=>{"use strict";var iy=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(e,t)}return this}};tR.exports=iy});var Vs=L((UW,iR)=>{"use strict";var nR=Au(),cM=(r,e,t)=>new nR(r,t).compare(new nR(e,t));iR.exports=cM});var oR=L(($W,sR)=>{"use strict";var lM=Vs(),dM=(r,e,t)=>lM(r,e,t)===0;sR.exports=dM});var uR=L((BW,aR)=>{"use strict";var fM=Vs(),pM=(r,e,t)=>fM(r,e,t)!==0;aR.exports=pM});var lR=L((WW,cR)=>{"use strict";var hM=Vs(),gM=(r,e,t)=>hM(r,e,t)>0;cR.exports=gM});var fR=L((VW,dR)=>{"use strict";var mM=Vs(),vM=(r,e,t)=>mM(r,e,t)>=0;dR.exports=vM});var hR=L((HW,pR)=>{"use strict";var wM=Vs(),yM=(r,e,t)=>wM(r,e,t)<0;pR.exports=yM});var mR=L((KW,gR)=>{"use strict";var bM=Vs(),CM=(r,e,t)=>bM(r,e,t)<=0;gR.exports=CM});var wR=L((XW,vR)=>{"use strict";var DM=oR(),TM=uR(),SM=lR(),EM=fR(),PM=hR(),xM=mR(),kM=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return DM(r,t,n);case"!=":return TM(r,t,n);case">":return SM(r,t,n);case">=":return EM(r,t,n);case"<":return PM(r,t,n);case"<=":return xM(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};vR.exports=kM});var ER=L((zW,SR)=>{"use strict";var Nu=Symbol("SemVer ANY"),ay=class r{static get ANY(){return Nu}constructor(e,t){if(t=yR(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),oy("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===Nu?this.value="":this.value=this.operator+this.semver.version,oy("comp",this)}parse(e){let t=this.options.loose?bR[CR.COMPARATORLOOSE]:bR[CR.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new DR(n[2],this.options.loose):this.semver=Nu}toString(){return this.value}test(e){if(oy("Comparator.test",e,this.options.loose),this.semver===Nu||e===Nu)return!0;if(typeof e=="string")try{e=new DR(e,this.options)}catch{return!1}return sy(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new TR(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new TR(this.value,t).test(e.semver):(t=yR(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||sy(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||sy(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};SR.exports=ay;var yR=lf(),{safeRe:bR,t:CR}=cf(),sy=wR(),oy=Ou(),DR=Au(),TR=uy()});var uy=L((GW,RR)=>{"use strict";var RM=/\s+/g,cy=class r{constructor(e,t){if(t=IM(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof ly)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(RM," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(i=>!xR(i[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&qM(i[0])){this.set=[i];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&LM)|(this.options.loose&&MM))+":"+e,i=PR.get(n);if(i)return i;let s=this.options.loose,o=s?Hr[xr.HYPHENRANGELOOSE]:Hr[xr.HYPHENRANGE];e=e.replace(o,zM(this.options.includePrerelease)),ht("hyphen replace",e),e=e.replace(Hr[xr.COMPARATORTRIM],AM),ht("comparator trim",e),e=e.replace(Hr[xr.TILDETRIM],NM),ht("tilde trim",e),e=e.replace(Hr[xr.CARETTRIM],FM),ht("caret trim",e);let a=e.split(" ").map(f=>jM(f,this.options)).join(" ").split(/\s+/).map(f=>XM(f,this.options));s&&(a=a.filter(f=>(ht("loose invalid filter",f,this.options),!!f.match(Hr[xr.COMPARATORLOOSE])))),ht("range list",a);let u=new Map,c=a.map(f=>new ly(f,this.options));for(let f of c){if(xR(f))return[f];u.set(f.value,f)}u.size>1&&u.has("")&&u.delete("");let l=[...u.values()];return PR.set(n,l),l}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>kR(n,t)&&e.set.some(i=>kR(i,t)&&n.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new OM(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(GM(this.set[t],e,this.options))return!0;return!1}};RR.exports=cy;var _M=rR(),PR=new _M,IM=lf(),ly=ER(),ht=Ou(),OM=Au(),{safeRe:Hr,t:xr,comparatorTrimReplace:AM,tildeTrimReplace:NM,caretTrimReplace:FM}=cf(),{FLAG_INCLUDE_PRERELEASE:LM,FLAG_LOOSE:MM}=uf(),xR=r=>r.value==="<0.0.0-0",qM=r=>r.value==="",kR=(r,e)=>{let t=!0,n=r.slice(),i=n.pop();for(;t&&n.length;)t=n.every(s=>i.intersects(s,e)),i=n.pop();return t},jM=(r,e)=>(ht("comp",r,e),r=BM(r,e),ht("caret",r),r=UM(r,e),ht("tildes",r),r=VM(r,e),ht("xrange",r),r=KM(r,e),ht("stars",r),r),kr=r=>!r||r.toLowerCase()==="x"||r==="*",UM=(r,e)=>r.trim().split(/\s+/).map(t=>$M(t,e)).join(" "),$M=(r,e)=>{let t=e.loose?Hr[xr.TILDELOOSE]:Hr[xr.TILDE];return r.replace(t,(n,i,s,o,a)=>{ht("tilde",r,n,i,s,o,a);let u;return kr(i)?u="":kr(s)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:kr(o)?u=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(ht("replaceTilde pr",a),u=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):u=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,ht("tilde return",u),u})},BM=(r,e)=>r.trim().split(/\s+/).map(t=>WM(t,e)).join(" "),WM=(r,e)=>{ht("caret",r,e);let t=e.loose?Hr[xr.CARETLOOSE]:Hr[xr.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(i,s,o,a,u)=>{ht("caret",r,i,s,o,a,u);let c;return kr(s)?c="":kr(o)?c=`>=${s}.0.0${n} <${+s+1}.0.0-0`:kr(a)?s==="0"?c=`>=${s}.${o}.0${n} <${s}.${+o+1}.0-0`:c=`>=${s}.${o}.0${n} <${+s+1}.0.0-0`:u?(ht("replaceCaret pr",u),s==="0"?o==="0"?c=`>=${s}.${o}.${a}-${u} <${s}.${o}.${+a+1}-0`:c=`>=${s}.${o}.${a}-${u} <${s}.${+o+1}.0-0`:c=`>=${s}.${o}.${a}-${u} <${+s+1}.0.0-0`):(ht("no pr"),s==="0"?o==="0"?c=`>=${s}.${o}.${a}${n} <${s}.${o}.${+a+1}-0`:c=`>=${s}.${o}.${a}${n} <${s}.${+o+1}.0-0`:c=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),ht("caret return",c),c})},VM=(r,e)=>(ht("replaceXRanges",r,e),r.split(/\s+/).map(t=>HM(t,e)).join(" ")),HM=(r,e)=>{r=r.trim();let t=e.loose?Hr[xr.XRANGELOOSE]:Hr[xr.XRANGE];return r.replace(t,(n,i,s,o,a,u)=>{ht("xRange",r,n,i,s,o,a,u);let c=kr(s),l=c||kr(o),f=l||kr(a),d=f;return i==="="&&d&&(i=""),u=e.includePrerelease?"-0":"",c?i===">"||i==="<"?n="<0.0.0-0":n="*":i&&d?(l&&(o=0),a=0,i===">"?(i=">=",l?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",l?s=+s+1:o=+o+1),i==="<"&&(u="-0"),n=`${i+s}.${o}.${a}${u}`):l?n=`>=${s}.0.0${u} <${+s+1}.0.0-0`:f&&(n=`>=${s}.${o}.0${u} <${s}.${+o+1}.0-0`),ht("xRange return",n),n})},KM=(r,e)=>(ht("replaceStars",r,e),r.trim().replace(Hr[xr.STAR],"")),XM=(r,e)=>(ht("replaceGTE0",r,e),r.trim().replace(Hr[e.includePrerelease?xr.GTE0PRE:xr.GTE0],"")),zM=r=>(e,t,n,i,s,o,a,u,c,l,f,d)=>(kr(n)?t="":kr(i)?t=`>=${n}.0.0${r?"-0":""}`:kr(s)?t=`>=${n}.${i}.0${r?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,kr(c)?u="":kr(l)?u=`<${+c+1}.0.0-0`:kr(f)?u=`<${c}.${+l+1}.0-0`:d?u=`<=${c}.${l}.${f}-${d}`:r?u=`<${c}.${l}.${+f+1}-0`:u=`<=${u}`,`${t} ${u}`.trim()),GM=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(ht(r[n].semver),r[n].semver!==ly.ANY&&r[n].semver.prerelease.length>0){let i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var IR=L((QW,_R)=>{"use strict";var QM=uy(),YM=(r,e,t)=>{try{e=new QM(e,t)}catch{return!1}return e.test(r)};_R.exports=YM});var AR=L(sn=>{"use strict";var JM=sn&&sn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),dy=sn&&sn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&JM(e,r,t)};Object.defineProperty(sn,"__esModule",{value:!0});sn.DiagnosticPullMode=sn.vsdiag=void 0;dy(Ce(),sn);dy($e(),sn);var OR=wv();Object.defineProperty(sn,"vsdiag",{enumerable:!0,get:function(){return OR.vsdiag}});Object.defineProperty(sn,"DiagnosticPullMode",{enumerable:!0,get:function(){return OR.DiagnosticPullMode}});dy(Zw(),sn)});var Rr=L(Kr=>{"use strict";var ZM=Kr&&Kr.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),LR=Kr&&Kr.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ZM(e,r,t)};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.SettingMonitor=Kr.LanguageClient=Kr.TransportKind=void 0;var Ci=require("child_process"),fy=require("fs"),py=require("path"),us=require("vscode"),Ct=gn(),NR=Zw(),eq=Uk(),Pt=ey(),tq=eR(),rq=IR();LR(ey(),Kr);LR(AR(),Kr);var FR="^1.82.0",xt;(function(r){r[r.stdio=0]="stdio",r[r.ipc=1]="ipc",r[r.pipe=2]="pipe",r[r.socket=3]="socket"})(xt||(Kr.TransportKind=xt={}));var as;(function(r){function e(t){let n=t;return n&&n.kind===xt.socket&&Ct.number(n.port)}r.isSocket=e})(as||(as={}));var hy;(function(r){function e(t){return Ct.string(t.command)}r.is=e})(hy||(hy={}));var gy;(function(r){function e(t){return Ct.string(t.module)}r.is=e})(gy||(gy={}));var my;(function(r){function e(t){let n=t;return n&&n.writer!==void 0&&n.reader!==void 0}r.is=e})(my||(my={}));var vy;(function(r){function e(t){let n=t;return n&&n.process!==void 0&&typeof n.detached=="boolean"}r.is=e})(vy||(vy={}));var wy=class extends NR.BaseLanguageClient{constructor(e,t,n,i,s){let o,a,u,c,l;Ct.string(t)?(o=e,a=t,u=n,c=i,l=!!s):(o=e.toLowerCase(),a=e,u=t,c=n,l=i),l===void 0&&(l=!1),super(o,a,c),this._serverOptions=u,this._forceDebug=l,this._isInDebugMode=l;try{this.checkVersion()}catch(f){throw Ct.string(f.message)&&this.outputChannel.appendLine(f.message),f}}checkVersion(){let e=tq(us.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${us.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!rq(e,FR))throw new Error(`The language client requires VS Code version ${FR} but received version ${us.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),await this.start()):await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,eq.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(l,f){if(!l&&!f)return;let d=Object.create(null);return Object.keys(process.env).forEach(h=>d[h]=process.env[h]),f&&(d.ELECTRON_RUN_AS_NODE="1",d.ELECTRON_NO_ASAR="1"),l&&Object.keys(l).forEach(h=>d[h]=l[h]),d}let n=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(){let l=process.execArgv;return l?l.some(f=>n.some(d=>f.startsWith(d))||i.some(d=>f===d)):!1}function o(l){if(l.stdin===null||l.stdout===null||l.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(Ct.func(a))return a().then(l=>{if(NR.MessageTransports.is(l))return this._isDetached=!!l.detached,l;if(my.is(l))return this._isDetached=!!l.detached,{reader:new Pt.StreamMessageReader(l.reader),writer:new Pt.StreamMessageWriter(l.writer)};{let f;return vy.is(l)?(f=l.process,this._isDetached=l.detached):(f=l,this._isDetached=!1),f.stderr.on("data",d=>this.outputChannel.append(Ct.string(d)?d:d.toString(e))),{reader:new Pt.StreamMessageReader(f.stdout),writer:new Pt.StreamMessageWriter(f.stdin)}}});let u,c=a;return c.run||c.debug?this._forceDebug||s()?(u=c.debug,this._isInDebugMode=!0):(u=c.run,this._isInDebugMode=!1):u=a,this._getServerWorkingDir(u.options).then(l=>{if(gy.is(u)&&u.module){let f=u,d=f.transport||xt.stdio;if(f.runtime){let h=[],m=f.options??Object.create(null);m.execArgv&&m.execArgv.forEach(N=>h.push(N)),h.push(f.module),f.args&&f.args.forEach(N=>h.push(N));let D=Object.create(null);D.cwd=l,D.env=t(m.env,!1);let _=this._getRuntimePath(f.runtime,l),R;if(d===xt.ipc?(D.stdio=[null,null,null,"ipc"],h.push("--node-ipc")):d===xt.stdio?h.push("--stdio"):d===xt.pipe?(R=(0,Pt.generateRandomPipeName)(),h.push(`--pipe=${R}`)):as.isSocket(d)&&h.push(`--socket=${d.port}`),h.push(`--clientProcessId=${process.pid.toString()}`),d===xt.ipc||d===xt.stdio){let N=Ci.spawn(_,h,D);return!N||!N.pid?Zo(N,`Launching server using runtime ${_} failed.`):(this._serverProcess=N,N.stderr.on("data",w=>this.outputChannel.append(Ct.string(w)?w:w.toString(e))),d===xt.ipc?(N.stdout.on("data",w=>this.outputChannel.append(Ct.string(w)?w:w.toString(e))),Promise.resolve({reader:new Pt.IPCMessageReader(N),writer:new Pt.IPCMessageWriter(N)})):Promise.resolve({reader:new Pt.StreamMessageReader(N.stdout),writer:new Pt.StreamMessageWriter(N.stdin)}))}else{if(d===xt.pipe)return(0,Pt.createClientPipeTransport)(R).then(N=>{let w=Ci.spawn(_,h,D);return!w||!w.pid?Zo(w,`Launching server using runtime ${_} failed.`):(this._serverProcess=w,w.stderr.on("data",p=>this.outputChannel.append(Ct.string(p)?p:p.toString(e))),w.stdout.on("data",p=>this.outputChannel.append(Ct.string(p)?p:p.toString(e))),N.onConnected().then(p=>({reader:p[0],writer:p[1]})))});if(as.isSocket(d))return(0,Pt.createClientSocketTransport)(d.port).then(N=>{let w=Ci.spawn(_,h,D);return!w||!w.pid?Zo(w,`Launching server using runtime ${_} failed.`):(this._serverProcess=w,w.stderr.on("data",p=>this.outputChannel.append(Ct.string(p)?p:p.toString(e))),w.stdout.on("data",p=>this.outputChannel.append(Ct.string(p)?p:p.toString(e))),N.onConnected().then(p=>({reader:p[0],writer:p[1]})))})}}else{let h;return new Promise((m,D)=>{let _=(f.args&&f.args.slice())??[];d===xt.ipc?_.push("--node-ipc"):d===xt.stdio?_.push("--stdio"):d===xt.pipe?(h=(0,Pt.generateRandomPipeName)(),_.push(`--pipe=${h}`)):as.isSocket(d)&&_.push(`--socket=${d.port}`),_.push(`--clientProcessId=${process.pid.toString()}`);let R=f.options??Object.create(null);if(R.env=t(R.env,!0),R.execArgv=R.execArgv||[],R.cwd=l,R.silent=!0,d===xt.ipc||d===xt.stdio){let N=Ci.fork(f.module,_||[],R);o(N),this._serverProcess=N,N.stderr.on("data",w=>this.outputChannel.append(Ct.string(w)?w:w.toString(e))),d===xt.ipc?(N.stdout.on("data",w=>this.outputChannel.append(Ct.string(w)?w:w.toString(e))),m({reader:new Pt.IPCMessageReader(this._serverProcess),writer:new Pt.IPCMessageWriter(this._serverProcess)})):m({reader:new Pt.StreamMessageReader(N.stdout),writer:new Pt.StreamMessageWriter(N.stdin)})}else d===xt.pipe?(0,Pt.createClientPipeTransport)(h).then(N=>{let w=Ci.fork(f.module,_||[],R);o(w),this._serverProcess=w,w.stderr.on("data",p=>this.outputChannel.append(Ct.string(p)?p:p.toString(e))),w.stdout.on("data",p=>this.outputChannel.append(Ct.string(p)?p:p.toString(e))),N.onConnected().then(p=>{m({reader:p[0],writer:p[1]})},D)},D):as.isSocket(d)&&(0,Pt.createClientSocketTransport)(d.port).then(N=>{let w=Ci.fork(f.module,_||[],R);o(w),this._serverProcess=w,w.stderr.on("data",p=>this.outputChannel.append(Ct.string(p)?p:p.toString(e))),w.stdout.on("data",p=>this.outputChannel.append(Ct.string(p)?p:p.toString(e))),N.onConnected().then(p=>{m({reader:p[0],writer:p[1]})},D)},D)})}}else if(hy.is(u)&&u.command){let f=u,d=u.args!==void 0?u.args.slice(0):[],h,m=u.transport;if(m===xt.stdio)d.push("--stdio");else if(m===xt.pipe)h=(0,Pt.generateRandomPipeName)(),d.push(`--pipe=${h}`);else if(as.isSocket(m))d.push(`--socket=${m.port}`);else if(m===xt.ipc)throw new Error("Transport kind ipc is not support for command executable");let D=Object.assign({},f.options);if(D.cwd=D.cwd||l,m===void 0||m===xt.stdio){let _=Ci.spawn(f.command,d,D);return!_||!_.pid?Zo(_,`Launching server using command ${f.command} failed.`):(_.stderr.on("data",R=>this.outputChannel.append(Ct.string(R)?R:R.toString(e))),this._serverProcess=_,this._isDetached=!!D.detached,Promise.resolve({reader:new Pt.StreamMessageReader(_.stdout),writer:new Pt.StreamMessageWriter(_.stdin)}))}else{if(m===xt.pipe)return(0,Pt.createClientPipeTransport)(h).then(_=>{let R=Ci.spawn(f.command,d,D);return!R||!R.pid?Zo(R,`Launching server using command ${f.command} failed.`):(this._serverProcess=R,this._isDetached=!!D.detached,R.stderr.on("data",N=>this.outputChannel.append(Ct.string(N)?N:N.toString(e))),R.stdout.on("data",N=>this.outputChannel.append(Ct.string(N)?N:N.toString(e))),_.onConnected().then(N=>({reader:N[0],writer:N[1]})))});if(as.isSocket(m))return(0,Pt.createClientSocketTransport)(m.port).then(_=>{let R=Ci.spawn(f.command,d,D);return!R||!R.pid?Zo(R,`Launching server using command ${f.command} failed.`):(this._serverProcess=R,this._isDetached=!!D.detached,R.stderr.on("data",N=>this.outputChannel.append(Ct.string(N)?N:N.toString(e))),R.stdout.on("data",N=>this.outputChannel.append(Ct.string(N)?N:N.toString(e))),_.onConnected().then(N=>({reader:N[0],writer:N[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))}).finally(()=>{this._serverProcess!==void 0&&this._serverProcess.on("exit",(l,f)=>{l!==null&&this.error(`Server process exited with code ${l}.`,void 0,!1),f!==null&&this.error(`Server process exited with signal ${f}.`,void 0,!1)})})}_getRuntimePath(e,t){if(py.isAbsolute(e))return e;let n=this._mainGetRootPath();if(n!==void 0){let i=py.join(n,e);if(fy.existsSync(i))return i}if(t!==void 0){let i=py.join(t,e);if(fy.existsSync(i))return i}return e}_mainGetRootPath(){let e=us.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(n=>{fy.lstat(t,(i,s)=>{n(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}};Kr.LanguageClient=wy;var yy=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return us.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new us.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,n=e>=0?this._setting.substr(e+1):void 0,i=n?us.workspace.getConfiguration(t).get(n,!1):us.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start().catch(s=>this._client.error("Start failed after configuration change",s,"force")):!i&&this._client.needsStop()&&this._client.stop().catch(s=>this._client.error("Stop failed after configuration change",s,"force"))}};Kr.SettingMonitor=yy;function Zo(r,e){return r===null?Promise.reject(e):new Promise((t,n)=>{r.on("error",i=>{n(`${e} ${i}`)}),setImmediate(()=>n(e))})}});var JR=L((s8,YR)=>{"use strict";YR.exports=Rr()});var g_=L((Q9,h_)=>{var p_="Expected a function",d_=NaN,Eq="[object Symbol]",Pq=/^\s+|\s+$/g,xq=/^[-+]0x[0-9a-f]+$/i,kq=/^0b[01]+$/i,Rq=/^0o[0-7]+$/i,_q=parseInt,Iq=typeof global=="object"&&global&&global.Object===Object&&global,Oq=typeof self=="object"&&self&&self.Object===Object&&self,Aq=Iq||Oq||Function("return this")(),Nq=Object.prototype,Fq=Nq.toString,Lq=Math.max,Mq=Math.min,Fy=function(){return Aq.Date.now()};function qq(r,e,t){var n,i,s,o,a,u,c=0,l=!1,f=!1,d=!0;if(typeof r!="function")throw new TypeError(p_);e=f_(e)||0,Vf(t)&&(l=!!t.leading,f="maxWait"in t,s=f?Lq(f_(t.maxWait)||0,e):s,d="trailing"in t?!!t.trailing:d);function h(g){var k=n,b=i;return n=i=void 0,c=g,o=r.apply(b,k),o}function m(g){return c=g,a=setTimeout(R,e),l?h(g):o}function D(g){var k=g-u,b=g-c,C=e-k;return f?Mq(C,s-b):C}function _(g){var k=g-u,b=g-c;return u===void 0||k>=e||k<0||f&&b>=s}function R(){var g=Fy();if(_(g))return N(g);a=setTimeout(R,D(g))}function N(g){return a=void 0,d&&n?h(g):(n=i=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,n=u=i=a=void 0}function p(){return a===void 0?o:N(Fy())}function v(){var g=Fy(),k=_(g);if(n=arguments,i=this,u=g,k){if(a===void 0)return m(u);if(f)return a=setTimeout(R,e),h(u)}return a===void 0&&(a=setTimeout(R,e)),o}return v.cancel=w,v.flush=p,v}function jq(r,e,t){var n=!0,i=!0;if(typeof r!="function")throw new TypeError(p_);return Vf(t)&&(n="leading"in t?!!t.leading:n,i="trailing"in t?!!t.trailing:i),qq(r,e,{leading:n,maxWait:e,trailing:i})}function Vf(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function Uq(r){return!!r&&typeof r=="object"}function $q(r){return typeof r=="symbol"||Uq(r)&&Fq.call(r)==Eq}function f_(r){if(typeof r=="number")return r;if($q(r))return d_;if(Vf(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Vf(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(Pq,"");var t=kq.test(r);return t||Rq.test(r)?_q(r.slice(2),t?2:8):xq.test(r)?d_:+r}h_.exports=jq});var cj={};_I(cj,{activate:()=>Jy});module.exports=II(cj);Lb().install();var gs=V(require("vscode"));var pI=V(require("path")),De=V(require("vscode"));var je=V(require("vscode")),ep=V(require("fs/promises")),b_=V(require("path"));var ge=V(require("vscode")),Ub=V(require("os")),Dr=V(require("path"));var nc=V(require("vscode"));var AO=Vp();function NO(){let r=null;return async function(e,...t){if(r)return r;let n=["Reload Extensions",...t];return r=(async()=>{try{let i=await nc.window.showWarningMessage(e,...n);return i==="Reload Extensions"&&await nc.commands.executeCommand("workbench.action.reloadWindow"),i}finally{r=null}})(),r}}var qn=AO(NO(),1e4,{leading:!0});var $b={get lsp(){return{get serverPath(){return cr(ge.workspace.getConfiguration("swift.sourcekit-lsp").get("serverPath",""))},get serverArguments(){return ge.workspace.getConfiguration("swift.sourcekit-lsp").get("serverArguments",[]).map(cr)},get inlayHintsEnabled(){return ge.workspace.getConfiguration("sourcekit-lsp").get("inlayHints.enabled",!0)},get supportCFamily(){return ge.workspace.getConfiguration("sourcekit-lsp").get("support-c-cpp","cpptools-inactive")},get supportedLanguages(){return ge.workspace.getConfiguration("swift.sourcekit-lsp").get("supported-languages",["swift","c","cpp","objective-c","objective-cpp"])},get disable(){return ge.workspace.getConfiguration("swift.sourcekit-lsp").get("disable",!1)}}},folder(r){function e(t,n,i=!1){if(!n){let s=e(t,"*",i);if(s)return s;let o=ge.workspace.getConfiguration("swift",r).get(t);return i&&Array.isArray(o)||!i&&o!==null&&typeof o=="object"&&Object.keys(o).length!==0?o:void 0}return ge.workspace.getConfiguration("swift",r).get(t,{})[n]}return{get testEnvironmentVariables(){return ge.workspace.getConfiguration("swift",r).get("testEnvironmentVariables",{})},get additionalTestArguments(){return ge.workspace.getConfiguration("swift",r).get("additionalTestArguments",[]).map(cr)},get autoGenerateLaunchConfigurations(){return ge.workspace.getConfiguration("swift",r).get("autoGenerateLaunchConfigurations",!0)},get disableAutoResolve(){return ge.workspace.getConfiguration("swift",r).get("disableAutoResolve",!1)},get searchSubfoldersForPackages(){return ge.workspace.getConfiguration("swift",r).get("searchSubfoldersForPackages",!1)},get attachmentsPath(){return cr(ge.workspace.getConfiguration("swift",r).get("attachmentsPath","./.build/attachments"))},pluginPermissions(t){return e("pluginPermissions",t,!1)??{}},pluginArguments(t){return e("pluginArguments",t,!0)??[]}}},get debugger(){return{get debugAdapter(){let r=ge.workspace.getConfiguration("swift.debugger").inspect("useDebugAdapterFromToolchain"),e=r?.workspaceValue??r?.globalValue;process.platform==="win32"&&process.arch==="arm64"&&(e=e??!0);let t=ge.workspace.getConfiguration("swift.debugger").get("debugAdapter","auto");switch(t){case"auto":return e!==void 0?e?"lldb-dap":"CodeLLDB":"auto";default:return t}},get customDebugAdapterPath(){return cr(ge.workspace.getConfiguration("swift.debugger").get("path",""))},get disable(){return ge.workspace.getConfiguration("swift.debugger").get("disable",!1)},get setupCodeLLDB(){return ge.workspace.getConfiguration("swift.debugger").get("setupCodeLLDB","prompt")}}},get excludeFromCodeCoverage(){return ge.workspace.getConfiguration("swift").get("excludeFromCodeCoverage",[]).map(cr)},get excludePathsFromPackageDependencies(){return ge.workspace.getConfiguration("swift").get("excludePathsFromPackageDependencies",[])},get path(){return cr(ge.workspace.getConfiguration("swift").get("path",""))},get runtimePath(){return cr(ge.workspace.getConfiguration("swift").get("runtimePath",""))},get sdk(){return cr(ge.workspace.getConfiguration("swift").get("SDK",""))},set sdk(r){ge.workspace.getConfiguration("swift").update("SDK",r).then(()=>{})},get swiftSDK(){return ge.workspace.getConfiguration("swift").get("swiftSDK","")},set swiftSDK(r){ge.workspace.getConfiguration("swift").update("swiftSDK",r).then(()=>{})},get buildArguments(){return ge.workspace.getConfiguration("swift").get("buildArguments",[]).map(cr)},get scriptSwiftLanguageVersion(){return ge.workspace.getConfiguration("swift").get("scriptSwiftLanguageVersion","6")},get packageArguments(){return ge.workspace.getConfiguration("swift").get("packageArguments",[]).map(cr)},get sanitizer(){return ge.workspace.getConfiguration("swift").get("sanitizer","off")},get buildPath(){return cr(ge.workspace.getConfiguration("swift").get("buildPath",""))},get disableSwiftPMIntegration(){return ge.workspace.getConfiguration("swift").get("disableSwiftPackageManagerIntegration",!1)},get swiftEnvironmentVariables(){return ge.workspace.getConfiguration("swift").get("swiftEnvironmentVariables",{})},get diagnosticsCollection(){return ge.workspace.getConfiguration("swift").get("diagnosticsCollection","keepSourceKit")},get diagnosticsStyle(){return ge.workspace.getConfiguration("swift").get("diagnosticsStyle","llvm")},get showBuildStatus(){return ge.workspace.getConfiguration("swift").get("showBuildStatus","swiftStatus")},get backgroundCompilation(){return ge.workspace.getConfiguration("swift").get("backgroundCompilation",!1)},get backgroundIndexing(){let r=ge.workspace.getConfiguration("swift.sourcekit-lsp").get("backgroundIndexing","auto");return typeof r=="boolean"?r?"on":"off":r},get actionAfterBuildError(){return ge.workspace.getConfiguration("swift").get("actionAfterBuildError","Focus Terminal")},get diagnostics(){return ge.workspace.getConfiguration("swift").get("diagnostics",!1)},get displayCoverageReportAfterRun(){return ge.workspace.getConfiguration("swift").get("coverage.displayReportAfterRun",!0)},get alwaysShowCoverageStatusItem(){return ge.workspace.getConfiguration("swift").get("coverage.alwaysShowStatusItem",!0)},get coverageHitColorLightMode(){return ge.workspace.getConfiguration("swift").get("coverage.colors.lightMode.hit","#c0ffc0")},get coverageMissColorLightMode(){return ge.workspace.getConfiguration("swift").get("coverage.colors.lightMode.miss","#ffc0c0")},get coverageHitColorDarkMode(){return ge.workspace.getConfiguration("swift").get("coverage.colors.darkMode.hit","#003000")},get coverageMissColorDarkMode(){return ge.workspace.getConfiguration("swift").get("coverage.colors.darkMode.miss","#400000")},get openAfterCreateNewProject(){return ge.workspace.getConfiguration("swift").get("openAfterCreateNewProject","prompt")},get warnAboutSymlinkCreation(){return ge.workspace.getConfiguration("swift").get("warnAboutSymlinkCreation",!0)},set warnAboutSymlinkCreation(r){ge.workspace.getConfiguration("swift").update("warnAboutSymlinkCreation",r,ge.ConfigurationTarget.Global).then(()=>{})},get enableTerminalEnvironment(){return ge.workspace.getConfiguration("swift").get("enableTerminalEnvironment",!0)},get disableSandbox(){return ge.workspace.getConfiguration("swift").get("disableSandbox",!1)}},FO=new RegExp(/\$\{(.+?)\}/g);function cr(r){return r.replace(FO,(e,t)=>typeof t=="string"&&LO(t)||e)}function LO(r){let e=()=>{let i=ge.window.activeTextEditor;if(i){let s=i.document.uri,o=ge.workspace.getWorkspaceFolder(s);if(o)return o.uri.fsPath}return ge.workspace.workspaceFolders?.at(0)?.uri.fsPath??""},t=()=>ge.window.activeTextEditor?.document?.uri?.fsPath||"",n={workspaceFolder:e,fileWorkspaceFolder:e,workspaceFolderBasename:()=>Dr.basename(e()),cwd:()=>process.cwd(),userHome:()=>Ub.homedir(),pathSeparator:()=>Dr.sep,file:t,relativeFile:()=>Dr.relative(e(),t()),relativeFileDirname:()=>Dr.dirname(Dr.relative(e(),t())),fileBasename:()=>Dr.basename(t()),fileExtname:()=>Dr.extname(t()),fileDirname:()=>Dr.dirname(t()),fileDirnameBasename:()=>Dr.basename(Dr.dirname(t()))};return r in n?n[r]():null}function Bb(r){return e=>{e.affectsConfiguration("swift.path")&&$b.path!==r.currentFolder?.toolchain.swiftFolderPath?qn("Changing the Swift path requires Visual Studio Code be reloaded."):e.affectsConfiguration("swift.SDK")||e.affectsConfiguration("swift.swiftSDK")?ge.commands.executeCommand("swift.restartLSPServer").then(()=>{}):e.affectsConfiguration("swift.swiftEnvironmentVariables")&&qn("Changing environment variables requires the project be reloaded.")}}var K=$b;var it=V(require("vscode")),jy=V(require("path"));var r_=V(require("vscode")),ls=V(require("path"));var oc=V(require("vscode"));var ic=V(require("fs/promises")),Zs=V(require("path"));async function lr(...r){try{return await ic.access(Zs.join(...r)),!0}catch{return!1}}async function eo(...r){try{return(await ic.stat(Zs.join(...r))).isFile()}catch{return!1}}function Oi(r,e){return!Zs.relative(e,r).startsWith("..")}function Wb(r,e=process.env.HOME??null,t=process.platform){return t==="win32"||r[0]!=="~"||!e?r:Zs.join(e,r.slice(1))}var sc=class r{constructor(e,t){this.exists=t;this.fileWatcher=oc.workspace.createFileSystemWatcher(new oc.RelativePattern(e,"Tests/LinuxMain.swift"),!1,!0),this.fileWatcher.onDidCreate(()=>this.exists=!0),this.fileWatcher.onDidDelete(()=>this.exists=!1)}static async create(e){let t=await lr(e.fsPath,"Tests","LinuxMain.swift");return new r(e,t)}dispose(){this.fileWatcher?.dispose()}};var ET=V(require("path")),PT=V(require("fs/promises")),Mr=V(require("vscode"));var La=V(require("path"));var xn=V(require("fs/promises")),ke=V(require("path")),TT=V(require("os")),ST=V(hT()),Fa=V(require("vscode"));var CT=V(require("vscode"));var fo=V(require("vscode")),vh=V(require("child_process")),gT=V(require("path"));var Ac=!1;function fr(r=process.env,e=K.runtimePath){let t=wh(),n=process.platform==="win32"?";":":";switch(r){case!1:r={};break;case!0:r={[t]:`\${env:${t}}`};break;default:break}return EA(r,t,e,n)}function EA(r,e,t,n){if(t!=="")return r[e]?{[e]:`${t}${n}${r[e]}`}:{[e]:t}}function wh(){return PA(process.platform)}function PA(r){switch(r){case"win32":return"Path";case"darwin":return"DYLD_LIBRARY_PATH";default:return"LD_LIBRARY_PATH"}}var mh=class extends Error{constructor(t,n,i){super(t.message);this.causedBy=t;this.stdout=n;this.stderr=i}};async function zt(r,e,t={},n,i=!0){if(n?.workspaceContext.outputChannel.logDiagnostic(`Exec: ${r} ${e.join(" ")}`,n.name),i){let s=fr(t.env);s&&Object.keys(s).length>0&&(t.env={...t.env??process.env,...s})}return t={...t,maxBuffer:t.maxBuffer??1024*1024*64},new Promise((s,o)=>{vh.execFile(r,e,t,(a,u,c)=>{a?o(new mh(a,u,c)):s({stdout:u,stderr:c})})})}async function Na(r,e,t,n,i,s={},o,a=!0,u="SIGTERM"){if(o?.workspaceContext.outputChannel.logDiagnostic(`Exec: ${r} ${e.join(" ")}`,o.name),a){let c=fr(s.env);c&&Object.keys(c).length>0&&(s.env={...s.env??process.env,...c})}return new Promise((c,l)=>{let f,d=vh.execFile(r,e,s,h=>{h?l(h):c(),f&&f.dispose()});t&&d.stdout?.pipe(t),n&&d.stderr?.pipe(n),i&&(f=i.onCancellationRequested(()=>{d.kill(u)}))})}async function pn(r,e,t={},n){let i;return typeof e=="object"&&"swiftExecutable"in e?i=e.swiftExecutable:e==="default"?i=kA():(i=e.getToolchainExecutable("swift"),r=e.buildFlags.withAdditionalFlags(r)),Object.keys(K.swiftEnvironmentVariables).length>0&&(t.env={...t.env??process.env,...K.swiftEnvironmentVariables}),t={...t,maxBuffer:t.maxBuffer??1024*1024*64},await zt(i,r,t,n)}async function mT(r,e){for(;!r();)await xA(e)}function xA(r){return new Promise(e=>setTimeout(e,r))}function vT(r,e){return r.reduce((t,n)=>{let i=e(n);return i!=null&&t.push(i),t},[])}function kA(r="swift"){let e=process.platform==="win32"?".exe":"";return gT.join(K.path,`${r}${e}`)}function yh(r=8){return Math.random().toString(16).substring(2,r)}function hn(r){return r?r.stderr?r.stderr:r.error?JSON.stringify(r.error):r instanceof Error?r.message:JSON.stringify(r):"No error provided"}function wT(r){return r.length===1?r[0]:[r.slice(0,-1).join(", "),r[r.length-1]].join(" and ")}function yT(r,e=0){let t=3735928559^e,n=1103547991^e;for(let i=0,s;i<r.length;i++)s=r.charCodeAt(i),t=Math.imul(t^s,2654435761),n=Math.imul(n^s,1597334677);return t=Math.imul(t^t>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507)^Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}function po(r,e,t){return new fo.Location(fo.Uri.file(r),new fo.Position(e-1,t??0))}var RA=new Set(["(",")","[","]",".","$","^","?","|","/",":"]);function bT(r,e){let t="";for(let n of r)RA.has(n)&&(!e||!e.has(n))?t+=`\\${n}`:t+=n;return t}var Mi=class{constructor(e,t=25e4){this.name=e;this.name=e,this.channel=CT.window.createOutputChannel(e,"Swift"),this.logStore=new bh(t)}append(e){this.channel.append(e),this.logStore.append(e)}appendLine(e){this.channel.appendLine(e),this.logStore.appendLine(e)}replace(e){this.channel.replace(e),this.logStore.replace(e)}clear(){this.channel.clear(),this.logStore.clear()}show(e,t){this.channel.show(t)}hide(){this.channel.hide()}dispose(){this.channel.dispose(),this.logStore.dispose()}log(e,t){let n;t!==void 0?n=`${t}: ${e}`:n=e,this.appendLine(`${this.nowFormatted}: ${n}`)}logDiagnostic(e,t){if(!K.diagnostics&&!Ac)return;let n=t!==void 0?`${t}: ${e}`:e;this.appendLine(`${this.nowFormatted}: ${n}`)}get nowFormatted(){return new Date().toLocaleString("en-US",{hourCycle:"h23",hour:"2-digit",minute:"numeric",second:"numeric"})}get logs(){return this.logStore.logs}},bh=class{constructor(e){this.maxLogs=e;this.startIndex=0;this.endIndex=0;this.logCount=0;this._logs=new Array(e).fill(null)}get logs(){let e=[];for(let t=0;t<this.logCount;t++)e.push(this._logs[(this.startIndex+t)%this.maxLogs]);return e}incrementIndex(e){return(e+1)%this.maxLogs}dispose(){this.clear()}clear(){this._logs=new Array(this.maxLogs).fill(null),this.startIndex=0,this.endIndex=0,this.logCount=0}appendLine(e){this.logCount>0&&(this.endIndex=this.incrementIndex(this.endIndex)),this.logCount===this.maxLogs?this.startIndex=this.incrementIndex(this.startIndex):this.logCount++,this._logs[this.endIndex]=e}append(e){this.logCount===0&&(this.logCount=1);let t=(this._logs[this.endIndex]??"")+e;this._logs[this.endIndex]=t}replace(e){this._logs=new Array(this.maxLogs).fill(null),this._logs[0]=e,this.startIndex=0,this.endIndex=1,this.logCount=1}};var ve=class r{constructor(e,t,n){this.major=e;this.minor=t;this.patch=n}static fromString(e){let t=e.match(/(\d+).(\d+)(?:.(\d+))?/);if(t){let n=parseInt(t[1]),i=parseInt(t[2]);if(t[3]===void 0)return new r(n,i,0);{let s=parseInt(t[3]);return new r(n,i,s)}}}toString(){return`${this.major}.${this.minor}.${this.patch}`}isLessThan(e){return this.major<e.major?!0:this.major>e.major?!1:this.minor<e.minor?!0:this.minor>e.minor?!1:this.patch<e.patch}isGreaterThan(e){return this.major>e.major?!0:this.major<e.major?!1:this.minor>e.minor?!0:this.minor<e.minor?!1:this.patch>e.patch}isLessThanOrEqual(e){return!this.isGreaterThan(e)}isGreaterThanOrEqual(e){return!this.isLessThan(e)}};var DT=V(require("path")),Nc=class r{constructor(e,t){this.type=e;this.toolchain=t}static create(e,t){if(e==="thread"||e==="address")return new r(e,t)}get runtimeEnvironment(){if(!this.toolchain.toolchainPath)return;let e=`/lib/swift/clang/lib/darwin/libclang_rt.${this.clangName}_osx_dynamic.dylib`;return{DYLD_INSERT_LIBRARIES:DT.join(this.toolchain.toolchainPath,e)}}get buildFlags(){return[`--sanitize=${this.type}`]}get clangName(){switch(this.type){case"address":return"asan";case"thread":return"tsan"}}};var Fc=V(require("path")),Ch=V(require("vscode")),Tr=/\r\n|\n|\r/gm;function Lc(r,e){let t=_A(r);return e?Fc.isAbsolute(e)?e:t?Fc.join(t,e):e:t}function _A(r){if(r.scope!==Ch.TaskScope.Global&&r.scope!==Ch.TaskScope.Workspace)return r.scope.uri.fsPath}function Mc(r){let t=/^Build complete!/gm.exec(r);return!!(t||(t=/^Build of product '.*' complete!/gm.exec(r),t))}function IA(r){switch(r){case"iOS":return"iphoneos";case"tvOS":return"appletvos";case"watchOS":return"watchos";case"xrOS":return"xros"}}function qc(r){switch(r){case"iOS":return"arm64-apple-ios";case"tvOS":return"arm64-apple-tvos";case"watchOS":return"arm64-apple-watchos";case"xrOS":return"arm64-apple-xros"}}var Lr=class r{constructor(e,t,n,i,s,o,a,u,c,l){this.swiftFolderPath=e;this.toolchainPath=t;this.targetInfo=n;this.swiftVersion=i;this.runtimePath=s;this.defaultSDK=o;this.customSDK=a;this.xcTestPath=u;this.swiftTestingPath=c;this.swiftPMTestingHelperPath=l;this.swiftVersionString=n.compilerVersion}static async create(e){let t=await this.getSwiftFolderPath(),n=await this.getToolchainPath(t,e),i=await this.getSwiftTargetInfo(this._getToolchainExecutable(n,"swift")),s=this.getSwiftVersion(i),[o,a]=await Promise.all([this.getRuntimePath(i),this.getDefaultSDK()]),u=this.getCustomSDK(),[c,l,f]=await Promise.all([this.getXCTestPath(i,t,s,o,u??a),this.getSwiftTestingPath(i,s,o,u??a),this.getSwiftPMTestingHelperPath(n)]);return new r(t,n,i,s,o,a,u,c,l,f)}get unversionedTriple(){return this.targetInfo.target?.unversionedTriple}get buildFlags(){return new Gt(this)}sanitizer(e){return Nc.create(e,this)}get hasMultiLineParallelTestOutput(){return this.swiftVersion.isLessThanOrEqual(new ve(5,6,0))||this.swiftVersion.isGreaterThanOrEqual(new ve(6,0,0))}static async getXcodeDeveloperDir(e){let{stdout:t}=await zt("xcode-select",["-p"],{env:e});return t.trimEnd()}static async getSDKForTarget(e){return await this.getSDKPath(IA(e))}static async getSDKPath(e){let{stdout:t}=await zt("xcrun",["--sdk",e,"--show-sdk-path"],{env:{...process.env,...K.swiftEnvironmentVariables}});return ke.join(t.trimEnd())}static async findXcodeInstalls(){if(process.platform!=="darwin")return[];let[{stdout:e},t]=await Promise.all([zt("mdfind",["kMDItemCFBundleIdentifier == 'com.apple.dt.Xcode'"]),this.getXcodeDeveloperDir()]),n=e.length>0?e.trimEnd().split(Tr):[],i=this.getXcodeDirectory(t),s=n;return i&&n.find(o=>o===i)===void 0&&s.push(i),s}static async getSwiftlyToolchainInstalls(){if(process.platform!=="linux")return[];try{let e=process.env.SWIFTLY_HOME_DIR;if(!e)return[];let t=await r.getSwiftlyConfig();if(!t||!("installedToolchains"in t))return[];let n=t.installedToolchains;return Array.isArray(n)?n.filter(i=>typeof i=="string").map(i=>ke.join(e,"toolchains",i)):[]}catch{throw new Error("Failed to retrieve Swiftly installations from disk.")}}static async getSwiftlyConfig(){let e=process.env.SWIFTLY_HOME_DIR;if(!e)return;let t=await xn.readFile(ke.join(e,"config.json"),"utf-8");return JSON.parse(t)}static async getToolchainInstalls(){return process.platform!=="darwin"?[]:Promise.all([this.findToolchainsIn("/Library/Developer/Toolchains/"),this.findToolchainsIn(ke.join(TT.homedir(),"Library/Developer/Toolchains/")),this.findCommandLineTools()]).then(e=>e.flatMap(t=>t))}static async findToolchainsIn(e){try{return(await Promise.all((await xn.readdir(e,{withFileTypes:!0})).filter(n=>n.name.startsWith("swift-")).map(async n=>{let i=ke.join(n.path,n.name),s=ke.join(i,"usr","bin","swift");return await lr(s)?i:null}))).filter(n=>typeof n=="string")}catch{return[]}}async getProjectTemplates(){if(this.swiftVersion.isLessThan(new ve(5,8,0)))return[];let{stdout:e}=await pn(["package","init","--help"],"default"),t=e.split(/\r?\n/g),n=t.findIndex(o=>o.trim().startsWith("--type"));if(n===-1)throw new Error("Unable to parse output from `swift package init --help`");n+=1;let i=[],s=/^\s*([a-zA-z-]+)\s+-\s+(.+)$/;for(;n<t.length;n++){let o=t[n];if(o.trim().startsWith("--"))break;let a=o.match(s);if(a){let u=a[1].split("-");i.push({id:a[1],name:u.map(c=>c[0].toLocaleUpperCase()+c.slice(1)).join(" "),description:a[2]})}else i[i.length-1].description+=" "+o.trim()}return i}static async findCommandLineTools(){let e="/Library/Developer/CommandLineTools";if(!await lr(e))return[];let t=ke.join(e,"usr","bin","swift");return await lr(t)?[e]:[]}getToolchainExecutable(e){return r._getToolchainExecutable(this.toolchainPath,e)}static _getToolchainExecutable(e,t){let n=process.platform==="win32"?".exe":"";return ke.join(e,"bin",t+n)}static getXcodeDirectory(e){let t=e;for(;ke.extname(t)!==".app";){if(ke.parse(t).base==="")return;t=ke.dirname(t)}return t}async getLLDB(){return this.findToolchainOrXcodeExecutable("lldb")}async getLLDBDebugAdapter(){return this.findToolchainOrXcodeExecutable("lldb-dap")}async findToolchainOrXcodeExecutable(e){process.platform==="win32"&&(e+=".exe");let t=ke.join(this.swiftFolderPath,e);if(await lr(t))return t;if(process.platform!=="darwin")throw new Error(`Failed to find ${e} within Swift toolchain '${this.toolchainPath}'`);return this.findXcodeExecutable(e)}async findXcodeExecutable(e){let t=r.getXcodeDirectory(this.toolchainPath);if(!t)throw new Error(`Failed to find ${e} within Swift toolchain '${this.toolchainPath}'`);try{let{stdout:n}=await zt("xcrun",["-find",e],{env:{...process.env,DEVELOPER_DIR:t}});return n.trimEnd()}catch(n){let i=`Failed to find ${e} within Xcode Swift toolchain '${t}'`;throw n instanceof Error&&(i+=`:
${n.message}`),new Error(i)}}basePlatformDeveloperPath(){let e=this.customSDK??this.defaultSDK;if(e)return ke.resolve(e,"../../")}swiftTestingLibraryPath(){let e="",t=this.basePlatformDeveloperPath();return t&&(e=`${ke.join(t,"usr/lib")}:`),`${e}${ke.join(this.toolchainPath,"lib/swift/macosx/testing")}`}swiftTestingFrameworkPath(){let e=this.basePlatformDeveloperPath();if(!e)return;let t=ke.join(e,"Library/Frameworks"),n=ke.join(e,"Library/PrivateFrameworks");return`${t}:${n}`}get diagnostics(){let e="";return e+=this.swiftVersionString,e+=`
Platform: ${process.platform}`,e+=`
Swift Path: ${this.swiftFolderPath}`,e+=`
Toolchain Path: ${this.toolchainPath}`,this.runtimePath&&(e+=`
Runtime Library Path: ${this.runtimePath}`),this.targetInfo.target?.triple&&(e+=`
Default Target: ${this.targetInfo.target?.triple}`),this.defaultSDK&&(e+=`
Default SDK: ${this.defaultSDK}`),this.customSDK&&(e+=`
Custom SDK: ${this.customSDK}`),this.xcTestPath&&(e+=`
XCTest Path: ${this.xcTestPath}`),e}logDiagnostics(e){e.logDiagnostic(this.diagnostics)}static async getSwiftFolderPath(){try{let e;if(K.path!==""){let i=process.platform==="win32"?".exe":"";e=ke.join(K.path,`swift${i}`)}else switch(process.platform){case"darwin":{let{stdout:i}=await zt("which",["swift"]);e=i.trimEnd();break}case"win32":{let{stdout:i}=await zt("where",["swift"]),s=i.trimEnd().split(`\r
`);s.length>1&&Fa.window.showWarningMessage(`Found multiple swift executables in in %PATH%. Using excutable found at ${s[0]}`),e=s[0];break}default:{let{stdout:i}=await zt("/bin/sh",["-c","LC_MESSAGES=C type swift"]),s=/^swift is (.*)$/.exec(i.trimEnd());if(s)e=s[1];else throw Error("Failed to find swift executable");break}}let t=await xn.realpath(e),n=Wb(ke.dirname(t));return await this.getSwiftEnvPath(n)}catch{throw Error("Failed to find swift executable")}}static async getSwiftEnvPath(e){if(process.platform==="linux"&&e.endsWith(".swiftenv/shims"))try{let t=ke.dirname(e),n=ke.join(t,"libexec","swiftenv"),{stdout:i}=await zt(n,["which","swift"]),s=i.trimEnd();return ke.dirname(s)}catch{return e}else return e}static async getToolchainPath(e,t){try{switch(process.platform){case"darwin":{if(K.path!=="")return ke.dirname(K.path);let n=await this.swiftlyToolchainLocation(t);if(n)return n;let{stdout:i}=await zt("xcrun",["--find","swift"],{env:K.swiftEnvironmentVariables}),s=i.trimEnd();return ke.dirname(ke.dirname(s))}default:return ke.dirname(e)}}catch{throw Error("Failed to find swift toolchain")}}static async swiftlyToolchainLocation(e){let t=process.env.SWIFTLY_HOME_DIR;if(t){let{stdout:n}=await zt("which",["swift"]);if(n.indexOf(t)===0)try{let{stdout:i}=await zt("swiftly",["use","--print-location"],{cwd:e?.fsPath}),s=i.trimEnd();if(s.length>0)return ke.join(s,"usr")}catch(i){let s=i;Fa.window.showErrorMessage(`${s.stderr}`)}}}static async getRuntimePath(e){if(K.runtimePath!=="")return K.runtimePath;if(process.platform==="win32"){let{stdout:t}=await zt("where",["swiftCore.dll"]),n=t.trimEnd();return n.length>0?ke.dirname(n):void 0}else return e.paths.runtimeLibraryPaths.length>0?e.paths.runtimeLibraryPaths.join(":"):void 0}static async getDefaultSDK(){switch(process.platform){case"darwin":return process.env.SDKROOT?process.env.SDKROOT:this.getSDKPath("macosx");case"win32":return process.env.SDKROOT}}static getCustomSDK(){return K.sdk!==""?K.sdk:void 0}static async getSwiftPMTestingHelperPath(e){if(process.platform==="darwin"){let t=ke.join(e,"libexec","swift","pm","swiftpm-testing-helper");if(await this.fileExists(t))return t}}static async getSwiftTestingPath(e,t,n,i){if(process.platform==="win32")return this.getWindowsPlatformDLLPath("Testing",e,t,n,i)}static async getXCTestPath(e,t,n,i,s){switch(process.platform){case"darwin":{let o=this.getXcodeDirectory(t),a=K.swiftEnvironmentVariables;o&&!("DEVELOPER_DIR"in a)&&(a.DEVELOPER_DIR=o);let u=await this.getXcodeDeveloperDir(a);return ke.join(u,"usr","bin")}case"win32":return await this.getWindowsPlatformDLLPath("XCTest",e,n,i,s)}}static async getWindowsPlatformDLLPath(e,t,n,i,s){let o=i!==void 0&&await lr(ke.join(i,`${e}.dll`))?i:void 0;if(!s)return o;let a=ke.dirname(ke.dirname(ke.dirname(s))),u=ke.join(a,"Info.plist");if(await lr(u)!==!0){if(o)return o;Fa.window.showWarningMessage(`${e} not found due to non-standardized library layout. Tests explorer won't work as expected.`);return}let c=await xn.readFile(u,"utf8"),l;try{l=ST.parse(c)}catch(h){Fa.window.showWarningMessage(`Unable to parse ${u}: ${h}`);return}let f=e==="XCTest"?"XCTEST_VERSION":"SWIFT_TESTING_VERSION",d=l.DefaultProperties[f];if(!d){new Mi("swift").appendLine(`Warning: ${u} is missing the ${f} key.`);return}if(n.isGreaterThanOrEqual(new ve(5,7,0))){let h,m=t.target?.triple.split("-",1)[0];switch(m){case"x86_64":h="bin64";break;case"i686":h="bin32";break;case"aarch64":h="bin64a";break;default:throw Error(`unsupported architecture ${m}`)}return ke.join(a,"Developer","Library",`${e}-${d}`,"usr",h)}else return ke.join(a,"Developer","Library",`${e}-${d}`,"usr","bin")}static async getSwiftTargetInfo(e){try{try{let{stdout:n}=await pn(["-print-target-info"],{swiftExecutable:e}),i=JSON.parse(n.trimEnd());if(i.compilerVersion)return i}catch{}let{stdout:t}=await pn(["--version"],{swiftExecutable:e});return{compilerVersion:t.split(Tr,1)[0],paths:{runtimeLibraryPaths:[""]}}}catch{throw Error("Failed to get swift version from either '-print-target-info' or '--version'.")}}static getSwiftVersion(e){let t=e.compilerVersion.match(/Swift version ([\S]+)/),n;return t&&(n=ve.fromString(t[1])),n??new ve(0,0,0)}static async fileExists(e){try{return await xn.access(e,xn.constants.F_OK),!0}catch{return!1}}};var Gt=class{constructor(e){this.toolchain=e}withSwiftSDKFlags(e){switch(e[0]){case"package":{let t=e.splice(0,2).concat(this.buildPathFlags());switch(t[1]){case"dump-symbol-graph":case"diagnose-api-breaking-changes":case"resolve":return[...t,...this.swiftpmSDKFlags(),...e];default:return t.concat(e)}}case"build":case"run":case"test":return[...e.splice(0,1).concat(this.buildPathFlags()),...this.swiftpmSDKFlags(),...e];default:return e}}withSwiftPackageFlags(e){switch(e[0]){case"package":{if(e[1]==="init")return e;let t=[...e];return t.splice(1,0,...K.packageArguments),t}case"build":case"run":case"test":return[...e,...K.packageArguments];default:return e}}swiftpmSDKFlags(){let e=[];return K.sdk!==""&&e.push("--sdk",K.sdk,...this.swiftDriverTargetFlags(!0)),K.swiftSDK!==""&&e.push("--swift-sdk",K.swiftSDK),e}buildPathFlags(){return K.buildPath&&K.buildPath.length>0?this.toolchain.swiftVersion.isLessThan(new ve(5,8,0))?["--build-path",K.buildPath]:["--scratch-path",K.buildPath]:[]}static buildDirectoryFromWorkspacePath(e,t=!1,n){let i=n==="posix"?La.posix:n==="win32"?La.win32:La,s=K.buildPath.length>0?K.buildPath:".build";return!i.isAbsolute(s)&&t?i.join(e,s):s}swiftDriverSDKFlags(e=!1){if(K.sdk==="")return[];let t=["-sdk",K.sdk];return e?t.flatMap(n=>["-Xswiftc",n]):t}getDarwinTarget(){let e=[{name:"iPhoneOS",target:"iOS"},{name:"AppleTVOS",target:"tvOS"},{name:"WatchOS",target:"watchOS"},{name:"XROS",target:"xrOS"}];if(K.sdk===""||process.platform!=="darwin")return;let t=K.sdk.split("/"),n=t[t.length-1];for(let i of e)if(n.includes(i.name)){let s=n.substring(i.name.length,n.length-4);return{...i,version:s}}}swiftDriverTargetFlags(e=!1){let t=this.getDarwinTarget();if(!t)return[];let n=["-target",`${qc(t.target)}${t.version}`];return e?n.flatMap(i=>["-Xswiftc",i]):n}withDisableSandboxFlags(e){if(!K.disableSandbox)return e;let t=["--disable-sandbox","-Xswiftc","-disable-sandbox"];switch(e[0]){case"package":return[e[0],...t,...e.slice(1)];case"build":case"run":case"test":return[...e,...t];default:return e}}withAdditionalFlags(e){return this.withSwiftPackageFlags(this.withDisableSandboxFlags(this.withSwiftSDKFlags(e)))}static filterArguments(e,t){let n=[],i=0;for(let s of e){if(i>0){n.push(s),i-=1;continue}let o=t.find(u=>u.argument===s);if(o){n.push(s),i=o.include;continue}t.find(u=>u.include===1&&s.startsWith(u.argument+"="))&&n.push(s)}return n}};var jc=class{constructor(e,t){this.folderContext=e;this.workspaceContext=t}async install(){this.packageFileWatcher=this.createPackageFileWatcher(),this.resolvedFileWatcher=this.createResolvedFileWatcher(),this.workspaceStateFileWatcher=await this.createWorkspaceStateFileWatcher(),this.snippetWatcher=this.createSnippetFileWatcher(),this.swiftVersionFileWatcher=await this.createSwiftVersionFileWatcher()}dispose(){this.packageFileWatcher?.dispose(),this.resolvedFileWatcher?.dispose(),this.workspaceStateFileWatcher?.dispose(),this.snippetWatcher?.dispose(),this.swiftVersionFileWatcher?.dispose()}createPackageFileWatcher(){let e=Mr.workspace.createFileSystemWatcher(new Mr.RelativePattern(this.folderContext.folder,"Package.swift"));return e.onDidCreate(async()=>await this.handlePackageSwiftChange()),e.onDidChange(async()=>await this.handlePackageSwiftChange()),e.onDidDelete(async()=>await this.handlePackageSwiftChange()),e}createResolvedFileWatcher(){let e=Mr.workspace.createFileSystemWatcher(new Mr.RelativePattern(this.folderContext.folder,"Package.resolved"));return e.onDidCreate(async()=>await this.handlePackageResolvedChange()),e.onDidChange(async()=>await this.handlePackageResolvedChange()),e.onDidDelete(async()=>await this.handlePackageResolvedChange()),e}async createWorkspaceStateFileWatcher(){let e=Mr.Uri.joinPath(Mr.Uri.file(Gt.buildDirectoryFromWorkspacePath(this.folderContext.folder.fsPath,!0)),"workspace-state.json"),t=Mr.workspace.createFileSystemWatcher(e.fsPath);return t.onDidCreate(async()=>await this.handleWorkspaceStateChange()),t.onDidChange(async()=>await this.handleWorkspaceStateChange()),t.onDidDelete(async()=>await this.handleWorkspaceStateChange()),await eo(e.fsPath)&&await this.handleWorkspaceStateChange(),t}createSnippetFileWatcher(){let e=Mr.workspace.createFileSystemWatcher(new Mr.RelativePattern(this.folderContext.folder,"Snippets/*.swift"));return e.onDidCreate(async()=>await this.handlePackageSwiftChange()),e.onDidDelete(async()=>await this.handlePackageSwiftChange()),e}async createSwiftVersionFileWatcher(){let e=Mr.workspace.createFileSystemWatcher(new Mr.RelativePattern(this.folderContext.folder,".swift-version"));return e.onDidCreate(async()=>await this.handleSwiftVersionFileChange()),e.onDidChange(async()=>await this.handleSwiftVersionFileChange()),e.onDidDelete(async()=>await this.handleSwiftVersionFileChange()),this.currentVersion=await this.readSwiftVersionFile()??this.folderContext.toolchain.swiftVersion,e}async handleSwiftVersionFileChange(){let e=await this.readSwiftVersionFile();e&&e.toString()!==this.currentVersion?.toString()&&(await this.workspaceContext.fireEvent(this.folderContext,"swiftVersionUpdated"),await qn("Changing the swift toolchain version requires the extension to be reloaded")),this.currentVersion=e??this.folderContext.toolchain.swiftVersion}async readSwiftVersionFile(){let e=ET.join(this.folderContext.folder.fsPath,".swift-version");try{let t=await PT.readFile(e);return ve.fromString(t.toString().trim())}catch(t){this.workspaceContext.outputChannel.appendLine(`Failed to read .swift-version file at ${e}: ${t}`);return}}async handlePackageSwiftChange(){await this.folderContext.reload(),await this.workspaceContext.fireEvent(this.folderContext,"packageUpdated")}async handlePackageResolvedChange(){let e=this.folderContext.swiftPackage.resolved?.fileHash;await this.folderContext.reloadPackageResolved(),this.folderContext.swiftPackage.resolved?.fileHash!==e&&await this.workspaceContext.fireEvent(this.folderContext,"resolvedUpdated")}async handleWorkspaceStateChange(){await this.folderContext.reloadWorkspaceState(),await this.workspaceContext.fireEvent(this.folderContext,"workspaceStateUpdated")}};var Uc=V(require("vscode")),Dh=V(require("fs/promises")),qi=V(require("path"));var Th=class{constructor(e){let t=JSON.parse(e),n=t;if(this.version=n.version,this.fileHash=yT(e),this.version===1){let i=t;this.pins=i.object.pins.map(s=>new $c(this.identity(s.repositoryURL),s.repositoryURL,s.state))}else if(this.version===2||this.version===3){let i=t;this.pins=i.pins.map(s=>new $c(s.identity,s.location,s.state))}else throw Error("Unsupported Package.resolved version")}identity(e){return qi.basename(e,".git").toLowerCase()}},$c=class{constructor(e,t,n){this.identity=e;this.location=t;this.state=n}};function AA(r){return r.products!==void 0}function NA(r){return r instanceof Error}var Bc=class r{constructor(e,t,n,i){this.folder=e;this.contentsPromise=t;this.resolved=n;this.workspaceState=i;this.plugins=[]}static async create(e,t){let[n,i]=await Promise.all([r.loadPackageResolved(e),r.loadWorkspaceState(e)]);return new r(e,r.loadPackage(e,t),n,i)}get contents(){return this.contentsPromise.then(e=>this._contents===void 0?(this._contents=e,e):this._contents)}static async loadPackage(e,t){try{let n=await pn(["package","describe","--type","json"],t,{cwd:e.fsPath}),i=JSON.parse(r.trimStdout(n.stdout)),s=await pn(["package","show-dependencies","--format","json"],t,{cwd:e.fsPath});return i.dependencies=JSON.parse(r.trimStdout(s.stdout)).dependencies,i}catch(n){let i=n;return i.stderr!==void 0&&(i.stderr.startsWith("error: root manifest")||i.stderr.startsWith("error: Could not find Package.swift"))?void 0:Error(hn(n))}}static async loadPackageResolved(e){try{let t=Uc.Uri.joinPath(e,"Package.resolved"),n=await Dh.readFile(t.fsPath,"utf8");return new Th(n)}catch{return}}static async loadPlugins(e,t,n){try{let{stdout:i}=await pn(["package","plugin","--list"],t,{cwd:e.fsPath}),s=[],o=i.split(Tr).map(a=>a.trim());for(let a of o){let u=/^(.*) \(plugin (.*) in package (.*)\)/.exec(a);u&&s.push({command:u[1],name:u[2],package:u[3]})}return s}catch(i){return n.appendLine(`Failed to laod plugins: ${i}`),[]}}static async loadWorkspaceState(e){try{let t=Uc.Uri.joinPath(Uc.Uri.file(Gt.buildDirectoryFromWorkspacePath(e.fsPath,!0)),"workspace-state.json"),n=await Dh.readFile(t.fsPath,"utf8");return JSON.parse(n)}catch{return}}async reload(e){let t=await r.loadPackage(this.folder,e);this._contents=t,this.contentsPromise=Promise.resolve(t)}async reloadPackageResolved(){this.resolved=await r.loadPackageResolved(this.folder)}async reloadWorkspaceState(){this.workspaceState=await r.loadWorkspaceState(this.folder)}async loadSwiftPlugins(e,t){this.plugins=await r.loadPlugins(this.folder,e,t)}get isValid(){return this.contents.then(e=>AA(e))}get error(){return this.contents.then(e=>NA(e)?e:void 0)}get foundPackage(){return this.contents.then(e=>e!==void 0)}get rootDependencies(){return this.dependencies.then(e=>e.map(t=>this.resolveDependencyAgainstWorkspaceState(t)))}resolveDependencyAgainstWorkspaceState(e){let t=this.workspaceState?.object.dependencies.find(n=>n.packageRef.identity===e.identity);return{...e,version:t?.state.checkoutState?.version??"",path:t?this.dependencyPackagePath(t,this.folder.fsPath):"",type:t?this.dependencyType(t):"",location:t?t.packageRef.location:""}}childDependencies(e){return e.dependencies.map(t=>this.resolveDependencyAgainstWorkspaceState(t))}dependencyPackagePath(e,t){let n=this.dependencyType(e);if(n==="editing")return e.state.path??qi.join(t,"Packages",e.subpath);if(n==="local")return e.state.path??e.packageRef.location;{let i=Gt.buildDirectoryFromWorkspacePath(t,!0);return e.packageRef.kind==="registry"?qi.join(i,"registry","downloads",e.subpath):qi.join(i,"checkouts",e.subpath)}}dependencyType(e){return e.state.name==="edited"?"editing":e.packageRef.kind==="local"||e.packageRef.kind==="fileSystem"?"local":"remote"}get name(){return this.contents.then(e=>e?.name??"")}get products(){return this.contents.then(e=>e?.products??[])}get dependencies(){return this.contents.then(e=>e?.dependencies??[])}get targets(){return this.contents.then(e=>e?.targets??[])}get executableProducts(){return this.products.then(e=>e.filter(t=>t.type.executable!==void 0))}get libraryProducts(){return this.products.then(e=>e.filter(t=>t.type.library!==void 0))}get currentTargets(){return this._contents?.targets??[]}async getTargets(e){return e===void 0?this.targets:this.targets.then(t=>t.filter(n=>n.type===e))}async getTarget(e){let t=qi.relative(this.folder.fsPath,e);return this.targets.then(n=>n.find(i=>Oi(t,i.path)))}static trimStdout(e){for(;!e.startsWith("{");){let t=e.indexOf(`
`);e=e.slice(t+1)}return e}};var yr=V(require("vscode"));var Je=V(require("vscode")),Rs=V(require("path")),Hh=V(require("stream")),TE=V(require("os")),SE=V(require("fs/promises"));var Ot=V(require("vscode"));var ja=V(require("vscode"));var kT=V(require("child_process")),ji=V(require("vscode"));var Ma=V(require("vscode"));function xT(r){if(Ma.env.remoteName)return require(`${Ma.env.appRoot}/node_modules/${r}`);try{return require(`${Ma.env.appRoot}/node_modules.asar/${r}`)}catch{return require(`${Ma.env.appRoot}/node_modules/${r}`)}}var{spawn:FA}=xT("node-pty"),Wc=class{constructor(){this.closeEmitter=new ji.EventEmitter;this.event=this.closeEmitter.event}handle(e){this.exitCode=e,this.queueClose()}reset(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.queueClose())}dispose(){this.closeEmitter.dispose()}queueClose(){this.closeTimeout=setTimeout(()=>{this.closeEmitter.fire(this.exitCode)},250)}},Vc=class{constructor(e,t,n={}){this.command=e;this.args=t;this.options=n;this.spawnEmitter=new ji.EventEmitter;this.writeEmitter=new ji.EventEmitter;this.errorEmitter=new ji.EventEmitter;this.closeHandler=new Wc;this.disposables=[];this.onDidSpawn=this.spawnEmitter.event;this.onDidWrite=this.writeEmitter.event;this.onDidThrowError=this.errorEmitter.event;this.onDidClose=this.closeHandler.event;this.disposables.push(this.spawnEmitter,this.writeEmitter,this.errorEmitter,this.closeHandler)}spawn(){try{let e=process.platform==="win32",t=!(e&&process.env.VSCODE_DEBUG==="1");this.spawnedProcess=FA(this.command,this.args,{cwd:this.options.cwd,env:{...process.env,...this.options.env},useConpty:t,cols:e?4096:void 0}),this.spawnEmitter.fire(),this.spawnedProcess.onData(n=>{this.writeEmitter.fire(n),this.closeHandler.reset()}),this.spawnedProcess.onExit(n=>{n.signal?this.closeHandler.handle(n.signal):typeof n.exitCode=="number"?this.closeHandler.handle(n.exitCode):this.closeHandler.handle()}),this.disposables.push(this.onDidClose(()=>{this.dispose()}))}catch(e){this.errorEmitter.fire(new Error(`${e}`)),this.closeHandler.handle()}}handleInput(e){this.spawnedProcess?.write(e)}terminate(e){this.spawnedProcess&&this.spawnedProcess.kill(e)}setDimensions(e){process.platform!=="win32"&&this.spawnedProcess?.resize(e.columns,e.rows)}dispose(){this.disposables.forEach(e=>e.dispose())}},Hc=class{constructor(e,t,n={}){this.command=e;this.args=t;this.options=n;this.spawnEmitter=new ji.EventEmitter;this.writeEmitter=new ji.EventEmitter;this.errorEmitter=new ji.EventEmitter;this.closeHandler=new Wc;this.disposables=[];this.onDidSpawn=this.spawnEmitter.event;this.onDidWrite=this.writeEmitter.event;this.onDidThrowError=this.errorEmitter.event;this.onDidClose=this.closeHandler.event;this.disposables.push(this.spawnEmitter,this.writeEmitter,this.errorEmitter,this.closeHandler)}spawn(){try{this.spawnedProcess=kT.spawn(this.command,this.args,{cwd:this.options.cwd,env:{...process.env,...this.options.env}}),this.spawnEmitter.fire(),this.spawnedProcess.stdout.on("data",e=>{this.writeEmitter.fire(e.toString()),this.closeHandler.reset()}),this.spawnedProcess.stderr.on("data",e=>{this.writeEmitter.fire(e.toString()),this.closeHandler.reset()}),this.spawnedProcess.on("error",e=>{this.errorEmitter.fire(new Error(`${e}`)),this.closeHandler.handle()}),this.spawnedProcess.once("exit",e=>{this.closeHandler.handle(e??void 0)}),this.disposables.push(this.onDidClose(()=>{this.dispose()}))}catch(e){this.errorEmitter.fire(new Error(`${e}`)),this.closeHandler.handle()}}handleInput(e){}terminate(e){this.spawnedProcess&&(this.spawnedProcess.kill(e),this.dispose())}setDimensions(e){}dispose(){this.spawnedProcess?.stdout.removeAllListeners(),this.spawnedProcess?.stderr.removeAllListeners(),this.spawnedProcess?.removeAllListeners(),this.disposables.forEach(e=>e.dispose())}};var qa=V(require("vscode")),Kc=class{constructor(e,t){this.createSwiftProcess=e;this.options=t;this.writeEmitter=new qa.EventEmitter;this.closeEmitter=new qa.EventEmitter;this.disposables=[];this.onDidWrite=this.writeEmitter.event;this.onDidClose=this.closeEmitter.event}open(e){this.swiftProcess=this.createSwiftProcess();let t=[this.swiftProcess.command,...this.swiftProcess.args].join(" ");try{this.disposables.push(this.swiftProcess.onDidSpawn(()=>{this.options.echo!==!1&&this.writeEmitter.fire(`> ${t}

\r`)}),this.swiftProcess.onDidWrite(n=>{this.writeEmitter.fire(n.replace(/\n(\r)?/g,`
\r`))}),this.swiftProcess.onDidThrowError(n=>{qa.window.showErrorMessage(`Failed to run Swift command "${t}":
${n}`),this.closeEmitter.fire(),this.dispose()}),this.swiftProcess.onDidClose(n=>{this.closeEmitter.fire(n),this.dispose()})),this.swiftProcess.spawn(),e&&this.setDimensions(e)}catch{this.closeEmitter.fire(),this.dispose()}}dispose(){for(let e of this.disposables)e.dispose()}handleInput(e){let t=Buffer.from(e);t.length===1&&t[0]===3?this.swiftProcess?.terminate():this.swiftProcess?.handleInput(e)}setDimensions(e){this.swiftProcess?.setDimensions(e)}close(){this.swiftProcess?.terminate(),this.writeEmitter.dispose(),this.closeEmitter.dispose()}};var Ui=class extends ja.CustomExecution{constructor(t,n,i,s=void 0){super(async()=>{let o=()=>(s||(this.swiftProcess=i.readOnlyTerminal?new Hc(t,n,i):new Vc(t,n,i),this.listen(this.swiftProcess)),this.swiftProcess);return new Kc(o,i.presentation||{})});this.command=t;this.args=n;this.options=i;this.swiftProcess=s;this.writeEmitter=new ja.EventEmitter;this.closeEmitter=new ja.EventEmitter;this.disposables=[];this.onDidWrite=this.writeEmitter.event;this.onDidClose=this.closeEmitter.event;this.swiftProcess&&this.listen(this.swiftProcess)}listen(t){this.dispose(),this.disposables.push(t.onDidWrite(n=>this.writeEmitter.fire(n)),t.onDidClose(n=>this.closeEmitter.fire(n)))}dispose(){this.disposables.forEach(t=>t.dispose()),this.disposables=[]}terminate(t){this.swiftProcess?.terminate(t)}};var _T=V(require("os")),Sr=V(require("path")),go=V(require("fs/promises"));var Vn="swift";var Ua=class{static getLaunchConfigType(e){return e.isGreaterThanOrEqual(new ve(6,0,0))&&K.debugger.debugAdapter!=="CodeLLDB"?"lldb-dap":"lldb"}static async getLLDBDebugAdapterPath(e){let t=K.debugger.customDebugAdapterPath;return t.length>0?t:e.getLLDBDebugAdapter()}};function Ts(r){return r==="Debug Tests"||r==="Debug Tests (Release Mode)"}function $a(r){return r==="Run Tests (Release Mode)"||r==="Debug Tests (Release Mode)"}var Es=V(require("path")),Xc=V(require("fs/promises"));var Ss=class r{constructor(e,t){this.success=e;this.failure=t}static makeSuccess(e){return new r(e)}static makeFailure(e){return new r(void 0,e)}};function zc(r){if(!Ac)return r;let e=structuredClone(r);return e.disableASLR=!1,e.initCommands=["settings set target.disable-aslr false"],e}async function RT(r){let e;try{e=await r.getLLDB()}catch(i){return Ss.makeFailure(i)}let t=Es.dirname(r.swiftFolderPath);try{let s=["-b","-O","script print('<!' + lldb.SBHostOS.GetLLDBPath(lldb.ePathTypeLLDBShlibDir).fullpath + '!>')"],{stdout:o}=await zt(e,s),a=/^<!([^!]*)!>/m.exec(o);a&&(t=a[1])}catch{if(process.platform==="win32")return Ss.makeFailure(void 0)}let n=await LA(t);return n?Ss.makeSuccess(n):Ss.makeFailure("LLDB failed to provide a library path")}async function LA(r){if((await Xc.stat(r)).isFile())return r;let t,n;if(process.platform==="linux")t=Es.join(r,"lib"),n=/liblldb.*\.so.*/;else if(process.platform==="darwin")t=Es.join(r,"lib"),n=/liblldb\..*dylib|LLDB/;else if(process.platform==="win32")t=Es.join(r,"bin"),n=/liblldb\.dll/;else return r;for(let i of[r,t]){let s=await MA(i,n);if(s)return Es.join(i,s)}}async function MA(r,e){try{let t=await Xc.readdir(r);for(let n of t)if(e.test(n))return n}catch{}return null}var ho=class r{constructor(e,t,n){this.ctx=e;this.isTestBuild=t;this.isRelease=n}static buildAll(e,t,n){return new r(e,t,n).build()}async build(){let e=$i(this.ctx.toolchain);return(await this.ctx.swiftPackage.getTargets("test")).length>0&&e.push(...this.testDiscoveryFlag(this.ctx)),this.isRelease&&(e=[...e,"-c","release"]),this.ctx.toolchain.buildFlags.getDarwinTarget()===void 0&&(e=["--build-tests",...e],this.isRelease&&(e=[...e,"-Xswiftc","-enable-testing"]),this.isTestBuild&&(e=[...e,...K.folder(this.ctx.workspaceFolder).additionalTestArguments])),{...await this.baseConfig,program:"swift",args:["build",...e],env:{}}}testDiscoveryFlag(e){if(e.swiftVersion.isLessThan(new ve(5,1,0)))return[];if(process.platform!=="darwin"){let t=e.linuxMain.exists,n=e.swiftVersion.isGreaterThanOrEqual(new ve(5,4,0));if(t||!n)return["--enable-test-discovery"]}return[]}get baseConfig(){return IT(this.ctx,!0)}},Ba=class r{constructor(e,t){this.fifoPipePath=e;this.attachmentPath=t}static build(e,t){return new r(e,t)}},Ps=class r{static async setupAttachmentFolder(e,t){let n=r.resolveAttachmentPath(e,t);return n&&(await go.mkdir(n,{recursive:!0}),n)}static async cleanupAttachmentFolder(e,t,n){let i=r.resolveAttachmentPath(e,t);if(i)try{(await go.readdir(i)).length===0&&await go.rmdir(i)}catch(s){n.appendLine(`Failed to clean up attachment path: ${s}`)}}static resolveAttachmentPath(e,t){let n=K.folder(e.workspaceFolder).attachmentsPath;if(n.length>0){Sr.isAbsolute(n)||(n=Sr.resolve(e.folder.fsPath,n));let i=this.dateString(t);return Sr.join(n,i)}}static dateString(e){let t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}_${String(t.getHours()).padStart(2,"0")}-${String(t.getMinutes()).padStart(2,"0")}-${String(t.getSeconds()).padStart(2,"0")}`}},Hn=class r{constructor(e,t,n,i,s,o=!1){this.ctx=e;this.testKind=t;this.testLibrary=n;this.testList=i;this.swiftTestingArguments=s;this.expandEnvVariables=o}static swiftTestingConfig(e,t,n,i,s=!1){return new r(e,n,"swift-testing",i,t,s).build()}static xcTestConfig(e,t,n,i=!1){return new r(e,t,"XCTest",n,void 0,i).build()}static testExecutableOutputPath(e,t,n){return new r(e,t,n,[],void 0,!0).testExecutableOutputPath()}async build(){if(!await this.hasTestTarget)return null;switch(process.platform){case"darwin":return this.buildDarwinConfig();case"win32":return this.buildWindowsConfig();default:return this.buildLinuxConfig()}}async buildWindowsConfig(){if(Ts(this.testKind)){let e={...fr(),...K.folder(this.ctx.workspaceFolder).testEnvironmentVariables},t=this.ctx.toolchain.runtimePath,n=this.ctx.toolchain.xcTestPath;n&&n!==t&&(e.Path=`${n};${e.Path??process.env.Path}`);let i=this.ctx.toolchain.swiftTestingPath;return i&&i!==t&&(e.Path=`${i};${e.Path??process.env.Path}`),{...await this.baseConfig(),program:await this.testExecutableOutputPath(),args:this.debuggingTestExecutableArgs(),env:e}}else return this.buildDarwinConfig()}async buildLinuxConfig(){return Ts(this.testKind)&&this.testLibrary==="XCTest"?{...await this.baseConfig(),program:await this.testExecutableOutputPath(),args:this.debuggingTestExecutableArgs(),env:{...fr(process.env,this.ctx.toolchain.runtimePath??K.runtimePath),...K.folder(this.ctx.workspaceFolder).testEnvironmentVariables}}:this.buildDarwinConfig()}async buildDarwinConfig(){let e=await this.baseConfig();switch(this.testLibrary){case"swift-testing":switch(this.testKind){case"Debug Tests (Release Mode)":case"Debug Tests":let t=this.ctx.toolchain,n=t.swiftTestingLibraryPath(),i=t.swiftTestingFrameworkPath(),s=t.swiftPMTestingHelperPath;return s?{...e,program:s,args:this.addBuildOptionsToArgs(this.addTestsToArgs(this.addSwiftTestingFlagsArgs(["--test-bundle-path",await this.unifiedTestingOutputPath(),"--testing-library","swift-testing"]))),env:{...this.testEnv,...this.sanitizerRuntimeEnvironment,DYLD_FRAMEWORK_PATH:i,DYLD_LIBRARY_PATH:n,SWT_SF_SYMBOLS_ENABLED:"0"}}:{...e,program:await this.testExecutableOutputPath(),args:this.debuggingTestExecutableArgs(),env:{...this.testEnv,...this.sanitizerRuntimeEnvironment,DYLD_FRAMEWORK_PATH:i,DYLD_LIBRARY_PATH:n,SWT_SF_SYMBOLS_ENABLED:"0"}};default:let a=this.addSwiftTestingFlagsArgs(["test",...this.testKind==="Run With Test Coverage"?["--enable-code-coverage"]:[]]);return this.swiftVersionGreaterOrEqual(6,0,0)&&(a=[...a,"--disable-xctest"]),{...e,program:this.swiftProgramPath,args:this.addBuildOptionsToArgs(this.addTestsToArgs(a)),env:{...this.testEnv,...this.sanitizerRuntimeEnvironment,SWT_SF_SYMBOLS_ENABLED:"0"},preLaunchTask:this.testKind==="Run With Test Coverage"?void 0:e.preLaunchTask}}case"XCTest":switch(this.testKind){case"Debug Tests (Release Mode)":case"Debug Tests":let t=this.ctx.toolchain.xcTestPath;return t===void 0?null:{...e,program:Sr.join(t,"xctest"),args:this.addXCTestExecutableTestsToArgs([await this.xcTestOutputPath()]),env:{...this.testEnv,...this.sanitizerRuntimeEnvironment,SWIFT_TESTING_ENABLED:"0"}};default:let n=this.ctx.toolchain.swiftVersion;if(n.isLessThan(new ve(5,7,0))&&n.isGreaterThanOrEqual(new ve(5,6,0))&&process.platform==="darwin")return await this.createDarwin56TestConfiguration();let i=["test",...this.testKind==="Run With Test Coverage"?["--enable-code-coverage"]:[]];return this.swiftVersionGreaterOrEqual(6,0,0)&&(i=[...i,"--enable-xctest","--disable-experimental-swift-testing"]),this.testKind==="Run Tests (Parallel)"&&(i=[...i,"--parallel"]),{...e,program:this.swiftProgramPath,args:this.addBuildOptionsToArgs(this.addTestsToArgs(i)),env:{...this.testEnv,...this.sanitizerRuntimeEnvironment,SWT_SF_SYMBOLS_ENABLED:"0"},preLaunchTask:this.testKind==="Run With Test Coverage"?void 0:e.preLaunchTask}}}}async createDarwin56TestConfiguration(){if((await this.ctx.swiftPackage.getTargets("test")).length===0)return null;let e,t=this.testList.join(",");t.length>0?e=`-XCTest ${t}`:e="";let{folder:n,nameSuffix:i}=xs(this.ctx,!0),s=this.ctx.toolchain.xcTestPath;if(s===void 0)return null;let o;switch(_T.arch()){case"x64":o="x86_64";break;case"arm64":o="arm64e";break;default:return null}let a=this.ctx.toolchain.sanitizer(K.sanitizer),u=Object.entries({...fr(),...K.folder(this.ctx.workspaceFolder).testEnvironmentVariables,...a?.runtimeEnvironment}).map(([c,l])=>`settings set target.env-vars ${c}="${l}"`);return{type:Vn,request:"custom",name:`Test ${await this.ctx.swiftPackage.name}`,targetCreateCommands:[`file -a ${o} ${s}/xctest`],processCreateCommands:[...u,`process launch -w ${n} -- ${e} ${this.xcTestOutputPath()}`],preLaunchTask:`swift: Build All${i}`}}addSwiftTestingFlagsArgs(e){if(!this.swiftTestingArguments)throw new Error("Attempted to create swift testing flags without any swift testing arguments. This is an internal error, please report an issue at https://github.com/swiftlang/vscode-swift/issues/new");let t=[...this.ctx.toolchain.buildFlags.withAdditionalFlags(e),"--enable-swift-testing","--event-stream-version","0","--event-stream-output-path",this.swiftTestingArguments.fifoPipePath];return this.swiftTestingArguments.attachmentPath&&this.swiftVersionGreaterOrEqual(6,1,0)&&t.push("--experimental-attachments-path",this.swiftTestingArguments.attachmentPath),t}addTestsToArgs(e){return[...e,...this.testList.flatMap(t=>["--filter",bT(t,new Set(["$","^"]))])]}addXCTestExecutableTestsToArgs(e){return e.length===0?e:["-XCTest",this.testList.join(","),...e]}addBuildOptionsToArgs(e){let t=[...e,...$i(this.ctx.toolchain,Ts(this.testKind))];return $a(this.testKind)&&(t=[...t,"-c","release","-Xswiftc","-enable-testing"]),t=[...t,...K.folder(this.ctx.workspaceFolder).additionalTestArguments],process.platform==="win32"&&this.testKind==="Run With Test Coverage"&&(t=[...t,"-Xlinker","-lldmingw"]),t}swiftVersionGreaterOrEqual(e,t,n){return this.ctx.swiftVersion.isGreaterThanOrEqual(new ve(e,t,n))}get swiftProgramPath(){return this.ctx.toolchain.getToolchainExecutable("swift")}get buildDirectory(){let{folder:e}=xs(this.ctx,this.expandEnvVariables);return Gt.buildDirectoryFromWorkspacePath(e,!0)}get artifactFolderForTestKind(){let e=$a(this.testKind)?"release":"debug",t=this.ctx.toolchain.unversionedTriple;return t?Sr.join(t,e):e}async xcTestOutputPath(){let e=await this.ctx.swiftPackage.name;return Sr.join(this.buildDirectory,this.artifactFolderForTestKind,`${e}PackageTests.xctest`)}async unifiedTestingOutputPath(){if(process.platform==="darwin"){let e=await this.ctx.swiftPackage.name;return Sr.join(await this.xcTestOutputPath(),"Contents","MacOS",`${e}PackageTests`)}else return this.xcTestOutputPath()}async testExecutableOutputPath(){switch(this.testLibrary){case"swift-testing":return this.unifiedTestingOutputPath();case"XCTest":return this.xcTestOutputPath()}}debuggingTestExecutableArgs(){switch(this.testLibrary){case"swift-testing":{let e=["--testing-library","swift-testing"];return this.addBuildOptionsToArgs(this.addTestsToArgs(this.addSwiftTestingFlagsArgs(e)))}case"XCTest":return[this.testList.join(",")]}}get sanitizerRuntimeEnvironment(){return this.ctx.toolchain.sanitizer(K.sanitizer)?.runtimeEnvironment}get testEnv(){return{...fr(),...K.folder(this.ctx.workspaceFolder).testEnvironmentVariables}}async baseConfig(){return IT(this.ctx,this.expandEnvVariables)}get hasTestTarget(){return this.ctx.swiftPackage.getTargets("test").then(e=>e.length>0)}};async function IT(r,e){let{folder:t,nameSuffix:n}=xs(r,e),i=await r.swiftPackage.name;return zc({type:Vn,request:"launch",sourceLanguages:["swift"],name:`Test ${i}`,cwd:t,args:[],preLaunchTask:`swift: Build All${n}`,terminal:"console"})}function xs(r,e=!1,t){let n=t==="posix"?Sr.posix:t==="win32"?Sr.win32:Sr,i=e?r.workspaceFolder.uri.fsPath:`\${workspaceFolder:${r.workspaceFolder.name}}`,s,o;return r.relativePath.length===0?(s=i,o=""):(s=n.join(i,r.relativePath),o=` (${r.relativePath})`),{folder:s,nameSuffix:o}}function jA(r){return process.platform==="win32"?r.swiftVersion.isGreaterThanOrEqual(new ve(5,9,0))?["-Xlinker","-debug:dwarf"]:["-Xswiftc","-g","-Xswiftc","-use-ld=lld","-Xlinker","-debug:dwarf"]:[]}function UA(){return K.diagnosticsStyle!=="default"?["-Xswiftc",`-diagnostic-style=${K.diagnosticsStyle}`]:[]}function $i(r,e=!0){let t=[];e&&t.push(...jA(r)),t.push(...UA());let n=r.sanitizer(K.sanitizer);return n&&t.push(...n.buildFlags),t.push(...K.buildArguments),t}function Eh(){return K.actionAfterBuildError==="Focus Terminal"?Ot.TaskRevealKind.Silent:Ot.TaskRevealKind.Never}var Ph=(()=>{let r=new Map,e=(t,n,i)=>`${t}:${n.folder}:${$i(n.toolchain).join(",")}:${i.definition.args.join(",")}`;return{get(t,n,i){let s=r.get(e(t,n,i));return s||this.set(t,n,i),s??i},set(t,n,i){r.set(e(t,n,i),i)},reset(){r.clear()}}})();function OT(r,e){let t=e?`${qr.buildAllName} - Release`:qr.buildAllName;return r.relativePath.length>0&&(t+=` (${r.relativePath})`),t}async function AT(r,e=!1){let t=(await ho.buildAll(r,!1,e)).args,n=OT(r,e),i=At(t,n,{group:Ot.TaskGroup.Build,cwd:r.folder,scope:r.workspaceFolder,presentationOptions:{reveal:Eh()},disableTaskQueue:!0},r.toolchain);return Ph.get(n,r,i)}async function Wa(r,e=!1){let t=OT(r,e),n=r.workspaceFolder.uri.fsPath,s=(await Ot.tasks.fetchTasks()).filter(u=>{if(u.source!=="Workspace"||u.scope!==r.workspaceFolder)return!1;let l=u.execution.options?.cwd;return(l==="${workspaceFolder}"||l===void 0)&&(l=n),l===r.folder.fsPath}),o=s.find(u=>u.group?.id===Ot.TaskGroup.Build.id&&u.group?.isDefault===!0);return o||(o=s.find(u=>u.name===`swift: ${t}`),o)||(o=(await Ot.tasks.fetchTasks({type:"swift"})).find(u=>u.name===t&&u.execution.options?.cwd===r.folder.fsPath&&u.source==="swift"),o||(o=await AT(r,e))),o}function $A(r,e){let t=e.toolchain,n="";e.relativePath.length>0&&(n=` (${e.relativePath})`);let i=`Build Debug ${r.name}${n}`,s=At(["build","--product",r.name,...$i(t)],i,{group:Ot.TaskGroup.Build,cwd:e.folder,scope:e.workspaceFolder,presentationOptions:{reveal:Eh()},disableTaskQueue:!0,dontTriggerTestDiscovery:!0},e.toolchain),o=Ph.get(i,e,s),a=`Build Release ${r.name}${n}`,u=At(["build","-c","release","--product",r.name,...$i(t,!1)],`Build Release ${r.name}${n}`,{group:Ot.TaskGroup.Build,cwd:e.folder,scope:e.workspaceFolder,presentationOptions:{reveal:Eh()},disableTaskQueue:!0,dontTriggerTestDiscovery:!0},e.toolchain),c=Ph.get(a,e,u);return[o,c]}function At(r,e,t,n,i={},s={readOnlyTerminal:!1}){let o=n.getToolchainExecutable("swift");r=n.buildFlags.withAdditionalFlags(r);let a=t.cwd.fsPath,u=t.cwd.fsPath,c={...K.swiftEnvironmentVariables,...fr(),...i},l=t?.presentationOptions??{},f=new Ot.Task({type:"swift",args:r,env:c,cwd:a,...t.showBuildStatus!==void 0?{showBuildStatus:t.showBuildStatus}:{},...t.disableTaskQueue!==void 0?{disableTaskQueue:t.disableTaskQueue}:{},...t.dontTriggerTestDiscovery!==void 0?{dontTriggerTestDiscovery:t.dontTriggerTestDiscovery}:{}},t?.scope??Ot.TaskScope.Workspace,e,"swift",new Ui(o,r,{cwd:u,env:c,presentation:l,readOnlyTerminal:s.readOnlyTerminal})),d;return t?.prefix?d=`(${t.prefix}) `:d="",f.detail=`${d}swift ${r.join(" ")}`,f.group=t?.group,f.presentationOptions=l,f}var qr=class{constructor(e){this.workspaceContext=e}static{this.buildAllName="Build All"}static{this.cleanBuildName="Clean Build"}static{this.resolvePackageName="Resolve Package Dependencies"}static{this.updatePackageName="Update Package Dependencies"}async provideTasks(e){if(this.workspaceContext.folders.length===0)return[];let t=[];for(let n of this.workspaceContext.folders){if(!await n.swiftPackage.foundPackage)continue;let i=n.taskQueue.activeOperation;if(n.toolchain.swiftVersion.isLessThan(new ve(6,0,0))&&i&&!i.operation.isBuildOperation){let o="Build tasks disabled";n.relativePath.length>0&&(o+=` (${n.relativePath})`);let a=new Ot.Task({type:"swift",args:[]},n.workspaceFolder,o,"swift",new Ot.CustomExecution(()=>{throw Error("Task disabled.")}));a.group=Ot.TaskGroup.Build,a.detail=`While ${i.operation.name} is running.`,a.presentationOptions={reveal:Ot.TaskRevealKind.Never,echo:!1},t.push(a);continue}t.push(await AT(n,!1));let s=await n.swiftPackage.executableProducts;for(let o of s)t.push(...$A(o,n))}return t}resolveTask(e,t){let n=this.workspaceContext.currentFolder??this.workspaceContext.folders[0];if(!n)return e;let s=n.toolchain.getToolchainExecutable("swift"),o;process.platform==="win32"?o=e.definition.windows:process.platform==="linux"?o=e.definition.linux:process.platform==="darwin"&&(o=e.definition.macos);let a=(o?.args??e.definition.args??[]).map(cr),u=o?.env??e.definition.env,c=Lc(e,o?.cwd??e.definition.cwd),l={...K.swiftEnvironmentVariables,...fr(),...u},f=e.definition.presentation??e.presentationOptions??{},d=new Ot.Task(e.definition,e.scope??Ot.TaskScope.Workspace,e.name??"Swift Custom Task","swift",new Ui(s,a,{cwd:c,env:l,presentation:f}),e.problemMatchers);return d.detail=e.detail??`swift ${a.join(" ")}`,d.group=e.group,d.presentationOptions=f,d}};var WA=Va();var VA={started:/Test Case '-\[(\S+)\s(.*)\]' started\./,finished:/Test Case '-\[(\S+)\s(.*)\]' (.*) \((\d.*) seconds\)/,error:/(.+):(\d+):\serror:\s-\[(\S+)\s(.*)\] : (.*)$/,skipped:/(.+):(\d+):\s-\[(\S+)\s(.*)\] : Test skipped/,startedSuite:/Test Suite '(.*)' started/,passedSuite:/Test Suite '(.*)' passed/,failedSuite:/Test Suite '(.*)' failed/},HA={started:/Test Case '(.*)\.(.*)' started/,finished:/Test Case '(.*)\.(.*)' (.*) \((\d.*) seconds\)/,error:/(.+):(\d+):\serror:\s*(.*)\.(.*) : (.*)/,skipped:/(.+):(\d+):\s*(.*)\.(.*) : Test skipped/,startedSuite:/Test Suite '(.*)' started/,passedSuite:/Test Suite '(.*)' passed/,failedSuite:/Test Suite '(.*)' failed/},Qc=class{constructor(e,t){this.hasMultiLineParallelTestOutput=e;this.outputParser=new Ha(t)}parseResult(e,t){this.hasMultiLineParallelTestOutput&&this.outputParser.parseResult(e,new xh(t))}},xh=class{constructor(e){this.runState=e}get excess(){return this.runState.excess}set excess(e){this.runState.excess=e}get activeSuite(){return this.runState.activeSuite}set activeSuite(e){this.runState.activeSuite=e}get pendingSuiteOutput(){return this.runState.pendingSuiteOutput}set pendingSuiteOutput(e){this.runState.pendingSuiteOutput=e}get failedTest(){return this.runState.failedTest}set failedTest(e){this.runState.failedTest=e}getTestItemIndex(e,t){return this.runState.getTestItemIndex(e,t)}recordIssue(e,t,n=!1,i){this.runState.recordIssue(e,t,n,i)}started(e,t){}completed(e,t){}skipped(e){}startedSuite(e){}passedSuite(e){}failedSuite(e){}recordOutput(e,t){}},Ha=class{constructor(e){this.regex=e??this.platformTestRegex}parseResult(e,t){let i=(process.platform==="win32"?WA(e):e).replace(/\r\n/g,`
`),s=i.split(Tr);t.excess&&(s[0]=t.excess+s[0]),s.length>0&&s[s.length-1]===""&&s.pop(),i[i.length-1]!==`
`?t.excess=s.pop():t.excess=void 0;for(let o of s){let a=this.regex.started.exec(o);if(a){let m=`${a[1]}/${a[2]}`;t.activeSuite=a[1],this.processPendingSuiteOutput(t,a[1]);let D=t.getTestItemIndex(m,void 0);this.startTest(D,t),this.appendTestOutput(D,o,t);continue}let u=this.regex.finished.exec(o);if(u){let m=`${u[1]}/${u[2]}`,D=t.getTestItemIndex(m,void 0),_=u[3],R=+u[4];switch(_){case"failed":this.failTest(D,{duration:R},t);break;case"passed":this.passTest(D,{duration:R},t);break;case"skipped":this.skipTest(D,t);break}this.appendTestOutput(D,o,t);continue}let c=this.regex.error.exec(o);if(c){let m=`${c[3]}/${c[4]}`,D=t.getTestItemIndex(m,c[1]);this.startErrorMessage(D,c[5],c[1],c[2],t),this.appendTestOutput(D,o,t);continue}let l=this.regex.skipped.exec(o);if(l){let m=`${l[3]}/${l[4]}`,D=t.getTestItemIndex(m,l[1]);this.skipTest(D,t),this.appendTestOutput(D,o,t);continue}let f=this.regex.startedSuite.exec(o);if(f){this.startTestSuite(f[1],o,t);continue}if(this.regex.passedSuite.exec(o)){this.completeSuite(t,o,this.passTestSuite);continue}if(this.regex.failedSuite.exec(o)){this.completeSuite(t,o,this.failTestSuite);continue}this.continueErrorMessage(o,t)}}processPendingSuiteOutput(e,t){if(e.pendingSuiteOutput){let n=t?e.getTestItemIndex(t,void 0):-1,i=e.pendingSuiteOutput.length-1;for(let s=0;s<=i;s++){let o=e.pendingSuiteOutput[s],a=s===i&&n!==-1;this.appendTestOutput(a?n:void 0,o,e)}e.pendingSuiteOutput=[]}}completeSuite(e,t,n){let i;e.activeSuite&&(n(e.activeSuite,e),i=e.getTestItemIndex(e.activeSuite,void 0)),this.processPendingSuiteOutput(e,e.activeSuite),e.activeSuite=void 0,this.appendTestOutput(i,t,e)}get platformTestRegex(){return process.platform==="darwin"?VA:HA}startTestSuite(e,t,n){n.pendingSuiteOutput=n.pendingSuiteOutput?[...n.pendingSuiteOutput,t]:[t],n.startedSuite(e)}passTestSuite(e,t){t.passedSuite(e)}failTestSuite(e,t){t.failedSuite(e)}startTest(e,t){t.started(e),t.failedTest=void 0}passTest(e,t,n){n.completed(e,t),n.failedTest=void 0}startErrorMessage(e,t,n,i,s){if(s.failedTest){let o=po(s.failedTest.file,s.failedTest.lineNumber);s.recordIssue(e,s.failedTest.message,!1,o),s.failedTest.complete=!0}s.failedTest={testIndex:e,message:t,file:n,lineNumber:parseInt(i),complete:!1}}continueErrorMessage(e,t){t.failedTest&&t.failedTest.complete!==!0?(t.failedTest.message+=`
${e}`,this.appendTestOutput(t.failedTest.testIndex,e,t)):this.appendTestOutput(void 0,e,t)}failTest(e,t,n){if(n.failedTest){let i=po(n.failedTest.file,n.failedTest.lineNumber),s=n.failedTest.message,o=this.extractDiff(s);n.recordIssue(e,s,!1,i,o)}else n.recordIssue(e,"Failed",!1);n.completed(e,t),n.failedTest=void 0}skipTest(e,t){t.skipped(e),t.failedTest=void 0}appendTestOutput(e,t,n){n.recordOutput(e,`${t}\r
`)}extractDiff(e){let t=/\((.*)\) is not .* to \((.*)\)/ms,n=e.match(t);if(n&&n[1]!==n[2])return{actual:n[1],expected:n[2]}}};var qT=V(require("readline")),jT=require("stream");var di=V(require("fs")),MT=V(require("net")),Yc=class{constructor(e){this.path=e}async start(e){return new Promise((t,n)=>{try{let i=MT.createServer(function(s){s.on("data",o=>e.push(o)),s.on("error",()=>i.close()),s.on("end",function(){e.push(null),i.close()})});i.listen(this.path,()=>t())}catch(i){n(i)}})}},Jc=class{constructor(e){this.path=e}async start(e){return new Promise((t,n)=>{di.open(this.path,di.constants.O_RDONLY,(i,s)=>{if(i)return n(i);try{let o=di.createReadStream("",{fd:s});o.on("data",a=>{e.push(a)||o.pause()}),e.on("drain",()=>o.resume()),o.on("error",()=>o.close()),o.on("end",()=>{e.push(null),di.close(s)}),t()}catch(o){di.close(s,()=>n(o))}})})}};var UT=require("child_process");var Xa=class{constructor(e,t,n){this.testRunStarted=e;this.addParameterizedTestCase=t;this.onAttachment=n;this.completionMap=new Map;this.testCaseMap=new Map}async watch(e,t,n){this.path=e;let i=n??this.createReader(e),s=new jT.Readable({read(){}});qT.createInterface({input:s,crlfDelay:1/0}).on("line",a=>this.parse(JSON.parse(a),t)),i.start(s)}async close(){this.path&&await new Promise(e=>{(0,UT.exec)(`echo '{}' > ${this.path}`,()=>{e()})})}parseStdout(e,t){for(let n of e.split(Tr))n.trim().length>0&&t.recordOutput(void 0,`${n}\r
`)}createReader(e){return process.platform==="win32"?new Yc(e):new Jc(e)}testName(e){let t=/^(.*\(.*\))\/(.*)\.swift:\d+:\d+$/,n=e.match(t);return n?n[1]:e}testCaseId(e,t){let n=this.testCaseMap.get(e)?.get(t);return n?`${e}/${this.idFromTestCase(n)}`:e}idFromTestCase(e){return e.id==="argumentIDs: nil"?e.displayName:e.id}idFromOptionalTestCase(e,t){return t?this.testCaseId(e,this.idFromTestCase(t)):this.testName(e)}parameterizedFunctionTestCaseToTestClass(e,t,n,i){return{id:this.testCaseId(e,this.idFromTestCase(t)),label:t.displayName,tags:[],children:[],style:"swift-testing",location:n,disabled:!0,sortText:`${i}`.padStart(8,"0")}}buildTestCaseMapForParameterizedTest(e){let t=new Map;(e.payload._testCases??[]).forEach(n=>{t.set(this.idFromTestCase(n),n)}),this.testCaseMap.set(e.payload.id,t)}getTestCaseIndex(e,t){let n=e.getTestItemIndex(t,void 0);return n===-1?e.getTestItemIndex(this.testName(t),void 0):n}partitionIssueMessages(e){return e.reduce((t,n)=>{let i=n.symbol==="details"||n.symbol==="default"||n.symbol==="none"?"details":"issues";return{...t,[i]:[...t[i],n]}},{issues:[],details:[]})}transformIssueMessageSymbols(e){return e.map(t=>({...t,symbol:t.symbol==="default"?"none":t.symbol}))}parse(e,t){if(e.kind==="test"&&e.payload.kind==="function"&&e.payload.isParameterized&&e.payload._testCases){this.buildTestCaseMapForParameterizedTest(e);let n=this.testName(e.payload.id),i=t.getTestItemIndex(n,void 0);e.payload._testCases.map((s,o)=>this.parameterizedFunctionTestCaseToTestClass(e.payload.id,s,po(e.payload.sourceLocation._filePath,e.payload.sourceLocation.line,e.payload.sourceLocation.column),o)).flatMap(s=>s?[s]:[]).forEach(s=>this.addParameterizedTestCase(s,i))}else if(e.kind==="event"){if(e.payload.kind==="runStarted"){this.testRunStarted();return}else if(e.payload.kind==="testStarted"){let n=this.testName(e.payload.testID),i=t.getTestItemIndex(n,void 0);t.started(i,e.payload.instant.absolute);return}else if(e.payload.kind==="testCaseStarted"){let n=this.idFromOptionalTestCase(e.payload.testID,e.payload._testCase),i=this.getTestCaseIndex(t,n);t.started(i,e.payload.instant.absolute);return}else if(e.payload.kind==="testSkipped"){let n=this.testName(e.payload.testID),i=t.getTestItemIndex(n,void 0);t.skipped(i);return}else if(e.payload.kind==="issueRecorded"){let n=this.idFromOptionalTestCase(e.payload.testID,e.payload._testCase),i=this.getTestCaseIndex(t,n),s=e.payload.issue.isKnown,o=e.payload.issue.sourceLocation,a=po(o._filePath,o.line,o.column),u=this.transformIssueMessageSymbols(e.payload.messages),{issues:c,details:l}=this.partitionIssueMessages(u),f=l.map(d=>Ka.render(d)).join(`
`);if(c.forEach(d=>{t.recordIssue(i,f.length>0?`${Ka.render(d)}
${f}`:Ka.render(d),s,a)}),e.payload._testCase&&n!==e.payload.testID){let d=this.getTestCaseIndex(t,e.payload.testID);u.forEach(h=>{t.recordIssue(d,h.text,s,a)})}return}else if(e.payload.kind==="testEnded"){let n=this.testName(e.payload.testID),i=t.getTestItemIndex(n,void 0);if(this.completionMap.get(i))return;this.completionMap.set(i,!0),t.completed(i,{timestamp:e.payload.instant.absolute});return}else if(e.payload.kind==="testCaseEnded"){let n=this.idFromOptionalTestCase(e.payload.testID,e.payload._testCase),i=this.getTestCaseIndex(t,n);if(this.completionMap.get(i))return;this.completionMap.set(i,!0),t.completed(i,{timestamp:e.payload.instant.absolute});return}else if(e.payload.kind==="_valueAttached"&&e.payload._attachment.path){let n=this.idFromOptionalTestCase(e.payload.testID),i=this.getTestCaseIndex(t,n);this.onAttachment(i,e.payload._attachment.path);return}}}},Ka=class{static render(e){return e.text}static colorize(e,t){let n="\x1B[",i=`${n}0m`;switch(e){case"details":case"skip":case"difference":case"passWithKnownIssue":return`${n}90m${t}${i}`;default:return t}}},mo=class r{static eventMessageSymbol(e){return this.colorize(e,this.symbol(e))}static{this.ansiEscapeCodePrefix="\x1B["}static{this.resetANSIEscapeCode=`${r.ansiEscapeCodePrefix}0m`}static symbol(e){if(process.platform==="win32")switch(e){case"default":return"\u25CA";case"skip":case"passWithKnownIssue":case"fail":return"\u279C";case"pass":return"\u221A";case"difference":return"\xB1";case"warning":return"\u25B2";case"details":return"\u2192";case"attachment":return"\u2399";case"none":return""}else switch(e){case"default":return"\u25C7";case"skip":case"passWithKnownIssue":case"fail":return"\u279C";case"pass":return"\u2714";case"difference":return"\xB1";case"warning":return"\u26A0\uFE0E";case"details":return"\u21B3";case"attachment":return"\u2399";case"none":return" "}}static colorize(e,t){switch(e){case"default":case"details":case"skip":case"difference":case"passWithKnownIssue":return`${r.ansiEscapeCodePrefix}90m${t}${r.resetANSIEscapeCode}`;case"pass":return`${r.ansiEscapeCodePrefix}92m${t}${r.resetANSIEscapeCode}`;case"fail":return`${r.ansiEscapeCodePrefix}91m${t}${r.resetANSIEscapeCode}`;case"warning":return`${r.ansiEscapeCodePrefix}93m${t}${r.resetANSIEscapeCode}`;case"attachment":return`${r.ansiEscapeCodePrefix}94m${t}${r.resetANSIEscapeCode}`;case"none":default:return t}}};var kh=V(require("vscode"));var Rh=class{createDebugAdapterTracker(e){return new za(e.id)}};function $T(){let r=new Rh,e=[kh.debug.registerDebugAdapterTrackerFactory("lldb",r),kh.debug.registerDebugAdapterTrackerFactory("lldb-dap",r)];return{dispose(){e.forEach(t=>t.dispose())}}}var za=class r{constructor(e){this.id=e;this.output=[];r.debugSessionIdMap[e]=this}static{this.debugSessionIdMap={}}static setDebugSessionCallback(e,t,n){let i=this.debugSessionIdMap[e.id];if(i){i.cb=n;for(let s of i.output)n(s);i.output=[]}else t.appendLine("Could not find debug adapter for session: "+e.id)}onDidSendMessage(e){let t=e;if(!(t&&t.type==="event"&&t.event==="output"&&t.body.category!=="console"))return;let n=t.body.output;this.cb?this.cb(n):this.output.push(n)}onWillStopSession(){delete r.debugSessionIdMap[this.id]}};var vo=V(require("vscode"));var Er=class{constructor(e,t={showStatusItem:!1,checkAlreadyRunning:!1}){this.task=e;this.options=t}get name(){return this.task.name}get id(){let e;return this.task.scope===vo.TaskScope.Workspace||this.task.scope===vo.TaskScope.Global?e=vo.TaskScope[this.task.scope]:this.task.scope?e=`,${this.task.scope.name}`:e="*undefined*",this.task.definition.args.join()+e}get statusItemId(){return this.task}get isBuildOperation(){return this.task.group===vo.TaskGroup.Build}run(e,t){return t?.isCancellationRequested?Promise.resolve(void 0):(e.outputChannel.log(`Exec Task: ${this.task.detail??this.task.name}`),e.tasks.executeTaskAndWait(this.task,t))}},wo=class{constructor(e,t,n,i,s){this.args=e;this.folderContext=t;this.name=n;this.options=i;this.process=s}get id(){return`${this.args.join()},${this.folderContext?.folder.path}`}get statusItemId(){return`${this.name} (${this.folderContext.name})`}get isBuildOperation(){return!1}async run(){let{stdout:e,stderr:t}=await pn(this.args,this.folderContext.toolchain,{cwd:this.folderContext.folder.fsPath},this.folderContext);return await this.process(e,t),0}},_h=class{constructor(e,t,n){this.operation=e;this.cb=t;this.token=n;this.promise=void 0}get id(){return this.operation.id}get showStatusItem(){return this.operation.options.showStatusItem}get log(){return this.operation.options.log}run(e){return this.operation.run(e,this.token)}},Zc=class{constructor(e){this.folderContext=e;this.queue=[],this.workspaceContext=e.workspaceContext,this.activeOperation=void 0,this.disabled=!1}queueOperation(e,t){let n=this.findQueuedOperation(e);if(n&&n.promise!==void 0)return n.promise;if(e.options.checkAlreadyRunning===!0&&this.activeOperation&&this.activeOperation.promise&&this.activeOperation.id===e.id)return this.activeOperation.promise;let i=new Promise((s,o)=>{n=new _h(e,a=>{a.success!==void 0?s(a.success):a.fail!==void 0?o(a.fail):s(void 0)},t),this.queue.push(n),this.processQueue()});return this.queue.length>0&&!this.queue[this.queue.length-1].promise&&(this.queue[this.queue.length-1].promise=i),i}async processQueue(){if(!this.activeOperation){let e=this.queue.shift();e&&(this.activeOperation=e,e.showStatusItem===!0&&this.workspaceContext.statusItem.start(e.operation.statusItemId),await this.waitWhileDisabled(),e.log&&this.workspaceContext.outputChannel.log(`${e.log}: starting ... `,this.folderContext.name),e.run(this.workspaceContext).then(t=>{if(e.log&&!e.token?.isCancellationRequested)switch(t){case 0:this.workspaceContext.outputChannel.log(`${e.log}: ... done.`,this.folderContext.name);break;default:this.workspaceContext.outputChannel.log(`${e.log}: ... failed.`,this.folderContext.name);break}this.finishTask(e,{success:t})}).catch(t=>{e.log&&this.workspaceContext.outputChannel.log(`${e.log}: ${t}`,this.folderContext.name),this.finishTask(e,{fail:t})}))}}finishTask(e,t){e.cb(t),e.showStatusItem===!0&&this.workspaceContext.statusItem.end(e.operation.statusItemId),this.activeOperation=void 0,this.processQueue()}findQueuedOperation(e){for(let t of this.queue)if(t.id===e.id)return t}async waitWhileDisabled(){await mT(()=>!this.disabled,1e3)}};var dE=V(lE()),ml=class{constructor(e){this.hasMultiLineParallelTestOutput=e}async parse(e,t,n){let i=await dE.parseStringPromise(e);try{return await this.parseXUnit(i,t)}catch(s){n.appendLine(`Error parsing xUnit output: ${s}`);return}}async parseXUnit(e,t){let n=0,i=0,s=0;return e.testsuites.testsuite.forEach(o=>{let a=parseInt(o.$.failures);i+=a,n=n+parseInt(o.$.tests),s+=parseInt(o.$.errors);let u;o.testcase.forEach(c=>{u=c.$.classname;let l=`${u}/${c.$.name}`,f=t.getTestItemIndex(l,void 0);c.failure&&!this.hasMultiLineParallelTestOutput&&t.recordIssue(f,c.failure.shift()?.$.message??"Test Failed",!1),t.completed(f,{duration:c.$.time})}),u!==void 0&&(u&&a===0?t.passedSuite(u):u&&t.failedSuite(u))}),{tests:n,failures:i,errors:s}}};function Vi(r,e,t){let n=t;return r.forEach(i=>{n=e(n,i)}),n}function Ya(r){let e=[];return r.forEach(t=>{e.push(t),e.push(...Ya(t.children))}),e}var vl=class{constructor(e,t){let{testItems:n,xcTestArgs:i,swiftTestArgs:s}=this.createTestLists(e,t);this.testItems=n,this.xcTestArgs=this.annotateTestArgs(i,t),this.swiftTestArgs=this.annotateTestArgs(s,t)}get hasXCTests(){return this.xcTestArgs.length>0}get hasSwiftTestingTests(){return this.swiftTestArgs.length>0}createTestLists(e,t){let n=e.include??[],i=e.exclude??[];return n.reduce(this.createTestItemReducer(n,i,t),{testItems:this.createIncludeParentList(n),xcTestArgs:[],swiftTestArgs:[]})}createIncludeParentList(e){let t=e.reduce((n,i)=>{let s=i.parent;for(;s;)n.set(s.id,s),s=s.parent;return n},new Map);return Array.from(t.values())}annotateTestArgs(e,t){return e.map(n=>{if(!!n.tags.find(a=>a.id==="test-target"))return`${n.id}.*`;let s=!!n.tags.find(a=>a.id==="XCTest"),o=n.children.size>0;if(s){let a=o?"/":"$";return t?n.id:`${n.id}${a}`}else if(o)return`${n.id}/`;return n.id})}createTestItemReducer(e,t,n){return(i,s)=>{let{testItems:o,swiftTestArgs:a,xcTestArgs:u}=this.processTestItem(s,e,t,n);if(u.length+a.length===0)return i;if(this.itemContainsAllArgs(s,u,a)){let{xcTestResult:c,swiftTestResult:l}=this.simplifyTestArgs(s,u,a,n);return{testItems:[...i.testItems,...o],xcTestArgs:[...i.xcTestArgs,...c],swiftTestArgs:[...i.swiftTestArgs,...l]}}else return{testItems:[...i.testItems,...o],swiftTestArgs:[...i.swiftTestArgs,...a],xcTestArgs:[...i.xcTestArgs,...u]}}}itemContainsAllArgs(e,t,n){return e.children.size>0&&t.length+n.length===e.children.size}simplifyTestArgs(e,t,n,i){if(!!e.tags.find(a=>a.id==="test-target"))return i?{xcTestResult:t,swiftTestResult:n}:{xcTestResult:t.length>0?[e]:[],swiftTestResult:n.length>0?[e]:[]};let o=!!e.tags.find(a=>a.id==="XCTest");return{xcTestResult:o?[e]:[],swiftTestResult:o?[]:[e]}}processTestItem(e,t,n,i){if(n.includes(e))return{testItems:[],xcTestArgs:[],swiftTestArgs:[]};let s=[],o=[],a=[];if(t.includes(e)||t.length===0){let u=e.tags.find(l=>l.id==="XCTest"),c=e.tags.find(l=>l.id==="swift-testing");(e.uri!==void 0||u)&&(s.push(e),this.isLeafTestItem(e,!!u)&&(u?o.push(e):c&&a.push(e)))}return Vi(e.children,this.createTestItemReducer([],n,i),{testItems:s,xcTestArgs:o,swiftTestArgs:a})}isLeafTestItem(e,t){if(t)return e.children.size===0;let n=!0;return e.children.forEach(i=>{i.uri&&(n=!1)}),n}};var fE=require("os"),$h=V(require("path")),yo=V(require("fs/promises"));var hi=class r{constructor(e){this.path=e}createDisposableFileCollection(){return new Bh(this)}filename(e,t){let n;return t?n=`${e}${yh(16)}.${t}`:n=`${e}${yh(16)}`,$h.join(this.path,n)}async withTemporaryFile(e,t){let n=this.filename("",e);return r.withNamedTemporaryFile(n,()=>t(n))}static async create(){let e=$h.join((0,fE.tmpdir)(),"vscode-swift");try{await yo.mkdir(e)}catch{}return new r(e)}static async withNamedTemporaryFile(e,t){return this.withNamedTemporaryFiles([e],t)}static async withNamedTemporaryFiles(e,t){try{let n=await t();for(let i of e)await yo.rm(i,{force:!0});return n}catch(n){for(let i of e)await yo.rm(i,{force:!0});throw n}}},Bh=class{constructor(e){this.folder=e;this.files=[]}file(e,t){let n=this.folder.filename(e,t);return this.files.push(n),n}async dispose(){for(let e of this.files)await yo.rm(e,{force:!0});this.files=[]}};var pE=V(require("vscode"));var Xn=new pE.TestTag("runnable"),XA=[Xn.id,"test-target","XCTest","swift-testing"];async function hE(r,e,t){let n=await e.getTargets("test"),i=[];for(let s of n){let o=[];for(let a of t)a.location&&await e.getTarget(a.location.uri.fsPath)===s&&o.push(a);i.push({id:s.c99name,label:s.name,children:o,location:void 0,disabled:!1,style:"test-target",tags:[]})}wl(r,i)}function gE(r,e,t,n){function i(o){if(o.style==="XCTest")return o;let a={...o},u=o.id.split(/\.|\//);if(u.pop(),u.length>1){let c=u.slice(0,2).join("."),l=u.slice(2);return l.length&&(c+="/"+l.join("/")),i({id:c,label:u[u.length-1],children:[a],location:void 0,disabled:!1,style:a.style,tags:a.tags})}return a}let s={id:e.id,label:e.label,children:t.map(i),location:void 0,disabled:!1,style:"test-target",tags:[]};wl(r,[s],n)}function wl(r,e,t){let n=GA(e);function i(s){if(s.children.forEach(o=>i(o)),!n.get(s.id)&&(!t||s.uri?.fsPath===t.fsPath)){let o=s.parent?s.parent.children:r.items;(s.children.size===0||zA(s))&&o.delete(s.id)}}r.items.size!==0&&r.items.forEach(i),e.forEach(s=>{yl(r,s)})}function zA(r){return r.children.size>0&&Vi(r.children,(e,t)=>e||t.uri!==void 0,!1)===!1}function GA(r,e){let t=new Map;function n(i){(!e||i.location?.uri.fsPath===e.fsPath)&&(t.set(i.id,i),i.children.forEach(s=>n(s)))}return r.forEach(i=>n(i)),t}function mE(r,e){Vi(r.children,(t,n)=>{let i=t.get(n.id);return i&&mE(i,n),t.add(n),t},e.children)}function QA(r){let e=r.tags.filter(t=>!XA.includes(t.id));return{...r,children:r.children.map(t=>({...t,tags:[...t.tags,...e]}))}}function yl(r,e,t){let n=t?.children??r.items,i=n.get(e.id),s;if(i===void 0||i&&e.location?.uri&&i.uri!==e.location.uri){if(s=r.createTestItem(e.id,e.label,e.location?.uri),i){let a=[];i.children.forEach(u=>{a.push(u)}),s.children.replace(a)}}else s=i;i&&mE(i,s),e=QA(e);let o=e.tags.find(a=>a.id===e.style);if(s.tags=o?[...e.tags]:[{id:e.style},...e.tags],e.disabled===!1&&(s.tags=[...s.tags,Xn]),s.label=e.label,s.range=e.location?.range,e.sortText)s.sortText=e.sortText;else if(!e.location){let a="".padStart(8,"0");s.sortText=`${a}:${e.label}`}return n.add(s),e.children.forEach(a=>{yl(r,a,s)}),s}var Ki=V(require("vscode")),yE=V(wE()),Cl=V(require("fs/promises")),Hi=V(require("path")),bE=require("stream"),CE=require("util");var bl=class{constructor(e){this.folderContext=e;this.lcovFiles=[];this.coverageDetails=new Map;let t=e.workspaceContext.tempFolder;this.lcovTmpFiles=t.createDisposableFileCollection()}loadDetailedCoverage(e){return this.coverageDetails.get(e)||[]}async captureCoverage(e){let t=Gt.buildDirectoryFromWorkspacePath(this.folderContext.folder.fsPath,!0),n=await Cl.readFile(`${t}/debug/codecov/default.profdata`),i=this.lcovTmpFiles.file(e,"profdata");await Cl.writeFile(i,n),this.lcovFiles.push({testLibrary:e,path:i})}async computeCoverage(e){let t=await this.computeLCOVCoverage();if(t.length>0)for(let n of t){let i=Ki.Uri.file(n.file),s=[];for(let a of n.lines.details){let u=new Ki.StatementCoverage(a.hit,new Ki.Position(a.line-1,0));s.push(u)}let o=Ki.FileCoverage.fromDetails(i,s);e.addCoverage(o),this.coverageDetails.set(i,s)}await this.lcovTmpFiles.dispose()}async mergeProfdata(e){let t=this.lcovTmpFiles.file("merged","profdata"),i=this.folderContext.toolchain.getToolchainExecutable("llvm-profdata");return await Na(i,["merge","-sparse","-o",t,...e],null,null,null,{env:process.env,maxBuffer:16*1024*1024},this.folderContext),t}async computeLCOVCoverage(){if(this.lcovFiles.length===0)return[];try{let e=await this.mergeProfdata(this.lcovFiles.map(({path:n})=>n)),t=await this.exportProfdata(this.lcovFiles.map(({testLibrary:n})=>n),e);return await this.loadLcov(t.toString("utf8"))}catch{return[]}}async exportProfdata(e,t){let n=new Set;if(e.includes("XCTest")){let o=await Hn.testExecutableOutputPath(this.folderContext,"Run With Test Coverage","XCTest");if(process.platform==="darwin"){let a=await this.folderContext.swiftPackage.name;o+=`/Contents/MacOS/${a}PackageTests`}n.add(o)}if(e.includes("swift-testing")){let o=await Hn.testExecutableOutputPath(this.folderContext,"Run With Test Coverage","swift-testing");n.add(o)}let i=Buffer.alloc(0),s=new bE.Writable({write(o,a,u){i=Buffer.concat([i,o]),u()}});return await Na(this.folderContext.toolchain.getToolchainExecutable("llvm-cov"),["export","--format","lcov",...n,`--ignore-filename-regex=${await this.ignoredFilenamesRegex()}`,`--instr-profile=${t}`],s,s,null,{env:{...process.env,...K.swiftEnvironmentVariables},maxBuffer:16*1024*1024},this.folderContext),i}async ignoredFilenamesRegex(){let e=this.folderContext.folder.path,t=Hi.join(e,".build"),n=Hi.join(e,"Snippets"),i=Hi.join(e,"Plugins"),s=(await this.folderContext.swiftPackage.getTargets("test")).map(a=>Hi.join(e,a.path)),o=K.excludeFromCodeCoverage.map(a=>Hi.isAbsolute(a)?a:Hi.join(e,a));return[t,n,i,...s,...o].join("|")}async loadLcov(e){return(0,CE.promisify)(yE.source)(e).then(t=>t??[])}};var DE=V(require("vscode")),Dl=class{constructor(...e){this.tokens=[];this.disposables=[];this.cancellationRequestedEmitter=new DE.EventEmitter;this.cancelled=!1;this.onCancellationRequested=this.cancellationRequestedEmitter.event;e.forEach(t=>this.add(t))}get isCancellationRequested(){return this.tokens.find(e=>e.isCancellationRequested)!==void 0}add(e){this.tokens.push(e),this.disposables.push(e.onCancellationRequested(t=>{this.cancelled||(this.cancelled=!0,this.cancellationRequestedEmitter.fire(t))}))}dispose(){this.disposables.forEach(e=>e.dispose())}};var tN=Va();var Kh=class r{constructor(e,t,n,i,s){this.testRunRequest=e;this.controller=t;this.args=n;this.folderContext=i;this.addedTestItems=[];this.runStarted=!1;this.queuedOutput=[];this.attachments={};this.testRunCompleteEmitter=new Je.EventEmitter;this.runState=r.initialTestRunState();this.testRunStarted=()=>{if(this.runStarted)return;this.resetTags(this.controller),this.runStarted=!0;let e=this.addedTestItems.map(({testClass:t,parentIndex:n})=>{let i=this.args.testItems[n];return i.children.replace([]),{testClass:t,parent:i}}).map(({testClass:t,parent:n})=>{t.location=void 0,t.tags=vT(n.tags,o=>o.id===Xn.id?null:new Je.TestTag(o.id));let i=yl(this.controller,t,n),s=n;for(;s?.parent;)s.parent.children.add(s),s=s.parent;return i});this.testRun=this.controller.createTestRun(this.testRunRequest),this.token.add(this.testRun.token),this._testItems=[...this.testItems,...e];for(let t of this.queuedOutput)this.performAppendOutput(this.testRun,t);this.queuedOutput=[];for(let t of this.testItems)this.testRun.enqueued(t)};this.addParameterizedTestCase=(e,t)=>{this.addedTestItems.push({testClass:e,parentIndex:t})};this.addAttachment=(e,t)=>{let n=this.attachments[e]??[];n.push(t),this.attachments[e]=n;let i=this.testItems[e];i&&(i.tags=[...i.tags,new Je.TestTag(r.Tags.HAS_ATTACHMENT)])};this._testItems=n.testItems,this.coverage=new bl(i),this.token=new Dl(s),this.onTestRunComplete=this.testRunCompleteEmitter.event}static initialTestRunState(){return{pending:[],failed:[],passed:[],skipped:[],errored:[],unknown:0,output:[]}}get testItems(){return this._testItems}get isCancellationRequested(){return this.token.isCancellationRequested}getTestIndex(e,t){return this.testItemFinder.getIndex(e,t)}get testItemFinder(){return process.platform==="darwin"?new Tl(this.testItems):new Sl(this.testItems,this.folderContext)}unknownTestRan(){this.runState.unknown++}started(e){this.runState.pending.push(e),this.testRun?.started(e)}clearPendingTest(e){this.runState.pending=this.runState.pending.filter(t=>t!==e)}skipped(e){e.tags=[...e.tags,new Je.TestTag(r.Tags.SKIPPED)],this.runState.skipped.push(e),this.clearPendingTest(e),this.testRun?.skipped(e)}passed(e,t){this.runState.passed.push(e),this.clearPendingTest(e),this.testRun?.passed(e,t)}failed(e,t,n){this.runState.failed.push({test:e,message:t}),this.clearPendingTest(e),this.testRun?.failed(e,t,n)}errored(e,t,n){this.runState.errored.push(e),this.clearPendingTest(e),this.testRun?.errored(e,t,n)}async end(){this.runStarted||this.testRunStarted(),this.runState.pending.forEach(e=>{this.failed(e,new Je.TestMessage("Test did not complete."))}),this.reportAttachments(),this.testRun?.end(),this.testRunCompleteEmitter.fire(),this.token.dispose()}setIteration(e){this.runState=r.initialTestRunState(),this.iteration=e}appendOutput(e){let t=this.prependIterationToOutput(e);this.testRun?this.performAppendOutput(this.testRun,t):this.queuedOutput.push(t)}appendOutputToTest(e,t,n){let i=this.prependIterationToOutput(e);this.testRun?this.performAppendOutput(this.testRun,i,n,t):this.queuedOutput.push(i)}reportAttachments(){let e=Object.keys(this.attachments);if(e.length>0){let t="",n=e.reduce((i,s)=>{let o=this.attachments[s];return t=o.length?o[0]:t,i+o.length},0);t&&(t=Rs.dirname(t),this.appendOutput(`${mo.eventMessageSymbol("attachment")} ${mo.ansiEscapeCodePrefix}90mRecorded ${n} attachment${n===1?"":"s"} to ${t}${mo.resetANSIEscapeCode}`))}}performAppendOutput(e,t,n,i){e.appendOutput(t,n,i),this.runState.output.push(tN(t))}prependIterationToOutput(e){if(this.iteration===void 0)return e;let t=this.iteration+1;return e.match(/[^\r\n]*[\r\n]*/g)?.map(i=>i?`\x1B[34mRun ${t}\x1B[0m ${i}`:"").join("")??""}async computeCoverage(){this.testRun&&await this.coverage.computeCoverage(this.testRun)}static{this.Tags={SKIPPED:"skipped",HAS_ATTACHMENT:"hasAttachment"}}resetTags(e){function t(n,i){let s=Object.values(r.Tags);i.tags=i.tags.filter(o=>!s.includes(o.id))}Vi(e.items,t,void 0)}},bo=class r{constructor(e,t,n,i,s){this.testKind=e;this.request=t;this.folderContext=n;this.controller=i;this.testArgs=new vl(this.ensureRequestIncludesTests(this.request),Ts(e)),this.testRun=new Kh(t,i,this.testArgs,n,s),this.xcTestOutputParser=e==="Run Tests (Parallel)"?new Qc(this.folderContext.toolchain.hasMultiLineParallelTestOutput):new Ha,this.swiftTestOutputParser=new Xa(this.testRun.testRunStarted,this.testRun.addParameterizedTestCase,this.testRun.addAttachment)}static{this.CANCELLATION_ERROR="Test run cancelled"}setIteration(e){this.swiftTestOutputParser=new Xa(this.testRun.testRunStarted,this.testRun.addParameterizedTestCase,this.testRun.addAttachment),this.testRun.setIteration(e)}ensureRequestIncludesTests(e){if((e.include?.length??0)>0)return e;let t=[];return this.controller.items.forEach(n=>t.push(n)),new Je.TestRunRequest(t,e.exclude,e.profile)}get workspaceContext(){return this.folderContext.workspaceContext}static setupProfiles(e,t,n){return[e.createRunProfile("Run Tests",Je.TestRunProfileKind.Run,async(i,s)=>{let o=new r("Run Tests",i,t,e,s);n.fire(o.testRun),await o.runHandler()},!0,Xn),e.createRunProfile("Run Tests (Parallel)",Je.TestRunProfileKind.Run,async(i,s)=>{let o=new r("Run Tests (Parallel)",i,t,e,s);n.fire(o.testRun),await o.runHandler()},!1,Xn),e.createRunProfile("Run Tests (Release Mode)",Je.TestRunProfileKind.Run,async(i,s)=>{let o=new r("Run Tests (Release Mode)",i,t,e,s);n.fire(o.testRun),await o.runHandler()},!1,Xn),e.createRunProfile("Run With Test Coverage",Je.TestRunProfileKind.Coverage,async(i,s)=>{let o=new r("Run With Test Coverage",i,t,e,s);n.fire(o.testRun),i.profile&&(i.profile.loadDetailedCoverage=async(a,u)=>o.testRun.coverage.loadDetailedCoverage(u.uri)),await o.runHandler(),await Je.commands.executeCommand("testing.openCoverage")},!1,Xn),e.createRunProfile("Debug Tests",Je.TestRunProfileKind.Debug,async(i,s)=>{let o=new r("Debug Tests",i,t,e,s);n.fire(o.testRun),await o.runHandler()},!1,Xn),e.createRunProfile("Debug Tests (Release Mode)",Je.TestRunProfileKind.Debug,async(i,s)=>{let o=new r("Debug Tests (Release Mode)",i,t,e,s);n.fire(o.testRun),await o.runHandler()},!1,Xn)]}testTargets(e){let t=new Set;for(let n of e){let i=n.id.split(".")[0];t.add(i)}return Array.from(t)}async runHandler(){let e=this.testTargets(this.testArgs.testItems);this.workspaceContext.testsStarted(this.folderContext,this.testKind,e);let t=new Ja(this.testRun),n=this.testRun.token.onCancellationRequested(()=>{this.testRun.appendOutput(`\r
Test run cancelled.`)});try{Ts(this.testKind)?await this.debugSession(t):await this.runSession(t)}catch(i){this.workspaceContext.outputChannel.log(`Error: ${hn(i)}`),this.testRun.appendOutput(`\r
Error: ${hn(i)}`)}this.testKind==="Run With Test Coverage"&&await this.testRun.computeCoverage(),n.dispose(),await this.testRun.end(),this.workspaceContext.testsFinished(this.folderContext,this.testKind,e)}async runSession(e){if(this.testArgs.hasSwiftTestingTests){let t=Date.now(),n=this.generateFifoPipePath(t);await hi.withNamedTemporaryFiles([n],async()=>{process.platform!=="win32"&&await zt("mkfifo",[n],void 0,this.folderContext);let i=await Ps.setupAttachmentFolder(this.folderContext,t),s=Ba.build(n,i),o=await Hn.swiftTestingConfig(this.folderContext,s,this.testKind,this.testArgs.swiftTestArgs,!0);if(o===null||this.testRun.isCancellationRequested)return this.testRun.runState;let a=this.testOutputWritable("swift-testing",e);await this.swiftTestOutputParser.watch(n,e),await this.launchTests(e,this.testKind==="Run Tests (Parallel)"?"Run Tests":this.testKind,a,o,"swift-testing"),await Ps.cleanupAttachmentFolder(this.folderContext,t,this.workspaceContext.outputChannel)})}if(this.testArgs.hasXCTests){let t=await Hn.xcTestConfig(this.folderContext,this.testKind,this.testArgs.xcTestArgs,!0);if(t===null||this.testRun.isCancellationRequested)return this.testRun.runState;this.testRun.testRunStarted(),await this.launchTests(e,this.testKind,this.testOutputWritable("XCTest",e),t,"XCTest")}return this.testRun.runState}async launchTests(e,t,n,i,s){try{switch(t){case"Run With Test Coverage":await this.runCoverageSession(n,i,s);break;case"Run Tests (Parallel)":await this.runParallelSession(n,i,e);break;default:await this.runStandardSession(n,i,t);break}}catch(o){o===r.CANCELLATION_ERROR?this.testRun.appendOutput(`\r
${o}`):o!==1?this.testRun.appendOutput(`\r
Error: ${hn(o)}`):(this.testRun.testRunStarted(),this.swiftTestOutputParser.close())}finally{n.end()}}async runStandardSession(e,t,n){return new Promise((i,s)=>{let o=t.args??[],a;switch(n){case"Run With Test Coverage":a=" With Code Coverage";break;case"Run Tests (Parallel)":a=" In Parallel";break;case"Debug Tests":a=" For Debugging";break;case"Run Tests (Release Mode)":a=" in Release Mode";break;case"Debug Tests (Release Mode)":a=" For Debugging in Release Mode";break;case"Run Tests":a=""}let u=At(o,`Building and Running Tests${a}`,{cwd:this.folderContext.folder,scope:this.folderContext.workspaceFolder,prefix:this.folderContext.name,presentationOptions:{reveal:Je.TaskRevealKind.Never}},this.folderContext.toolchain,{...process.env,...t.env},{readOnlyTerminal:process.platform!=="win32"});u.execution.onDidWrite(l=>{let f=l.replace("[1/1] Planning build","").replace(/\[1\/1\] Write swift-version-.*/gm,"").replace(/LLVM Profile Error: Failed to write file "default.profraw": Operation not permitted\r\n/gm,"");e.write(f)});let c=this.testRun.token.onCancellationRequested(()=>{u.execution.terminate("SIGINT"),s(r.CANCELLATION_ERROR)});u.execution.onDidClose(l=>{c.dispose(),l?s(l):i()}),this.folderContext.taskQueue.queueOperation(new Er(u),this.testRun.token)})}async runCoverageSession(e,t,n){try{await this.runStandardSession(e,t,"Run With Test Coverage")}catch(i){if(i!==1)throw i}await this.testRun.coverage.captureCoverage(n)}async runParallelSession(e,t,n){await this.workspaceContext.tempFolder.withTemporaryFile("xml",async i=>{let s=[...t.args??[],"--xunit-output",i];try{t.args=await this.runStandardSession(e,{...t,args:s},"Run Tests (Parallel)")}catch(c){if(c!==1)throw c}let o=await SE.readFile(i,"utf8"),u=await new ml(this.folderContext.toolchain.hasMultiLineParallelTestOutput).parse(o,n,this.workspaceContext.outputChannel);u&&this.testRun.appendOutput(`\r
Executed ${u.tests} tests, with ${u.failures} failures and ${u.errors} errors.\r
`)})}async debugSession(e){let t="";try{await this.runStandardSession(new Hh.Writable({write:(a,u,c)=>{t+=a.toString(),c()}}),await ho.buildAll(this.folderContext,!0,$a(this.testKind)),this.testKind)}catch(a){throw e.recordOutput(void 0,t),new Error(`Build failed with exit code ${a}`)}let n=Date.now(),i=[],s=[],o=this.generateFifoPipePath(n);await hi.withNamedTemporaryFiles([o],async()=>{if(this.testArgs.hasSwiftTestingTests){process.platform!=="win32"&&await zt("mkfifo",[o],void 0,this.folderContext);let c=await Ps.setupAttachmentFolder(this.folderContext,n),l=Ba.build(o,c),f=await Hn.swiftTestingConfig(this.folderContext,l,this.testKind,this.testArgs.swiftTestArgs,!0);if(f!==null){if(f.testType="swift-testing",f.preLaunchTask=null,f.name=`Swift Testing: ${f.name}`,K.diagnostics){let d=JSON.stringify(f);this.workspaceContext.outputChannel.logDiagnostic(`swift-testing Debug Config: ${d}`,this.folderContext.name)}s.push(f)}}if(this.testArgs.hasXCTests){let c=await Hn.xcTestConfig(this.folderContext,this.testKind,this.testArgs.xcTestArgs,!0);if(c!==null){if(c.testType="XCTest",c.preLaunchTask=null,c.name=`XCTest: ${c.name}`,K.diagnostics){let l=JSON.stringify(c);this.workspaceContext.outputChannel.logDiagnostic(`XCTest Debug Config: ${l}`,this.folderContext.name)}s.push(c)}}await s.filter(c=>c!==null).map(c=>()=>new Promise((l,f)=>{if(this.testRun.isCancellationRequested){l();return}let d=Je.debug.onDidStartDebugSession(m=>{let D=this.testOutputHandler(c.testType,e);D(`> ${c.program} ${c.args.join(" ")}

\r`),za.setDebugSessionCallback(m,this.workspaceContext.outputChannel,R=>{D(R)});let _=this.testRun.token.onCancellationRequested(()=>{this.workspaceContext.outputChannel.logDiagnostic("Test Debugging Cancelled",this.folderContext.name),Je.debug.stopDebugging(m).then(()=>l())});i.push(_)});i.push(d);let h=Je.debug.onDidTerminateDebugSession(m=>{m.name===c.name&&(this.workspaceContext.outputChannel.logDiagnostic("Stop Test Debugging",this.folderContext.name),i.forEach(D=>D.dispose()),Je.commands.executeCommand("workbench.view.extension.test").then(()=>l()))});i.push(h),Je.debug.startDebugging(this.folderContext.workspaceFolder,c).then(async m=>{m?(c.testType==="swift-testing"?await this.swiftTestOutputParser.watch(o,e):c.testType==="XCTest"&&this.testRun.testRunStarted(),this.workspaceContext.outputChannel.logDiagnostic("Start Test Debugging",this.folderContext.name)):(i.forEach(D=>D.dispose()),f("Debugger not started"))},m=>{i.forEach(D=>D.dispose()),f(m)})})).reduce((c,l)=>c.then(()=>l()),Promise.resolve()),await Ps.cleanupAttachmentFolder(this.folderContext,n,this.workspaceContext.outputChannel)})}testOutputHandler(e,t){let n=!1;switch(e){case"swift-testing":return i=>{i.indexOf("Test run started.")!==-1&&(n=!0),n?this.swiftTestOutputParser.parseStdout(i.toString(),t):this.testRun.appendOutput(i.toString().replace(/\n/g,`\r
`))};case"XCTest":return i=>this.xcTestOutputParser.parseResult(i.toString(),t)}}testOutputWritable(e,t){let n=this.testOutputHandler(e,t);return new Hh.Writable({write:(i,s,o)=>{n(i),o()}})}get testItemFinder(){return process.platform==="darwin"?new Tl(this.testArgs.testItems):new Sl(this.testArgs.testItems,this.folderContext)}generateFifoPipePath(e){return process.platform==="win32"?`\\\\.\\pipe\\vscodemkfifo-${e}`:Rs.join(TE.tmpdir(),`vscodemkfifo-${e}`)}},Tl=class{constructor(e){this.testItems=e}getIndex(e){return this.testItems.findIndex(t=>t.id===e)}},Sl=class{constructor(e,t){this.testItems=e;this.folderContext=t}getIndex(e,t){let n=-1;return t&&(n=this.testItems.findIndex(i=>this.isTestWithFilenameInTarget(e,t,i))),n===-1&&(n=this.testItems.findIndex(i=>i.id.endsWith(e))),n}isTestWithFilenameInTarget(e,t,n){if(!n.id.endsWith(e))return!1;let i=n.parent?.parent;if(!i)return!1;let s=this.folderContext.swiftPackage.currentTargets.find(o=>i.label===o.name);if(s){let o=t,a=Rs.join(this.folderContext.folder.fsPath,s.path),u=Rs.relative(a,o);return s.sources.find(c=>c===u)!==void 0}return!1}},Ja=class{constructor(e){this.testRun=e;this.startTimes=new Map;this.issues=new Map}getTestItemIndex(e,t){return this.testRun.getTestIndex(e,t)}started(e,t){if(this.isUnknownTest(e))return;let n=this.testRun.testItems[e];this.issues.delete(e),this.testRun.started(n),this.currentTestItem=n,this.startTimes.set(e,t)}completed(e,t){if(this.isUnknownTest(e))return;let n=this.testRun.testItems[e],i=this.startTimes.get(e),s;if("timestamp"in t){if(i===void 0)throw Error("Timestamp was provided on test completion, but there was no startTime set when the test was started.");s=(t.timestamp-i)*1e3}else s=t.duration*1e3;let o=n.children.size>0,a=o?this.childrensIssues(n):this.issues.get(e)??[];if(a.length>0){let u=a.filter(({isKnown:c})=>!c);u.length===0?this.testRun.skipped(n):o?this.testRun.failed(n,[],s):this.testRun.failed(n,u.map(({message:c})=>c),s)}else this.testRun.passed(n,s);this.lastTestItem=this.currentTestItem,this.currentTestItem=void 0}childrensIssues(e){let t=this.getTestItemIndex(e.id);return[...this.issues.get(t)??[],...Vi(e.children,(n,i)=>[...n,...this.childrensIssues(i).map(s=>(s.message.message=`${i.label} \u203A ${s.message.message}`,{...s,message:s.message}))],[])]}recordIssue(e,t,n=!1,i,s){if(this.isUnknownTest(e))return;let o=new Je.TestMessage(t);s&&(o.expectedOutput=s.expected,o.actualOutput=s.actual),o.location=i;let a=this.issues.get(e)??[];a.push({message:o,isKnown:n}),this.issues.set(e,a)}skipped(e){this.isUnknownTest(e)||(this.testRun.skipped(this.testRun.testItems[e]),this.lastTestItem=this.currentTestItem,this.currentTestItem=void 0)}isUnknownTest(e){return e<0||e>=this.testRun.testItems.length?(this.testRun.unknownTestRan(),!0):!1}startedSuite(){}passedSuite(e){let t=this.testRun.getTestIndex(e);if(t!==-1)this.testRun.passed(this.testRun.testItems[t]);else{let n=this.lastTestItem?.parent;n&&n.id.endsWith(`.${e}`)&&this.testRun.passed(n)}}failedSuite(e){let t=this.testRun.getTestIndex(e);if(t!==-1)this.testRun.failed(this.testRun.testItems[t],[]);else{let n=this.lastTestItem?.parent;n&&n.id.endsWith(`.${e}`)&&this.testRun.failed(n,[])}}recordOutput(e,t){if(e===void 0||this.isUnknownTest(e)){this.testRun.appendOutput(t);return}let n=this.testRun.testItems[e],{uri:i,range:s}=n,o=i&&s?new Je.Location(i,s):void 0;this.testRun.appendOutputToTest(t,n,o)}};var gf=V(Rr()),ea;(n=>(n.method="textDocument/doccDocumentation",n.messageDirection=gf.MessageDirection.clientToServer,n.type=new gf.RequestType(n.method)))(ea||={});var mf=V(Rr()),by;(n=>(n.method="workspace/getReferenceDocument",n.messageDirection=mf.MessageDirection.clientToServer,n.type=new mf.RequestType(n.method)))(by||={});var Hs=V(Rr()),Fu;(n=>(n.method="workspace/tests",n.messageDirection=Hs.MessageDirection.clientToServer,n.type=new Hs.RequestType0(n.method)))(Fu||={});var Lu;(n=>(n.method="textDocument/tests",n.messageDirection=Hs.MessageDirection.clientToServer,n.type=new Hs.RequestType(n.method)))(Lu||={});var vf=V(Rr()),Cy;(n=>(n.method="sourcekit-lsp/inlayHints",n.messageDirection=vf.MessageDirection.clientToServer,n.type=new vf.RequestType(n.method)))(Cy||={});var wf=V(Rr()),Dy;(n=>(n.method="workspace/peekDocuments",n.messageDirection=wf.MessageDirection.clientToServer,n.type=new wf.RequestType(n.method)))(Dy||={});var yf=V(Rr()),Mu;(n=>(n.method="workspace/triggerReindex",n.messageDirection=yf.MessageDirection.clientToServer,n.type=new yf.RequestType0("workspace/triggerReindex")))(Mu||={});var bf=V(Rr()),Ty;(n=>(n.method="window/logMessage",n.messageDirection=bf.MessageDirection.serverToClient,n.type=new bf.NotificationType(n.method)))(Ty||={});var Cf=V(Rr()),nq;(n=>(n.method="textDocument/symbolInfo",n.messageDirection=Cf.MessageDirection.clientToServer,n.type=new Cf.RequestType(n.method)))(nq||={});var Zn=V(require("vscode")),nt=V(Rr());var ju=V(require("vscode"));var Ef=V(require("vscode")),VR=V(require("path")),Pf=V(Rr());var et=V(require("vscode")),Tf=V(require("fs")),Ey=V(require("path"));var iq=Va(),Sy=(r,e)=>r.range.start.isEqual(e.range.start)&&r.message===e.message,Py=(r,e)=>e(r.source??""),Df=r=>Py(r,Di.isSwiftc),MR=r=>Py(r,Di.isSourcekit),Di=class r{constructor(e){this.diagnosticCollection=et.languages.createDiagnosticCollection("swift");this.allDiagnostics=new Map;this.disposed=!1;this.capitalizeMessage=e=>{let t=e.message;return e={...e},e.message=this.capitalize(t),e};this.cleanMessage=e=>(e={...e},e.message=e.message.replace("(fix available)","").trim(),e);this.onDidChangeConfigurationDisposible=et.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("swift.diagnosticsCollection")&&(this.diagnosticCollection.clear(),this.allDiagnostics.forEach((n,i)=>this.updateDiagnosticsCollection(et.Uri.file(i))))}),this.onDidStartTaskDisposible=et.tasks.onDidStartTask(t=>{let n=t.execution.task;if(n.definition.type!=="swift"||!this.includeSwiftcDiagnostics())return;let i=n.execution;this.parseDiagnostics(i).then(o=>{this.removeSwiftcDiagnostics(),o.forEach((a,u)=>{this.handleDiagnostics(et.Uri.file(u),r.isSwiftc,a)})}).catch(o=>e.outputChannel.log(`${o}`,'Failed to provide "swiftc" diagnostics'))})}static{this.swiftc="swiftc"}static{this.isSourcekit=e=>this.swiftc!==e}static{this.isSwiftc=e=>this.swiftc===e}handleDiagnostics(e,t,n){if(this.disposed)return;let i=!t(r.swiftc);n=n.map(this.capitalizeMessage).map(this.cleanMessage);let s=this.allDiagnostics.get(e.fsPath)?.slice()||[],o=this.removeDiagnostics(s,a=>Py(a,t));i&&(this.removeDiagnostics(o,a=>!!n.find(u=>Sy(a,u))),this.removeDiagnostics(s,a=>Df(a)&&!!o.find(u=>Sy(a,u))));for(let a of n)if(a.code&&typeof a.code!="string"&&typeof a.code!="number"){let u=a.code.target.fsPath,c=!1,l=`https:${Ey.sep}docs.swift.org${Ey.sep}`;if(u.indexOf(l)!==-1){let f=`https://docs.swift.org/${u.split(l).pop()}/`;a.code.target=et.Uri.parse(f.replace(/\\/g,"/")),c=!0}else a.code.target.fsPath.endsWith(".md")&&(c=!0);c&&(a.code={target:et.Uri.parse(`command:swift.openEducationalNote?${encodeURIComponent(JSON.stringify(a.code.target))}`),value:"More Information..."})}s.push(...n),this.allDiagnostics.set(e.fsPath,s),this.updateDiagnosticsCollection(e)}updateDiagnosticsCollection(e){let t=this.allDiagnostics.get(e.fsPath)??[],n=t.filter(Df),i=t.filter(MR),s=[];switch(K.diagnosticsCollection){case"keepSourceKit":s.push(...n),this.mergeDiagnostics(s,i,MR);break;case"keepSwiftc":s.push(...i),this.mergeDiagnostics(s,n,Df);break;case"onlySourceKit":s.push(...i);break;case"onlySwiftc":s.push(...n);break;case"keepAll":s.push(...i),s.push(...n);break}this.diagnosticCollection.set(e,s)}mergeDiagnostics(e,t,n){for(let i of t){let s=e.find(o=>Sy(o,i));if(s&&e.splice(e.indexOf(s),1),n(i)){e.push(i);continue}if(!s||!n(s)){e.push(i);continue}e.push(s)}}removeSwiftcDiagnostics(){this.allDiagnostics.forEach((e,t)=>{let n=e.slice();this.removeDiagnostics(n,Df),e.length!==n.length&&this.allDiagnostics.set(t,n),this.updateDiagnosticsCollection(et.Uri.file(t))})}removeDiagnostics(e,t){let n=[],i=e.length;for(;i--;)t(e[i])&&n.push(...e.splice(i,1));return n}clear(){this.diagnosticCollection.clear(),this.allDiagnostics.clear()}dispose(){this.disposed=!0,this.diagnosticCollection.dispose(),this.onDidStartTaskDisposible.dispose(),this.onDidChangeConfigurationDisposible.dispose()}includeSwiftcDiagnostics(){return K.diagnosticsCollection!=="onlySourceKit"}parseDiagnostics(e){return new Promise(t=>{let n=new Map,i=[],s=()=>{i.forEach(c=>c.dispose()),t(n)},o,a,u=!1;i.push(e.onDidWrite(c=>{let f=((o||"")+iq(c)).split(Tr);o=f.pop();for(let d of f){if(Mc(d)){s();return}let h=this.parseDiagnostic(d);if(!h)continue;if(h instanceof et.DiagnosticRelatedInformation){if(!a)continue;let R=h;if(a.relatedInformation?.find(N=>N.message===R.message&&N.location.uri.fsPath===R.location.uri.fsPath&&N.location.range.isEqual(R.location.range)))continue;if(a.relatedInformation=(a.relatedInformation||[]).concat(R),u){let N=R.location.uri.fsPath,w=n.get(N)||[];a.range=R.location.range,n.set(N,[...w,a]),u=!1}continue}let{uri:m,diagnostic:D}=h,_=n.get(m)||[];if(_.find(R=>R.message===D.message&&R.range.isEqual(D.range))){a=void 0;continue}a=D,this.isValidUri(m)?n.set(m,[..._,D]):u=!0}}),e.onDidClose(s))})}isValidUri(e){try{return Tf.accessSync(e,Tf.constants.F_OK),!0}catch{return!1}}parseDiagnostic(e){let t=/^(?:\S+\s+)?(.*?):(\d+)(?::(\d+))?:\s+(warning|error|note):\s+(.*)$/g,n=/\[(-W|#).*?\]/g,i=t.exec(e);if(!i)return;let s=et.Uri.file(i[1]).fsPath,o=this.capitalize(i[5]).replace(n,"").trim(),a=this.range(i[2],i[3]),u=this.severity(i[4]);if(u===et.DiagnosticSeverity.Information)return new et.DiagnosticRelatedInformation(new et.Location(et.Uri.file(s),a),o);let c=new et.Diagnostic(a,o,u);return c.source=r.swiftc,{uri:s,diagnostic:c}}range(e,t){let n=parseInt(e)-1,i=parseInt(t)-1,s=new et.Position(n,i);return new et.Range(s,s)}severity(e){let t=et.DiagnosticSeverity.Error;switch(e){case"warning":t=et.DiagnosticSeverity.Warning;break;case"note":t=et.DiagnosticSeverity.Information;break;default:break}return t}capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}};var qu=V(require("fs/promises")),ta=V(require("path")),Ut=V(require("vscode")),jR=require("os"),UR=require("child_process"),$R=require("stream");async function xy(r,e=!0){try{let t=await sq(r,e);if(!t)return;let n=ta.join((0,jR.tmpdir)(),`vscode-diagnostics-${gq(new Date)}`);await qu.mkdir(n),await Sf(n,"extension-logs.txt",aq(r));for(let i of r.folders){let s=ta.basename(i.folder.fsPath),o=Math.random().toString(36).substring(2,10);await Sf(n,`${s}-${o}-settings.txt`,uq(i)),t==="Full"&&(await Sf(n,`${s}-${o}-source-code-diagnostics.txt`,cq()),i.toolchain.swiftVersion.isGreaterThanOrEqual(new ve(6,0,0))?await dq(i,n):await Sf(n,`${s}-${o}-sourcekit-lsp.txt`,lq(i))),r.outputChannel.log(`Saved diagnostics to ${n}`),await oq(n)}}catch(t){Ut.window.showErrorMessage(`Unable to capture diagnostic logs: ${t}`)}}async function BR(r){let e="OK",t="Cancel",n=await Ut.window.showInformationMessage("SourceKit-LSP has been restored. Would you like to capture a diagnostic bundle to file an issue?",e,t);if(!(!n||n===t))return await xy(r,!1)}async function sq(r,e){if(r.globalToolchainSwiftVersion.isGreaterThanOrEqual(new ve(6,0,0))||Ut.workspace.getConfiguration("sourcekit-lsp").get("trace.server","off")!=="off"){let t=e?"Capture Full Diagnostics":"Capture Diagnostics",n="Capture Minimal Diagnostics",i=e?[t,n]:[t],s=await Ut.window.showInformationMessage(`A Diagnostic Bundle collects information that helps the developers of the Swift for VS Code extension diagnose and fix issues.

This information contains:
- Extension logs
- Versions of Swift installed on your system
- Crash logs from SourceKit
- Log messages emitted by SourceKit
- If possible, a minimized project that caused SourceKit to crash
- If possible, a minimized project that caused the Swift compiler to crash

All information is collected locally and you can inspect the diagnose bundle before sharing it with developers of the Swift for VS Code extension.

Please file an issue with a description of the problem you are seeing at https://github.com/swiftlang/vscode-swift, and attach this diagnose bundle.`,{modal:!0,detail:e?`If you wish to omit potentially sensitive information choose "${n}"`:void 0},...i);return s?s===t?"Full":"Minimal":void 0}else return"Minimal"}async function oq(r){let e=`Show In ${qR()}`,t="Copy Path to Clipboard",n=await Ut.window.showInformationMessage(`Saved diagnostic logs to ${r}`,e,t);n===t?await Ut.env.clipboard.writeText(r):n===e&&(0,UR.exec)(pq(r),i=>{i&&process.platform!=="win32"&&Ut.window.showErrorMessage(`Failed to open ${qR()}: ${i.message}`)})}async function Sf(r,e,t){t.length!==0&&await qu.writeFile(ta.join(r,e),t)}function aq(r){return r.outputChannel.logs.join(`
`)}function uq(r){let e=JSON.stringify(Ut.workspace.getConfiguration("swift"),null,2);return`${r.toolchain.diagnostics}
Settings:
${e}`}function cq(){let r=e=>`${hq(e.severity)} - ${e.message} [Ln ${e.range.start.line}, Col ${e.range.start.character}]`;return Ut.languages.getDiagnostics().map(([e,t])=>`${e}
	${t.map(r).join(`
	`)}`).join(`
`)}function lq(r){return(r.workspaceContext.languageClientManager.get(r).languageClientOutputChannel?.logs??[]).join(`
`)}async function dq(r,e){let t=ta.join(e,"sourcekit-lsp");await qu.mkdir(t);let n=r.toolchain.getToolchainExecutable("sourcekit-lsp"),s=K.lsp.serverPath,o=s.length>0?s:n;await Ut.window.withProgress({location:Ut.ProgressLocation.Notification},async a=>{a.report({message:"Diagnosing SourceKit-LSP..."});let u=fq(c=>a.report({message:`Diagnosing SourceKit-LSP: ${c}%`}));await Na(o,["diagnose","--bundle-output-path",t,"--toolchain",r.toolchain.toolchainPath],u,u,null,{env:{...process.env,...K.swiftEnvironmentVariables},maxBuffer:16*1024*1024},r??void 0)})}function fq(r){return new $R.Writable({write(e,t,n){let i=e.toString("utf8").trim(),s=/^([0-9])+%/.exec(i);s&&s[1]&&r(s[1]),n()}})}function pq(r){switch(process.platform){case"win32":return`explorer ${r}`;case"darwin":return`open ${r}`;default:return`xdg-open ${r}`}}function qR(){switch(process.platform){case"win32":return"Explorer";case"darwin":return"Finder";default:return"File Manager"}}function hq(r){switch(r){case Ut.DiagnosticSeverity.Error:return"Error";case Ut.DiagnosticSeverity.Warning:return"Warning";case Ut.DiagnosticSeverity.Information:return"Information";case Ut.DiagnosticSeverity.Hint:return"Hint"}}function gq(r){let e=(d,h=2)=>d.toString().padStart(h,"0"),t=r.getFullYear(),n=e(r.getMonth()+1),i=e(r.getDate()),s=e(r.getHours()),o=e(r.getMinutes()),a=e(r.getSeconds()),u=-r.getTimezoneOffset(),c=u>=0?"+":"-",l=e(Math.floor(Math.abs(u)/60)),f=e(Math.abs(u)%60);return`${t}-${n}-${i}T${s}-${o}-${a}${c}${l}-${f}`}var ky=V(require("vscode")),WR={protocol2Code:r=>{if(!r.startsWith("sourcekit-lsp:"))return ky.Uri.parse(r);let e=new URL(r),t=e.protocol;t.endsWith(":")&&(t=t.substring(0,t.length-1));let n=e.username;e.password&&(n+=":"+e.password);let i=e.host;n&&(i=n+"@"+i);let s=e.search;s.startsWith("?")&&(s=s.substring(1));let o=e.hash;return o.startsWith("#")&&(o=o.substring(1)),ky.Uri.from({scheme:t,authority:i,path:e.pathname,query:s,fragment:o})},code2Protocol:r=>{if(r.scheme!=="sourcekit-lsp")return r.toString();let e=new URL(r.scheme+"://"),t,n,i,s=r.authority.indexOf("@");if(s!==-1){t=r.authority.substring(s+1);let u=r.authority.substring(0,s),c=u.indexOf(":");c===-1?(n=u,i=""):(n=u.substring(0,c),i=u.substring(c+1))}else t=r.authority,n="",i="";e.host=t,e.username=n,e.password=i,e.pathname=r.path;let o=r.query;o&&(o="?"+o),e.search=o;let a=r.fragment;return a&&(a="#"+a),e.hash=a,e.toString()}};function mq(r){let e={"workspace/peekDocuments":!0,"workspace/getReferenceDocument":!0,"textDocument/codeLens":{supportedCommands:{"swift.run":"swift.run","swift.debug":"swift.debug"}}};return r.isGreaterThanOrEqual(new ve(6,0,0))&&(K.backgroundIndexing==="on"||K.backgroundIndexing==="auto"&&r.isGreaterThanOrEqual(new ve(6,1,0)))&&(e={...e,backgroundIndexing:!0,backgroundPreparationMode:"enabled"}),r.isGreaterThanOrEqual(new ve(6,1,0))&&(e={...e,"window/didChangeActiveDocument":!0}),K.swiftSDK!==""&&(e={...e,swiftPM:{swiftSDK:K.swiftSDK}}),e}var Ti=class r{static{this.appleLangDocumentSelector=[{scheme:"sourcekit-lsp",language:"swift"},{scheme:"file",language:"swift"},{scheme:"untitled",language:"swift"},{scheme:"file",language:"objective-c"},{scheme:"untitled",language:"objective-c"},{scheme:"file",language:"objective-cpp"},{scheme:"untitled",language:"objective-cpp"}]}static{this.cFamilyDocumentSelector=[{scheme:"file",language:"c"},{scheme:"untitled",language:"c"},{scheme:"file",language:"cpp"},{scheme:"untitled",language:"cpp"}]}static{this.documentationDocumentSelector=[{scheme:"file",language:"markdown"},{scheme:"untitled",language:"markdown"},{scheme:"file",language:"tutorial"},{scheme:"untitiled",language:"tutorial"}]}static{this.miscelaneousDocumentSelector=[{scheme:"file",language:"plaintext",pattern:"**/.swift-version"}]}static sourcekitLSPDocumentTypes(){let e;switch(K.lsp.supportCFamily){case"enable":e=[...r.appleLangDocumentSelector,...r.cFamilyDocumentSelector];break;case"disable":e=r.appleLangDocumentSelector;break;case"cpptools-inactive":e=Ef.extensions.getExtension("ms-vscode.cpptools")?.isActive===!0?r.appleLangDocumentSelector:[...r.appleLangDocumentSelector,...r.cFamilyDocumentSelector]}return e=e.filter(t=>K.lsp.supportedLanguages.includes(t.language)),e.push(...r.documentationDocumentSelector),e}static allHandledDocumentTypes(){return[...this.sourcekitLSPDocumentTypes(),...r.miscelaneousDocumentSelector]}};function HR(r,e,t,n,i,s){return{documentSelector:Ti.sourcekitLSPDocumentTypes(),revealOutputChannelOn:Pf.RevealOutputChannelOn.Never,workspaceFolder:t,outputChannel:new Mi(`SourceKit Language Server (${r.toString()})`),middleware:{didOpen:n.didOpen.bind(n),didClose:n.didClose.bind(n),provideCodeLenses:async(o,a,u)=>(await u(o,a))?.map(l=>{switch(l.command?.command){case"swift.run":l.command.title=`$(play) ${l.command.title}`;break;case"swift.debug":l.command.title=`$(debug) ${l.command.title}`;break}return l}),provideDocumentSymbols:async(o,a,u)=>{let c=await u(o,a),l=c;return s&&l&&s(o,l),c},provideDefinition:async(o,a,u,c)=>{let l=await c(o,a,u),f=l;if(f&&VR.extname(f[0].uri.path)===".swiftinterface"&&f[0].uri.scheme==="file"){let d=f[0].uri.with({scheme:"readonly"});return new Ef.Location(d,f[0].range)}return l},provideInlayHints:async(o,a,u,c)=>{let l=await c(o,a,u);return r.isLessThan(new ve(5,10,0))&&l?.forEach(f=>f.textEdits=void 0),l},provideDiagnostics:async(o,a,u,c)=>{let l=await c(o,a,u);if(l?.kind===Pf.vsdiag.DocumentDiagnosticReportKind.unChanged)return;let f=o;e.diagnostics.handleDiagnostics(f.uri??o,Di.isSourcekit,l?.items??[])},handleDiagnostics:(o,a)=>{e.diagnostics.handleDiagnostics(o,Di.isSourcekit,a)},handleWorkDoneProgress:(()=>{let o=new Date(0).getTime();return async(a,u,c)=>{let l=c(a,u),f=new Date().getTime(),d=60*60*1e3;return f-o>d&&a.toString().startsWith("sourcekitd-crashed")&&(o=f,BR(e)),l}})()},uriConverters:WR,errorHandler:i,initializationFailedHandler:()=>!1,initializationOptions:mq(r)}}var Ry=class{constructor(e){this.client=e}provideInlayHints(e,t,n){if(!K.lsp.inlayHintsEnabled)return null;let i={textDocument:this.client.code2ProtocolConverter.asTextDocumentIdentifier(e),range:{start:t.start,end:t.end}};return this.client.sendRequest(Cy.type,i,n).then(o=>o.map(a=>{let u=a.label,c;switch(a.category){case"type":c=ju.InlayHintKind.Type,u=`: ${u}`;break;case"parameter":c=ju.InlayHintKind.Parameter;break}return{label:u,position:a.position,kind:c,paddingLeft:!0}}),o=>o)}};function KR(r){return ju.languages.registerInlayHintsProvider(Ti.sourcekitLSPDocumentTypes(),new Ry(r))}var on=V(require("vscode"));async function vq(r,e,t){await on.commands.executeCommand("editor.action.peekLocations",r,new on.Position(e.line,e.character!==0?e.character-1:1),[new on.Location(on.Uri.parse(""),new on.Position(0,0))],"peek"),await on.commands.executeCommand("editor.action.peekLocations",r,e,t,"peek")}function XR(r){return r.onRequest(Dy.method,async t=>{let n=r.protocol2CodeConverter.asUri(t.uri),i=new on.Position(t.position.line,t.position.character),s=t.locations.map(o=>new on.Location(r.protocol2CodeConverter.asUri(o),new on.Position(0,0)));return await vq(n,i,s),{success:!0}})}var zR=V(require("vscode")),Uu=class{constructor(e,t=!0,n=!0){this.name=e;this.includeLogLevel=t;this.includeTimestamp=n}get channel(){return this._channel||(this._channel=zR.window.createOutputChannel(this.name)),this._channel}dispose(){this._channel?.dispose(),this._channel=void 0}debug(e){this.logOutputMessage("Debug",e)}info(e){this.logOutputMessage("Info",e)}warn(e){this.logOutputMessage("Warn",e)}error(e){this.logOutputMessage("Error",e)}logOutputMessage(e,t){let n="";this.includeLogLevel&&(n=(n||"[")+e.padEnd(5)),this.includeTimestamp&&(n+=n?" - ":"[",n+=new Date().toLocaleTimeString()),n+=n?"] ":" ",n+=t,this.channel.appendLine(n)}};var GR=V(require("vscode"));function QR(r){return GR.workspace.registerTextDocumentContentProvider("sourcekit-lsp",{provideTextDocumentContent:async(t,n)=>{let i={uri:r.code2ProtocolConverter.asUri(t)},s=await r.sendRequest(by.type,i,n);return s?s.content:"Unable to retrieve reference document"}})}var ZR=V(JR()),ra=class{createLanguageClient(e,t,n,i){return new ZR.LanguageClient(e,t,n,i)}};var _y=V(require("vscode"));var xf=V(Rr()),na;(n=>(n.method="window/didChangeActiveDocument",n.messageDirection=xf.MessageDirection.clientToServer,n.type=new xf.NotificationType(n.method)))(na||={});var kf=class{constructor(){this.openDocuments=new Set;this.lastActiveDocument=null}async didOpen(e,t){this.openDocuments.add(e.uri),await t(e)}async didClose(e,t){this.openDocuments.add(e.uri),await t(e)}activateDidChangeActiveDocument(e){return this.sendNotification(e,_y.window.activeTextEditor?.document),_y.window.onDidChangeActiveTextEditor(t=>{this.sendNotification(e,t?.document)})}sendNotification(e,t){if(ia(e,na.method,1)){let n=t&&this.openDocuments.has(t.uri)?e.code2ProtocolConverter.asTextDocumentIdentifier(t):null;n!==this.lastActiveDocument&&e.sendNotification(na.method,{textDocument:n}),this.lastActiveDocument=n}}};var Rf=class r{constructor(e,t=new ra){this.folderContext=e;this.languageClientFactory=t;this.namedOutputChannels=new Map;this.activeDocumentManager=new kf;this.namedOutputChannels.set(r.indexingLogName,new Uu(r.indexingLogName,!1,!0)),this.swiftVersion=e.swiftVersion,this.singleServerSupport=this.swiftVersion.isGreaterThanOrEqual(new ve(5,7,0)),this.subscriptions=[],this.subFolderWorkspaces=[];let n=Zn.workspace.onDidChangeConfiguration(i=>{if(!i.affectsConfiguration("swift.sourcekit-lsp"))return;let s="Changing SourceKit-LSP settings requires the language server be restarted. Would you like to restart it now?",o="Restart Language Server";if(i.affectsConfiguration("swift.sourcekit-lsp.disable"))if(K.lsp.disable){if(this.state===nt.State.Stopped)return;s=`You have disabled the Swift language server, but it is still running. Would you like to stop it now?
                        This will turn off features such as code completion, error diagnostics, jump-to-definition, and test discovery.`,o="Stop Language Server"}else{if(this.state!==nt.State.Stopped)return;s="You have enabled the Swift language server. Would you like to start it now?",o="Start Language Server"}else if(K.lsp.disable&&this.state===nt.State.Stopped)return;Zn.window.showInformationMessage(s,o).then(a=>{a===o&&this.restart()})});if(this.subscriptions.push(n),this.swiftVersion.isLessThan(new ve(5,6,0))){e.workspaceContext.outputChannel.logDiagnostic("LSP: Adding new/delete file handlers");let i=Zn.workspace.onDidCreateFiles(()=>{this.restart()}),s=Zn.workspace.onDidDeleteFiles(()=>{this.restart()});this.subscriptions.push(i,s)}this.waitingOnRestartCount=0,this.documentSymbolWatcher=void 0,this.cancellationToken=new Zn.CancellationTokenSource}static{this.indexingLogName="SourceKit-LSP: Indexing"}static{this.buildArgumentFilter=[{argument:"--build-path",include:1},{argument:"--scratch-path",include:1},{argument:"-Xswiftc",include:1},{argument:"-Xcc",include:1},{argument:"-Xcxx",include:1},{argument:"-Xlinker",include:1},{argument:"-Xclangd",include:1},{argument:"-index-store-path",include:1}]}get state(){return this.languageClient?this.languageClient.state:nt.State.Stopped}async stop(){this.languageClient&&this.languageClient.state===nt.State.Running&&await this.languageClient.dispose()}dispose(){this.cancellationToken?.cancel(),this.cancellationToken?.dispose(),this.legacyInlayHints?.dispose(),this.peekDocuments?.dispose(),this.getReferenceDocument?.dispose(),this.subscriptions.forEach(e=>e.dispose()),this.namedOutputChannels.forEach(e=>e.dispose())}async useLanguageClient(e){if(!this.languageClient||!this.clientReadyPromise)throw new Error("Language Client Unavailable");return this.clientReadyPromise.then(()=>{if(!this.languageClient||!this.cancellationToken)throw new Error("Language Client Unavailable");return e(this.languageClient,this.cancellationToken.token)},t=>t)}async restart(){await this.setLanguageClientFolder(this.folderContext,!0)}get languageClientOutputChannel(){return this.languageClient?.outputChannel}async addFolder(e){e.isRootFolder||await this.useLanguageClient(async t=>{let n=e.folder;this.subFolderWorkspaces.push(e.folder);let i={uri:t.code2ProtocolConverter.asUri(n),name:an.uriName(n)};await t.sendNotification(nt.DidChangeWorkspaceFoldersNotification.type,{event:{added:[i],removed:[]}})})}async removeFolder(e){e.isRootFolder||await this.useLanguageClient(async t=>{let n=e.folder;this.subFolderWorkspaces=this.subFolderWorkspaces.filter(s=>s!==n);let i={uri:t.code2ProtocolConverter.asUri(n),name:an.uriName(n)};await t.sendNotification(nt.DidChangeWorkspaceFoldersNotification.type,{event:{added:[],removed:[i]}})})}async addSubFolderWorkspaces(e){for(let t of this.subFolderWorkspaces){let n={uri:e.code2ProtocolConverter.asUri(t),name:an.uriName(t)};await e.sendNotification(nt.DidChangeWorkspaceFoldersNotification.type,{event:{added:[n],removed:[]}})}}async setLanguageClientFolder(e,t=!1){let n=e.folder;if(this.languageClient===void 0){this.currentWorkspaceFolder=e,this.restartedPromise=this.setupLanguageClient(e);return}else{if(!this.singleServerSupport&&this.currentWorkspaceFolder?.folder===n&&!t)return;await this.restartLanguageClient(e)}}async restartLanguageClient(e){if(this.waitingOnRestartCount+=1,this.restartedPromise)try{await this.restartedPromise}catch{}if(this.waitingOnRestartCount-=1,this.waitingOnRestartCount!==0)return;let t=this.languageClient;this.languageClient=null,this.currentWorkspaceFolder=e,this.legacyInlayHints?.dispose(),this.legacyInlayHints=void 0,this.peekDocuments?.dispose(),this.peekDocuments=void 0,this.getReferenceDocument?.dispose(),this.getReferenceDocument=void 0,t&&(this.cancellationToken?.cancel(),this.cancellationToken?.dispose(),this.restartedPromise=t.stop().then(async()=>{await this.setupLanguageClient(e),t.outputChannel.dispose()}).catch(async n=>{n.message==="Stopping the server timed out"&&await this.setupLanguageClient(e),this.folderContext.workspaceContext.outputChannel.log(`${n}`)}),await this.restartedPromise)}async setupLanguageClient(e){if(K.lsp.disable){this.languageClient=void 0;return}let{client:t,errorHandler:n}=this.createLSPClient(e);return this.startClient(t,n)}createLSPClient(e){let t=e.toolchain,n=t.getToolchainExecutable("sourcekit-lsp"),i=K.lsp,s=i.serverPath,o=s.length>0?s:n,a=t.buildFlags,u=[...a.swiftDriverSDKFlags(!0),...a.swiftDriverTargetFlags(!0),...Gt.filterArguments(K.buildArguments.concat(a.buildPathFlags()),r.buildArgumentFilter)],c={command:o,args:i.serverArguments.concat(u),options:{env:{...process.env,...K.swiftEnvironmentVariables,...fr()}}};s.length>0&&K.path.length>0&&s!==n&&(c.options={env:{...c.options?.env,SOURCEKIT_TOOLCHAIN_PATH:t.toolchainPath}});let l=c,f;e&&!this.singleServerSupport&&(f={uri:e.folder,name:an.uriName(e.folder),index:0});let d=new Iy(5),h=HR(this.swiftVersion,this.folderContext.workspaceContext,f,this.activeDocumentManager,d,this.documentSymbolWatcher);return{client:this.languageClientFactory.createLanguageClient("swift.sourcekit-lsp",`SourceKit Language Server (${this.folderContext.toolchain.swiftVersion.toString()})`,l,h),errorHandler:d}}async startClient(e,t){let n=new Promise((i,s)=>{let o=e.onDidChangeState(a=>{a.oldState===nt.State.Starting&&a.newState===nt.State.Running?(i(),o.dispose(),this.addSubFolderWorkspaces(e)):a.oldState===nt.State.Starting&&a.newState===nt.State.Stopped&&(s("SourceKit-LSP failed to start"),o.dispose())})});return e.clientOptions.workspaceFolder?this.folderContext.workspaceContext.outputChannel.log(`SourceKit-LSP setup for ${an.uriName(e.clientOptions.workspaceFolder.uri)}`):this.folderContext.workspaceContext.outputChannel.log("SourceKit-LSP setup"),e.onNotification(Ty.type,i=>{this.logMessage(e,i)}),this.clientReadyPromise=e.start().then(()=>n).then(()=>{t.enable(),this.swiftVersion.isLessThan(new ve(5,7,0))&&(this.legacyInlayHints=KR(e)),this.peekDocuments=XR(e),this.getReferenceDocument=QR(e),this.subscriptions.push(this.getReferenceDocument);try{ia(e,na.method,1)&&(this.didChangeActiveDocument=this.activeDocumentManager.activateDidChangeActiveDocument(e),this.subscriptions.push(this.didChangeActiveDocument))}catch{}}).catch(i=>{throw this.folderContext.workspaceContext.outputChannel.log(`${i}`),this.languageClient?.stop(),this.languageClient=void 0,i}),this.languageClient=e,this.cancellationToken=new Zn.CancellationTokenSource,this.clientReadyPromise}logMessage(e,t){let n=e;if(t.logName){let i=this.namedOutputChannels.get(t.logName)??new Uu(t.logName);this.namedOutputChannels.set(t.logName,i),n=i}switch(t.type){case nt.MessageType.Info:n.info(t.message);break;case nt.MessageType.Debug:n.debug(t.message);break;case nt.MessageType.Warning:n.warn(t.message);break;case nt.MessageType.Error:n.error(t.message);break;case nt.MessageType.Log:n.info(t.message);break}}},Iy=class{constructor(e){this.maxRestartCount=e;this.enabled=!1;this.restarts=[]}enable(){this.enabled=!0}error(e,t,n){return n&&n<=3?{action:nt.ErrorAction.Continue}:{action:nt.ErrorAction.Shutdown}}closed(){return this.enabled?(this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:nt.CloseAction.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?new Promise(t=>{Zn.window.showErrorMessage(`The SourceKit-LSP server crashed ${this.maxRestartCount+1} times in the last 3 minutes. See the output for more information. Do you want to restart it again.`,"Yes","No").then(n=>{n==="Yes"?(this.restarts=[],t({action:nt.CloseAction.Restart})):t({action:nt.CloseAction.DoNotRestart})})}):(this.restarts.shift(),{action:nt.CloseAction.Restart})):{action:nt.CloseAction.DoNotRestart,handled:!0}}};function ia(r,e,t){let n=r.initializeResult?.capabilities.experimental;if(!n)throw new Error(`${e} requests not supported`);return(n[e]?.version??-1)>=t}var _f=class{constructor(e){this.languageClient=e}async getDocumentTests(e,t){return await this.languageClient.useLanguageClient(async(n,i)=>{if(ia(n,Lu.method,2)){let s=await n.sendRequest(Lu.type,{textDocument:{uri:t.toString()}},i);return this.transformToTestClass(n,e,s)}else throw new Error(`${Lu.method} requests not supported`)})}async getWorkspaceTests(e){return await this.languageClient.useLanguageClient(async(t,n)=>{if(ia(t,Fu.method,2)){let i=await t.sendRequest(Fu.type,n);return await this.transformToTestClass(t,e,i)}else throw new Error(`${Fu.method} requests not supported`)})}async transformToTestClass(e,t,n){let i=[];for(let s of n){let o=e.protocol2CodeConverter.asLocation(s.location);i=[...i,{...s,id:await this.transformId(s,o,t),children:await this.transformToTestClass(e,t,s.children),location:o}]}return i}async transformId(e,t,n){let i=await n.getTarget(t.uri.fsPath),s=i!==void 0&&!e.id.startsWith(`${i.c99name}.`)?`${i.c99name}.${e.id}`:e.id;return e.style==="XCTest"?s.replace(/\(\)$/,""):s}};function If(r){let e=new Array,t=r.match(/[^\r\n]+/g);if(!t)return e;for(let n of t){let i,s,o="XCTest",a=/^([\w\d_]*)\.([\w\d_]*)\/(.*)$/.exec(n);a&&(i=a[1],s=`${a[2]}/${a[3]}`,o="XCTest");let u=/^([\w\d_]*)\.(.*\(.*\))$/.exec(n);if(u&&(i=u[1],s=u[2],o="swift-testing"),!s||!i)continue;let c=[i,...s.split("/")],l=".";c.reduce(({tests:f,currentId:d},h)=>{let m=d?`${d}${l}${h}`:h;d&&(l="/");let D=m===i?"test-target":o,_=f.find(R=>R.id===m);return _||(_={id:m,label:h,location:void 0,style:o,children:[],disabled:!1,tags:[{id:D}]},f.push(_)),{tests:_.children,currentId:m}},{tests:e,currentId:void 0})}return e}var cs=V(require("vscode"));function e_(r,e,t){let n=new Map,i=e.filter(a=>a.kind===cs.SymbolKind.Class||a.kind===cs.SymbolKind.Namespace).flatMap(a=>{let u=a.children.filter(l=>l.kind===cs.SymbolKind.Method).filter(l=>l.name.match(/^test.*\(\)/)).map(l=>{let f=l.name.indexOf("("),d=l.name;return f&&(d=l.name.slice(0,f)),{name:d,location:new cs.Location(t,l.range)}}),c=a.kind===cs.SymbolKind.Class?new cs.Location(t,a.range):void 0;return n.set(`${r}.${a.name}`,c),u.map(l=>{let f=`${r}.${a.name}/${l.name}`;return n.set(f,l.location),f})}).join(`
`),s=If(i);return t_(s,n)}function t_(r,e){return r.map(t=>({...t,location:e.get(t.id),children:t_(t.children,e)}))}var sa=class r{constructor(e){this.folderContext=e;this.testFileEdited=!0;this.tokenSource=new yr.CancellationTokenSource;this.onTestItemsDidChangeEmitter=new yr.EventEmitter;this.onDidCreateTestRunEmitter=new yr.EventEmitter;this.onTestItemsDidChange=this.onTestItemsDidChangeEmitter.event,this.onCreateTestRun=this.onDidCreateTestRunEmitter.event,this.controller=yr.tests.createTestController(e.name,`${e.name} Tests`),this.controller.resolveHandler=async o=>{o||await this.discoverTestsInWorkspace(this.tokenSource.token)},this.testRunProfiles=bo.setupProfiles(this.controller,this.folderContext,this.onDidCreateTestRunEmitter);let n=e.workspaceContext.languageClientManager.get(e);this.lspTestDiscovery=new _f(n);let i=e.workspaceContext.tasks.onDidEndTaskProcess(o=>{let a=o.execution.task,u=a.execution;a.scope===this.folderContext.workspaceFolder&&a.group===yr.TaskGroup.Build&&u?.options?.cwd===this.folderContext.folder.fsPath&&o.exitCode===0&&a.definition.dontTriggerTestDiscovery!==!0&&this.testFileEdited&&(this.testFileEdited=!1,this.folderContext.swiftPackage.getTargets("test").then(c=>{c.length>0&&this.discoverTestsInWorkspace(this.tokenSource.token)}))}),s=this.folderContext.workspaceContext.onDidChangeSwiftFiles(({uri:o})=>{this.testFileEdited===!1&&this.folderContext.getTestTarget(o).then(a=>{a&&(this.testFileEdited=!0)})});this.subscriptions=[this.tokenSource,s,i,this.controller,this.onTestItemsDidChangeEmitter,this.onDidCreateTestRunEmitter,...this.testRunProfiles,this.onTestItemsDidChange(()=>this.updateSwiftTestContext())]}static{this.errorTestItemId="#Error#"}dispose(){this.controller.refreshHandler=void 0,this.controller.resolveHandler=void 0,this.tokenSource.cancel(),this.subscriptions.forEach(e=>e.dispose())}static observeFolders(e){let t=new yr.CancellationTokenSource,n=e.onDidChangeFolders(({folder:i,operation:s,workspace:o})=>{switch(s){case"add":i&&i.swiftPackage.getTargets("test").then(a=>{a.length!==0&&(i.addTestExplorer(),K.folder(i.workspaceFolder).disableAutoResolve||i.testExplorer?.discoverTestsInWorkspace(t.token))});break;case"packageUpdated":i&&i.swiftPackage.getTargets("test").then(a=>{let u=a.length>0;u&&!i.hasTestExplorer()?(i.addTestExplorer(),K.folder(i.workspaceFolder).disableAutoResolve||i.testExplorer?.discoverTestsInWorkspace(t.token)):!u&&i.hasTestExplorer()?i.removeTestExplorer():i.hasTestExplorer()&&i.refreshTestExplorer()});break;case"focus":if(i){let a=o.languageClientManager.get(i);a.documentSymbolWatcher=(u,c)=>r.onDocumentSymbols(i,u,c)}}});return{dispose:()=>{t.dispose(),n.dispose()}}}updateSwiftTestContext(){let e=Ya(this.controller.items).map(({id:t})=>t);yr.commands.executeCommand("setContext","swift.tests",e).then(()=>{})}static onDocumentSymbols(e,t,n){let i=t?.uri,s=e?.testExplorer;s&&n&&i&&i.scheme==="file"&&Oi(i.fsPath,e.folder.fsPath)&&e.swiftPackage.getTarget(i.fsPath).then(o=>{o&&o.type==="test"&&s.lspTestDiscovery.getDocumentTests(e.swiftPackage,i).then(a=>gE(s.controller,{id:o.c99name,label:o.name},a,i)).catch(()=>{let a=e_(o.name,n,i);s.updateTests(s.controller,a,i)})})}updateTests(e,t,n){wl(e,t,n),this.onTestItemsDidChangeEmitter.fire(e)}async discoverTestsInWorkspace(e){try{await this.discoverTestsInWorkspaceLSP(e)}catch{this.folderContext.workspaceContext.outputChannel.logDiagnostic("workspace/tests LSP request not supported, falling back to SPM to discover tests.","Test Discovery"),await this.discoverTestsInWorkspaceSPM(e)}}async discoverTestsInWorkspaceSPM(e){async function t(n,i){try{let s="OK",o="Enable SourceKit-LSP";i&&K.lsp.disable===!0&&yr.window.showInformationMessage(`swift-testing tests will not be detected since SourceKit-LSP
                            has been disabled for this workspace.`,o,s).then(f=>{f===o?(n.folderContext.workspaceContext.outputChannel.log("Enabling SourceKit-LSP after swift-testing message"),yr.workspace.getConfiguration("swift").update("sourcekit-lsp.disable",!1).then(()=>{})):f===s&&n.folderContext.workspaceContext.outputChannel.log("User acknowledged that SourceKit-LSP is disabled")});let a=n.folderContext.toolchain,u=$i(a);if(process.platform==="darwin"&&K.sanitizer!=="off"){let f=await Wa(n.folderContext);f.definition.dontTriggerTestDiscovery=!0;let d=await n.folderContext.taskQueue.queueOperation(new Er(f));if(d===void 0||d!==0){n.setErrorTestItem("Build the project to enable test discovery.");return}}if(e.isCancellationRequested)return;let c;a.swiftVersion.isGreaterThanOrEqual(new ve(5,8,0))?c=["test","list","--skip-build"]:c=["test","--list-tests","--skip-build"],c=[...c,...u];let l=new wo(c,n.folderContext,"Listing Tests",{showStatusItem:!0,checkAlreadyRunning:!1,log:"Listing tests"},f=>{n.deleteErrorTestItem();let d=If(f);n.updateTests(n.controller,d)});await n.folderContext.taskQueue.queueOperation(l,e)}catch(s){if(i){let o=await Wa(n.folderContext);if(!o)return;try{await n.folderContext.taskQueue.queueOperation(new Er(o))}catch{}await t(n,!1)}else{let o=hn(s);process.platform==="darwin"&&o.match(/error: unableToLoadBundle/)||process.platform==="win32"&&o.match(/The file doesnt exist./)||!["darwin","win32"].includes(process.platform)&&o.match(/No such file or directory/)?n.setErrorTestItem("Build the project to enable test discovery."):o.startsWith("error: no tests found")?n.setErrorTestItem("Add a test target to your Package.","No Tests Found."):n.setErrorTestItem(o),n.folderContext.workspaceContext.outputChannel.log(`Test Discovery Failed: ${o}`,n.folderContext.name)}}}await t(this,!0)}async discoverTestsInWorkspaceLSP(e){let t=await this.lspTestDiscovery.getWorkspaceTests(this.folderContext.swiftPackage);e.isCancellationRequested||(await hE(this.controller,this.folderContext.swiftPackage,t),this.onTestItemsDidChangeEmitter.fire(this.controller))}deleteErrorTestItem(){this.controller.items.delete(r.errorTestItemId),this.onTestItemsDidChangeEmitter.fire(this.controller)}setErrorTestItem(e,t="Test Discovery Error"){if(this.folderContext.workspaceContext.outputChannel.log(`Test Discovery Error: ${e}`),this.controller.items.forEach(n=>{this.controller.items.delete(n.id)}),this.controller.items.size===0){let n=this.controller.createTestItem(r.errorTestItemId,t);n.error=e,this.controller.items.add(n)}this.onTestItemsDidChangeEmitter.fire(this.controller)}};var Oy=V(require("vscode"));var wq=Vp(),Of=class{constructor(e){this.folderContext=e;this.validFileTypes=["swift","c","cpp","h","hpp","m","mm"];this.disposables=[];this.configurationEventDisposable=Oy.workspace.onDidChangeConfiguration(t=>{t.affectsConfiguration("swift.backgroundCompilation",e.folder)&&(K.backgroundCompilation?this.setupFileWatching():this.stopFileWatching())}),K.backgroundCompilation&&this.setupFileWatching()}setupFileWatching(){let e=this.validFileTypes.join(","),t=["Sources","Tests","Snippets","Plugins"].join(",");this.disposables.push(this.workspaceFileWatcher=Oy.workspace.createFileSystemWatcher(`**/{${t}}/**/*.{${e}}`)),this.disposables.push(this.workspaceFileWatcher.onDidChange(wq(()=>{this.runTask()},100,{trailing:!0})))}stopFileWatching(){this.disposables.forEach(e=>e.dispose())}dispose(){this.configurationEventDisposable?.dispose(),this.disposables.forEach(e=>e.dispose())}async runTask(){let e=await Wa(this.folderContext);if(e)try{await this.folderContext.taskQueue.queueOperation(new Er(e))}catch{}}};var an=class r{constructor(e,t,n,i,s,o){this.folder=e;this.toolchain=t;this.linuxMain=n;this.swiftPackage=i;this.workspaceFolder=s;this.workspaceContext=o;this.hasResolveErrors=!1;this.packageWatcher=new jc(this,o),this.backgroundCompilation=new Of(this),this.taskQueue=new Zc(this)}dispose(){this.linuxMain?.dispose(),this.packageWatcher.dispose(),this.testExplorer?.dispose(),this.backgroundCompilation.dispose()}static async create(e,t,n){let i=`Loading Package (${r.uriName(e)})`;n.statusItem.start(i);let s=await Lr.create(e),{linuxMain:o,swiftPackage:a}=await n.statusItem.showStatusWhileRunning(i,async()=>{let l=await sc.create(e),f=await Bc.create(e,s);return{linuxMain:l,swiftPackage:f}});n.statusItem.end(i);let u=new r(e,s,o,a,t,n),c=await a.error;return c&&(r_.window.showErrorMessage(`Failed to load ${u.name}/Package.swift: ${c.message}`),n.outputChannel.log(`Failed to load Package.swift: ${c.message}`,u.name)),await u.packageWatcher.install(),u}get name(){return this.relativePath.length===0?this.workspaceFolder.name:`${this.workspaceFolder.name}/${this.relativePath}`}get relativePath(){return ls.relative(this.workspaceFolder.uri.fsPath,this.folder.fsPath)}get isRootFolder(){return this.workspaceFolder.uri===this.folder}get swiftVersion(){return this.toolchain.swiftVersion}async reload(){await this.swiftPackage.reload(this.toolchain)}async reloadPackageResolved(){await this.swiftPackage.reloadPackageResolved()}async reloadWorkspaceState(){await this.swiftPackage.reloadWorkspaceState()}async loadSwiftPlugins(e){await this.swiftPackage.loadSwiftPlugins(this.toolchain,e)}async fireEvent(e){await this.workspaceContext.fireEvent(this,e)}editedPackageFolder(e){return ls.join(this.folder.fsPath,"Packages",e)}addTestExplorer(){return this.testExplorer===void 0&&(this.testExplorer=new sa(this)),this.testExplorer}removeTestExplorer(){this.testExplorer?.dispose(),this.testExplorer=void 0}refreshTestExplorer(){this.testExplorer?.controller.resolveHandler&&this.testExplorer.controller.resolveHandler(void 0)}hasTestExplorer(){return this.testExplorer!==void 0}static uriName(e){return ls.basename(e.fsPath)}async getTestTarget(e,t){return Oi(e.fsPath,this.folder.fsPath)?(await this.swiftPackage.getTargets(t)).find(s=>{let o=ls.relative(ls.join(this.folder.fsPath,s.path),e.fsPath);return s.sources.find(a=>a===o)!==void 0}):void 0}};var Nf=V(require("vscode")),n_=V(require("path")),$u=class{constructor(e){this.task=e}get name(){if(typeof this.task!="string"){let e=this.task.definition.cwd;return e?`${this.task.name} (${n_.basename(e)})`:this.task.name}else return this.task}},Af=class{constructor(){this.runningTasks=[];this.item=Nf.window.createStatusBarItem(Nf.StatusBarAlignment.Left)}async showStatusWhileRunning(e,t){this.start(e);try{let n=await t();return this.end(e),n}catch(n){throw this.end(e),n}}start(e){if(this.runningTasks.findIndex(n=>n.task===e)!==-1)return;let t=new $u(e);this.runningTasks.push(t),this.showTask(t)}update(e,t){let n=this.runningTasks.find(i=>i.task===e);n&&this.showTask(n,t)}end(e){let t=this.runningTasks.findIndex(n=>n.task===e);if(t!==-1)if(this.runningTasks.splice(t,1),this.runningTasks.length===0)this.hide();else{let n=this.runningTasks[this.runningTasks.length-1];this.showTask(n)}}showTask(e,t){t=t??e.name,typeof e.task!="string"?this.show(`$(loading~spin) ${t}`,t,"workbench.action.tasks.showTasks"):this.show(`$(loading~spin) ${t}`,t)}show(e,t=void 0,n=void 0){this.item.text=e,this.item.accessibilityInformation={label:t??e},this.item.command=n,this.item.show()}hide(){this.item.hide()}dispose(){this.item.dispose()}};var Ff=class{constructor(e,t=new ra){this.subscriptions=[];this.clients=new Map;this.subscriptions.push(e.onDidChangeFolders(async({folder:n,operation:i})=>{await this.handleEvent(n,i,t)}));for(let n of e.folders)this.handleEvent(n,"add",t)}async handleEvent(e,t,n){if(!e)return;let i=e.swiftVersion.isGreaterThanOrEqual(new ve(5,7,0));switch(t){case"add":{let s=await this.create(e,i,n);await(i?s.addFolder(e):s.setLanguageClientFolder(e));break}case"remove":{await(await this.create(e,i,n)).removeFolder(e);break}case"focus":{i||await(await this.create(e,i,n)).setLanguageClientFolder(e);break}}}get(e){return this.getByVersion(e.swiftVersion.toString())}getByVersion(e){let t=this.clients.get(e);if(!t)throw new Error("LanguageClientManager has not yet been created. This is a bug, please file an issue at https://github.com/swiftlang/vscode-swift/issues");return t}async stop(){for(let e of this.clients.values())await e.stop();this.clients.clear()}async create(e,t,n){let i=e.swiftVersion.toString(),s=this.clients.get(i);return s||(s=new Rf(e,n),this.clients.set(i,s),t&&await s.setLanguageClientFolder(e)),s}dispose(){this.subscriptions.forEach(e=>e.dispose())}};var Bu=V(require("vscode")),Lf=class{constructor(e){this.workspaceContext=e;this.taskEndObservers=new Set;this.taskId=0;this.onDidEndTaskProcessDisposible=Bu.tasks.onDidEndTaskProcess(t=>{this.taskEndObservers.forEach(n=>n(t))}),this.onDidEndTaskDisposible=Bu.tasks.onDidEndTask(t=>{this.taskEndObservers.forEach(n=>n({execution:t.execution,exitCode:void 0})),t.execution.task.definition.disableTaskQueue&&this.disableTaskQueue(t.execution.task,!1)}),this.onDidStartTaskDisposible=Bu.tasks.onDidStartTask(t=>{this.taskStartObserver&&this.taskStartObserver(t),t.execution.task.definition.disableTaskQueue&&this.disableTaskQueue(t.execution.task,!0)})}onDidEndTaskProcess(e){return this.taskEndObservers.add(e),{dispose:()=>{this.removeObserver(e)}}}async executeTaskAndWait(e,t){return e.definition.id=this.taskId,this.taskId+=1,new Promise((n,i)=>{this.startingTaskPromise?this.startingTaskPromise.then(()=>this.executeTaskAndResolve(e,n,i,t)):this.executeTaskAndResolve(e,n,i,t)})}executeTaskAndResolve(e,t,n,i){let s=this.onDidEndTaskProcess(o=>{o.execution.task.definition.id===e.definition.id&&(s.dispose(),t(o.exitCode))});this.startingTaskPromise!==void 0&&this.workspaceContext.outputChannel.appendLine("TaskManager: Starting promise should be undefined if we reach here."),this.startingTaskPromise=new Promise(o=>{this.taskStartObserver=()=>{this.taskStartObserver=void 0,this.startingTaskPromise=void 0,o()}}),Bu.tasks.executeTask(e).then(o=>{i?.onCancellationRequested(()=>{o.terminate(),s.dispose(),t(void 0)})},o=>{this.workspaceContext.outputChannel.appendLine(`Error executing task: ${o}`),s.dispose(),this.startingTaskPromise=void 0,n(o)})}removeObserver(e){this.taskEndObservers.delete(e)}disableTaskQueue(e,t){let n=this.workspaceContext.folders.findIndex(i=>i.folder.fsPath===e.definition.cwd);n!==-1&&(this.workspaceContext.folders[n].taskQueue.disabled=t)}dispose(){this.onDidEndTaskDisposible.dispose(),this.onDidEndTaskProcessDisposible.dispose(),this.onDidStartTaskDisposible.dispose()}};var Si=V(require("path")),ei=V(require("vscode")),i_=require("util");async function Ei(r,e={}){if(!e.force&&!K.folder(r.workspaceFolder).autoGenerateLaunchConfigurations)return!1;let t=ei.workspace.getConfiguration("launch",r.folder),n=t.get("configurations")||[],i=[],s=[];for(let a of await yq(r)){let u=n.findIndex(l=>l.name===a.name);if(u===-1){i.push(a);continue}let c=structuredClone(n[u]);bq(c,a,["program","cwd","preLaunchTask","type"]),(0,i_.isDeepStrictEqual)(n[u],c)||s.push({index:u,config:c})}let o=!1;if(i.length>0&&(n.push(...i),o=!0),s.length>0){let a=e.yes?"Update":void 0;if(!a){let c=`The Swift extension would like to update launch configurations '${wT(s.map(l=>l.config.name))}'.`;a=await ei.window.showWarningMessage(`${r.name}: ${c} Do you want to update?`,"Update","Cancel")}a==="Update"&&(s.forEach(u=>n[u.index]=u.config),o=!0)}return o?(await t.update("configurations",n,ei.ConfigurationTarget.WorkspaceFolder),!0):!1}function s_(r,e){let n=ei.workspace.getConfiguration("launch",e.workspaceFolder).get("configurations")||[],{folder:i}=xs(e),s=Si.join(Gt.buildDirectoryFromWorkspacePath(i,!0),"debug",r);return n.find(o=>Si.normalize(o.program)===Si.normalize(s))}async function yq(r){let e=await r.swiftPackage.executableProducts,{folder:t,nameSuffix:n}=xs(r,void 0,"posix"),i=Gt.buildDirectoryFromWorkspacePath(t,!0,"posix");return e.flatMap(s=>{let o={type:Vn,request:"launch",args:[],cwd:t};return[{...o,name:`Debug ${s.name}${n}`,program:Si.posix.join(i,"debug",s.name),preLaunchTask:`swift: Build Debug ${s.name}${n}`},{...o,name:`Release ${s.name}${n}`,program:Si.posix.join(i,"release",s.name),preLaunchTask:`swift: Build Release ${s.name}${n}`}]})}function o_(r,e){let{folder:t}=xs(e),n=Gt.buildDirectoryFromWorkspacePath(t,!0);return{type:Vn,request:"launch",name:`Run ${r}`,program:Si.posix.join(n,"debug",r),args:[],cwd:t,runType:"snippet"}}async function Mf(r,e,t={}){return new Promise((n,i)=>{ei.debug.startDebugging(r,e,t).then(s=>{if(s){let o=ei.debug.onDidTerminateDebugSession(async()=>{o.dispose(),n(!0)})}else n(!1)},s=>{i(s)})})}function bq(r,e,t){for(let n of t){if(e[n]===void 0){delete r[n];continue}r[n]=e[n]}}var Xr=V(require("vscode"));function Dq(){let r=!1,e=!1,t=!1,n=!1,i=!1,s=!1,o,a=!1,u=!1,c=!1,l=!1,f=!1,d=!1;return{updateKeysBasedOnActiveVersion(h){this.createNewProjectAvailable=h.isGreaterThanOrEqual(new ve(5,8,0)),this.switchPlatformAvailable=process.platform==="darwin"?h.isGreaterThanOrEqual(new ve(6,1,0)):!1},get isActivated(){return r},set isActivated(h){r=h,Xr.commands.executeCommand("setContext","swift.isActivated",h).then(()=>{})},get hasPackage(){return e},set hasPackage(h){e=h,Xr.commands.executeCommand("setContext","swift.hasPackage",h).then(()=>{})},get hasExecutableProduct(){return t},set hasExecutableProduct(h){t=h,Xr.commands.executeCommand("setContext","swift.hasExecutableProduct",h).then(()=>{})},get packageHasDependencies(){return i},set packageHasDependencies(h){i=h,Xr.commands.executeCommand("setContext","swift.packageHasDependencies",h).then(()=>{})},get flatDependenciesList(){return n},set flatDependenciesList(h){n=h,Xr.commands.executeCommand("setContext","swift.flatDependenciesList",h).then(()=>{})},get packageHasPlugins(){return s},set packageHasPlugins(h){s=h,Xr.commands.executeCommand("setContext","swift.packageHasPlugins",h).then(()=>{})},get currentTargetType(){return o},set currentTargetType(h){o=h,Xr.commands.executeCommand("setContext","swift.currentTargetType",h??"none").then(()=>{})},get fileIsSnippet(){return a},set fileIsSnippet(h){a=h,Xr.commands.executeCommand("setContext","swift.fileIsSnippet",h).then(()=>{})},get lldbVSCodeAvailable(){return u},set lldbVSCodeAvailable(h){u=h,Xr.commands.executeCommand("setContext","swift.lldbVSCodeAvailable",h).then(()=>{})},get createNewProjectAvailable(){return c},set createNewProjectAvailable(h){c=h,Xr.commands.executeCommand("setContext","swift.createNewProjectAvailable",h).then(()=>{})},get supportsReindexing(){return l},set supportsReindexing(h){l=h,Xr.commands.executeCommand("setContext","swift.supportsReindexing",h).then(()=>{})},get supportsDocumentationLivePreview(){return f},set supportsDocumentationLivePreview(h){f=h,Xr.commands.executeCommand("setContext","swift.supportsDocumentationLivePreview",h).then(()=>{})},get switchPlatformAvailable(){return d},set switchPlatformAvailable(h){d=h,Xr.commands.executeCommand("setContext","swift.switchPlatformAvailable",h).then(()=>{})}}}var Tq=Dq(),Ge=Tq;var qf=V(require("vscode")),jf=V(require("path"));function a_(r){if(!r.currentFolder||!r.currentDocument||r.currentFolder.swiftVersion.isLessThan({major:5,minor:7,patch:0})){Ge.fileIsSnippet=!1;return}let e=r.currentDocument.fsPath,t=jf.join(r.currentFolder.folder.fsPath,"Snippets");e.startsWith(t)?Ge.fileIsSnippet=!0:Ge.fileIsSnippet=!1}async function u_(r,e){return await l_(r,{noDebug:!0},e)}async function c_(r,e){return await l_(r,{},e)}async function l_(r,e,t){let n;if(t)n=t;else if(r.currentDocument)n=jf.basename(r.currentDocument.fsPath,".swift");else return!1;let i=r.currentFolder;if(!i)return!1;let s=At(["build","--product",n],`Build ${n}`,{group:qf.TaskGroup.Build,cwd:i.folder,scope:i.workspaceFolder,presentationOptions:{reveal:qf.TaskRevealKind.Always}},i.toolchain),o=o_(n,i);try{return r.buildStarted(n,o,e),await i.taskQueue.queueOperation(new Er(s)).then(a=>{if(a===0)return Mf(i.workspaceFolder,o,e)}).then(a=>(r.buildFinished(n,o,e),a))}catch(a){return r.outputChannel.appendLine(`Failed to debug snippet: ${a}`),!1}}var un=V(require("vscode"));var Uf=class{constructor(e,t){this.document=e;this.position=t}match(e){let t=this.getLine();if(!t)return null;let n=e.exec(t.text);if(n){let i=n.index+n[0].length;this.position=this.position.translate(void 0,i+t.whitespace);let s=n.map(o=>o);return s.shift(),s}return null}skipUntil(e){let t='{([<"',n='})]>"',i="})]",s=[];for(let o=this.getLine();o;o=this.getLine()){let a=-1,u=0;for(;u<o.text.length;){let c=o.text[u];if(e.indexOf(c)!==-1){let l=s.pop();if(!l)return this.position=this.position.translate(void 0,u+o.whitespace+1),o.text[u];e=l}else if((a=t.indexOf(c))!==-1)s.push(e),e=n[a];else{if(i.indexOf(c)!==-1&&e!=='"')return;c==="\\"&&e==='"'&&(u+=1)}u+=1}this.position=this.position.translate(1,-this.position.character)}}getLine(){for(;this.position.line<this.document.lineCount;){let t=this.document.lineAt(this.position.line).text.substring(this.position.character),n=/^\s*/.exec(t),i=0;if(n&&(i=n[0].length),t.length>i)return{text:t.substring(i),whitespace:i};this.position=this.position.translate(1,-this.position.character)}return null}};var $f=class extends un.CompletionItem{constructor(e,t,n,i){super(t,un.CompletionItemKind.Text),this.detail=n,this.insertText=e,this.sortText=i}},Ay=class{async provideCompletionItems(e,t){return t.line===0||this.isLineComment(e,t.line-1)===!1?void 0:[new $f("/// ","///","Documentation comment")]}isLineComment(e,t){return!!/^\s*\/\/\//.test(e.lineAt(t).text)}},Ny=class{async provideCompletionItems(e,t){if(this.isLineComment(e,t.line)===!1)return;let i=new un.Position(t.line+1,0),s=this.getFunctionDetails(e,i);if(s){if(s.parameters.length===0&&s.returns===!1&&s.throws===!1)return;let o=this.constructSnippet(s,!1);return[new $f(o,"/// - parameters:","Function documentation comment")]}}async insert(e,t){let n=new un.Position(t,0),i=e.document,s=this.getFunctionDetails(i,n);if(s){let o=this.constructSnippet(s,!0),a=new un.Position(t,s.indent);await e.insertSnippet(o,a)}}isLineComment(e,t){return!!/^\s*\/\/\/\s*$/.test(e.lineAt(t).text)}getFunctionDetails(e,t){let n=new Uf(e,t);if(!n.match(/^[^{]*\b(?:func|init)/))return null;let i=n.match(/^([^(<]*)\s*(\(|<)/);if(!i||i[1]==="<"&&(n.skipUntil(">"),!n.match(/^\(/)))return null;let s=[];if(!n.match(/^\)/))for(;;){let u=n.match(/(\S*)(?:\s*)?:/);if(!u)return null;s.push(...u);let c=n.skipUntil(",)");if(!c)return null;if(c===")")break}let o=!1;for(;;){let u=n.match(/^\s*([a-z]+)/);if(!u||u.length===0)break;u[0]==="throws"&&(o=!0,n.match(/^\s*(\(.*\))/))}let a=n.match(/^\s*->/)!==null;return{indent:e.lineAt(t.line).firstNonWhitespaceCharacterIndex,parameters:s,returns:a,throws:o}}constructSnippet(e,t){let n="";t&&(n+="/// "),n+=" $1";let i=2;if(e.parameters.length===1)n+=`
/// - Parameter ${e.parameters[0]}: $${i}`,i++;else if(e.parameters.length>0){n+=`
/// - Parameters:`;for(let s of e.parameters)n+=`
///   - ${s}: $${i}`,i++}return e.throws&&(n+=`
/// - Throws: $${i}`,i++),e.returns&&(n+=`
/// - Returns: $${i}`),t&&(n+=`
`),new un.SnippetString(n)}},Bf=class{constructor(){this.functionCommentCompletion=new Ny,this.functionCommentCompletionProvider=un.languages.registerCompletionItemProvider("swift",this.functionCommentCompletion,"/"),this.commentCompletionProvider=un.languages.registerCompletionItemProvider("swift",new Ay,`
`)}async insert(e,t){await this.functionCommentCompletion.insert(e,t)}dispose(){this.functionCommentCompletionProvider.dispose(),this.commentCompletionProvider.dispose()}};var ti=V(require("vscode"));var Sq=Va(),Wf=class{constructor(e){this.statusItem=e;this.onDidStartTaskDisposible=ti.tasks.onDidStartTask(t=>{K.showBuildStatus&&this.handleTaskStatus(t.execution.task)})}dispose(){this.onDidStartTaskDisposible.dispose()}handleTaskStatus(e){if(e.definition.type!=="swift")return;let t=e.definition.showBuildStatus||K.showBuildStatus;if(t==="never")return;let n=e.execution,i=e.group===ti.TaskGroup.Build,s=[],o=a=>new Promise(u=>{let c=()=>{s.forEach(l=>l.dispose()),u()};s.push(this.outputParser(new $u(e).name,n,i,t,a,c),n.onDidClose(c),ti.tasks.onDidEndTask(l=>{l.execution.task===e&&c()}))});t==="progress"||t==="notification"?ti.window.withProgress({location:t==="progress"?ti.ProgressLocation.Window:ti.ProgressLocation.Notification},a=>o(u=>a.report({message:u}))):this.statusItem.showStatusWhileRunning(e,()=>o(a=>this.statusItem.update(e,a)))}outputParser(e,t,n,i,s,o){let a=!1,u=c=>{let f=Sq(c).split(Tr).reverse();for(let d of f){if(Mc(d))return s(e),!n;let h=this.findBuildProgress(d);if(h)return s(`${e}: [${h.completed}/${h.total}]`),a=!0,!1;if(this.checkIfFetching(d))return s(`${e}: Fetching Dependencies`),a=!0,!1}return!1};return!a&&i!=="never"&&s(`${e}: Preparing...`),t.onDidWrite(c=>{u(c)&&o()})}checkIfFetching(e){return!!/^Fetching\s/gm.exec(e)}findBuildProgress(e){let n=/^\[(\d+)\/(\d+)\]/g.exec(e);if(n)return{completed:parseInt(n[1]),total:parseInt(n[2])}}};var Ly=V(require("vscode"));var kt=V(require("vscode")),m_=V(require("fs/promises")),Pi=V(require("path"));var Wu=V(Rr()),Bq=g_();var Hf=class r{constructor(e,t){this.context=e;this.webviewPanel=t;this.subscriptions=[];this.disposeEmitter=new kt.EventEmitter;this.renderEmitter=new kt.EventEmitter;this.updateContentEmitter=new kt.EventEmitter;this.onDidDispose=this.disposeEmitter.event;this.onDidUpdateContent=this.updateContentEmitter.event;this.onDidRenderContent=this.renderEmitter.event;this.convertDocumentation=Bq(async e=>{let t=e.document;if(t.uri.scheme!=="file"||!["markdown","tutorial","swift"].includes(t.languageId)){this.postMessage({type:"update-content",content:{type:"error",errorMessage:"The active text editor does not support Swift Documentation Live Preview"}});return}let n=this.context.folders.find(s=>t.uri.fsPath.startsWith(s.folder.fsPath));if(!n)return;let i=this.context.languageClientManager.get(n);try{let s=await i.useLanguageClient(async o=>await o.sendRequest(ea.type,{textDocument:{uri:t.uri.toString()},position:e.selection.start}));this.postMessage({type:"update-content",content:{type:"render-node",renderNode:this.parseRenderNode(s.renderNode)}})}catch(s){let o="An internal error occurred",a=`SourceKit-LSP request "${ea.method}" failed: `;if(s instanceof Wu.ResponseError){if(s.code===Wu.LSPErrorCodes.RequestCancelled)return;switch(s.code){case Wu.LSPErrorCodes.RequestFailed:o=s.message;break;default:this.context.outputChannel.log(a+JSON.stringify(s.toJson(),void 0,2));break}}else this.context.outputChannel.log(a+`${s}`);this.postMessage({type:"update-content",content:{type:"error",errorMessage:o}})}},100,{trailing:!0});this.activeTextEditor=kt.window.activeTextEditor,this.subscriptions.push(this.webviewPanel.webview.onDidReceiveMessage(this.receiveMessage,this),kt.window.onDidChangeActiveTextEditor(this.handleActiveTextEditorChange,this),kt.window.onDidChangeTextEditorSelection(this.handleSelectionChange,this),kt.workspace.onDidChangeTextDocument(this.handleDocumentChange,this),this.webviewPanel.onDidDispose(this.dispose,this)),this.reveal()}static async create(e,t){let n=e.asAbsolutePath(Pi.join("assets","swift-docc-render")),i=kt.window.createWebviewPanel("swift.previewDocumentationEditor","Preview Swift Documentation",{viewColumn:kt.ViewColumn.Beside,preserveFocus:!0},{enableScripts:!0,localResourceRoots:[kt.Uri.file(e.asAbsolutePath(Pi.join("node_modules","@vscode/codicons","dist"))),kt.Uri.file(e.asAbsolutePath(Pi.join("assets","documentation-webview"))),kt.Uri.file(n),...t.folders.map(c=>c.folder)]});i.iconPath={light:kt.Uri.file(e.asAbsolutePath(Pi.join("assets","icons","light","swift-documentation.svg"))),dark:kt.Uri.file(e.asAbsolutePath(Pi.join("assets","icons","dark","swift-documentation.svg")))};let s=i.webview.asWebviewUri(kt.Uri.file(n)),o=i.webview.asWebviewUri(kt.Uri.file(e.asAbsolutePath(Pi.join("assets","documentation-webview","index.js")))),a=await m_.readFile(Pi.join(n,"index.html"),"utf-8"),u=i.webview.asWebviewUri(kt.Uri.file(e.asAbsolutePath(Pi.join("node_modules","@vscode/codicons","dist","codicon.css"))));return a=a.replaceAll("{{BASE_PATH}}",s.toString()).replace("</head>",`<link href="${u}" rel="stylesheet" /></head>`).replace("</body>",`<script src="${o.toString()}"></script></body>`),i.webview.html=a,new r(t,i)}reveal(){this.webviewPanel.reveal(void 0,!0)}dispose(){this.subscriptions.forEach(e=>e.dispose()),this.subscriptions=[],this.webviewPanel.dispose(),this.disposeEmitter.fire()}postMessage(e){e.type==="update-content"&&this.updateContentEmitter.fire(e.content),this.webviewPanel.webview.postMessage(e)}receiveMessage(e){switch(e.type){case"loaded":if(!this.activeTextEditor)break;this.convertDocumentation(this.activeTextEditor);break;case"rendered":this.renderEmitter.fire();break}}handleActiveTextEditorChange(e){this.activeTextEditor===e||e===void 0||(this.activeTextEditor=e,this.activeTextEditorSelection=e.selection,this.convertDocumentation(e))}handleSelectionChange(e){this.activeTextEditor!==e.textEditor||this.activeTextEditorSelection===e.textEditor.selection||(this.activeTextEditorSelection=e.textEditor.selection,this.convertDocumentation(e.textEditor))}handleDocumentChange(e){this.activeTextEditor?.document===e.document&&this.convertDocumentation(this.activeTextEditor)}parseRenderNode(e){let t=JSON.parse(e);for(let n of Object.getOwnPropertyNames(t.references)){let i=t.references[n];for(let s of i.variants??[]){let o=kt.Uri.parse(s.url).with({scheme:"file"});s.url=this.webviewPanel.webview.asWebviewUri(o).toString()}}return t}};var Kf=class{constructor(e,t){this.extension=e;this.context=t;this.editorUpdatedContentEmitter=new Ly.EventEmitter;this.editorRenderedEmitter=new Ly.EventEmitter;this.onPreviewDidUpdateContent=this.editorUpdatedContentEmitter.event;this.onPreviewDidRenderContent=this.editorRenderedEmitter.event}async launchDocumentationPreview(){if(!Ge.supportsDocumentationLivePreview)return!1;if(this.previewEditor)this.previewEditor.reveal();else{if(!this.context.currentFolder)return!1;this.previewEditor=await Hf.create(this.extension,this.context);let t=[this.previewEditor.onDidUpdateContent(n=>{this.editorUpdatedContentEmitter.fire(n)}),this.previewEditor.onDidRenderContent(()=>{this.editorRenderedEmitter.fire()}),this.previewEditor.onDidDispose(()=>{t.forEach(n=>n.dispose()),this.previewEditor=void 0})]}return!0}dispose(){this.previewEditor?.dispose()}};var oa=V(require("vscode"));async function v_(r,e,t){let n=[];async function i(s){await My(s.fsPath,e)&&n.push(s),t&&await oa.workspace.fs.readDirectory(s).then(async o=>{for(let a of o)a[1]===oa.FileType.Directory&&a[0][0]!=="."&&a[0]!=="Packages"&&await i(oa.Uri.joinPath(s,a[0]))})}return await i(r),n}async function My(r,e){return!e&&await lr(r,"Package.swift")||await lr(r,"compile_commands.json")||await lr(r,"compile_flags.txt")||await lr(r,"buildServer.json")||await lr(r,"build")||await lr(r,"out")}var ds=V(require("vscode")),w_=V(require("path"));var Xf=class{constructor(e){this.workspaceContext=e}async provideTasks(e){if(this.workspaceContext.folders.length===0)return[];let t=[];for(let n of this.workspaceContext.folders)for(let i of n.swiftPackage.plugins)t.push(this.createSwiftPluginTask(i,n.toolchain,{cwd:n.folder,scope:n.workspaceFolder,presentationOptions:{reveal:ds.TaskRevealKind.Always}}));return t}resolveTask(e,t){let n=this.workspaceContext.currentFolder??this.workspaceContext.folders[0];if(!n)return e;let i=n.toolchain.getToolchainExecutable("swift"),s=["package",...this.pluginArguments(e.definition),e.definition.command,...(e.definition.args??[]).map(cr)];s=n.toolchain.buildFlags.withAdditionalFlags(s);let o=Lc(e,e.definition.cwd),a=new ds.Task(e.definition,e.scope??ds.TaskScope.Workspace,e.name,"swift-plugin",new Ui(i,s,{cwd:o,presentation:e.presentationOptions}),e.problemMatchers);return a.detail=e.detail??`swift ${s.join(" ")}`,a.presentationOptions=e.presentationOptions,a}createSwiftPluginTask(e,t,n){let i=t.getToolchainExecutable("swift"),s=w_.relative(n.scope.uri.fsPath,n.cwd.fsPath),o=s!==""?s:void 0,a=this.getTaskDefinition(e,o),u=["package",...this.pluginArgumentsFromConfiguration(n.scope,a,e),e.command,...a.args];u=t.buildFlags.withAdditionalFlags(u);let c=n?.presentationOptions??{},l=new ds.Task(a,n.scope??ds.TaskScope.Workspace,e.name,"swift-plugin",new Ui(i,u,{cwd:n.cwd.fsPath,env:{...K.swiftEnvironmentVariables,...fr()},presentation:c}),[]),f;return n.prefix?f=`(${n.prefix}) `:f="",l.detail=`${f}swift ${u.join(" ")}`,l.presentationOptions=c,l}getTaskDefinition(e,t){let n={type:"swift-plugin",command:e.command,args:[],disableSandbox:!1,allowWritingToPackageDirectory:!1,cwd:t,disableTaskQueue:!1};switch(`${e.package}, ${e.command}`){case"swift-aws-lambda-runtime, archive":n.disableSandbox=!0,n.disableTaskQueue=!0;break;case"SwiftDocCPlugin, generate-documentation":n.allowWritingToPackageDirectory=!0;break;case"SwiftDocCPlugin, preview-documentation":n.disableSandbox=!0,n.allowWritingToPackageDirectory=!0;break;case"SwiftFormat, swiftformat":n.allowWritingToPackageDirectory=!0;break;case"swift-format, format-source-code":n.allowWritingToPackageDirectory=!0;break;default:break}return n}pluginArgumentsFromConfiguration(e,t,n){let i=K.folder(e),s=i.pluginPermissions(),o=i.pluginPermissions(n.package),a=i.pluginPermissions(`${n.package}:${n.command}`),u=i.pluginArguments(),c=i.pluginArguments(n.package),l=i.pluginArguments(`${n.package}:${n.command}`),f={};return t.disableSandbox&&(f.disableSandbox=!0),t.allowWritingToPackageDirectory&&(f.allowWritingToPackageDirectory=!0),t.allowWritingToDirectory&&(f.allowWritingToDirectory=t.allowWritingToDirectory),t.allowNetworkConnections&&(f.allowNetworkConnections=t.allowNetworkConnections),[...u,...c,...l,...this.pluginArguments({...s,...o,...a,...f})]}pluginArguments(e){let t=[];return e.disableSandbox&&t.push("--disable-sandbox"),e.allowWritingToPackageDirectory&&t.push("--allow-writing-to-package-directory"),e.allowWritingToDirectory&&(Array.isArray(e.allowWritingToDirectory)?t.push("--allow-writing-to-directory",...e.allowWritingToDirectory):t.push("--allow-writing-to-directory")),e.allowNetworkConnections&&(t.push("--allow-network-connections"),t.push(e.allowNetworkConnections)),t}};var Dt=V(require("vscode")),qy=V(require("path"));function y_(r){let e=[],t=Dt.workspace.onDidChangeConfiguration(i=>{i.affectsConfiguration("swift.debugger.disable")&&(e.map(s=>s.dispose()),e=[],K.debugger.disable||n())});function n(){e.push($T()),e.push(Wq(r))}return K.debugger.disable||n(),{dispose:()=>{t.dispose(),e.map(i=>i.dispose())}}}function Wq(r){return Dt.debug.registerDebugConfigurationProvider(Vn,r.launchProvider)}var zf=class{constructor(e,t,n){this.platform=e;this.workspaceContext=t;this.outputChannel=n}async resolveDebugConfigurationWithSubstitutedVariables(e,t){let i=this.workspaceContext.folders.find(o=>o.workspaceFolder.uri.fsPath===e?.uri.fsPath)?.toolchain??this.workspaceContext.globalToolchain;if(this.platform==="win32"&&t.testType===void 0&&qy.extname(t.program)!==".exe"&&qy.extname(t.program)!==".xctest"&&(t.program+=".exe"),"pid"in t){let o=Number.parseInt(t.pid,10);if(isNaN(o))return await Dt.window.showErrorMessage("Failed to launch debug session",{modal:!0,detail:`Invalid process ID: "${t.pid}" is not a valid integer. Please update your launch configuration`},"Configure").then(a=>{if(a==="Configure")return null});t.pid=o}let s=fr(!0);if(s){let o=t.env??{};t.env={...s,existingEnv:o}}if(t.type=Ua.getLaunchConfigType(i.swiftVersion),t.type==="lldb"){if(t.sourceLanguages=["swift"],!Dt.extensions.getExtension("vadimcn.vscode-lldb")&&!await this.promptToInstallCodeLLDB()||!await this.promptForCodeLldbSettings(i))return}else if(t.type==="lldb-dap"){t.env&&(t.env=this.convertEnvironmentVariables(t.env));let o=await Ua.getLLDBDebugAdapterPath(i);if(!await eo(o)){Dt.window.showErrorMessage(`Cannot find the LLDB debug adapter in your Swift toolchain: No such file or directory "${o}"`);return}t.debugAdapterExecutable=o}return zc(t)}async promptToInstallCodeLLDB(){switch(await Dt.window.showErrorMessage("The CodeLLDB extension is required to debug with Swift toolchains prior to Swift 6.0. Please install the extension to continue.",{modal:!0},"Install CodeLLDB","View Extension")){case"Install CodeLLDB":return await Dt.commands.executeCommand("workbench.extensions.installExtension","vadimcn.vscode-lldb"),!0;case"View Extension":return await Dt.commands.executeCommand("workbench.extensions.search","@id:vadimcn.vscode-lldb"),await Dt.commands.executeCommand("workbench.extensions.action.showReleasedVersion","vadimcn.vscode-lldb"),!1;case void 0:return!1}}async promptForCodeLldbSettings(e){let t=await RT(e);if(!t.success){let o=`Error: ${hn(t.failure)}`;return Dt.window.showWarningMessage(`Failed to setup CodeLLDB for debugging of Swift code. Debugging may produce unexpected results. ${o}`),this.outputChannel.log(`Failed to setup CodeLLDB: ${o}`),!0}let n=t.success,i=Dt.workspace.getConfiguration("lldb");if(i.get("library")===n&&i.get("launch.expressions")==="native")return!0;let s;switch(K.debugger.setupCodeLLDB){case"prompt":s=await Dt.window.showInformationMessage("The Swift extension needs to update some CodeLLDB settings to enable debugging features. Do you want to set this up in your global settings or workspace settings?",{modal:!0},"Global","Workspace","Run Anyway");break;case"alwaysUpdateGlobal":s="Global";break;case"alwaysUpdateWorkspace":s="Workspace";break;case"never":s="Run Anyway";break}switch(s){case"Global":await i.update("library",n,Dt.ConfigurationTarget.Global),await i.update("launch.expressions","native",Dt.ConfigurationTarget.Global),await i.update("library",void 0,Dt.ConfigurationTarget.Workspace),await i.update("launch.expressions",void 0,Dt.ConfigurationTarget.Workspace);break;case"Workspace":await i.update("library",n,Dt.ConfigurationTarget.Workspace),await i.update("launch.expressions","native",Dt.ConfigurationTarget.Workspace);break}return!0}convertEnvironmentVariables(e){return Object.entries(e).map(([t,n])=>`${t}=${n}`)}};var Gf=class r{constructor(e,t,n,i){this.tempFolder=t;this.outputChannel=n;this.globalToolchain=i;this.folders=[];this.initialisationFinished=!1;this.testStartEmitter=new it.EventEmitter;this.testFinishEmitter=new it.EventEmitter;this.onDidStartTests=this.testStartEmitter.event;this.onDidFinishTests=this.testFinishEmitter.event;this.buildStartEmitter=new it.EventEmitter;this.buildFinishEmitter=new it.EventEmitter;this.onDidStartBuild=this.buildStartEmitter.event;this.onDidFinishBuild=this.buildFinishEmitter.event;this.observers=new Set;this.swiftFileObservers=new Set;this.statusItem=new Af,this.buildStatus=new Wf(this.statusItem),this.languageClientManager=new Ff(this),this.tasks=new Lf(this),this.diagnostics=new Di(this),this.taskProvider=new qr(this),this.pluginProvider=new Xf(this),this.launchProvider=new zf(process.platform,this,n),this.documentation=new Kf(e,this),this.currentDocument=null,this.commentCompletionProvider=new Bf;let s=it.workspace.onDidChangeConfiguration(async c=>{if(c.affectsConfiguration("swift.runtimePath")){if(!await this.needToAutoGenerateLaunchConfig())return;it.window.showInformationMessage(`Launch configurations need to be updated after changing the Swift runtime path. Custom versions of environment variable '${wh()}' may be overridden. Do you want to update?`,"Update","Cancel").then(async l=>{l==="Update"&&this.folders.forEach(f=>Ei(f,{yes:!0}))})}if(c.affectsConfiguration("swift.buildPath")){if(!await this.needToAutoGenerateLaunchConfig())return;it.window.showInformationMessage("Launch configurations need to be updated after changing the Swift build path. Do you want to update?","Update","Cancel").then(l=>{l==="Update"&&this.folders.forEach(f=>Ei(f,{yes:!0}))})}}),o=this.onDidChangeFolders(c=>{switch(c.operation){case"remove":this.updatePluginContextKey();break;case"focus":this.updateContextKeys(c.folder),this.updateContextKeysForFile();break;case"unfocus":this.updateContextKeys(c.folder);break;case"resolvedUpdated":c.folder===this.currentFolder&&this.updateContextKeys(c.folder)}}),a=this.tasks.onDidEndTaskProcess(c=>{c.execution.task.group===it.TaskGroup.Build&&c.exitCode!==0&&c.exitCode!==void 0&&K.actionAfterBuildError==="Focus Problems"&&it.commands.executeCommand("workbench.panel.markers.view.focus").then(()=>{})}),u=it.workspace.createFileSystemWatcher("**/*.swift");u.onDidCreate(c=>{this.swiftFileObservers.forEach(l=>l({uri:c,operation:"created"}))}),u.onDidChange(c=>{this.swiftFileObservers.forEach(l=>l({uri:c,operation:"changed"}))}),u.onDidDelete(c=>{this.swiftFileObservers.forEach(l=>l({uri:c,operation:"deleted"}))}),this.subscriptions=[u,a,this.commentCompletionProvider,o,s,this.tasks,this.diagnostics,this.documentation,this.languageClientManager,this.outputChannel,this.statusItem,this.buildStatus],this.lastFocusUri=it.window.activeTextEditor?.document.uri,this.setupEventListeners()}async stop(){try{await this.languageClientManager.stop()}catch{}}dispose(){this.folders.forEach(e=>e.dispose()),this.folders.length=0,this.subscriptions.forEach(e=>e.dispose()),this.subscriptions.length=0}get globalToolchainSwiftVersion(){return this.globalToolchain.swiftVersion}static async create(e,t,n){let i=await hi.create();return new r(e,i,t,n)}updateContextKeys(e){if(!e){Ge.hasPackage=!1,Ge.hasExecutableProduct=!1,Ge.packageHasDependencies=!1;return}Promise.all([e.swiftPackage.foundPackage,e.swiftPackage.executableProducts,e.swiftPackage.dependencies]).then(([t,n,i])=>{Ge.hasPackage=t,Ge.hasExecutableProduct=n.length>0,Ge.packageHasDependencies=i.length>0})}async updateContextKeysForFile(){if(this.currentDocument){let e=await this.currentFolder?.swiftPackage.getTarget(this.currentDocument?.fsPath);Ge.currentTargetType=e?.type}else Ge.currentTargetType=void 0;this.currentFolder&&await this.languageClientManager.get(this.currentFolder).useLanguageClient(async t=>{let n=t.initializeResult?.capabilities.experimental;if(!n){Ge.supportsReindexing=!1,Ge.supportsDocumentationLivePreview=!1;return}Ge.supportsReindexing=n[Mu.method]!==void 0,Ge.supportsDocumentationLivePreview=n[ea.method]!==void 0}),a_(this)}updatePluginContextKey(){let e=!1;for(let t of this.folders)if(t.swiftPackage.plugins.length>0){e=!0;break}Ge.packageHasPlugins=e}setupEventListeners(){let e=it.workspace.onDidChangeWorkspaceFolders(n=>{if(this===void 0){console.log("Trying to run onDidChangeWorkspaceFolders on deleted context");return}this.onDidChangeWorkspaceFolders(n)}),t=it.window.onDidChangeActiveTextEditor(async n=>{if(this===void 0){console.log("Trying to run onDidChangeWorkspaceFolders on deleted context");return}await this.focusTextEditor(n)});this.subscriptions.push(e,t)}async addWorkspaceFolders(){if(it.workspace.workspaceFolders&&it.workspace.workspaceFolders.length>0)for(let e of it.workspace.workspaceFolders)await this.addWorkspaceFolder(e);this.currentFolder===void 0&&(this.folders.length===1?await this.focusFolder(this.folders[0]):await this.focusFolder(null)),await this.initialisationComplete()}async fireEvent(e,t){for(let n of this.observers)await n({folder:e,operation:t,workspace:this})}async focusFolder(e){e!==this.currentFolder&&(this.currentFolder!==void 0&&await this.fireEvent(this.currentFolder,"unfocus"),this.currentFolder=e,await this.fireEvent(e,"focus"))}testsFinished(e,t,n){this.testFinishEmitter.fire({kind:t,folder:e,targets:n})}testsStarted(e,t,n){this.testStartEmitter.fire({kind:t,folder:e,targets:n})}buildStarted(e,t,n){this.buildStartEmitter.fire({targetName:e,launchConfig:t,options:n})}buildFinished(e,t,n){this.buildFinishEmitter.fire({targetName:e,launchConfig:t,options:n})}async onDidChangeWorkspaceFolders(e){for(let t of e.added)await this.addWorkspaceFolder(t);for(let t of e.removed)await this.removeWorkspaceFolder(t)}async addWorkspaceFolder(e){let t=await v_(e.uri,K.disableSwiftPMIntegration,K.folder(e).searchSubfoldersForPackages);for(let n of t)await this.addPackageFolder(n,e);this.getActiveWorkspaceFolder(it.window.activeTextEditor)===e&&await this.focusTextEditor(it.window.activeTextEditor)}async addPackageFolder(e,t){let n=this.folders.findIndex(s=>s.folder.fsPath===e.fsPath);if(n!==-1)return this.outputChannel.log(`Adding package folder ${e} twice`,"WARN"),this.folders[n];let i=await an.create(e,t,this);return this.folders.push(i),await this.fireEvent(i,"add"),i}async removeWorkspaceFolder(e){for(let t of this.folders){if(t.workspaceFolder!==e)return;this.currentFolder===t&&await this.focusFolder(null);let n=[...this.observers];n.reverse();for(let i of n)await i({folder:t,operation:"remove",workspace:this});t.dispose()}this.folders=this.folders.filter(t=>t.workspaceFolder!==e)}onDidChangeFolders(e){return this.observers.add(e),{dispose:()=>this.observers.delete(e)}}onDidChangeSwiftFiles(e){return this.swiftFileObservers.add(e),{dispose:()=>this.swiftFileObservers.delete(e)}}async focusTextEditor(e){await this.focusUri(e?.document.uri)}async focusUri(e){this.currentDocument=e??null,await this.updateContextKeysForFile(),(this.currentDocument?.scheme==="file"||this.currentDocument?.scheme==="sourcekit-lsp")&&await this.focusPackageUri(this.currentDocument)}async focusPackageUri(e){let t=await this.getPackageFolder(e);if(t instanceof an)await this.focusFolder(t),this.lastFocusUri=void 0;else if(t instanceof it.Uri)if(this.initialisationFinished===!1)this.lastFocusUri=e;else{let n=it.workspace.getWorkspaceFolder(t);if(!n)return;await this.unfocusCurrentFolder();let i=await this.addPackageFolder(t,n);await this.focusFolder(i)}else await this.focusFolder(null)}async initialisationComplete(){this.initialisationFinished=!0,this.lastFocusUri&&(await this.focusUri(this.lastFocusUri),this.lastFocusUri=void 0)}getWorkspaceFolder(e){return it.workspace.getWorkspaceFolder(e)}getActiveWorkspaceFolder(e){if(!(!e||!e.document))return it.workspace.getWorkspaceFolder(e.document.uri)}async getPackageFolder(e){let t=this.folders.find(a=>Oi(e.fsPath,a.folder.fsPath));if(t)return t;let n=this.getWorkspaceFolder(e);if(!n)return;let i=n.uri.fsPath,s,o=jy.dirname(e.fsPath);for(await this.isValidWorkspaceFolder(o)&&(s=o);o!==i;)o=jy.dirname(o),await this.isValidWorkspaceFolder(o)&&(s=o);if(s)return it.Uri.file(s)}async isValidWorkspaceFolder(e){return await My(e,K.disableSwiftPMIntegration)}async unfocusCurrentFolder(){this.currentFolder!==void 0&&await this.fireEvent(this.currentFolder,"unfocus"),this.currentFolder=void 0}async needToAutoGenerateLaunchConfig(){let e=!1;for(let t of this.folders){let n=K.folder(t.workspaceFolder).autoGenerateLaunchConfigurations&&(await t.swiftPackage.executableProducts).length>0;e=e||n}return e}};var Qf="loading~spin";async function C_(r,e){let t=await ep.readdir(r),n=[],i=K.excludePathsFromPackageDependencies;for(let s of t){if(i.includes(s))continue;let o=b_.join(r,s),a=await ep.stat(o);n.push(new Uy(s,o,a.isDirectory(),e))}return n.sort((s,o)=>s.isDirectory===o.isDirectory?s.name.localeCompare(o.name):s.isDirectory?-1:1)}var ri=class r{constructor(e,t,n){this.dependency=e;this.childDependencies=t;this.parentId=n;this.id=(this.parentId?`${this.parentId}->`:"")+`${this.name}-${this.dependency.version??""}`}get name(){return this.dependency.identity}get location(){return this.dependency.location}get type(){return this.dependency.type}get path(){return this.dependency.path??""}toTreeItem(){let e=new je.TreeItem(this.name,je.TreeItemCollapsibleState.Collapsed);return e.id=this.id,e.description=this.dependency.version,e.iconPath=new je.ThemeIcon(this.icon()),e.contextValue=this.dependency.type,e.accessibilityInformation={label:`Package ${this.name}`},e.tooltip=this.path,e}icon(){return this.dependency.type==="editing"?"edit":this.dependency.type==="local"?"notebook-render-output":"package"}async getChildren(){let[e,t]=await Promise.all([this.childDependencies(this.dependency),C_(this.dependency.path,this.id)]);return[...e.map(i=>new r(i,this.childDependencies,this.id)),...t]}},Uy=class{constructor(e,t,n,i){this.name=e;this.path=t;this.isDirectory=n;this.parentId=i;this.id=(this.parentId?`${this.parentId}->`:"")+`${this.path}`}toTreeItem(){let e=new je.TreeItem(this.name,this.isDirectory?je.TreeItemCollapsibleState.Collapsed:je.TreeItemCollapsibleState.None);return e.id=this.id,e.resourceUri=je.Uri.file(this.path),e.tooltip=this.path,this.isDirectory?e.accessibilityInformation={label:`Folder ${this.name}`}:(e.command={command:"vscode.open",arguments:[e.resourceUri],title:"Open File"},e.accessibilityInformation={label:`File ${this.name}`}),e}async getChildren(){return await C_(this.path,this.id)}},Yf=class{constructor(e,t,n,i){this.type=e;this.id=t;this.name=n;this.active=i}toTreeItem(){let e=new je.TreeItem(this.name,je.TreeItemCollapsibleState.None);return e.id=`${this.type}-${this.id}`,e.iconPath=new je.ThemeIcon(this.active?Qf:"play"),e.contextValue="task",e.accessibilityInformation={label:this.name},e.command={command:"swift.runTask",arguments:[this.name],title:"Run Task"},e}getChildren(){return[]}};function $y(r){return`%test-${r}`}function By(r){return`%snippet-${r}`}var Jf=class{constructor(e,t){this.target=e;this.activeTasks=t}get name(){return this.target.name}get args(){return[this.name]}toTreeItem(){let e=this.target.name,t=this.getChildren().length>0,n=new je.TreeItem(e,t?je.TreeItemCollapsibleState.Expanded:je.TreeItemCollapsibleState.None);return n.id=`${this.target.type}:${e}`,n.iconPath=new je.ThemeIcon(this.icon()),n.contextValue=this.contextValue(),n.accessibilityInformation={label:e},n.tooltip=`${e} (${this.target.type})`,n}icon(){if(this.activeTasks.has(this.name))return Qf;switch(this.target.type){case"executable":return"output";case"library":return"library";case"system-target":return"server";case"binary":return"file-binary";case"plugin":return"plug";case"test":return this.activeTasks.has($y(this.name))?Qf:"test-view-icon";case"snippet":return this.activeTasks.has(By(this.name))?Qf:"notebook"}}contextValue(){switch(this.target.type){case"executable":return"runnable";case"snippet":return"snippet_runnable";case"test":return"test_runnable";default:return}}getChildren(){return[]}},Ks=class{constructor(e,t,n,i){this.id=e;this.name=t;this.icon=n;this._getChildren=i}get path(){return""}toTreeItem(){let e=new je.TreeItem(this.name,je.TreeItemCollapsibleState.Collapsed);return e.id=`${this.id}-${this.name}`,e.iconPath=new je.ThemeIcon(this.icon),e.contextValue="header",e.accessibilityInformation={label:this.name},e}getChildren(){return this._getChildren()}},Wy=class{constructor(e,t){this.name=e;this.folder=t}get path(){return""}toTreeItem(){let e=new je.TreeItem(this.name,je.TreeItemCollapsibleState.None);return e.id=`error-${this.folder.fsPath}`,e.iconPath=new je.ThemeIcon("error",new je.ThemeColor("errorForeground")),e.contextValue="error",e.accessibilityInformation={label:this.name},e.tooltip="Could not build the Package.swift, fix the error to refresh the project panel",e.command={command:"swift.openManifest",arguments:[this.folder],title:"Open Manifest"},e}getChildren(){return Promise.resolve([])}},Zf=class{constructor(e){this.workspaceContext=e;this.didChangeTreeDataEmitter=new je.EventEmitter;this.disposables=[];this.activeTasks=new Set;this.lastComputedNodes=[];this.onDidChangeTreeData=this.didChangeTreeDataEmitter.event;Ge.hasPackage=!1,Ge.hasExecutableProduct=!1,Ge.packageHasDependencies=!1,this.observeTasks(e)}dispose(){this.workspaceObserver?.dispose()}observeTasks(e){this.disposables.push(new Vy(()=>this.didChangeTreeDataEmitter.fire())),this.disposables.push(je.tasks.onDidStartTask(t=>{let n=t.execution.task.detail??t.execution.task.name;this.activeTasks.add(n),this.didChangeTreeDataEmitter.fire()}),je.tasks.onDidEndTask(t=>{let n=t.execution.task.detail??t.execution.task.name;this.activeTasks.delete(n),this.didChangeTreeDataEmitter.fire()}),e.onDidStartBuild(t=>{t.launchConfig.runType==="snippet"?this.activeTasks.add(By(t.targetName)):this.activeTasks.add(t.targetName),this.didChangeTreeDataEmitter.fire()}),e.onDidFinishBuild(t=>{t.launchConfig.runType==="snippet"?this.activeTasks.delete(By(t.targetName)):this.activeTasks.delete(t.targetName),this.didChangeTreeDataEmitter.fire()}),e.onDidStartTests(t=>{for(let n of t.targets)this.activeTasks.add($y(n));this.didChangeTreeDataEmitter.fire()}),e.onDidFinishTests(t=>{for(let n of t.targets)this.activeTasks.delete($y(n));this.didChangeTreeDataEmitter.fire()}))}observeFolders(e){this.workspaceObserver=this.workspaceContext.onDidChangeFolders(({folder:t,operation:n})=>{switch(n){case"focus":if(!t)return;e.title=`Swift Project (${t.name})`,this.didChangeTreeDataEmitter.fire();break;case"unfocus":e.title="Swift Project",this.didChangeTreeDataEmitter.fire();break;case"workspaceStateUpdated":case"resolvedUpdated":case"packageViewUpdated":case"pluginsUpdated":if(!t)return;t===this.workspaceContext.currentFolder&&this.didChangeTreeDataEmitter.fire()}})}getTreeItem(e){return e.toTreeItem()}async getChildren(e){let t=this.workspaceContext.currentFolder;if(!t)return[];if(!e&&t.hasResolveErrors)return[new Wy("Error Parsing Package.swift",t.folder),...this.lastComputedNodes];let n=await this.computeChildren(t,e);return e||(this.lastComputedNodes=n),n}async computeChildren(e,t){if(t)return t.getChildren();let n=await this.dependencies(),i=await this.snippets(),s=await this.commands();return[...n.length>0?[new Ks("dependencies","Dependencies","circuit-board",this.dependencies.bind(this))]:[],new Ks("targets","Targets","book",this.targets.bind(this)),new Ks("tasks","Tasks","debug-continue-small",this.tasks.bind(this,e)),...i.length>0?[new Ks("snippets","Snippets","notebook",()=>Promise.resolve(i))]:[],...s.length>0?[new Ks("commands","Commands","debug-line-by-line",()=>Promise.resolve(s))]:[]]}async dependencies(){let e=this.workspaceContext.currentFolder;if(!e)return[];let t=e.swiftPackage,n=await t.rootDependencies;if(Ge.flatDependenciesList){let i=new Map,s=a=>{let u=[];for(let c of a){i.has(c.identity)||(u.push(c),i.set(c.identity,!0));let l=t.childDependencies(c);u.push(...s(l))}return u};return s(n).map(a=>new ri(a,()=>[]))}else{let i=t.childDependencies.bind(t);return n.map(s=>new ri(s,i))}}async targets(){let e=this.workspaceContext.currentFolder;if(!e)return[];let t=i=>`${i.target.type}-${i.name}`;return(await e.swiftPackage.targets).filter(i=>i.type!=="snippet").map(i=>new Jf(i,this.activeTasks)).sort((i,s)=>t(i).localeCompare(t(s)))}async tasks(e){return(await je.tasks.fetchTasks()).filter(n=>(!n.definition.cwd||n.definition.cwd===e.folder.fsPath)&&n.source!=="swift-plugin").map((n,i)=>new Yf("task",`${n.definition.cwd}-${n.name}-${n.detail??""}-${i}`,n.name,this.activeTasks.has(n.detail??n.name))).sort((n,i)=>n.name.localeCompare(i.name))}async commands(){return(await this.workspaceContext.pluginProvider.provideTasks(new je.CancellationTokenSource().token)).map((n,i)=>new Yf("command",`${n.definition.cwd}-${n.name}-${n.detail??""}-${i}`,n.name,this.activeTasks.has(n.detail??n.name))).sort((n,i)=>n.name.localeCompare(i.name))}async snippets(){let e=this.workspaceContext.currentFolder;return e?(await e.swiftPackage.targets).filter(n=>n.type==="snippet").flatMap(n=>new Jf(n,this.activeTasks)).sort((n,i)=>n.name.localeCompare(i.name)):[]}},Vy=class r{constructor(e){this.onTasksChanged=e;this.previousTasks=[];this.pollTasks()}static{this.POLL_INTERVAL=5e3}async pollTasks(){try{let e=await je.tasks.fetchTasks();(e.length!==this.previousTasks.length||e.some((n,i)=>{let s=this.previousTasks[i],o=n.execution.command,a=s.execution.command;return!s||n.name!==s.name||n.source!==s.source||n.definition.cwd!==s.definition.cwd||n.detail!==s.detail||o!==a}))&&(this.previousTasks=e,this.onTasksChanged())}catch{}this.timeout=setTimeout(()=>this.pollTasks(),r.POLL_INTERVAL)}dispose(){this.timeout&&clearTimeout(this.timeout)}};var Ae=V(require("vscode")),Dn=V(require("path"));async function Vq(){await Ae.env.openExternal(Ae.Uri.parse("https://www.swift.org/install"))&&await qn("The Swift extension must be reloaded once you have downloaded and installed the new toolchain.","Select Toolchain")==="Select Toolchain"&&await Ae.commands.executeCommand("swift.selectToolchain")}async function Hq(){await Ae.env.openExternal(Ae.Uri.parse("https://www.swift.org/install/"))&&await qn("The Swift extension must be reloaded once you have downloaded and installed the new toolchain.","Select Toolchain")==="Select Toolchain"&&await Ae.commands.executeCommand("swift.selectToolchain")}async function Kq(){let r=await Ae.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:"Select the folder containing Swift binaries",openLabel:"Select folder"});!r||r.length!==1||await T_(r[0].fsPath)}async function tp(){let r;K.path?r=await Ae.window.showErrorMessage(`The Swift executable at "${K.path}" either could not be found or failed to launch. Please select a new toolchain.`,"Remove From Settings","Select Toolchain"):r=await Ae.window.showErrorMessage("Unable to automatically discover your Swift toolchain. Either install a toolchain from Swift.org or provide the path to an existing toolchain.","Select Toolchain"),r==="Remove From Settings"?await Gq():r==="Select Toolchain"&&await Ae.commands.executeCommand("swift.selectToolchain")}var aa=class{constructor(e){this.type="separator";this.kind=Ae.QuickPickItemKind.Separator;this.label=e}};async function Xq(r){let e=(await Lr.findXcodeInstalls()).reverse().map(s=>{let o=Dn.join(s,"Contents","Developer","Toolchains","XcodeDefault.xctoolchain","usr");return{type:"toolchain",category:"xcode",label:Dn.basename(s,".app"),detail:s,xcodePath:s,toolchainPath:o,swiftFolderPath:Dn.join(o,"bin")}}),t=(await Lr.getToolchainInstalls()).reverse().map(s=>{let o={type:"toolchain",category:"public",label:Dn.basename(s,".xctoolchain"),detail:s,toolchainPath:Dn.join(s,"usr"),swiftFolderPath:Dn.join(s,"usr","bin")};return o.label==="swift-latest"&&(o.label="Latest Installed Toolchain",o.onDidSelect=async()=>{Ae.window.showInformationMessage(`The Swift extension is now configured to always use the most recently installed toolchain pointed at by the symbolic link "${s}".`)}),o}),n=(await Lr.getSwiftlyToolchainInstalls()).reverse().map(s=>({type:"toolchain",category:"swiftly",label:Dn.basename(s),detail:s,toolchainPath:Dn.join(s,"usr"),swiftFolderPath:Dn.join(s,"usr","bin")}));if(r){let s=[...e,...t,...n].find(o=>o.toolchainPath===r.toolchainPath);s?s.description="$(check) in use":t.splice(0,0,{type:"toolchain",category:"public",label:`Swift ${r.swiftVersion.toString()}`,description:"$(check) in use",detail:r.toolchainPath,toolchainPath:r.toolchainPath,swiftFolderPath:r.swiftFolderPath})}let i=[];return process.platform==="linux"&&i.push({type:"action",label:"$(swift-icon) Install Swiftly for toolchain management...",detail:"Install https://swiftlang.github.io/swiftly to manage your toolchains on Linux",run:Hq}),i.push({type:"action",label:"$(cloud-download) Download from Swift.org...",detail:"Open https://swift.org/install to download and install a toolchain",run:Vq}),i.push({type:"action",label:"$(folder-opened) Select toolchain directory...",detail:"Select a folder on your machine where the Swift toolchain is installed",run:Kq}),[...e.length>0?[new aa("Xcode"),...e]:[],...t.length>0?[new aa("toolchains"),...t]:[],...n.length>0?[new aa("swiftly"),...n]:[],new aa("actions"),...i]}async function D_(r){let e=[],t=await Ae.window.showQuickPick(Xq(r).then(n=>(e=n.filter(i=>"category"in i&&i.category==="xcode").map(i=>i.xcodePath),n)),{title:"Select the Swift toolchain",placeHolder:"Pick a Swift toolchain that VS Code will use",canPickMany:!1});if(t?.type==="action")return await t.run();if(t?.type==="toolchain"){let n;if(process.platform==="darwin"){let s;if(t.category==="xcode")s=t.xcodePath;else if(e.length===1)s=e[0];else if(e.length>1&&(s=await zq(e),!s))return;s&&(n=await Lr.getXcodeDeveloperDir({...process.env,DEVELOPER_DIR:s}))}await T_(t.swiftFolderPath,n)&&t.onDidSelect&&await t.onDidSelect();return}}async function zq(r){return(await Ae.window.showQuickPick(Lr.getXcodeDeveloperDir(K.swiftEnvironmentVariables).then(t=>r.map(n=>{let i={label:Dn.basename(n,".app"),detail:n};return t.startsWith(n)&&(i.description="$(check) in use"),i}).sort((n,i)=>t.startsWith(n.detail??"")?-1:t.startsWith(i.detail??"")?1:n.label.localeCompare(i.label))),{title:"Select a developer directory",placeHolder:"Pick an Xcode installation to use as the developer directory and for the macOS SDK",canPickMany:!1}))?.detail}async function Gq(){let r=Ae.workspace.getConfiguration("swift"),e=r.inspect("swiftEnvironmentVariables");e?.globalValue&&await r.update("swiftEnvironmentVariables",{...e?.globalValue,DEVELOPER_DIR:void 0},Ae.ConfigurationTarget.Global),await r.update("path",void 0,Ae.ConfigurationTarget.Global),e?.workspaceValue&&await r.update("swiftEnvironmentVariables",{...e?.workspaceValue,DEVELOPER_DIR:void 0},Ae.ConfigurationTarget.Workspace),await r.update("path",void 0,Ae.ConfigurationTarget.Workspace)}async function T_(r,e){let t,n=[];if(Ae.workspace.workspaceFolders&&n.push({label:"Workspace Configuration",description:"(Recommended)",detail:"Add to VS Code workspace configuration",target:Ae.ConfigurationTarget.Workspace}),n.push({label:"User Configuration",detail:"Add to VS Code user configuration.",target:Ae.ConfigurationTarget.Global}),n.length>1){let o=await Ae.window.showQuickPick(n,{title:"Toolchain Configuration",placeHolder:"Select a location to update the toolchain selection",canPickMany:!1});if(!o)return!1;t=o.target}else t=Ae.ConfigurationTarget.Global;let i=Ae.workspace.getConfiguration("swift");await i.update("path",r,t);let s=K.swiftEnvironmentVariables;return await i.update("swiftEnvironmentVariables",{...s,DEVELOPER_DIR:e},t),await Qq(t),!0}async function Qq(r){if(r!==Ae.ConfigurationTarget.Global)return;if(Ae.workspace.getConfiguration("swift").inspect("path")?.workspaceValue){if(await Ae.window.showWarningMessage("You already have a Swift path configured in Workspace Settings which takes precedence over User Settings. Would you like to remove the setting from your workspace and use the User Settings instead?","Remove Workspace Setting")!=="Remove Workspace Setting")return;let n=Ae.workspace.getConfiguration("swift"),i=n.inspect("swiftEnvironmentVariables");i?.workspaceValue&&await n.update("swiftEnvironmentVariables",{...i?.workspaceValue,DEVELOPER_DIR:void 0},Ae.ConfigurationTarget.Workspace),await n.update("path",void 0,Ae.ConfigurationTarget.Workspace)}}var S_=V(require("vscode"));async function E_(){await S_.debug.startDebugging(void 0,{type:Vn,request:"attach",name:"Attach",pid:"${command:pickProcess}"})}var fs=V(require("vscode"));async function P_(r){return r.currentFolder?r.languageClientManager.get(r.currentFolder).useLanguageClient(async(t,n)=>{try{await t.sendRequest(Mu.type,n),await fs.window.showWarningMessage("Re-indexing a project should never be necessary and indicates a bug in SourceKit-LSP. Please file an issue describing which symbol was out-of-date and how you got into the state.","Report Issue","Close")==="Report Issue"&&await fs.commands.executeCommand("vscode.open",fs.Uri.parse("https://github.com/swiftlang/sourcekit-lsp/issues/new?template=BUG_REPORT.yml&title=Symbol%20Indexing%20Issue"))}catch(i){let s=i;s.code===-32601?fs.window.showWarningMessage("The installed version of SourceKit-LSP does not support background indexing."):fs.window.showWarningMessage(s.message)}}):void 0}var ua=V(require("vscode"));var Hy=V(require("vscode"));async function cn(r,e,t,n=!1,i=!1){try{return await t.taskQueue.queueOperation(new Er(r,{showStatusItem:!0,checkAlreadyRunning:i,log:e}))===0?!0:(n&&Hy.window.showErrorMessage(`${e} failed`),!1)}catch(s){return n&&Hy.window.showErrorMessage(`${e} failed: ${s}`),!1}}function rp(r,e){let t=e.hasResolveErrors;e.hasResolveErrors=!r,t&&!e.hasResolveErrors&&e.fireEvent("resolvedUpdated")}async function x_(r,e){return await __(r,{noDebug:!0},e)}async function k_(r,e){return await __(r,{},e)}async function R_(r){let e=r.currentFolder;if(e)return await Yq(e)}async function Yq(r){let e=At(["package","clean"],qr.cleanBuildName,{cwd:r.folder,scope:r.workspaceFolder,prefix:r.name,presentationOptions:{reveal:ua.TaskRevealKind.Silent},group:ua.TaskGroup.Clean},r.toolchain);return await cn(e,"Clean Build",r)}async function __(r,e,t){let n=r.currentFolder;if(!n){r.outputChannel.appendLine("debugBuildWithOptions: No current folder on WorkspaceContext");return}let i;if(t)i=(await n.swiftPackage.targets).find(a=>a.name===t);else{let o=ua.window.activeTextEditor?.document.fileName;if(!o){r.outputChannel.appendLine("debugBuildWithOptions: No active text editor");return}i=await n.swiftPackage.getTarget(o)}if(!i){r.outputChannel.appendLine("debugBuildWithOptions: No active target");return}if(i.type!=="executable"){r.outputChannel.appendLine(`debugBuildWithOptions: Target is not an executable, instead is ${i.type}`);return}let s=s_(i.name,n);if(s){r.buildStarted(i.name,s,e);let o=await Mf(n.workspaceFolder,s,e);return r.buildFinished(i.name,s,e),o}}var ni=V(require("vscode")),I_=V(require("path")),np=V(require("fs/promises"));async function O_(r){let e=ni.window.activeTextEditor?.document;if(!e||!r.currentFolder)return;if(process.platform==="win32"&&r.currentFolder.swiftVersion.isLessThan(new ve(5,7,0))){ni.window.showErrorMessage("Run Swift Script is unavailable with the legacy driver on Windows.");return}let t,n=K.scriptSwiftLanguageVersion;if(n==="Ask Every Run"){let a=await ni.window.showQuickPick([{value:"5",label:"Swift 5"},{value:"6",label:"Swift 6"}],{placeHolder:"Select a target Swift version"});if(!a)return;t=a.value}else t=n;let i=e.fileName,s=!1;if(e.isUntitled){s=!0,i=r.tempFolder.filename(e.fileName,"swift");let a=e.getText();await np.writeFile(i,a)}else await e.save();let o=At(["-swift-version",t,i],`Run ${i}`,{scope:ni.TaskScope.Global,cwd:ni.Uri.file(I_.dirname(i)),presentationOptions:{reveal:ni.TaskRevealKind.Always,clear:!0}},r.currentFolder.toolchain);await r.tasks.executeTaskAndWait(o),s&&await np.rm(i)}var A_=V(require("vscode"));async function N_(r,e,t){let n=e.currentFolder;if(!n)return e.outputChannel.log("currentFolder is not set."),!1;let i=t;if(!i){let a=await A_.window.showOpenDialog({canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,defaultUri:n.folder,openLabel:"Select",title:"Select folder"});if(!a)return!1;i=a[0]}let s=At(n.toolchain.buildFlags.withAdditionalFlags(["package","edit","--path",i.fsPath,r]),"Edit Package Dependency",{scope:n.workspaceFolder,cwd:n.folder,prefix:n.name},n.toolchain),o=await cn(s,`Use local version of ${r}`,n,!0);return o&&await e.fireEvent(n,"resolvedUpdated"),o}var Vu=V(require("vscode"));async function F_(r,e){let t=e.currentFolder;if(!t)return;let n=At(["package","edit",r],"Edit Package Dependency",{scope:t.workspaceFolder,cwd:t.folder,prefix:t.name},t.toolchain);if(await cn(n,`edit locally ${r}`,t,!0)){await e.fireEvent(t,"resolvedUpdated");let s=Vu.workspace.workspaceFolders?.length??0;Vu.workspace.updateWorkspaceFolders(s,0,{uri:Vu.Uri.file(t.editedPackageFolder(r)),name:r})}}var Xs=V(require("vscode")),L_=V(require("fs/promises"));async function M_(r,e){let t=e.currentFolder;if(!t)return e.outputChannel.log("currentFolder is not set."),!1;e.outputChannel.log(`unedit dependency ${r}`,t.name);let n=`Reverting edited dependency ${r} (${t.name})`;return await e.statusItem.showStatusWhileRunning(n,async()=>await q_(t,r,e))}async function q_(r,e,t,n=[]){try{let i=new wo(r.toolchain.buildFlags.withAdditionalFlags(["package","unedit",...n,e]),r,`Finish editing ${e}`,{showStatusItem:!0,checkAlreadyRunning:!1,log:"Unedit"},()=>{});await r.taskQueue.queueOperation(i),await t.fireEvent(r,"resolvedUpdated");let s=Xs.workspace.workspaceFolders?.findIndex(o=>o.name===e);if(s)try{await L_.stat(Xs.workspace.workspaceFolders[s].uri.fsPath)}catch{Xs.workspace.updateWorkspaceFolders(s,1)}return!0}catch(i){let s=i;if(s.stderr.match(/has uncommited changes/)){if(await Xs.window.showWarningMessage(`${e} has uncommitted changes. Are you sure you want to continue?`,"Yes","No")==="No")return t.outputChannel.log(s.stderr,r.name),!1;await q_(r,e,t,["--force"])}else t.outputChannel.log(s.stderr,r.name),Xs.window.showErrorMessage(`${s.stderr}`);return!1}}var Hu=V(require("vscode"));async function j_(r){let e=Hu.workspace.workspaceFolders?.length??0;Hu.workspace.updateWorkspaceFolders(e,0,{uri:Hu.Uri.file(r.path),name:r.name})}var ip=V(require("vscode"));function U_(r){try{let e=ip.Uri.parse(r.location,!0);ip.env.openExternal(e)}catch{}}var sp=V(require("vscode"));async function $_(r){let e=await sp.window.showQuickPick([{value:void 0,label:"macOS"},{value:"iOS",label:"iOS"},{value:"tvOS",label:"tvOS"},{value:"watchOS",label:"watchOS"},{value:"xrOS",label:"visionOS"}],{placeHolder:"Select a new target platform"});if(e){let t=`Setting target platform to ${e.label}`;r.statusItem.start(t);try{e.value&&await Lr.getSDKForTarget(e.value);let n=e.value?qc(e.value):"";n!==""?(K.swiftSDK=n,sp.window.showWarningMessage(`Selecting the ${e.label} target platform will provide code editing support, but compiling with a ${e.label} SDK will have undefined results.`)):K.swiftSDK=""}catch{sp.window.showErrorMessage(`Unable set the Swift SDK setting to ${e.label}, verify that the SDK exists`)}r.statusItem.end(t)}}var B_=V(require("vscode"));async function W_(r){let e=B_.window.activeTextEditor;if(!e)return;let t=e.selection.active.line;await r.commentCompletionProvider.insert(e,t)}var ar=V(require("vscode")),op=V(require("fs/promises"));var ca=V(require("vscode")),Ky=class{constructor(){this.progressReportEmitter=new ca.EventEmitter;this.onDidReportProgress=e=>(this.lastProgressReport!==void 0&&e(this.lastProgressReport),this.progressReportEmitter.event(e))}report(e){this.lastProgressReport=e,this.progressReportEmitter.fire(e)}};async function V_(r,e,t){let n=new ca.CancellationTokenSource,i=new Ky,s=[n],o=e(i,n.token),a=setTimeout(()=>{ca.window.withProgress(r,async(u,c)=>{s.push(i.onDidReportProgress(l=>u.report(l))),c.isCancellationRequested&&n.cancel(),c.onCancellationRequested(()=>n.cancel()),await o}).then(void 0,()=>{})},t);s.push({dispose:()=>clearTimeout(a)});try{return await o}finally{for(let u of s)u.dispose()}}async function H_(r){if(!r){tp();return}if(!r.swiftVersion.isGreaterThanOrEqual(new ve(5,8,0))){ar.window.showErrorMessage("Creating a new swift project is only available starting in swift version 5.8.0.");return}let e=await r.getProjectTemplates(),t=await ar.window.showQuickPick(e.map(d=>({label:d.name,description:d.id,detail:d.description,type:d})),{placeHolder:"Select a swift project template"});if(!t)return;let n=t.type.id,i=await ar.window.showOpenDialog({title:"Select a folder to create a new swift project in",openLabel:"Select folder",canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1});if(!i||i.length===0)return;let s=await op.readdir(i[0].fsPath,{encoding:"utf-8"}),o=`swift-${n}`;for(let d=1;s.includes(o);d++)o=`swift-${n}-${d}`;let a=await ar.window.showInputBox({value:o,prompt:"Enter a name for your new swift project",validateInput(d){if(d.trim()==="")return"Project name cannot be empty.";if(d.includes("/")||d.includes("\\"))return"Project name cannot contain '/' or '\\' characters.";if(d==="."||d==="..")return"Project name cannot be '.' or '..'.";if(s.includes(d))return"A file/folder with this name already exists."}});if(a===void 0)return;let u=ar.Uri.joinPath(i[0],a);await op.mkdir(u.fsPath),await V_({location:ar.ProgressLocation.Notification,title:`Creating swift project ${a}`},async()=>{await pn(["package","init","--type",n,"--name",a],r,{cwd:u.fsPath})},1e3);let c=!!ar.workspace.workspaceFolders,l=K.openAfterCreateNewProject,f;if(l==="always"?f="open":l==="alwaysNewWindow"?f="openNewWindow":l==="whenNoFolderOpen"&&!c&&(f="open"),f===void 0){let d=`Would you like to open ${a}?`,h="Open",m="Open in New Window",D=[h,m],_="Add to Workspace";c&&(d=`Would you like to open ${a}, or add it to the current workspace?`,D.push(_));let R=await ar.window.showInformationMessage(d,{modal:!0,detail:"The default action can be configured in settings"},...D);R===h?f="open":R===m?f="openNewWindow":R===_&&(f="addToWorkspace")}if(f==="open")await ar.commands.executeCommand("vscode.openFolder",u,{forceReuseWindow:!0});else if(f==="openNewWindow")await ar.commands.executeCommand("vscode.openFolder",u,{forceNewWindow:!0});else if(f==="addToWorkspace"){let d=ar.workspace.workspaceFolders?.length??0;ar.workspace.updateWorkspaceFolders(d,0,{uri:u})}}var ap=V(require("vscode"));async function K_(r){r?.fsPath.endsWith(".md")?await ap.commands.executeCommand("markdown.showPreviewToSide",r):r!==void 0&&await ap.env.openExternal(r)}var up=V(require("vscode"));async function X_(r,e){let t=await Jq(e,r);t&&await up.window.showTextDocument(t)}async function Jq(r,e){let t=[`Package@swift-${e.major}.${e.minor}.${e.patch}.swift`,`Package@swift-${e.major}.${e.minor}.swift`,`Package@swift-${e.major}.swift`,"Package.swift"].map(n=>up.Uri.joinPath(r,n));for(let n of t)if(await eo(n.fsPath))return n;return null}var z_=V(require("vscode"));async function G_(r){let e=r.currentFolder;return e?await Ku(e):!1}async function Ku(r,e){let t=At(["package","resolve"],qr.resolvePackageName,{cwd:r.folder,scope:r.workspaceFolder,prefix:r.name,presentationOptions:{reveal:z_.TaskRevealKind.Silent}},r.toolchain),n=await cn(t,"Resolving Dependencies",r,!1,e);return rp(n,r),n}var Xu=V(require("vscode"));async function Q_(r){let e=r.currentFolder;if(e)return await Zq(e)}async function Zq(r){let e=At(r.toolchain.buildFlags.withAdditionalFlags(["package","reset"]),"Reset Package Dependencies",{cwd:r.folder,scope:r.workspaceFolder,prefix:r.name,presentationOptions:{reveal:Xu.TaskRevealKind.Silent},group:Xu.TaskGroup.Clean},r.toolchain);return await cn(e,"Reset Package",r).then(async t=>{if(!t)return!1;let n=At(["package","resolve"],qr.resolvePackageName,{cwd:r.folder,scope:r.workspaceFolder,prefix:r.name,presentationOptions:{reveal:Xu.TaskRevealKind.Silent}},r.toolchain);return await cn(n,"Resolving Dependencies",r)},t=>t)}var Y_=V(require("vscode"));async function J_(r){let e=r.currentFolder;return e?await ej(e):(r.outputChannel.log("currentFolder is not set."),!1)}async function ej(r){let e=At(["package","update"],qr.updatePackageName,{cwd:r.folder,scope:r.workspaceFolder,prefix:r.name,presentationOptions:{reveal:Y_.TaskRevealKind.Silent}},r.toolchain),t=await cn(e,"Updating Dependencies",r);return rp(t,r),t}var Z_=V(require("vscode"));async function eI(){await Z_.commands.executeCommand("workbench.action.tasks.runTask",{type:"swift-plugin"})}var ps=V(require("vscode"));async function Xy(r,e,t,n=void 0,i){let s=n;if(s===void 0){let f=await ps.window.showInputBox({prompt:"Label: ",placeHolder:`${t?"Maximum ":""}# of times to run`,validateInput:d=>/^[1-9]\d*$/.test(d)?void 0:"Enter an integer value"});if(!f)return;s=parseInt(f)}if(!r.testExplorer)return;let o=new ps.CancellationTokenSource,a=r.testExplorer,u=new bo("Run Tests",new ps.TestRunRequest([e]),r,a.controller,o.token);a.onDidCreateTestRunEmitter.fire(u.testRun);let c=new Ja(u.testRun);await ps.commands.executeCommand("workbench.panel.testResults.view.focus");let l=[];for(let f=0;f<s;f++){u.setIteration(f),u.testRun.appendOutput(`\x1B[36mBeginning Test Iteration #${f+1}\x1B[0m
`);let d=await(i!==void 0?i():u.runSession(c));if(l.push(d),u.testRun.isCancellationRequested||t&&(d.failed.length>0||d.errored.length>0))break}return await u.testRun.end(),l}var tI=V(require("fs/promises")),cp=V(require("path")),_r=V(require("vscode")),tj="swift",rj=`Untitled.${tj}`;async function rI(r,e=async t=>(await _r.workspace.fs.stat(t)).type===_r.FileType.Directory){if(r){let t=await e(r)?r.fsPath:cp.dirname(r.fsPath),n=_r.Uri.file(cp.join(t,rj)),i=await _r.window.showSaveDialog({defaultUri:n,title:"Enter a file path to be created"});if(!i)return;try{await tI.writeFile(i.fsPath,"","utf-8");let s=await _r.workspace.openTextDocument(i);await _r.languages.setTextDocumentLanguage(s,"swift"),await _r.window.showTextDocument(s)}catch{_r.window.showErrorMessage(`Failed to create ${i.fsPath}`)}}else{let t=await _r.workspace.openTextDocument({language:"swift"});await _r.window.showTextDocument(t)}}var la=V(require("vscode"));async function zu(r,e,t){let n=r.currentFolder?.testExplorer;if(n===void 0)return;let i=n.testRunProfiles.find(a=>a.label===e);if(i===void 0)return;let s=Ya(n.controller.items);if(t){let a=new RegExp(`^${t}(\\.|$)`);s=s.filter(u=>a.test(u.id))}let o=new la.CancellationTokenSource;await i.runHandler(new la.TestRunRequest(s,void 0,i),o.token),await la.commands.executeCommand("testing.showMostRecentOutput")}function zy(r,e){r.currentFolder&&(Ge.flatDependenciesList=e,r.fireEvent(r.currentFolder,"packageViewUpdated"))}var da=V(require("vscode"));var nI=async(r,e)=>{if(!r.currentFolder)return;let n=(await da.tasks.fetchTasks()).find(i=>i.name===e);if(n||(n=(await r.pluginProvider.provideTasks(new da.CancellationTokenSource().token)).find(o=>o.name===e)),!n){da.window.showErrorMessage(`Task "${e}" not found`);return}return r.currentFolder.taskQueue.queueOperation(new Er(n)).then(i=>i===0)};var fp=V(require("path")),aI=V(require("vscode"));var iI=V(require("util")),sI=V(require("child_process"));var nj=iI.promisify(sI.execFile),fa=class{async listAllProcesses(){let e=nj(this.getCommand(),this.getCommandArguments(),{maxBuffer:10485760}),t=this.createParser();return(await e).stdout.split(Tr).flatMap(n=>{let i=t(n.toString());return!i||i.id===e.child.pid?[]:[i]})}};var pa=class extends fa{getCommand(){return"ps"}getCommandArguments(){return["-axo","pid=PID,state=STATE,lstart=START,exe:128=COMMAND,args=ARGUMENTS"]}createParser(){let e,t;return n=>{if(!e||!t){e=n.indexOf("COMMAND"),t=n.indexOf("ARGUMENTS");return}let i=/^\s*([0-9]+)\s+([a-zA-Z<>+]+)\s+/.exec(n);if(!i)return;let s=i[2];if(s.includes("X")||s.includes("Z"))return;let o=n.slice(e,t).trim();if(o!=="-")return{id:Number(i[1]),command:o,arguments:n.slice(t).trim(),start:Date.parse(n.slice(i[0].length,e).trim())}}}};var lp=class extends pa{getCommandArguments(){return["-axo",`pid=PID,state=STATE,lstart=START,comm=${"COMMAND".padEnd(256,"-")},args=ARGUMENTS`]}};var dp=class extends fa{getCommand(){return"PowerShell"}getCommandArguments(){return["-Command",'Get-CimInstance -ClassName Win32_Process | Format-Table ProcessId, @{Label="CreationDate";Expression={"{0:yyyyMddHHmmss}" -f $_.CreationDate}}, CommandLine | Out-String -width 9999']}createParser(){let e=/^([0-9]+)\s+([0-9]+)\s+(.*)$/;return t=>{let n=e.exec(t.trim());if(!n||n.length!==4)return;let i=Number(n[1]),s=Number(n[2]),o=n[3].trim();if(isNaN(i)||!o)return;let a=o;if(o[0]==='"'){let u=o.indexOf('"',1);u>0&&(a=o.slice(1,u))}else{let u=o.indexOf(" ");u>0&&(a=o.slice(0,u))}return{id:i,command:a,arguments:o,start:s}}}};function oI(){switch(process.platform){case"darwin":return new lp;case"win32":return new dp;default:return new pa}}async function uI(r){let e=oI();return(await aI.window.showQuickPick(e.listAllProcesses().then(n=>{if(n.sort((i,s)=>s.start-i.start),typeof r?.program=="string"){let i=r.program,s=fp.basename(i);if(n=n.filter(o=>fp.basename(o.command)===s).sort((o,a)=>{let u=o.command===i?1:0;return(a.command===i?1:0)-u}),n.length===0)return[{label:"No processes matched the debug configuration's program"}]}return n.map(i=>({processId:i.id,label:fp.basename(i.command),description:i.id.toString(),detail:i.arguments}))}),{placeHolder:"Select a process to attach the debugger to",matchOnDetail:!0,matchOnDescription:!0}))?.processId?.toString()}var pp=V(require("vscode"));async function cI(){return await pp.env.openExternal(pp.Uri.parse("https://docs.swift.org/vscode/documentation/userdocs"))}var lI=V(require("vscode"));async function Qy(r){let e=ij(r);if(e.length===0)return;if(e.length===1)return Gy(r,e[0].label);e=[...e,{label:"All",description:"Restart all sourcekit-lsp instances",detail:e.map(n=>n.detail).join(", ")}];let t=await lI.window.showQuickPick(e,{title:"Restart LSP server",placeHolder:"Select a sourcekit-lsp instance to restart",canPickMany:!1});if(t)if(t.label==="All"){let n=e.slice(0,-1);for(let i of n)return Gy(r,i.label)}else return Gy(r,t.label)}function ij(r){let e=r.folders.reduce((t,n)=>(t[n.swiftVersion.toString()]=t[n.swiftVersion.toString()]??[],t[n.swiftVersion.toString()].push({folder:n,fullToolchainName:n.toolchain.swiftVersionString}),t),{});return Object.keys(e).map(t=>({label:t,description:e[t][0].fullToolchainName,detail:e[t].map(({folder:n})=>n.name).join(", ")}))}async function Gy(r,e){await r.languageClientManager.getByVersion(e).restart()}var dI=V(require("vscode"));async function fI(r){if(r.folders.length===0)return!1;if(r.folders.length===1)return await Ei(r.folders[0],{force:!0,yes:!0});let e=r.folders.map(i=>({type:"folder",folder:i,label:i.name,detail:i.workspaceFolder.uri.fsPath}));e.push({type:"all",label:"Generate For All Folders"});let t=await dI.window.showQuickPick(e,{matchOnDetail:!0,placeHolder:"Select a folder to generate launch configurations for"});if(!t)return!1;let n=[];return t.type==="all"?n.push(...r.folders):n.push(t.folder),(await Promise.all(n.map(i=>Ei(i,{force:!0,yes:!0})))).reduceRight((i,s)=>i||s)}function hI(r){return[De.commands.registerCommand("swift.createNewProject",()=>H_(r)),De.commands.registerCommand("swift.selectToolchain",()=>D_(r)),De.commands.registerCommand("swift.pickProcess",e=>uI(e))]}function gI(r){return[De.commands.registerCommand("swift.generateLaunchConfigurations",async()=>await fI(r)),De.commands.registerCommand("swift.newFile",async e=>await rI(e)),De.commands.registerCommand("swift.resolveDependencies",async()=>await G_(r)),De.commands.registerCommand("swift.updateDependencies",async()=>await J_(r)),De.commands.registerCommand("swift.run",async e=>await x_(r,...hs(e))),De.commands.registerCommand("swift.debug",async e=>await k_(r,...hs(e))),De.commands.registerCommand("swift.cleanBuild",async()=>await R_(r)),De.commands.registerCommand("swift.runTestsMultipleTimes",async(e,t)=>{if(r.currentFolder)return await Xy(r.currentFolder,e,!1,t)}),De.commands.registerCommand("swift.runTestsUntilFailure",async(e,t)=>{if(r.currentFolder)return await Xy(r.currentFolder,e,!0,t)}),De.commands.registerCommand("swift.switchPlatform",async()=>await $_(r)),De.commands.registerCommand("swift.resetPackage",async()=>await Q_(r)),De.commands.registerCommand("swift.runScript",async()=>await O_(r)),De.commands.registerCommand("swift.openPackage",async()=>{if(r.currentFolder)return await X_(r.currentFolder.swiftVersion,r.currentFolder.folder)}),De.commands.registerCommand("swift.runSnippet",async e=>await u_(r,...hs(e))),De.commands.registerCommand("swift.debugSnippet",async e=>await c_(r,...hs(e))),De.commands.registerCommand("swift.runPluginTask",async()=>await eI()),De.commands.registerCommand("swift.runTask",async e=>await nI(r,e)),De.commands.registerCommand("swift.restartLSPServer",async()=>await Qy(r)),De.commands.registerCommand("swift.reindexProject",async()=>await P_(r)),De.commands.registerCommand("swift.insertFunctionComment",async()=>await W_(r)),De.commands.registerCommand("swift.useLocalDependency",async(e,t)=>{if(e instanceof ri)return await N_(e.name,r,t)}),De.commands.registerCommand("swift.editDependency",async e=>{if(e instanceof ri)return await F_(e.name,r)}),De.commands.registerCommand("swift.uneditDependency",async e=>{if(e instanceof ri)return await M_(e.name,r)}),De.commands.registerCommand("swift.openInWorkspace",async e=>{if(e instanceof ri)return await j_(e)}),De.commands.registerCommand("swift.openExternal",e=>{if(e instanceof ri)return U_(e)}),De.commands.registerCommand("swift.attachDebugger",E_),De.commands.registerCommand("swift.clearDiagnosticsCollection",()=>r.diagnostics.clear()),De.commands.registerCommand("swift.captureDiagnostics",async()=>await xy(r)),De.commands.registerCommand("swift.runAllTestsParallel",async e=>await zu(r,"Run Tests (Parallel)",...hs(e))),De.commands.registerCommand("swift.runAllTests",async e=>await zu(r,"Run Tests",...hs(e))),De.commands.registerCommand("swift.debugAllTests",async e=>await zu(r,"Debug Tests",...hs(e))),De.commands.registerCommand("swift.coverAllTests",async e=>await zu(r,"Run With Test Coverage",...hs(e))),De.commands.registerCommand("swift.previewDocumentation",async()=>await r.documentation.launchDocumentationPreview()),De.commands.registerCommand("swift.flatDependenciesList",()=>zy(r,!0)),De.commands.registerCommand("swift.nestedDependenciesList",()=>zy(r,!1)),De.commands.registerCommand("swift.openEducationalNote",e=>K_(e)),De.commands.registerCommand("swift.openManifest",async e=>{let t=pI.join(e.fsPath,"Package.swift");await De.commands.executeCommand("vscode.open",De.Uri.file(t))}),De.commands.registerCommand("swift.openDocumentation",()=>cI())]}function hs(r){return typeof r=="object"&&r!==null&&"args"in r?r.args??[]:typeof r=="string"?[r]:[]}var Yy=V(require("vscode")),mI=V(Rr());var hp=class{constructor(e){let t=Yy.languages.createLanguageStatusItem("swiftlang-version",Ti.allHandledDocumentTypes()),n=e.currentFolder?.toolchain??e.globalToolchain;t.text=n.swiftVersionString,t.accessibilityInformation={label:`Swift Version ${n.swiftVersion.toString()}`};let i=Yy.languages.createLanguageStatusItem("swiftlang-package",[...Ti.appleLangDocumentSelector,...Ti.cFamilyDocumentSelector]);i.text="No Package.swift",i.accessibilityInformation={label:"There is no Package.swift"};let s=e.onDidChangeFolders(async({folder:o,operation:a})=>{switch(a){case"focus":o&&await o.swiftPackage.foundPackage?(i.text="Package.swift",i.command=mI.Command.create("Open Package","swift.openPackage"),i.accessibilityInformation={label:"Open Package.swift"},t.text=o.toolchain.swiftVersionString,t.accessibilityInformation={label:`Swift Version ${o.toolchain.swiftVersion.toString()}`}):(i.text="No Package.swift",i.accessibilityInformation={label:"There is no Package.swift"},i.command=void 0,t.text=e.globalToolchain.swiftVersionString,t.accessibilityInformation={label:`Swift Version ${e.globalToolchain.swiftVersion.toString()}`})}});this.subscriptions=[s,t,i]}dispose(){this.subscriptions.forEach(e=>e.dispose())}};var vI=V(require("vscode")),wI=V(require("fs/promises"));function yI(){return vI.workspace.registerTextDocumentContentProvider("readonly",{provideTextDocumentContent:async e=>{try{return await wI.readFile(e.fsPath,"utf8")}catch{return`Failed to load swiftinterface ${e.path}`}}})}var gp=V(require("fs/promises"));var ha=V(require("vscode"));function bI(r){process.platform==="win32"&&K.warnAboutSymlinkCreation&&oj(r).then(async e=>{if(e)return;let t=await ha.window.showWarningMessage("The Swift extension is unable to create symbolic links on your system and some features may not work correctly. Please either enable Developer Mode or allow symlink creation via Windows privileges.","Learn More","Don't Show Again");if(t==="Learn More")return ha.env.openExternal(ha.Uri.parse("https://learn.microsoft.com/en-us/windows/apps/get-started/enable-your-device-for-development"));t==="Don't Show Again"&&(K.warnAboutSymlinkCreation=!1)})}async function oj(r){let e=await hi.create();return await e.withTemporaryFile("",async t=>{let n=e.filename("symlink-");try{return await gp.symlink(t,n,"file"),await gp.unlink(n),!0}catch(i){return r?.log(`${i}`),!1}})}var xi=V(require("vscode"));var CI=process.platform==="win32"?";":":",mp=class{constructor(e){this.context=e;this.subscriptions=[];this.update(),this.subscriptions.push(xi.workspace.onDidChangeConfiguration(t=>{(t.affectsConfiguration("swift.enableTerminalEnvironment")||t.affectsConfiguration("swift.path")||t.affectsConfiguration("swift.swiftEnvironmentVariables"))&&this.update()}))}dispose(){this.context.environmentVariableCollection.clear();for(let e of this.subscriptions)e.dispose()}update(){let e=this.context.environmentVariableCollection;if(e.clear(),!!K.enableTerminalEnvironment){K.path&&e.prepend("PATH",K.path+CI,{applyAtShellIntegration:!0});for(let t in K.swiftEnvironmentVariables)e.replace(t,K.swiftEnvironmentVariables[t],{applyAtShellIntegration:!0})}}},vp=class r{provideTerminalProfile(){let e={...K.swiftEnvironmentVariables};if(!K.enableTerminalEnvironment){let t=xi.window.onDidOpenTerminal(n=>{K.path&&n.sendText(`export PATH=${K.path+CI}$PATH`),t.dispose()})}return new xi.TerminalProfile({name:"Swift Terminal",iconPath:new xi.ThemeIcon("swift-icon"),shellArgs:[],env:e})}static register(){return xi.window.registerTerminalProfileProvider("swift.terminalProfile",new r)}};var DI=V(require("fs/promises"));var wp=class r{constructor(e,t){this.outputChannel=e;this.disposed=!1;this.checkIntervalMs=t?.checkIntervalMs||r.DEFAULT_CHECK_INTERVAL_MS,this.xcodeSymlink=t?.xcodeSymlink||(async()=>{try{return await DI.readlink(r.XCODE_SYMLINK_LOCATION)}catch{return}}),this.isValidXcodePlatform()&&this.setup()}static{this.DEFAULT_CHECK_INTERVAL_MS=2e3}static{this.XCODE_SYMLINK_LOCATION="/var/select/developer_dir"}dispose(){this.disposed=!0,clearInterval(this.interval)}async setup(){this.xcodePath=await this.xcodeSymlink(),this.interval=setInterval(async()=>{if(this.disposed)return clearInterval(this.interval);let e=await this.xcodeSymlink();!K.path&&e&&this.xcodePath!==e&&(this.outputChannel.appendLine(`Selected Xcode changed from ${this.xcodePath} to ${e}`),this.xcodePath=e,await qn("The Swift Extension has detected a change in the selected Xcode. Please reload the extension to apply the changes."))},this.checkIntervalMs)}isValidXcodePlatform(){return process.platform==="darwin"}};async function Jy(r){try{let e=new Mi("Swift");r.subscriptions.push(e),e.log("Activating Swift for Visual Studio Code..."),bI(e);let t=await uj(e);if(!t)return tp(),{workspaceContext:void 0,outputChannel:e,activate:()=>Jy(r),deactivate:async()=>{await TI(r)}};let n=await Gf.create(r,e,t);r.subscriptions.push(n),r.subscriptions.push(new mp(r)),r.subscriptions.push(vp.register()),r.subscriptions.push(...hI(t)),r.subscriptions.push(gs.workspace.onDidChangeConfiguration(Bb(n))),r.subscriptions.push(...gI(n)),r.subscriptions.push(y_(n)),r.subscriptions.push(new wp(e)),r.subscriptions.push(gs.tasks.registerTaskProvider("swift",n.taskProvider)),r.subscriptions.push(gs.tasks.registerTaskProvider("swift-plugin",n.pluginProvider)),r.subscriptions.push(new hp(n)),r.subscriptions.push(yI()),r.subscriptions.push(n.onDidChangeFolders(({folder:o,operation:a})=>{n.outputChannel.log(`${a}: ${o?.folder.fsPath}`,o?.name)}));let i=new Zf(n),s=gs.window.createTreeView("projectPanel",{treeDataProvider:i,showCollapseAll:!0});return i.observeFolders(s),r.subscriptions.push(s,i),r.subscriptions.push(n.onDidChangeFolders(aj(e))),r.subscriptions.push(sa.observeFolders(n)),n.addWorkspaceFolders(),Ge.isActivated=!0,{workspaceContext:n,outputChannel:e,activate:()=>Jy(r),deactivate:async()=>{await n.stop(),await TI(r)}}}catch(e){let t=hn(e);throw gs.window.showErrorMessage(`Activating Swift extension failed: ${t}`),e}}function aj(r){async function e(t,n){(!K.folder(t.workspaceFolder).disableAutoResolve||K.backgroundCompilation)&&(K.backgroundCompilation&&t.workspaceFolder.uri===t.folder?await t.backgroundCompilation.runTask():await Ku(t,!0),t.toolchain.swiftVersion.isGreaterThanOrEqual(new ve(5,6,0))&&n.statusItem.showStatusWhileRunning(`Loading Swift Plugins (${an.uriName(t.workspaceFolder.uri)})`,async()=>{await t.loadSwiftPlugins(r),n.updatePluginContextKey(),await t.fireEvent("pluginsUpdated")}))}return async({folder:t,operation:n,workspace:i})=>{if(t)switch(n){case"add":await Ei(t),await t.swiftPackage.foundPackage&&e(t,i);break;case"packageUpdated":await Ei(t),await t.swiftPackage.foundPackage&&!K.folder(t.workspaceFolder).disableAutoResolve&&await Ku(t,!0);break;case"resolvedUpdated":await t.swiftPackage.foundPackage&&!K.folder(t.workspaceFolder).disableAutoResolve&&await Ku(t,!0)}}}async function uj(r){try{let e=await Lr.create();return e.logDiagnostics(r),Ge.updateKeysBasedOnActiveVersion(e.swiftVersion),e}catch(e){r.log("Failed to discover Swift toolchain"),r.log(`${e}`);return}}async function TI(r){Ge.isActivated=!1,r.subscriptions.forEach(e=>e.dispose()),r.subscriptions.length=0}0&&(module.exports={activate});
/*! Bundled license information:

sax/lib/sax.js:
  (*! http://mths.be/fromcodepoint v0.1.0 by @mathias *)
*/
//# sourceMappingURL=extension.js.map
